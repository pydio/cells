(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Callbacks:()=>a,InfoPanel:()=>Or,MetaClient:()=>b,Renderer:()=>Ht,TypeEditor:()=>un,UserMetaDialog:()=>Dr,UserMetaPanel:()=>sr});const r=require("pydio");var n=e.n(r);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===o(i)?i:String(i)),n)}var i}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"editMeta",value:function(){var e=n().getInstance();e.UI.openComponentInModal("ReactMeta","UserMetaDialog",{dialogTitleId:489,selection:e.getUserSelection()})}}],null&&i(t.prototype,null),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const l=require("react");var u=e.n(l);const c=require("material-ui"),s=require("pydio/http/api");var f=e.n(s);const p=require("cells-sdk");function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==y(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===y(o)?o:String(o)),n)}var o}var b=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.client=f().getRestClient()}var t,r,n;return t=e,n=[{key:"getInstance",value:function(){return e.Instance||(e.Instance=new e),e.Instance}}],(r=[{key:"saveMeta",value:function(e,t){var r=this,n=new p.UserMetaServiceApi(this.client);return new Promise((function(o,i){r.loadConfigs().then((function(r){var a=[];e.map((function(e){var o=new p.IdmUpdateUserMetaRequest;o.MetaDatas=[],o.Operation="PUT",r.forEach((function(r,n){if(t.has(n)){var i=new p.IdmUserMeta;i.NodeUuid=e.getMetadata().get("uuid"),i.Namespace=n,i.JsonValue=JSON.stringify(t.get(n)),i.Policies=[p.ServiceResourcePolicy.constructFromObject({Action:"READ",Subject:"*",Effect:"allow"}),p.ServiceResourcePolicy.constructFromObject({Action:"WRITE",Subject:"*",Effect:"allow"})],o.MetaDatas.push(i)}})),a.push(n.updateUserMeta(o))})),Promise.all(a).then((function(){o()})).catch((function(e){i(e)}))}))}))}},{key:"clearConfigs",value:function(){this.configs=null}},{key:"loadConfigs",value:function(){var e=this;return this.configs?Promise.resolve(this.configs):(this.promise||(this.promise=new Promise((function(t){var r={},n=new Map;new p.UserMetaServiceApi(e.client).listUserMetaNamespace().then((function(o){o.Namespaces.map((function(e){var t=e.Namespace,n={label:e.Label,indexable:e.Indexable,order:e.Order,visible:!0,readonly:!e.PoliciesContextEditable};if(e.JsonDefinition){var o=JSON.parse(e.JsonDefinition);Object.keys(o).map((function(e){"hide"===e?n.visible=!o[e]:n[e]=o[e]}))}r[t]=n}));var i=Object.entries(r).map((function(e){return e[1].ns=e[0],e[1]}));i.sort((function(e,t){var r=e.order||0,n=t.order||0;return r>n?1:r===n?0:-1})),i.map((function(e){if("choice"===e.type&&e.data&&e.data.split){var t=e.data.split(",").map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("|"),2);return{key:t[0],value:t[1]}}));e.data={items:t}}n.set(e.ns,e)})),e.configs=n,t(n),e.promise=null})).catch((function(){t(new Map),e.promise=null}))}))),this.promise)}},{key:"listTags",value:function(e){var t=this;return new Promise((function(r){new p.UserMetaServiceApi(t.client).listUserMetaTags(e).then((function(e){e.Tags?r(e.Tags):r([])})).catch((function(e){r([])}))}))}},{key:"createTag",value:function(e,t){return new p.UserMetaServiceApi(this.client).putUserMetaTag(e,p.RestPutUserMetaTagRequest.constructFromObject({Namespace:e,Tag:t}))}}])&&m(t.prototype,r),n&&m(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},h.apply(this,arguments)}function g(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==v(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===v(o)?o:String(o)),n)}var o}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function j(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}(l,t);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(o);if(i){var r=w(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={value:t.props.value||0,configs:t.props.configs||new Map,getRealValue:function(){var e=t.props,r=e.node,n=e.column;return r.getMetadata().get(n.name)}},t}return r=l,(n=[{key:"componentDidMount",value:function(){var e=this;this.props.configs||b.getInstance().loadConfigs().then((function(t){e.setState({configs:t})}))}},{key:"render",value:function(){return u().createElement(e,h({},this.props,this.state))}}])&&g(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(u().Component)}function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==S(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===S(o)?o:String(o)),n)}var o}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function T(e){return T=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},T(e)}var k={fontSize:20,color:"#FBC02D",marginTop:6,marginBottom:6};const x=j(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=T(n);if(o){var r=T(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e=this.props,t=e.getRealValue,r=e.size,n=t()||0,o=[0,1,2,3,4].map((function(e){return u().createElement("span",{key:"star-"+e,className:"mdi mdi-star"+(n>e?"":"-outline")})})),i="small"===r?{color:k.color}:k;return u().createElement("span",{style:i},o)}}])&&P(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component));function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==C(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==C(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===C(o)?o:String(o)),n)}var o}function _(e,t){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_(e,t)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}const D=j(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(n);if(o){var r=R(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e,t=this.props,r=t.configs,n=t.getRealValue,o=t.column,i=n(),a=n(),l=r.get(o.name);if(l&&l.data&&l.data.items){var c=l.data.items.filter((function(e){return e.key===i}));c.length&&(a=c[0].value,c[0].color&&(e=u().createElement("span",{className:"mdi mdi-label",style:{color:c[0].color,marginRight:5}})))}return u().createElement("span",null,e,a)}}])&&M(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component));function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==I(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===I(o)?o:String(o)),n)}var o}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var B=function(){var e=n().getMessages();return{low:{label:e["meta.user.4"],sortValue:"5",color:"#66c"},todo:{label:e["meta.user.5"],sortValue:"4",color:"#69c"},personal:{label:e["meta.user.6"],sortValue:"3",color:"#6c6"},work:{label:e["meta.user.7"],sortValue:"2",color:"#c96"},important:{label:e["meta.user.8"],sortValue:"1",color:"#c66"}}};const L=j(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(n);if(o){var r=A(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,(r=[{key:"render",value:function(){var e=(0,this.props.getRealValue)(),t=B();if(e&&t[e]){var r=t[e];return u().createElement("span",null,u().createElement("span",{className:"mdi mdi-label",style:{color:r.color}})," ",r.label)}return u().createElement("span",null,e)}}])&&N(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component)),F=require("color");var U=e.n(F),q={};function W(e){if(0===e.length)return{};if(q[e])return q[e];var t,r,n=0;for(t=0,r=e.length;t<r;t++)n=(n<<5)-n+1e3*e.charCodeAt(t),n|=0;var o=(16777215&n).toString(16).toUpperCase(),i="00000".substring(0,6-o.length)+o,a=new(U())("#"+i).hsl(),l=a.hue(),u=new(U())({h:l,s:a.saturationl(),l:90}),c={color:new(U())({h:l,s:a.saturationl(),l:40}).string(),backgroundColor:u.string()};return q[e]=c,c}function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},J.apply(this,arguments)}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==z(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===z(o)?o:String(o)),n)}var o}function H(e,t){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},H(e,t)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}function G(e){return function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H(e,t)}(l,t);var r,n,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$(o);if(i){var r=$(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(t=a.call(this,e)).state={value:t.props.value||"",configs:t.props.configs||new Map,getRealValue:function(){var e=t.props,r=e.node,n=e.column;return r.getMetadata().get(n.name)}},t}return r=l,n=[{key:"updateValue",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setState({value:e});var r=this.props,n=r.fieldname,o=r.onChange,i=r.onValueChange;if(o){var a={};a["ajxp_meta_"+n]=e,o(a,t)}else this.props.onValueChange&&i(n,e,t)}},{key:"componentDidMount",value:function(){var e=this;this.props.configs||b.getInstance().loadConfigs().then((function(t){e.setState({configs:t})}))}},{key:"componentWillReceiveProps",value:function(e,t){this.setState({value:e.value||""})}},{key:"render",value:function(){return u().createElement(e,J({},this.props,this.state,{updateValue:this.updateValue.bind(this)}))}}],n&&K(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(u().Component)}const Y=require("material-ui/styles");function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){ee(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ee(e,t,r){return(t=re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,re(n.key),n)}}function re(e){var t=function(e,t){if("object"!==X(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===X(t)?t:String(t)}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ne(e,t)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}var ie=n().requireLib("hoc").ThemedModernStyles,ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oe(n);if(o){var r=oe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"render",value:function(){var e=this.props,t=e.updateValue,r=e.value,n=void 0===r?0:r,o=e.search,i=e.label,a=e.muiTheme,l=ie(a),c=[-1,0,1,2,3,4].map((function(e){var r="star"+(-1===e?"-off":n>e?"":"-outline"),o=-1===e?{marginRight:5,cursor:"pointer"}:{cursor:"pointer"};return u().createElement("span",{key:"star-"+e,onClick:function(){return t(e+1,!0)},className:"mdi mdi-"+r,style:o})}));return o?u().createElement("div",{className:"advanced-search-stars",style:Z(Z(Z({},l.div),{},{borderRadius:l.textFieldV1Search.inputStyle.borderRadius},k),{},{fontSize:18})},u().createElement("div",null,c)):u().createElement("div",{style:Z(Z({},l.textFieldV2.style),{},{borderBottom:l.fillBlockV2Right.borderBottom,marginBottom:6})},u().createElement("div",{style:{color:a.palette.mui3["on-surface-variant"],fontSize:12,padding:"3px 8px 0",lineHeight:"16px"}},i),u().createElement("div",{style:Z(Z({},k),{},{paddingLeft:6})},c))}}],r&&te(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);const le=G((0,Y.muiThemeable)()(ae));function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ce.apply(this,arguments)}function se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?se(Object(r),!0).forEach((function(t){pe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pe(e,t,r){return(t=be(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ye(e){return function(e){if(Array.isArray(e))return de(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return de(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?de(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,be(n.key),n)}}function be(e){var t=function(e,t){if("object"!==ue(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ue(t)?t:String(t)}function ve(e,t){return ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ve(e,t)}function he(e){return he=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},he(e)}var ge=n().requireLib("hoc"),Oe=ge.ModernSelectField,we=ge.ThemedModernStyles,je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ve(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=he(n);if(o){var r=he(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={},t}return t=a,r=[{key:"changeSelector",value:function(e,t,r){this.props.updateValue(r,!0)}},{key:"componentDidMount",value:function(){var e=this,t=this.props.itemsLoader;t&&t((function(t,r,n,o){e.setState({menuItems:t,keys:r,stepper:n,labels:o})}))}},{key:"next",value:function(){}},{key:"render",value:function(){var e,t=this.state,r=t.stepper,n=t.labels,o=void 0===n?{}:n,i=t.keys,a=void 0===i?[]:i,l=this.props,s=l.value,f=l.label,p=l.updateValue,y=l.search,d=l.muiTheme;e=void 0===this.state.menuItems?ye(this.props.menuItems):ye(this.state.menuItems);var m=we(d),b=m.fillBlockV2Right,v=m.fillBlockV2Left,h=m.selectFieldV1Search,g=m.selectFieldV2;e.unshift(u().createElement(c.MenuItem,{value:"",primaryText:""}));var O,w,j=y?fe({variant:"v1"},h):{variant:"v2"};if(r&&!y){var S=a.indexOf(s);S>0&&(O=o[a[S-1]]),S<a.length-1&&(w=o[a[S+1]]),j.style=fe(fe({},g.style),{},{borderRadius:0})}return u().createElement("div",{style:{display:"flex"}},r&&!y&&u().createElement("div",{style:fe(fe({},v),{},{marginRight:2,padding:"2px 4px"})},u().createElement(c.IconButton,{iconClassName:"mdi mdi-chevron-left",disabled:!O,tooltip:O,tooltipPosition:"bottom-right",onClick:function(){return p(a[a.indexOf(s)-1],!0)},style:{width:28,padding:"12px 0"}})),u().createElement("div",{style:{flex:1}},u().createElement(Oe,ce({fullWidth:!0,value:s,hintText:f,onChange:this.changeSelector.bind(this)},j),e)),r&&!y&&u().createElement("div",{style:fe(fe({},b),{},{marginLeft:2,padding:"2px 4px"})},u().createElement(c.IconButton,{iconClassName:"mdi mdi-chevron-right",tooltip:w,disabled:!w,tooltipPosition:"bottom-left",onClick:function(){return p(a[a.indexOf(s)+1],!0)},style:{width:28,padding:"12px 0"}})))}}],r&&me(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);const Se=G((0,Y.muiThemeable)()(je)),Pe=require("pydio/util/lang");var Ee=e.n(Pe);function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ke.apply(this,arguments)}function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ce(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){Me(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Me(e,t,r){return(t=Re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Re(n.key),n)}}function Re(e){var t=function(e,t){if("object"!==Te(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Te(t)?t:String(t)}function De(e,t){return De=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},De(e,t)}function Ie(e){return Ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ie(e)}var Ne=n().requireLib("hoc"),Ve=Ne.ThemedModernStyles,Ae=Ne.ModernAutoComplete,Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&De(e,t)}(l,e);var t,r,o,i,a=(o=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ie(o);if(i){var r=Ie(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);var r=(t=a.call(this,e)).props,n=r.node,o=r.value,i=r.column;return t.state={loading:!1,dataSource:[],tags:n?n.getMetadata().get(i.name):o,searchText:""},t}return t=l,r=[{key:"componentDidMount",value:function(){this.getRealValue(),this.props.editMode&&this.load()}},{key:"componentWillReceiveProps",value:function(e){var t=e.node,r=e.value,n=e.column;t?this.setState({tags:t.getMetadata().get(n.name)}):r?this.setState({tags:r}):this.setState({tags:""}),e.editMode&&!this.state.loaded&&this.load()}},{key:"getRealValue",value:function(){var e=this.props,t=e.node,r=e.value,n=e.column;null==t?this.setState({tags:r}):this.setState({tags:t.getMetadata().get(n.name)})}},{key:"suggestionLoader",value:function(e){var t=this,r=this.props,n=r.skipAutoSuggest,o=r.fieldname,i=r.column,a=r.autoSuggestTagName;n?e([]):(this.setState({loading:this.state.loading+1}),b.getInstance().listTags(a||o||i.name).then((function(r){t.setState({loading:t.state.loading-1}),e(r)})))}},{key:"load",value:function(){this.setState({loading:!0}),this.suggestionLoader(function(e){var t=e.filter((function(e){return!!e})).map((function(e){return{value:u().createElement(c.MenuItem,{innerDivStyle:{paddingLeft:0,marginLeft:0},style:Ce({margin:"5px 10px",fontSize:14,fontWeight:500,paddingLeft:10,borderRadius:4},W(e))},u().createElement("span",{className:"mdi mdi-label-outline",style:{marginRight:5}}),e),text:e}}));this.setState({dataSource:t,loading:!1,loaded:!0})}.bind(this))}},{key:"handleRequestDelete",value:function(e){var t=this,r=this.props.updateValue,n=this.state.tags.split(","),o=n.indexOf(e);n.splice(o,1),this.setState({tags:n.toString()},(function(){r(t.state.tags,!0)}))}},{key:"handleUpdateInput",value:function(e){this.setState({searchText:e})}},{key:"handleNewRequest",value:function(){var e=this,t=this.state,r=t.searchText,n=t.tags;if(r){var o=[];n&&n.split&&(o=n.split(",")),o.indexOf(r)>-1?this.setState({searchText:""}):(o.push(r),this.setState({searchText:"",tags:o.toString()},(function(){(0,e.props.updateValue)(e.state.tags,!0)})))}}},{key:"renderChip",value:function(e){var t=W(e),r=t.color,n=t.backgroundColor,o={margin:2,borderRadius:"4px 16px 16px 4px"},i={color:r,fontWeight:500,paddingLeft:10,paddingRight:16};return this.props.editMode?u().createElement(c.Chip,{key:e,backgroundColor:n,labelStyle:i,style:o,onRequestDelete:this.handleRequestDelete.bind(this,e)},e):u().createElement(c.Chip,{key:e,backgroundColor:n,labelStyle:i,style:o},e)}},{key:"render",value:function(){var e,t,r=this,o=this.props,i=o.editMode,a=o.search,l=o.label,s=o.muiTheme,f=this.state,p=f.tags,y=f.searchText,d=[];p&&p.split&&(e=(d=p.split(",").map((function(e){return Ee().trim(e," ")})).filter((function(e){return!!e}))).map((function(e){return r.renderChip(e)})));var m=Ve(s);if(i){var b=a?c.AutoComplete:Ae,v=a?Ce({style:{marginBottom:-10}},m.textFieldV1Search):{hintText:l};t=u().createElement(b,ke({fullWidth:!0,hintText:n().getMessages()["meta.user.10"],searchText:y,onUpdateInput:this.handleUpdateInput.bind(this),onNewRequest:this.handleNewRequest.bind(this),dataSource:this.state.dataSource,filter:function(e,t){return 0===t.toLowerCase().indexOf(e.toLowerCase())&&-1===d.indexOf(t)},openOnFocus:!0,menuProps:{maxHeight:200,desktop:!0},listStyle:{paddingTop:5,paddingBottom:5},onClose:function(){y&&r.handleNewRequest()}},v))}else t=u().createElement("div",null);return u().createElement("div",{style:a?{marginBottom:8}:{}},t,e&&u().createElement("div",{style:{display:"flex",flexWrap:"wrap",zoom:.8,marginTop:a?8:0}},e))}}],r&&_e(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(u().Component);const Le=G((0,Y.muiThemeable)()(Be));function Fe(e){return Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fe(e)}function Ue(){return Ue=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ue.apply(this,arguments)}function qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(r),!0).forEach((function(t){ze(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ze(e,t,r){return(t=$e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$e(n.key),n)}}function He(e,t,r){return t&&Ke(e.prototype,t),r&&Ke(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $e(e){var t=function(e,t){if("object"!==Fe(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Fe(t)?t:String(t)}function Ge(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ye(e,t)}function Ye(e,t){return Ye=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ye(e,t)}function Xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Qe(e);if(t){var o=Qe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===Fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Qe(e){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qe(e)}var Ze=n().requireLib("hoc"),et=Ze.ModernTextField,tt=Ze.ModernSelectField,rt=Ze.ThemedModernStyles,nt=Ze.DatePicker,ot=Ze.TimePicker,it=n().requireLib("boot").moment,at=function(e){Ge(r,e);var t=Xe(r);function r(){return Je(this,r),t.apply(this,arguments)}return He(r,[{key:"render",value:function(){var e=this.props,t=e.getRealValue,r=e.configs,n=e.column,o=r.get(n.name),i="date",a="normal";o&&o.data&&(i=o.data.format||i,a=o.data.display||a);var c=t(),s=new Date(1e3*parseFloat(c));if(isNaN(s.getTime()))return u().createElement(l.Fragment,null,"[Invalid Date]");var f=new it(s);if("relative"===a)return u().createElement(l.Fragment,null,f.fromNow());switch(i){case"date":return u().createElement(l.Fragment,null,f.format("ll"));case"date-time":default:return u().createElement(l.Fragment,null,f.format("llll"));case"time":return u().createElement(l.Fragment,null,f.format("LT"))}}}]),r}(l.Component);at=j((0,Y.muiThemeable)()(at));var lt=function(e){Ge(r,e);var t=Xe(r);function r(e){var n;return Je(this,r),(n=t.call(this,e)).state={},n}return He(r,[{key:"configAsState",value:function(e,t){e.has(t)&&this.setState(e.get(t).data)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.fieldname,n=t.configs;n?this.configAsState(n,r):b.getInstance().loadConfigs().then((function(t){return e.configAsState(t,r)}))}},{key:"getDate",value:function(){var e,t=this.props.value,r="";if(!t)return{vDate:null,searchComp:r};t.indexOf&&["<",">"].indexOf(t.charAt(0))>-1?(r=t.charAt(0),"="===t.charAt(1)?(r+="=",e=parseFloat(t.substr(2))):e=parseFloat(t.substr(1))):e=parseFloat(t);var n=new Date(1e3*parseFloat(e));return isNaN(n.getTime())?{vDate:new Date(0),searchComp:r}:{vDate:n,searchComp:r}}},{key:"clear",value:function(){(0,this.props.updateValue)("")}},{key:"updateDate",value:function(e,t){var r=this.props,n=r.updateValue,o=r.search,i=this.getDate(),a=i.vDate,l=i.searchComp;a||(a=new Date(0)),"date-time"===t?(e.setHours(a.getHours()),e.setMinutes(a.getMinutes()),e.setSeconds(a.getSeconds())):(e.setHours(0),e.setMinutes(0),e.setSeconds(0)),n(o?l+""+parseInt(e/1e3):parseInt(e/1e3))}},{key:"updateTime",value:function(e){var t=this.props,r=t.updateValue,n=t.search,o=this.getDate(),i=o.vDate,a=o.searchComp;i||(i=new Date(0)),i.setHours(e.getHours()),i.setMinutes(e.getMinutes()),i.setSeconds(e.getSeconds()),r(n?a+""+parseInt(i/1e3):parseInt(i/1e3))}},{key:"updateComp",value:function(e){var t=this.props.updateValue,r=this.getDate().vDate;r||(r=new Date),t(e+""+parseInt(r/1e3))}},{key:"render",value:function(){var e=this,t=this.props,r=t.supportTemplates,n=t.search,o=t.updateValue,i=t.value,a=t.label,l=t.muiTheme,s=rt(l);if(r)return u().createElement(et,{value:i,fullWidth:!0,hintText:a,onChange:function(e,t){o(t)}});var f=this.state.format,p=void 0===f?"date":f,y=this.getDate(),d=y.vDate,m=y.searchComp,b=[];if(n){var v=s.selectFieldV1Search,h=We(We({},v.style),{},{borderRadius:0,marginTop:4});b.push(u().createElement("div",{style:{width:60,marginRight:0}},u().createElement(tt,Ue({},v,{style:h,fullWidth:!0,value:m,onChange:function(t,r,n){return e.updateComp(n)}}),u().createElement(c.MenuItem,{value:"",primaryText:"="}),u().createElement(c.MenuItem,{value:">=",primaryText:">="}),u().createElement(c.MenuItem,{value:"<=",primaryText:"<="}),u().createElement(c.MenuItem,{value:">",primaryText:">"}),u().createElement(c.MenuItem,{value:"<",primaryText:"<"}))))}var g=n?We({},s.textFieldV1Search):We(We({},s.textFieldV2),{},{textFieldStyle:{height:52}});return"date"!==p&&"date-time"!==p||b.push(u().createElement("div",{style:{flex:3}},u().createElement(nt,Ue({floatingLabelText:n?null:a+" (date)",hintText:n?"Date":null},g,{container:"inline",fullWidth:!0,value:d,onChange:function(t,r){return e.updateDate(r,p)},autoOk:"date"===p})))),"date-time"===p&&b.push(u().createElement("div",{style:{width:8}})),"time"!==p&&"date-time"!==p||b.push(u().createElement("div",{style:{flex:2}},u().createElement(ot,Ue({floatingLabelText:n?null:a+" (time)",hintText:n?"Time":null},g,{dialogStyle:{zIndex:5e3},fullWidth:!0,value:d,onChange:function(t,r){return e.updateTime(r)},autoOk:"time"===p})))),!n&&d&&b.push(u().createElement("div",{style:We(We({cursor:"pointer"},s.fillBlockV2Right),{},{paddingTop:22,paddingRight:8}),onClick:function(){return e.clear()}},u().createElement(c.FontIcon,{className:"mdi mdi-close",color:"rgba(0,0,0,.5)"}))),u().createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:n?null:6}},b)}}]),r}(l.Component);function ut(e){return ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ut(e)}function ct(){return ct=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ct.apply(this,arguments)}function st(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ft(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?st(Object(r),!0).forEach((function(t){pt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function pt(e,t,r){return(t=dt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,dt(n.key),n)}}function dt(e){var t=function(e,t){if("object"!==ut(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===ut(t)?t:String(t)}function mt(e,t){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mt(e,t)}function bt(e){return bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},bt(e)}lt=G((0,Y.muiThemeable)()(lt));var vt=Pydio.requireLib("hoc").ThemedModernStyles,ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=bt(n);if(o){var r=bt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===ut(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"render",value:function(){var e=this.props,t=e.updateValue,r=e.value,n=e.search,o=e.muiTheme,i=vt(o),a=ft({},i.toggleFieldV1Search),l=r?"Yes":"No";n||(a=ft({},i.toggleFieldV2),l=this.props.label+" ("+l+")");var s=u().createElement(c.Toggle,ct({toggled:r,onToggle:function(e,r){t(r)},label:l,labelPosition:"right"},a));return n?s:u().createElement("div",{style:{margin:"12px 0 6px"}},s)}}],r&&yt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);const gt=G((0,Y.muiThemeable)()(ht));function Ot(e){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ot(e)}function wt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wt(Object(r),!0).forEach((function(t){St(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function St(e,t,r){return(t=xt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pt(){return Pt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pt.apply(this,arguments)}function Et(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xt(n.key),n)}}function kt(e,t,r){return t&&Tt(e.prototype,t),r&&Tt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xt(e){var t=function(e,t){if("object"!==Ot(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ot(t)?t:String(t)}function Ct(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mt(e,t)}function Mt(e,t){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mt(e,t)}function _t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Rt(e);if(t){var o=Rt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===Ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Rt(e){return Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rt(e)}var Dt=n().requireLib("form").InputIntegerBytes,It=n().requireLib("hoc"),Nt=It.ModernTextField,Vt=It.ModernSelectField,At=It.ModernStyles,Bt=function(e){Ct(r,e);var t=_t(r);function r(){return Et(this,r),t.apply(this,arguments)}return kt(r,[{key:"render",value:function(){var e=this.props,t=e.getRealValue,r=e.configs,n=e.column,o=e.inline,i=r.get(n.name),a="general";i&&i.data&&(a=i.data.format||a);var s=t();switch(a){case"bytesize":return u().createElement(Dt,{value:s,editMode:!1,displayContext:"grid",toggleEditMode:function(){},disabled:!0});case"percentage":return u().createElement(l.Fragment,null,s,"%");case"progress":return o?u().createElement(c.LinearProgress,{value:s,max:100,mode:"determinate",style:{display:"inline-block",width:60,height:6,backgroundColor:"rgba(189,189,189,.5)"}}):u().createElement("div",{style:{display:"flex",alignItems:"center"}},u().createElement(c.LinearProgress,{value:s,max:100,mode:"determinate",style:{flex:1}}),u().createElement("div",{style:{marginLeft:5}},s,"%"));default:return u().createElement(l.Fragment,null,s)}}}]),r}(u().Component);Bt=j(Bt);var Lt=function(e){Ct(r,e);var t=_t(r);function r(e){var n;return Et(this,r),(n=t.call(this,e)).state={},n}return kt(r,[{key:"configAsState",value:function(e,t){e.has(t)&&this.setState(e.get(t).data)}},{key:"componentDidMount",value:function(){var e=this,t=this.props,r=t.fieldname,n=t.configs;n?this.configAsState(n,r):b.getInstance().loadConfigs().then((function(t){return e.configAsState(t,r)}))}},{key:"render",value:function(){var e=this.props,t=e.supportTemplates,r=e.search,n=e.updateValue,o=e.label,i=function(e){n(e,!1)},a=this.state.format,l=void 0===a?"general":a,s=this.props.value,f="";r&&(s.indexOf&&["<",">"].indexOf(s.charAt(0))>-1?(f=s.charAt(0),"="===s.charAt(1)?(f+="=",s=parseInt(s.substr(2))):s=parseInt(s.substr(1))):s=parseInt(s));var p=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r?At.textFieldV1Search:null;return u().createElement(Nt,Pt({value:s,fullWidth:!0,hintText:o,type:e,onChange:t,underlineShow:!n,variant:r?"v1":"v2"},i))};if(t)return p("",(function(e,t){return i(t)}));if(r){var y=At.selectFieldV1Search,d=jt(jt({},y.style),{},{borderRadius:0});return u().createElement("div",{style:{display:"flex"}},u().createElement("div",{style:{width:60,marginRight:0}},u().createElement(Vt,Pt({},y,{style:d,fullWidth:!0,value:f,onChange:function(e,t,r){return i(r+""+s)}}),u().createElement(c.MenuItem,{value:"",primaryText:"="}),u().createElement(c.MenuItem,{value:">=",primaryText:">="}),u().createElement(c.MenuItem,{value:"<=",primaryText:"<="}),u().createElement(c.MenuItem,{value:">",primaryText:">"}),u().createElement(c.MenuItem,{value:"<",primaryText:"<"}))),u().createElement("div",{style:{flex:1}},p("number",(function(e,t){i(t?f+""+t:t)}))))}var m="number";switch(l){case"general":default:return p(m,(function(e,t){return i(parseInt(t))}));case"percentage":return p(m,(function(e,t){i(Math.max(0,Math.min(100,t)))}));case"progress":return u().createElement("div",null,p(m,(function(e,t){i(Math.max(0,Math.min(100,t)))}),!0),u().createElement(c.LinearProgress,{mode:"determinate",max:100,value:s,style:{marginTop:-8}}));case"bytesize":var b=function(){};return u().createElement(Dt,{value:s,editMode:!0,onChange:function(e,t){return i(parseInt(e))},isDisplayGrid:b,isDisplayForm:b,toggleEditMode:b,attributes:{type:"integer-bytes",label:o},variant:r?"v1":"v2"})}}}]),r}(u().Component);function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ut.apply(this,arguments)}function qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Wt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(r),!0).forEach((function(t){zt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zt(e,t,r){return(t=Kt(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Kt(n.key),n)}}function Kt(e){var t=function(e,t){if("object"!==Ft(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Ft(t)?t:String(t)}Lt=G(Lt);var Ht=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,r=[{key:"renderStars",value:function(e,t){return e.getMetadata().get(t.name)?u().createElement(x,{node:e,column:t,size:"small"}):null}},{key:"renderBoolean",value:function(e,t){return e.getMetadata().get(t.name)?u().createElement("span",null,u().createElement("span",{className:"mdi mdi-check",style:{color:"#4caf50"}})," ",t.label):null}},{key:"renderSelector",value:function(e,t){return e.getMetadata().get(t.name)?u().createElement(D,{node:e,column:t}):null}},{key:"renderCSSLabel",value:function(e,t){return e.getMetadata().get(t.name)?u().createElement(L,{node:e,column:t}):null}},{key:"renderTagsCloud",value:function(e,t){if(!e.getMetadata().get(t.name))return null;var r={display:"inline-block",backgroundColor:"#E1BEE7",borderRadius:6,height:22,lineHeight:"22px",padding:"0 6px",color:"#9C27B0",fontWeight:500,fontSize:12,marginLeft:2,marginRight:6},n=e.getMetadata().get(t.name);return n&&n.split?u().createElement("span",null,n.split(",").map((function(e,t){var o=Wt(Wt({},r),W(e));return t===n.split(",").length-1&&(o=Wt(Wt({},o),{},{marginRight:-4})),u().createElement("span",{style:o},e)}))):null}},{key:"renderDate",value:function(e,t){return e.getMetadata().get(t.name)?u().createElement(at,{node:e,column:t,type:"date"}):null}},{key:"renderInteger",value:function(e,t){return e.getMetadata().get(t.name)?u().createElement(Bt,{node:e,column:t,inline:!0}):null}},{key:"formPanelStars",value:function(e){return u().createElement(le,Ut({},e,{search:!0}))}},{key:"formPanelCssLabels",value:function(e,t){var r=Object.keys(B()).map(function(e){var t=B()[e],r=u().createElement("span",null,u().createElement("span",{className:"mdi mdi-label",style:{color:t.color,marginRight:5}}),t.label);return u().createElement(c.MenuItem,{value:e,primaryText:r})}.bind(this));return u().createElement(Se,Ut({},e,{menuItems:r,search:!t}))}},{key:"formPanelSelectorFilter",value:function(e,t){var r=function(t,r){var n,o=t.get(e.fieldname),i=[],a=[],l={};o&&o.data&&o.data.items&&(i=o.data.items.map((function(e){a.push(e.key),l[e.key]=e.value;var t=e.value;return e.color&&(t=u().createElement("span",null,u().createElement("span",{className:"mdi mdi-label",style:{color:e.color,marginRight:5}}),e.value)),u().createElement(c.MenuItem,{value:e.key,primaryText:t})}))),o&&o.data&&o.data.steps&&(n=!0),r(i,a,n,l)};return u().createElement(Se,Ut({},e,{menuItems:[],itemsLoader:function(e){t?r(t,e):b.getInstance().loadConfigs().then((function(t){return r(t,e)}))},search:!t}))}},{key:"formPanelTags",value:function(e,t){return u().createElement(Le,Ut({},e,{editMode:!0,search:!t}))}},{key:"formPanelDate",value:function(e){return u().createElement(lt,Ut({type:"date"},e,{editMode:!0,search:!0}))}},{key:"formPanelBoolean",value:function(e){return u().createElement(gt,Ut({},e,{search:!0}))}},{key:"formPanelInteger",value:function(e){return u().createElement(Lt,Ut({},e,{search:!0}))}},{key:"typeFormRenderer",value:function(t){switch(t){case"stars_rate":return e.formPanelStars;case"css_label":return e.formPanelCssLabels;case"choice":return e.formPanelSelectorFilter;case"tags":return e.formPanelTags;case"integer":return e.formPanelInteger;case"boolean":return e.formPanelBoolean;case"date":return e.formPanelDate;default:return null}}},{key:"typeColumnRenderer",value:function(t){var r;switch(t){case"stars_rate":r={renderComponent:e.renderStars,sortType:"number"};break;case"css_label":r={renderComponent:e.renderCSSLabel,sortType:"string"};break;case"choice":r={renderComponent:e.renderSelector,sortType:"string"};break;case"tags":r={renderComponent:e.renderTagsCloud,renderBlock:!0,sortType:"string"};break;case"integer":r={renderComponent:e.renderInteger,sortType:"number"};break;case"boolean":r={renderComponent:e.renderBoolean,sortType:"number"};break;case"date":r={renderComponent:e.renderDate,sortType:"number"};break;default:return{}}return r.renderComponent&&(r.renderCell=r.renderComponent),r}}],null&&Jt(t.prototype,null),r&&Jt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function $t(e){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$t(e)}var Gt=["style","children","muiTheme"];function Yt(e,t){if(e){if("string"==typeof e)return Xt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xt(e,t):void 0}}function Xt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Qt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ir(n.key),n)}}function Zt(e,t){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zt(e,t)}function er(e){return er=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},er(e)}function tr(){return tr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tr.apply(this,arguments)}function rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rr(Object(r),!0).forEach((function(t){or(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function or(e,t,r){return(t=ir(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ir(e){var t=function(e,t){if("object"!==$t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===$t(t)?t:String(t)}var ar=n().requireLib("hoc").ModernTextField,lr=n().requireLib("components").EmptyStateView,ur=(0,Y.muiThemeable)()((function(e){var t=e.style,r=e.children,n=e.muiTheme,o=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Gt),i=nr({},t);return t.borderTop&&(i=nr(nr({},t),{},{borderTop:t.borderTop+"px solid "+n.palette.mui3["outline-variant-50"]})),u().createElement("div",tr({style:i},o),r)})),cr="pydio.layout.meta-groups-expanded",sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zt(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=er(n);if(o){var r=er(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===$t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),void 0===e.editMode&&(e.editMode=!1),(t=i.call(this,e)).state={updateMeta:new Map,fields:{},configs:new Map,groupsExpanded:{}},localStorage.getItem(cr))try{t.state.groupsExpanded=JSON.parse(localStorage.getItem("pydio.layout.meta-groups-expanded"))||{}}catch(e){localStorage.removeItem(cr)}return t}return t=a,r=[{key:"componentDidMount",value:function(){var e=this;(this.props.loader?this.props.loader():b.getInstance().loadConfigs()).then((function(t){var r=e.props,n=r.node,o=r.loadChecks,i={},a=new Map;o&&t.forEach((function(e,t){n.getMetadata().has(t)&&(i[t]=!0,a.set(t,n.getMetadata().get(t)))})),e.setState({configs:t,fields:i,updateMeta:a})}))}},{key:"updateValue",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.state.updateMeta.set(e,t),this.setState({updateMeta:this.state.updateMeta}),this.props.onChangeUpdateData&&this.props.onChangeUpdateData(this.state.updateMeta),r&&this.props.autoSave&&this.props.autoSave()}},{key:"deleteValue",value:function(e){this.state.updateMeta.delete(e),this.setState({updateMeta:this.state.updateMeta}),this.props.onChangeUpdateData&&this.props.onChangeUpdateData(this.state.updateMeta)}},{key:"getUpdateData",value:function(){return this.state.updateMeta}},{key:"resetUpdateData",value:function(){this.setState({updateMeta:new Map}),this.props.onChangeUpdateData&&this.props.onChangeUpdateData(new Map)}},{key:"onCheck",value:function(e,t){var r=this.state.fields;r[e]=t,t||this.deleteValue(e),this.setState({fields:r})}},{key:"addNode",value:function(e,t,r){var n,o=e,i=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Yt(e))){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw i}}}}(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;o[a]||(o[a]={}),o=o[a]}}catch(e){i.e(e)}finally{i.f()}o.__NS__=r}},{key:"pathsToTree",value:function(e){var t=this,r={};return Object.keys(e).map((function(n){var o=e[n];if(""!==(n=n.replace(/(^\/|\/$)/g,"").replace(/\\/g,"/"))){var i=n.split("/");t.addNode(r,i,o)}else r.__NS__=o})),r}},{key:"render",value:function(){var e=this.state.configs,t=this.props,r=t.supportTemplates,n=t.multiple,o=t.pydio,i=t.style,a={};e.forEach((function(e,t){var n=e.type,o=e.groupName,i=void 0===o?"":o;("json"!==n||r)&&(a[i]||(a[i]=new Map),a[i].set(t,e))}));var l,c=this.pathsToTree(a);if(n){var s=o.MessageHash;l=u().createElement("div",{style:{paddingBottom:16}},u().createElement("em",null,s["meta.user.12"])," ",s["meta.user.13"])}return u().createElement("div",{style:nr({width:"100%",overflowY:"scroll",overflowX:"hidden"},i)},l,this.renderGroup("",c))}},{key:"renderGroup",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=this.state,i=o.updateMeta,a=o.groupsExpanded,l=this.props,s=l.pydio,f=l.node,p=l.editMode,y=l.onRequestEditMode,d=l.supportTemplates,m=l.multiple,b=l.additionalProps,v=[],h=f.getMetadata(),g=0,O=Object.keys(t).filter((function(e){return"__NS__"!==e}));O.sort();var w=t.__NS__||new Map;w.forEach((function(e,t){var n,o=e.label,a=e.type,l=e.readonly;if("json"!==a||d){n=h.get(t),i.has(t)&&(n=i.get(t));var s=n;if(p&&!l){var y,O={fieldname:t,label:o,value:n,configs:w,onValueChange:function(e,t,n){return r.updateValue(e,t,n)}};switch(b&&b[a]&&(O=nr(nr({},O),b[a])),a){case"stars_rate":y=u().createElement(le,O);break;case"choice":y=Ht.formPanelSelectorFilter(O,w);break;case"css_label":y=Ht.formPanelCssLabels(O,w);break;case"tags":y=Ht.formPanelTags(O,w);break;case"date":y=u().createElement(lt,tr({type:a},O,{supportTemplates:d}));break;case"integer":y=u().createElement(Lt,tr({},O,{supportTemplates:d}));break;case"boolean":y=u().createElement(gt,O);break;default:var j="integer"===a&&!d;y=u().createElement(ar,{value:n||"",variant:"v2",fullWidth:!0,disabled:l,floatingLabelText:o,multiLine:"textarea"===a||"json"===a,type:j?"number":null,onChange:function(e,n){j&&(n=parseInt(n)),r.updateValue(t,n)},onKeyPress:function(e){"Enter"===e.key&&r.updateValue(t,n,!0)}})}if(m){var S=r.state.fields[t]||!1;v.push(u().createElement("div",{className:"infoPanelRow",key:t,style:{marginBottom:20}},u().createElement(c.Checkbox,{checked:S,label:o,onCheck:function(e,n){return r.onCheck(t,n)}}),S&&u().createElement("div",{className:"infoPanelValue"},y)))}else v.push(u().createElement("div",{key:t},y))}else{var P={name:t};switch(a){case"stars_rate":n=u().createElement(x,{node:f,column:P});break;case"choice":n=u().createElement(D,{node:f,column:P});break;case"css_label":n=u().createElement(L,{node:f,column:P});break;case"tags":n=u().createElement(Le,{node:f,column:P});break;case"date":n=u().createElement(at,{node:f,column:P,type:a});break;case"integer":n=u().createElement(Bt,{node:f,column:P});break;case"boolean":s=n=n?"Yes":"No"}s&&g++,v.push(u().createElement("div",{className:"infoPanelRow"+(s?"":" no-value"),key:t},u().createElement("div",{className:"infoPanelLabel"},o),u().createElement("div",{className:"infoPanelValue"},n)))}}}));var j={header:{fontSize:14,fontWeight:500,paddingTop:10,paddingBottom:10,display:"flex",alignItems:"center",cursor:"pointer",borderTop:1},fields:{}};n>0&&(j.fields={marginLeft:16*n+8,marginBottom:10,marginTop:-8}),n>-1&&(j.header=nr(nr({},j.header),{},{marginLeft:16*(n+1),borderTop:0,paddingTop:0,paddingBottom:12}));var S,P=O.map((function(o,i){var l=e+"/"+o,c=a[l],s=j.header;return 0===i&&(s=nr(nr({},j.header),{},{borderTop:0})),u().createElement(u().Fragment,null,o&&u().createElement(ur,{style:s,className:"nsgroup-header",key:o,onClick:function(){r.setState({groupsExpanded:nr(nr({},a),{},or({},l,!c))},(function(){localStorage.setItem(cr,JSON.stringify(r.state.groupsExpanded))}))}},u().createElement("span",{className:"mdi mdi-chevron-"+(c?"down":"right"),style:{fontSize:18,color:"#ccc"}}),u().createElement("span",null," ",o)),a[l]&&r.renderGroup(l,t[o],n+1))}));v.push.apply(v,function(e){if(Array.isArray(e))return Xt(e)}(S=P)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(S)||Yt(S)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var E=s.MessageHash;if(p||g)return u().createElement("div",{style:nr({},j.fields)},v);var T={};return y&&(T={onClick:y,style:{cursor:"pointer"}}),u().createElement("div",T,u().createElement(lr,{pydio:this.props.pydio,iconClassName:"mdi mdi-tag-outline",primaryTextId:E["meta.user."+(y?"11":"16")],style:{padding:"10px 40px 20px",backgroundColor:"transparent"},iconStyle:{fontSize:40},legendStyle:{fontSize:13}}))}}],r&&Qt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);function fr(e){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fr(e)}function pr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?pr(Object(r),!0).forEach((function(t){dr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function dr(e,t,r){return(t=br(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,br(n.key),n)}}function br(e){var t=function(e,t){if("object"!==fr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===fr(t)?t:String(t)}function vr(e,t){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},vr(e,t)}function hr(e){return hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hr(e)}var gr=n().requireLib("workspaces").InfoPanelCard,Or=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hr(n);if(o){var r=hr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={},t._nodeObserver=function(){t.refs.panel&&t.refs.panel.resetUpdateData(),t.forceUpdate()},e.node&&e.node.observe("node_replaced",t._nodeObserver),t}return t=a,(r=[{key:"componentWillReceiveProps",value:function(e){this.props.node&&this.props.node.stopObserving("node_replaced",this._nodeObserver),e.node!==this.props.node&&this.refs.panel&&e.node.observe("node_replaced",this._nodeObserver)}},{key:"componentWillUnmount",value:function(){this.props.node&&this.props.node.stopObserving("node_replaced",this._nodeObserver)}},{key:"saveMeta",value:function(){var e=this.refs.panel.getUpdateData();return b.getInstance().saveMeta(this.props.pydio.getContextHolder().getSelectedNodes(),e)}},{key:"onChangeUpdateData",value:function(e){this.setState({updateData:e})}},{key:"render",value:function(){var e=this,t=[],r=this.props,n=r.pydio,o=r.node,i=r.popoverPanel,a=n.MessageHash,l=this.state.updateData||new Map,s="true"===o.getMetadata().get("node_readonly"),f=!1;!s&&l.size>0&&(f=!0,t.push(u().createElement(c.FlatButton,{key:"edit",label:a["meta.user.15"],onClick:function(){e.saveMeta()}})));var p={};return i&&(p=yr(yr({},p),{},{maxHeight:"80vh",overflowY:"auto"})),f||(p=yr(yr({},p),{},{paddingBottom:16})),u().createElement(gr,{identifier:"meta-user",style:this.props.style,title:this.props.pydio.MessageHash["meta.user.1"],actions:t.length?t:null,icon:"tag-multiple",iconColor:"#00ACC1",popoverPanel:i},u().createElement(sr,{ref:"panel",node:this.props.node,editMode:!s,pydio:this.props.pydio,onChangeUpdateData:function(t){e.onChangeUpdateData(t)},autoSave:function(){e.saveMeta()},style:p}))}}])&&mr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);const wr=require("pydio/model/node");var jr=e.n(wr);const Sr=require("pydio/model/data-model");var Pr=e.n(Sr);const Er=require("create-react-class");var Tr=e.n(Er);const kr=require("prop-types");var xr=e.n(kr),Cr=n().requireLib("boot"),Mr=Cr.ActionDialogMixin,_r=Cr.CancelButtonProviderMixin,Rr=Cr.SubmitButtonProviderMixin;const Dr=Tr()({displayName:"UserMetaDialog",propsTypes:{selection:xr().instanceOf(Pr())},mixins:[Mr,_r,Rr],saveMeta:function(){var e=this.refs.panel.getUpdateData(),t={};return e.forEach((function(e,r){t[r]=e})),b.getInstance().saveMeta(this.props.selection.getSelectedNodes(),e)},submit:function(){var e=this;this.saveMeta().then((function(){e.dismiss()}))},render:function(){return u().createElement(sr,{pydio:this.props.pydio,multiple:!this.props.selection.isUnique(),ref:"panel",node:this.props.selection.isUnique()?this.props.selection.getUniqueNode():new(jr()),editMode:!0,style:{fontSize:14}})}});function Ir(e){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}function Nr(){return Nr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nr.apply(this,arguments)}function Vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Ir(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Ir(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Ir(o)?o:String(o)),n)}var o}function Ar(e,t){return Ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ar(e,t)}function Br(e){return Br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Br(e)}var Lr=Pydio.requireLib("hoc"),Fr=Lr.ModernSelectField,Ur=Lr.ModernTextField,qr=Lr.ThemedModernStyles,Wr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ar(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Br(n);if(o){var r=Br(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Ir(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={},t}return t=a,r=[{key:"addSelectionValue",value:function(){var e=this.state,t=e.selectorNewKey,r=e.selectorNewValue,n=e.selectorNewColor,o=this.props,i=o.data,a=o.setAdditionalDataKey,l=i.items,u=void 0===l?[]:l;u.push({key:t,value:r,color:n}),a("items",u),this.setState({selectorNewKey:"",selectorNewValue:"",selectorNewColor:""})}},{key:"removeSelectionValue",value:function(e){var t=this.props,r=t.data,n=t.setAdditionalDataKey,o=r.items;n("items",(void 0===o?[]:o).filter((function(t){return t.key!==e})))}},{key:"renderColor",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r?u().createElement("span",{className:"mdi mdi-label"+(t?"":"-outline"),style:{color:t||"#ccc",marginRight:5}}):u().createElement("span",{style:{width:60,marginRight:6}},u().createElement(Fr,{disabled:r,fullWidth:!0,value:t,onChange:function(t,r,n){e.setState({selectorNewColor:n})}},u().createElement(c.MenuItem,{value:"",primaryText:u().createElement("span",{className:"mdi mdi-label-outline",style:{color:"#ccc"}})}),["#9c27b0","#607d8b","#66c","#69c","#6c6","#696","#c96","#ff9800","#c66","#fff","#ccc","#999","#000"].map((function(e){return u().createElement(c.MenuItem,{value:e,primaryText:u().createElement("span",{className:"mdi mdi-label",style:{color:e}})})}))))}},{key:"render",value:function(){var e=this,t=this.props,r=t.data,n=t.m,o=t.setAdditionalDataKey,i=t.muiTheme,a=this.state,s=a.selectorNewKey,f=a.selectorNewValue,p=a.selectorNewColor,y=r.items,d=void 0===y?[]:y,m=qr(i);return u().createElement(l.Fragment,null,u().createElement("div",{style:{padding:10,paddingRight:0,backgroundColor:"#f5f5f5",borderRadius:3}},u().createElement("div",{style:{fontSize:13}},n("editor.selection")),u().createElement("div",null,d.map((function(t){var r=t.key,n=t.value,o=t.color;return u().createElement("div",{key:r,style:{display:"flex",alignItems:"center"}},e.renderColor(o,!0),u().createElement("span",{style:{marginRight:6,width:80}},u().createElement(Ur,{value:r,disabled:!0,fullWidth:!0})),u().createElement("span",{style:{flex:1}},u().createElement(Ur,{value:n,disabled:!0,fullWidth:!0})),u().createElement("span",null,u().createElement(c.IconButton,{iconClassName:"mdi mdi-delete",iconStyle:{color:"rgba(0,0,0,.3)"},onClick:function(){e.removeSelectionValue(r)}})))}))),u().createElement("div",{style:{display:"flex"},key:"new-selection-key"},this.renderColor(p),u().createElement("span",{style:{width:80,marginRight:6}},u().createElement(Ur,{value:s,onChange:function(t,r){e.setState({selectorNewKey:r})},hintText:n("editor.selection.key"),fullWidth:!0})),u().createElement("span",{style:{flex:1}},u().createElement(Ur,{value:f,onChange:function(t,r){e.setState({selectorNewValue:r})},hintText:n("editor.selection.value"),fullWidth:!0})),u().createElement("span",null,u().createElement(c.IconButton,{iconClassName:"mdi mdi-plus",onClick:function(){e.addSelectionValue()},disabled:!s||!f})))),u().createElement("div",null,u().createElement(c.Toggle,Nr({label:n("editor.selection.steps"),labelPosition:"left",toggled:r.steps,onToggle:function(e,t){return o("steps",t)}},m.toggleFieldV2))))}}],r&&Vr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);const zr=Wr=(0,Y.muiThemeable)()(Wr);function Jr(e){return Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jr(e)}function Kr(){return Kr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kr.apply(this,arguments)}function Hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(r),!0).forEach((function(t){Gr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Gr(e,t,r){return(t=Qr(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qr(n.key),n)}}function Qr(e){var t=function(e,t){if("object"!==Jr(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Jr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Jr(t)?t:String(t)}function Zr(e,t){return Zr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zr(e,t)}function en(e){return en=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},en(e)}var tn=n().requireLib("hoc"),rn=tn.ModernSelectField,nn=tn.ModernTextField,on=tn.ThemedModernStyles,an={string:"Text",textarea:"Long Text",integer:"Number",boolean:"Boolean",date:"Date",choice:"Selection",tags:"Extensible Tags",stars_rate:"Stars Rating",css_label:"Color Labels",json:"JSON"},ln=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zr(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=en(n);if(o){var r=en(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Jr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function a(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return t=a,r=[{key:"slugifier",value:function(e){var t=this.props.slugifier;return(void 0===t?Ee().computeStringSlug:t)(e)}},{key:"updateType",value:function(e){var t=this.props,r=t.namespace,n=t.onChange,o={type:e};"date"===e&&(o.data={format:"date",display:"normal"}),r.JsonDefinition=JSON.stringify(o),n(r)}},{key:"updateLabel",value:function(e){var t=this.props,r=t.create,n=t.namespace,o=t.onChange,i=t.forcePrefix,a=void 0===i?"":i,l=t.labelToName;!r||!(void 0===l||l)||n.Namespace&&n.Namespace!==a+this.slugifier(n.Label)||this.updateName(e),n.Label=e,o(n)}},{key:"updateName",value:function(e){var t=this.props,r=t.namespace,n=t.onChange,o=t.forcePrefix,i=this.slugifier(e);o&&0!==i.indexOf(o)&&(i=o+i),r.Namespace=i,n(r)}},{key:"getAdditionalData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.props.namespace;try{var r=JSON.parse(t.JsonDefinition).data||e;return e.items&&r.split?{items:r.split(",").map((function(e){var t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,l=[],u=!0,c=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Yr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Yr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("|"),2);return{key:t[0],value:t[1]}}))}:r}catch(e){}return e}},{key:"setAdditionalDataKey",value:function(e,t){var r=this.props,n=r.namespace,o=r.onChange,i=JSON.parse(n.JsonDefinition),a=Gr({},e,t);i.data=$r($r({},i.data),a),n.JsonDefinition=JSON.stringify(i),o(n)}},{key:"render",value:function(){var e=this,t=this.props,r=t.pydio,n=t.create,o=t.namespace,i=t.readonly,a=t.labelError,s=t.nameError,f=t.styles,p=t.metaTypes,y=void 0===p?an:p,d=t.showMandatory,m=void 0!==d&&d,b=t.showDefaultValue,v=void 0!==b&&b,h=t.format,g=void 0===h?["label","namespace","section","type","value","mandatory"]:h,O=t.muiTheme,w=on(O),j=this.props.m;j||(j=function(e){return r.MessageHash["ajxp_admin.metadata."+e]||e});var S="string";o.JsonDefinition&&(S=JSON.parse(o.JsonDefinition).type);var P={};return P.label=u().createElement(nn,{floatingLabelText:j("label"),value:o.Label,onChange:function(t,r){e.updateLabel(r)},fullWidth:!0,errorText:a,disabled:i,variant:"v2"}),P.namespace=u().createElement(nn,{floatingLabelText:j("namespace"),disabled:!n,value:o.Namespace,onChange:function(t,r){e.updateName(r)},fullWidth:!0,errorText:s,variant:"v2"}),P.section=u().createElement("div",{style:f.section},j("type")),P.type=u().createElement(l.Fragment,null,u().createElement(rn,{hintText:j("type"),value:S,onChange:function(t,r,n){return e.updateType(n)},disabled:i,fullWidth:!0,variant:"v2"},Object.keys(y).map((function(e){return u().createElement(c.MenuItem,{value:e,primaryText:j("type."+e)||y[e]})}))),"choice"===S&&u().createElement(zr,{data:this.getAdditionalData({items:[],steps:!1}),setAdditionalDataKey:this.setAdditionalDataKey.bind(this),m:j}),"date"===S&&u().createElement(l.Fragment,null,u().createElement(rn,{hintText:j("type.date.format"),value:this.getAdditionalData({format:"date",display:"normal"}).format,onChange:function(t,r,n){return e.setAdditionalDataKey("format",n)},disabled:i,fullWidth:!0,variant:"v2"},u().createElement(c.MenuItem,{value:"date",primaryText:j("type.date.format.date")}),u().createElement(c.MenuItem,{value:"date-time",primaryText:j("type.date.format.date-time")}),u().createElement(c.MenuItem,{value:"time",primaryText:j("type.date.format.time")})),u().createElement(rn,{hintText:j("type.date.display"),value:this.getAdditionalData({format:"date",display:"normal"}).display,onChange:function(t,r,n){return e.setAdditionalDataKey("display",n)},disabled:i,fullWidth:!0,variant:"v2"},u().createElement(c.MenuItem,{value:"normal",primaryText:j("type.date.display.normal")}),u().createElement(c.MenuItem,{value:"relative",primaryText:j("type.date.display.relative")}))),"integer"===S&&u().createElement(l.Fragment,null,u().createElement(rn,{hintText:j("type.integer.format"),value:this.getAdditionalData({format:"general"}).format||"general",onChange:function(t,r,n){return e.setAdditionalDataKey("format",n)},disabled:i,fullWidth:!0,variant:"v2"},u().createElement(c.MenuItem,{value:"general",primaryText:j("type.integer.format.general")}),u().createElement(c.MenuItem,{value:"bytesize",primaryText:j("type.integer.format.bytesize")}),u().createElement(c.MenuItem,{value:"percentage",primaryText:j("type.integer.format.percentage")}),u().createElement(c.MenuItem,{value:"progress",primaryText:j("type.integer.format.progress")})))),P.value=u().createElement(nn,{floatingLabelText:v,value:this.getAdditionalData({defaultValue:""}).defaultValue,onChange:function(t,r){e.setAdditionalDataKey("defaultValue",r)},fullWidth:!0,variant:"v2"}),P.mandatory=u().createElement(c.Toggle,Kr({},w.toggleFieldV2,{toggled:this.getAdditionalData({mandatory:!1}).mandatory,onToggle:function(t,r){e.setAdditionalDataKey("mandatory",r)},label:j("field.mandatory"),labelPosition:"right"})),u().createElement("div",null,g.filter((function(e){return v||"value"!==e})).filter((function(e){return m||"mandatory"!==e})).map((function(e){return P[e]})))}}],r&&Xr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(u().Component);(ln=(0,Y.muiThemeable)()(ln)).MetaTypes=an;const un=ln;window.ReactMeta=t})();