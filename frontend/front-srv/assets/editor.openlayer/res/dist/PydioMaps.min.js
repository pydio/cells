(()=>{var t={424:t=>{"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},257:function(t,e,n){var r,i,o;function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}o=function(){"use strict";function t(t,r,i,o,a){!function t(n,r,i,o,a){for(;o>i;){if(o-i>600){var u=o-i+1,s=r-i+1,l=Math.log(u),c=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*c*(u-c)/u)*(s-u/2<0?-1:1);t(n,r,Math.max(i,Math.floor(r-s*c/u+f)),Math.min(o,Math.floor(r+(u-s)*c/u+f)),a)}var h=n[r],y=i,p=o;for(e(n,i,r),a(n[o],h)>0&&e(n,i,o);y<p;){for(e(n,y,p),y++,p--;a(n[y],h)<0;)y++;for(;a(n[p],h)>0;)p--}0===a(n[i],h)?e(n,i,p):e(n,++p,o),p<=r&&(i=p+1),r<=p&&(o=p-1)}}(t,r,i||0,o||t.length-1,a||n)}function e(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function n(t,e){return t<e?-1:t>e?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(t,e,n){if(!n)return e.indexOf(t);for(var r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function o(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,r,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=e;o<n;o++){var a=t.children[o];u(i,t.leaf?r(a):a)}return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function s(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function h(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function y(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,r,i,o){for(var a=[n,r];a.length;)if(!((r=a.pop())-(n=a.pop())<=i)){var u=n+Math.ceil((r-n)/i/2)*i;t(e,u,n,r,o),a.push(n,u,u,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var e=this.data,n=[];if(!y(t,e))return n;for(var r=this.toBBox,i=[];e;){for(var o=0;o<e.children.length;o++){var a=e.children[o],u=e.leaf?r(a):a;y(t,u)&&(e.leaf?n.push(a):h(t,u)?this._all(a,n):i.push(a))}e=i.pop()}return n},r.prototype.collides=function(t){var e=this.data;if(!y(t,e))return!1;for(var n=[];e;){for(var r=0;r<e.children.length;r++){var i=e.children[r],o=e.leaf?this.toBBox(i):i;if(y(t,o)){if(e.leaf||h(t,o))return!0;n.push(i)}}e=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,e){if(!t)return this;for(var n,r,o,a=this.data,u=this.toBBox(t),s=[],l=[];a||s.length;){if(a||(a=s.pop(),r=s[s.length-1],n=l.pop(),o=!0),a.leaf){var c=i(t,a.children,e);if(-1!==c)return a.children.splice(c,1),s.push(a),this._condense(s),this}o||a.leaf||!h(a,u)?r?(n++,a=r.children[n],o=!1):a=null:(s.push(a),l.push(n),n=0,r=a,a=a.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,e){return t.minX-e.minX},r.prototype.compareMinY=function(t,e){return t.minY-e.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},r.prototype._build=function(t,e,n,r){var i,a=n-e+1,u=this._maxEntries;if(a<=u)return o(i=p(t.slice(e,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,r-1))),(i=p([])).leaf=!1,i.height=r;var s=Math.ceil(a/u),l=s*Math.ceil(Math.sqrt(u));v(t,e,n,l,this.compareMinX);for(var c=e;c<=n;c+=l){var f=Math.min(c+l-1,n);v(t,c,f,s,this.compareMinY);for(var h=c;h<=f;h+=s){var y=Math.min(h+s-1,f);i.children.push(this._build(t,h,y,r-1))}}return o(i,this.toBBox),i},r.prototype._chooseSubtree=function(t,e,n,r){for(;r.push(e),!e.leaf&&r.length-1!==n;){for(var i=1/0,o=1/0,a=void 0,u=0;u<e.children.length;u++){var s=e.children[u],l=c(s),f=(h=t,y=s,(Math.max(y.maxX,h.maxX)-Math.min(y.minX,h.minX))*(Math.max(y.maxY,h.maxY)-Math.min(y.minY,h.minY))-l);f<o?(o=f,i=l<i?l:i,a=s):f===o&&l<i&&(i=l,a=s)}e=a||e.children[0]}var h,y;return e},r.prototype._insert=function(t,e,n){var r=n?t:this.toBBox(t),i=[],o=this._chooseSubtree(r,this.data,e,i);for(o.children.push(t),u(o,r);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},r.prototype._split=function(t,e){var n=t[e],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),u=p(n.children.splice(a,n.children.length-a));u.height=n.height,u.leaf=n.leaf,o(n,this.toBBox),o(u,this.toBBox),e?t[e-1].children.push(u):this._splitRoot(n,u)},r.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,e,n){for(var r,i,o,u,s,l,f,h=1/0,y=1/0,p=e;p<=n-e;p++){var v=a(t,0,p,this.toBBox),d=a(t,p,n,this.toBBox),g=(i=v,o=d,u=Math.max(i.minX,o.minX),s=Math.max(i.minY,o.minY),l=Math.min(i.maxX,o.maxX),f=Math.min(i.maxY,o.maxY),Math.max(0,l-u)*Math.max(0,f-s)),m=c(v)+c(d);g<h?(h=g,r=p,y=m<y?m:y):g===h&&m<y&&(y=m,r=p)}return r||n-e},r.prototype._chooseSplitAxis=function(t,e,n){var r=t.leaf?this.compareMinX:s,i=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,r)<this._allDistMargin(t,e,n,i)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,e,n,r){t.children.sort(r);for(var i=this.toBBox,o=a(t,0,e,i),s=a(t,n-e,n,i),l=f(o)+f(s),c=e;c<n-e;c++){var h=t.children[c];u(o,t.leaf?i(h):h),l+=f(o)}for(var y=n-e-1;y>=e;y--){var p=t.children[y];u(s,t.leaf?i(p):p),l+=f(s)}return l},r.prototype._adjustParentBBoxes=function(t,e,n){for(var r=n;r>=0;r--)u(e[r],t)},r.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},r},"object"==a(e)?t.exports=o():void 0===(i="function"==typeof(r=o)?r.call(e,n,e,t):r)||(t.exports=i)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r].call(o.exports,o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{Editor:()=>Qv,OLMap:()=>Wv});const t=require("react");var e=n.n(t);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===i(o)?o:String(o)),r)}var o}const a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}var e,n;return e=t,(n=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),u="propertychange";function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===s(i)?i:String(i)),r)}var i}const c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.disposed=!1}var e,n;return e=t,(n=[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])&&l(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t,e){return t>e?1:t<e?-1:0}function h(t,e,n){if(t[0]<=e)return 0;var r=t.length;if(e<=t[r-1])return r-1;if("function"==typeof n){for(var i=1;i<r;++i){var o=t[i];if(o===e)return i;if(o<e)return n(e,t[i-1],o)>0?i-1:i}return r-1}if(n>0){for(var a=1;a<r;++a)if(t[a]<e)return a-1;return r-1}if(n<0){for(var u=1;u<r;++u)if(t[u]<=e)return u;return r-1}for(var s=1;s<r;++s){if(t[s]==e)return s;if(t[s]<e)return t[s-1]-e<e-t[s]?s-1:s}return r-1}function y(t,e,n){for(;e<n;){var r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function p(t,e){for(var n=Array.isArray(e)?e:[e],r=n.length,i=0;i<r;i++)t[t.length]=n[i]}function v(t,e){var n=t.length;if(n!==e.length)return!1;for(var r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function d(){return!0}function g(){return!1}function m(){}function b(t){var e,n,r,i=!1;return function(){var o=Array.prototype.slice.call(arguments);return i&&this===r&&v(o,n)||(i=!0,r=this,n=o,e=t.apply(this,arguments)),e}}function _(t){for(var e in t)delete t[e]}function w(t){var e;for(e in t)return!1;return!e}function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==S(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===S(i)?i:String(i)),r)}var i}function x(t,e){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},x(t,e)}function k(t){return k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},k(t)}const P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&x(t,e)}(u,t);var e,n,r,i,o=(r=u,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=k(r);if(i){var n=k(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===S(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=o.call(this)).eventTarget_=t,e.pendingRemovals_=null,e.dispatching_=null,e.listeners_=null,e}return e=u,(n=[{key:"addEventListener",value:function(t,e){if(t&&e){var n=this.listeners_||(this.listeners_={}),r=n[t]||(n[t]=[]);r.includes(e)||r.push(e)}}},{key:"dispatchEvent",value:function(t){var e="string"==typeof t,n=e?t:t.type,r=this.listeners_&&this.listeners_[n];if(r){var i=e?new a(t):t;i.target||(i.target=this.eventTarget_||this);var o,u=this.dispatching_||(this.dispatching_={}),s=this.pendingRemovals_||(this.pendingRemovals_={});n in u||(u[n]=0,s[n]=0),++u[n];for(var l=0,c=r.length;l<c;++l)if(!1===(o="handleEvent"in r[l]?r[l].handleEvent(i):r[l].call(this,i))||i.propagationStopped){o=!1;break}if(0==--u[n]){var f=s[n];for(delete s[n];f--;)this.removeEventListener(n,m);delete u[n]}return o}}},{key:"disposeInternal",value:function(){this.listeners_&&_(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_&&this.listeners_[t]||void 0}},{key:"hasListener",value:function(t){return!!this.listeners_&&(t?t in this.listeners_:Object.keys(this.listeners_).length>0)}},{key:"removeEventListener",value:function(t,e){if(this.listeners_){var n=this.listeners_[t];if(n){var r=n.indexOf(e);-1!==r&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[r]=m,++this.pendingRemovals_[t]):(n.splice(r,1),0===n.length&&delete this.listeners_[t]))}}}}])&&O(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(c),E="change",j="contextmenu",R="click",T="keydown",C="keypress",I="touchmove",M="wheel";function A(t,e,n,r,i){if(r&&r!==t&&(n=n.bind(r)),i){var o=n;n=function(){t.removeEventListener(e,n),o.apply(this,arguments)}}var a={target:t,type:e,listener:n};return t.addEventListener(e,n),a}function F(t,e,n,r){return A(t,e,n,r,!0)}function L(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),_(t))}function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===D(i)?i:String(i)),r)}var i}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},G(t,e)}function z(t){return z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},z(t)}var N=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=z(r);if(i){var n=z(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t}return e=a,(n=[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(E)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(t,e){if(Array.isArray(t)){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=A(this,t[i],e);return r}return A(this,t,e)}},{key:"onceInternal",value:function(t,e){var n;if(Array.isArray(t)){var r=t.length;n=new Array(r);for(var i=0;i<r;++i)n[i]=F(this,t[i],e)}else n=F(this,t,e);return e.ol_key=n,n}},{key:"unInternal",value:function(t,e){var n=e.ol_key;if(n)!function(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)L(t[e]);else L(t)}(n);else if(Array.isArray(t))for(var r=0,i=t.length;r<i;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)}}])&&B(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(P);N.prototype.on,N.prototype.once,N.prototype.un;const W=N;function X(){throw new Error("Unimplemented abstract method.")}var Y=0;function K(t){return t.ol_uid||(t.ol_uid=String(++Y))}function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Z(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Z(i)?i:String(i)),r)}var i}function U(t,e,n){return e&&V(t.prototype,e),n&&V(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}function Q(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=tt(t);if(e){var i=tt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return $(t)}(this,n)}}function $(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tt(t){return tt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tt(t)}var et=function(t){H(n,t);var e=Q(n);function n(t,r,i){var o;return q(this,n),(o=e.call(this,t)).key=r,o.oldValue=i,o}return U(n)}(a);const nt=function(t){H(n,t);var e=Q(n);function n(t){var r;return q(this,n),(r=e.call(this)).on,r.once,r.un,K($(r)),r.values_=null,void 0!==t&&r.setProperties(t),r}return U(n,[{key:"get",value:function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&Object.assign({},this.values_)||{}}},{key:"getPropertiesInternal",value:function(){return this.values_}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(t,e){var n;n="change:".concat(t),this.hasListener(n)&&this.dispatchEvent(new et(n,t,e)),n=u,this.hasListener(n)&&this.dispatchEvent(new et(n,t,e))}},{key:"addChangeListener",value:function(t,e){this.addEventListener("change:".concat(t),e)}},{key:"removeChangeListener",value:function(t,e){this.removeEventListener("change:".concat(t),e)}},{key:"set",value:function(t,e,n){var r=this.values_||(this.values_={});if(n)r[t]=e;else{var i=r[t];r[t]=e,i!==e&&this.notify(t,i)}}},{key:"setProperties",value:function(t,e){for(var n in t)this.set(n,t[n],e)}},{key:"applyProperties",value:function(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}},{key:"unset",value:function(t,e){if(this.values_&&t in this.values_){var n=this.values_[t];delete this.values_[t],w(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}]),n}(W),rt="add",it="remove";function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function at(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ot(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ot(i)?i:String(i)),r)}var i}function ut(t,e,n){return e&&at(t.prototype,e),n&&at(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function st(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ct(t,e)}function ct(t,e){return ct=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ct(t,e)}function ft(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=ht(t);if(e){var i=ht(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function ht(t){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ht(t)}var yt="length",pt=function(t){lt(n,t);var e=ft(n);function n(t,r,i){var o;return st(this,n),(o=e.call(this,t)).element=r,o.index=i,o}return ut(n)}(a);const vt=function(t){lt(n,t);var e=ft(n);function n(t,r){var i;if(st(this,n),(i=e.call(this)).on,i.once,i.un,r=r||{},i.unique_=!!r.unique,i.array_=t||[],i.unique_)for(var o=0,a=i.array_.length;o<a;++o)i.assertUnique_(i.array_[o],o);return i.updateLength_(),i}return ut(n,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this}},{key:"forEach",value:function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)t(e[n],n,e)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get(yt)}},{key:"insertAt",value:function(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new pt(rt,e,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}},{key:"remove",value:function(t){for(var e=this.array_,n=0,r=e.length;n<r;++n)if(e[n]===t)return this.removeAt(n)}},{key:"removeAt",value:function(t){if(!(t<0||t>=this.getLength())){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new pt(it,e,t)),e}}},{key:"setAt",value:function(t,e){if(t>=this.getLength())this.insertAt(t,e);else{if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);var n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new pt(it,n,t)),this.dispatchEvent(new pt(rt,e,t))}}},{key:"updateLength_",value:function(){this.set(yt,this.array_.length)}},{key:"assertUnique_",value:function(t,e){for(var n=0,r=this.array_.length;n<r;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}]),n}(nt);var dt,gt="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",mt=gt.includes("firefox"),bt=(gt.includes("safari")&&!gt.includes("chrom")&&(gt.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(gt)),gt.includes("webkit")&&!gt.includes("edge")),_t=gt.includes("macintosh"),wt="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,St="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Ot="undefined"!=typeof Image&&Image.prototype.decode,xt=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function kt(t,e){if(!t)throw new Error(e)}function Pt(t,e){var n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function Et(t,e,n,r,i,o,a,u){var s=Math.sin(o),l=Math.cos(o);return t[0]=r*l,t[1]=i*s,t[2]=-r*s,t[3]=i*l,t[4]=a*r*l-u*r*s+e,t[5]=a*i*s+u*i*l+n,t}function jt(t,e){var n,r=(n=e)[0]*n[3]-n[1]*n[2];kt(0!==r,"Transformation matrix cannot be inverted");var i=e[0],o=e[1],a=e[2],u=e[3],s=e[4],l=e[5];return t[0]=u/r,t[1]=-o/r,t[2]=-a/r,t[3]=i/r,t[4]=(a*l-u*s)/r,t[5]=-(i*l-o*s)/r,t}function Rt(t){var e="matrix("+t.join(", ")+")";if(St)return e;var n=dt||(dt=document.createElement("div"));return n.style.transform=e,n.style.transform}new Array(6);const Tt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function It(t){for(var e=[1/0,1/0,-1/0,-1/0],n=0,r=t.length;n<r;++n)Kt(e,t[n]);return e}function Mt(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function At(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Ft(t,e,n){var r,i;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(i=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*i}function Lt(t,e){return Bt(t,e[0],e[1])}function Dt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Bt(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Gt(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=e[0],u=e[1],s=Tt.UNKNOWN;return a<n?s|=Tt.LEFT:a>i&&(s|=Tt.RIGHT),u<r?s|=Tt.BELOW:u>o&&(s|=Tt.ABOVE),s===Tt.UNKNOWN&&(s=Tt.INTERSECTING),s}function zt(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function Nt(t){return zt(1/0,1/0,-1/0,-1/0,t)}function Wt(t,e){var n=t[0],r=t[1];return zt(n,r,n,r,e)}function Xt(t,e,n,r,i){return Zt(Nt(i),t,e,n,r)}function Yt(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Kt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Zt(t,e,n,r,i){for(;n<r;n+=i)Vt(t,e[n],e[n+1]);return t}function Vt(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Ut(t,e){var n;return(n=e(Ht(t)))||(n=e(Jt(t)))||(n=e(oe(t)))?n:(n=e(ie(t)))||!1}function qt(t){var e=0;return se(t)||(e=ae(t)*ne(t)),e}function Ht(t){return[t[0],t[1]]}function Jt(t){return[t[2],t[1]]}function Qt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function $t(t,e){var n;if("bottom-left"===e)n=Ht(t);else if("bottom-right"===e)n=Jt(t);else if("top-left"===e)n=ie(t);else{if("top-right"!==e)throw new Error("Invalid corner");n=oe(t)}return n}function te(t,e,n,r,i){var o,a,u=(o=ee(t,e,n,r),a=8,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(o,a)||function(t,e){if(t){if("string"==typeof t)return Ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(t,e):void 0}}(o,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],l=u[1],c=u[2],f=u[3],h=u[4],y=u[5],p=u[6],v=u[7];return zt(Math.min(s,c,h,p),Math.min(l,f,y,v),Math.max(s,c,h,p),Math.max(l,f,y,v),i)}function ee(t,e,n,r){var i=e*r[0]/2,o=e*r[1]/2,a=Math.cos(n),u=Math.sin(n),s=i*a,l=i*u,c=o*a,f=o*u,h=t[0],y=t[1];return[h-s+f,y-l-c,h-s-f,y-l+c,h+s-f,y+l+c,h+s+f,y+l-c,h-s+f,y-l-c]}function ne(t){return t[3]-t[1]}function re(t,e,n){var r=n||[1/0,1/0,-1/0,-1/0];return ue(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):Nt(r),r}function ie(t){return[t[0],t[3]]}function oe(t){return[t[2],t[3]]}function ae(t){return t[2]-t[0]}function ue(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function se(t){return t[2]<t[0]||t[3]<t[1]}function le(t,e){var n=e.getExtent(),r=Qt(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){var i=ae(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}const ce={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var fe={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};fe.max=fe.whitepoint[2].D65,fe.rgb=function(t,e){e=e||fe.whitepoint[2].E;var n,r,i,o=t[0]/e[0],a=t[1]/e[1],u=t[2]/e[2];return r=-.96924363628087*o+1.87596750150772*a+.041555057407175*u,i=.055630079696993*o+-.20397695888897*a+1.056971514242878*u,n=(n=3.240969941904521*o+-1.537383177570093*a+-.498610760293*u)>.0031308?1.055*Math.pow(n,1/2.4)-.055:n*=12.92,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r*=12.92,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:i*=12.92,[255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1)),255*(i=Math.min(Math.max(0,i),1))]},ce.xyz=function(t,e){var n=t[0]/255,r=t[1]/255,i=t[2]/255,o=.21263900587151*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.71516867876775*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)+.072192315360733*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92),a=.019330818715591*n+.11919477979462*r+.95053215224966*i;return[(.41239079926595*n+.35758433938387*r+.18048078840183*i)*(e=e||fe.whitepoint[2].E)[0],o*e[1],a*e[2]]};const he=fe,ye={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(t,e,n){var r,i,o,a,u,s,l,c,f;return o=t[0],a=t[1],u=t[2],0===o?[0,0,0]:(e=e||"D65",n=n||2,r=a/(13*o)+4*(l=he.whitepoint[n][e][0])/(l+15*(c=he.whitepoint[n][e][1])+3*(f=he.whitepoint[n][e][2]))||0,i=u/(13*o)+9*c/(l+15*c+3*f)||0,[9*(s=o>8?c*Math.pow((o+16)/116,3):c*o*.0011070564598794539)*r/(4*i)||0,s,s*(12-3*r-20*i)/(4*i)||0])}};he.luv=function(t,e,n){var r,i,o,a,u,s,l,c,f,h,y;e=e||"D65",n=n||2,h=4*(l=he.whitepoint[n][e][0])/(l+15*(c=he.whitepoint[n][e][1])+3*(f=he.whitepoint[n][e][2])),y=9*c/(l+15*c+3*f),r=4*(a=t[0])/(a+15*(u=t[1])+3*(s=t[2]))||0,i=9*u/(a+15*u+3*s)||0;var p=u/c;return[o=p<=.008856451679035631?903.2962962962961*p:116*Math.pow(p,1/3)-16,13*o*(r-h),13*o*(i-y)]};var pe={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(t){var e,n=t[0],r=t[1];return e=t[2]/360*2*Math.PI,[n,r*Math.cos(e),r*Math.sin(e)]},xyz:function(t){return ye.xyz(pe.luv(t))}};const ve=pe;ye.lchuv=function(t){var e=t[0],n=t[1],r=t[2],i=Math.sqrt(n*n+r*r),o=360*Math.atan2(r,n)/2/Math.PI;return o<0&&(o+=360),[e,i,o]},he.lchuv=function(t){return ye.lchuv(he.luv(t))};var de=n(424);const ge=function(t){var e,n,r=[],i=1;if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if("number"==typeof t)return{space:"rgb",values:[t>>>16,(65280&t)>>>8,255&t],alpha:1};if(t=String(t).toLowerCase(),de[t])r=de[t].slice(),n="rgb";else if("transparent"===t)i=0,n="rgb",r=[0,0,0];else if("#"===t[0]){var o=t.slice(1),a=o.length;i=1,a<=4?(r=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],4===a&&(i=parseInt(o[3]+o[3],16)/255)):(r=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],8===a&&(i=parseInt(o[6]+o[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),n="rgb"}else if(e=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(t)){var u=e[1],s="cmyk"===(n=u.replace(/a$/,""))?4:"gray"===n?1:3;r=e[2].trim().split(/\s*[,\/]\s*|\s+/),"color"===n&&(n=r.shift()),i=(r=r.map((function(t,e){if("%"===t[t.length-1])return t=parseFloat(t)/100,3===e?t:"rgb"===n?255*t:"h"===n[0]?100*t:"l"!==n[0]||e?"lab"===n?125*t:"lch"===n?e<2?150*t:360*t:"o"!==n[0]||e?"oklab"===n?.4*t:"oklch"===n?e<2?.4*t:360*t:t:t:100*t;if("h"===n[e]||2===e&&"h"===n[n.length-1]){if(void 0!==me[t])return me[t];if(t.endsWith("deg"))return parseFloat(t);if(t.endsWith("turn"))return 360*parseFloat(t);if(t.endsWith("grad"))return 360*parseFloat(t)/400;if(t.endsWith("rad"))return 180*parseFloat(t)/Math.PI}return"none"===t?0:parseFloat(t)}))).length>s?r.pop():1}else if(/[0-9](?:\s|\/|,)/.test(t)){var l,c;r=t.match(/([0-9]+)/g).map((function(t){return parseFloat(t)})),n=(null===(l=t.match(/([a-z])/gi))||void 0===l||null===(c=l.join(""))||void 0===c?void 0:c.toLowerCase())||"rgb"}return{space:n,values:r,alpha:i}};var me={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};const be={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(t){var e,n,r,i,o,a=t[0]/360,u=t[1]/100,s=t[2]/100,l=0;if(0===u)return[o=255*s,o,o];for(e=2*s-(n=s<.5?s*(1+u):s+u-s*u),i=[0,0,0];l<3;)(r=a+1/3*-(l-1))<0?r++:r>1&&r--,o=6*r<1?e+6*(n-e)*r:2*r<1?n:3*r<2?e+(n-e)*(2/3-r)*6:e,i[l++]=255*o;return i}};function _e(t,e,n){return Math.min(Math.max(t,e),n)}function we(t,e,n,r,i,o){var a=i-n,u=o-r;if(0!==a||0!==u){var s=((t-n)*a+(e-r)*u)/(a*a+u*u);s>1?(n=i,r=o):s>0&&(n+=a*s,r+=u*s)}return Se(t,e,n,r)}function Se(t,e,n,r){var i=n-t,o=r-e;return i*i+o*o}function Oe(t){return t*Math.PI/180}function xe(t,e){var n=t%e;return n*e<0?n+e:n}function ke(t,e,n){return t+n*(e-t)}function Pe(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}function Ee(t,e){return Math.floor(Pe(t,e))}function je(t,e){return Math.ceil(Pe(t,e))}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Te(t){return"string"==typeof t?t:Ge(t)}ce.hsl=function(t){var e,n,r=t[0]/255,i=t[1]/255,o=t[2]/255,a=Math.min(r,i,o),u=Math.max(r,i,o),s=u-a;return u===a?e=0:r===u?e=(i-o)/s:i===u?e=2+(o-r)/s:o===u&&(e=4+(r-i)/s),(e=Math.min(60*e,360))<0&&(e+=360),n=(a+u)/2,[e,100*(u===a?0:n<=.5?s/(u+a):s/(2-u-a)),100*n]};var Ce=1024,Ie={},Me=0;function Ae(t){if(4===t.length)return t;var e=t.slice();return e[3]=1,e}function Fe(t){var e=he.lchuv(ce.xyz(t));return e[3]=t[3],e}function Le(t){if(Ie.hasOwnProperty(t))return Ie[t];if(Me>=Ce){var e=0;for(var n in Ie)0==(3&e++)&&(delete Ie[n],--Me)}var r=function(t){var e;Array.isArray(t)&&t.raw&&(t=String.raw.apply(String,arguments)),t instanceof Number&&(t=+t);var n=ge(t);if(!n.space)return[];var r="h"===n.space[0]?be.min:ce.min,i="h"===n.space[0]?be.max:ce.max;return(e=Array(3))[0]=Math.min(Math.max(n.values[0],r[0]),i[0]),e[1]=Math.min(Math.max(n.values[1],r[1]),i[1]),e[2]=Math.min(Math.max(n.values[2],r[2]),i[2]),"h"===n.space[0]&&(e=be.rgb(e)),e.push(Math.min(Math.max(n.alpha,0),1)),e}(t);if(4!==r.length)throw new Error('Failed to parse "'+t+'" as color');var i,o=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(isNaN(a))throw new Error('Failed to parse "'+t+'" as color')}}catch(t){o.e(t)}finally{o.f()}return Be(r),Ie[t]=r,++Me,r}function De(t){return Array.isArray(t)?t:Le(t)}function Be(t){return t[0]=_e(t[0]+.5|0,0,255),t[1]=_e(t[1]+.5|0,0,255),t[2]=_e(t[2]+.5|0,0,255),t[3]=_e(t[3],0,1),t}function Ge(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var r=t[2];return r!=(0|r)&&(r=r+.5|0),"rgba("+e+","+n+","+r+","+(void 0===t[3]?1:Math.round(100*t[3])/100)+")"}function ze(t){return ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(t)}function Ne(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ze(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ze(i)?i:String(i)),r)}var i}function We(t,e,n){return e+":"+t+":"+(n?Te(n):"null")}var Xe=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}var e,n;return e=t,(n=[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}},{key:"get",value:function(t,e,n){var r=We(t,e,n);return r in this.cache_?this.cache_[r]:null}},{key:"set",value:function(t,e,n,r){var i=We(t,e,n);this.cache_[i]=r,++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}])&&Ne(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());const Ye="opacity",Ke="visible",Ze="extent",Ve="zIndex",Ue="maxResolution",qe="minResolution",He="maxZoom",Je="minZoom",Qe="source";function $e(t){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$e(t)}function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===$e(i)?i:String(i)),r)}var i}function en(){return en="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=rn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},en.apply(this,arguments)}function nn(t,e){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nn(t,e)}function rn(t){return rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rn(t)}const on=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nn(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=rn(r);if(i){var n=rn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===$e(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).on,e.once,e.un,e.background_=t.background;var n=Object.assign({},t);return"object"===$e(t.properties)&&(delete n.properties,Object.assign(n,t.properties)),n[Ye]=void 0!==t.opacity?t.opacity:1,kt("number"==typeof n[Ye],"Layer opacity must be a number"),n[Ke]=void 0===t.visible||t.visible,n[Ve]=t.zIndex,n[Ue]=void 0!==t.maxResolution?t.maxResolution:1/0,n[qe]=void 0!==t.minResolution?t.minResolution:0,n[Je]=void 0!==t.minZoom?t.minZoom:-1/0,n[He]=void 0!==t.maxZoom?t.maxZoom:1/0,e.className_=void 0!==n.className?n.className:"ol-layer",delete n.className,e.setProperties(n),e.state_=null,e}return e=a,(n=[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=_e(Math.round(100*this.getOpacity())/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n||e.managed?n:1/0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}},{key:"getLayersArray",value:function(t){return X()}},{key:"getLayerStatesArray",value:function(t){return X()}},{key:"getExtent",value:function(){return this.get(Ze)}},{key:"getMaxResolution",value:function(){return this.get(Ue)}},{key:"getMinResolution",value:function(){return this.get(qe)}},{key:"getMinZoom",value:function(){return this.get(Je)}},{key:"getMaxZoom",value:function(){return this.get(He)}},{key:"getOpacity",value:function(){return this.get(Ye)}},{key:"getSourceState",value:function(){return X()}},{key:"getVisible",value:function(){return this.get(Ke)}},{key:"getZIndex",value:function(){return this.get(Ve)}},{key:"setBackground",value:function(t){this.background_=t,this.changed()}},{key:"setExtent",value:function(t){this.set(Ze,t)}},{key:"setMaxResolution",value:function(t){this.set(Ue,t)}},{key:"setMinResolution",value:function(t){this.set(qe,t)}},{key:"setMaxZoom",value:function(t){this.set(He,t)}},{key:"setMinZoom",value:function(t){this.set(Je,t)}},{key:"setOpacity",value:function(t){kt("number"==typeof t,"Layer opacity must be a number"),this.set(Ye,t)}},{key:"setVisible",value:function(t){this.set(Ke,t)}},{key:"setZIndex",value:function(t){this.set(Ve,t)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),en(rn(a.prototype),"disposeInternal",this).call(this)}}])&&tn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt),an="prerender",un="postrender",sn="precompose",ln="rendercomplete",cn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var fn=42,hn=256,yn={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};function pn(t){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pn(t)}function vn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==pn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==pn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===pn(i)?i:String(i)),r)}var i}const dn=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}var e,n;return e=t,(n=[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||yn[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])&&vn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function mn(t,e){return mn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mn(t,e)}function bn(t){return bn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bn(t)}var _n=6378137,wn=Math.PI*_n,Sn=[-wn,-wn,wn,wn],On=[-180,-85,180,85],xn=_n*Math.log(Math.tan(Math.PI/2)),kn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mn(t,e)}(o,t);var e,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=bn(n);if(r){var i=bn(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===gn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,{code:t,units:"m",extent:Sn,global:!0,worldExtent:On,getPointResolution:function(t,e){return t/Math.cosh(e[1]/_n)}})}return e=o,Object.defineProperty(e,"prototype",{writable:!1}),e}(dn),Pn=[new kn("EPSG:3857"),new kn("EPSG:102100"),new kn("EPSG:102113"),new kn("EPSG:900913"),new kn("http://www.opengis.net/def/crs/EPSG/0/3857"),new kn("http://www.opengis.net/gml/srs/epsg.xml#3857")];function En(t){return En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},En(t)}function jn(t,e){return jn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jn(t,e)}function Rn(t){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rn(t)}var Tn=[-180,-90,180,90],Cn=6378137*Math.PI/180,In=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jn(t,e)}(o,t);var e,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Rn(n);if(r){var i=Rn(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===En(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),i.call(this,{code:t,units:"degrees",extent:Tn,axisOrientation:e,global:!0,metersPerUnit:Cn,worldExtent:Tn})}return e=o,Object.defineProperty(e,"prototype",{writable:!1}),e}(dn),Mn=[new In("CRS:84"),new In("EPSG:4326","neu"),new In("urn:ogc:def:crs:OGC:1.3:CRS84"),new In("urn:ogc:def:crs:OGC:2:84"),new In("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new In("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new In("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],An={},Fn={};function Ln(t,e,n){var r=t.getCode(),i=e.getCode();r in Fn||(Fn[r]={}),Fn[r][i]=n}function Dn(t,e){for(var n=!0,r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function Bn(t,e){var n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,o=t[1]*n+t[0]*r;return t[0]=i,t[1]=o,t}function Gn(t,e){if(e.canWrapX()){var n=ae(e.getExtent()),r=function(t,e,n){var r=e.getExtent(),i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||ae(r),i=Math.floor((t[0]-r[0])/n)),i}(t,e,n);r&&(t[0]-=r*n)}return t}var zn=6371008.8;function Nn(t,e,n){n=n||zn;var r=Oe(t[1]),i=Oe(e[1]),o=(i-r)/2,a=Oe(e[0]-t[0])/2,u=Math.sin(o)*Math.sin(o)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}var Wn={info:1,warn:2,error:3,none:4},Xn=Wn.info;function Yn(){var t;Xn>Wn.warn||(t=console).warn.apply(t,arguments)}var Kn=!0;function Zn(t,e){if(void 0!==e)for(var n=0,r=t.length;n<r;++n)e[n]=t[n];else e=t.slice();return e}function Vn(t,e){if(void 0!==e&&t!==e){for(var n=0,r=t.length;n<r;++n)e[n]=t[n];t=e}return t}function Un(t){!function(t,e){An[t]=e}(t.getCode(),t),Ln(t,t,Zn)}function qn(t){return"string"==typeof t?An[e=t]||An[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Hn(t,e,n,r){var i,o=(t=qn(t)).getPointResolutionFunc();if(o){if(i=o(e,n),r&&r!==t.getUnits()){var a=t.getMetersPerUnit();a&&(i=i*a/yn[r])}}else{var u=t.getUnits();if("degrees"==u&&!r||"degrees"==r)i=e;else{var s=tr(t,qn("EPSG:4326"));if(s===Vn&&"degrees"!==u)i=e*t.getMetersPerUnit();else{var l=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];i=(Nn((l=s(l,l,2)).slice(0,2),l.slice(2,4))+Nn(l.slice(4,6),l.slice(6,8)))/2}var c=r?yn[r]:t.getMetersPerUnit();void 0!==c&&(i/=c)}}return i}function Jn(t){!function(t){t.forEach(Un)}(t),t.forEach((function(e){t.forEach((function(t){e!==t&&Ln(e,t,Zn)}))}))}function Qn(t,e){return t?"string"==typeof t?qn(t):t:qn(e)}function $n(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||tr(t,e)===Zn)&&n}function tr(t,e){var n=function(t,e){var n;return t in Fn&&e in Fn[t]&&(n=Fn[t][e]),n}(t.getCode(),e.getCode());return n||(n=Vn),n}function er(t,e){return tr(qn(t),qn(e))}function nr(t,e,n){return er(e,n)(t,void 0,t.length)}function rr(t,e,n,r){return function(t,e,n,r){if(se(t))return Nt(n);var i=[];if(r>1)for(var o=t[2]-t[0],a=t[3]-t[1],u=0;u<r;++u)i.push(t[0]+o*u/r,t[1],t[2],t[1]+a*u/r,t[2]-o*u/r,t[3],t[0],t[3]-a*u/r);else i=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(i,i,2);for(var s=[],l=[],c=0,f=i.length;c<f;c+=2)s.push(i[c]),l.push(i[c+1]);return function(t,e,n){return zt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(s,l,n)}(t,er(e,n),void 0,r)}var ir,or,ar,ur=null;function sr(){return ur}function lr(t,e){return ur?nr(t,e,ur):t}function cr(t,e){return ur?nr(t,ur,e):(Kn&&!Dn(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(Kn=!1,Yn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t)}function fr(t,e){return ur?rr(t,e,ur):t}function hr(t,e){return ur?rr(t,ur,e):t}function yr(t,e){if(!ur)return t;var n=qn(e).getMetersPerUnit(),r=ur.getMetersPerUnit();return n&&r?t*n/r:t}function pr(t,e,n){return function(r,i,o,a,u){if(r){if(!i&&!e)return r;var s=e?0:o[0]*i,l=e?0:o[1]*i,c=u?u[0]:0,f=u?u[1]:0,h=t[0]+s/2+c,y=t[2]-s/2+c,p=t[1]+l/2+f,v=t[3]-l/2+f;h>y&&(y=h=(y+h)/2),p>v&&(v=p=(v+p)/2);var d=_e(r[0],h,y),g=_e(r[1],p,v);if(a&&n&&i){var m=30*i;d+=-m*Math.log(1+Math.max(0,h-r[0])/m)+m*Math.log(1+Math.max(0,r[0]-y)/m),g+=-m*Math.log(1+Math.max(0,p-r[1])/m)+m*Math.log(1+Math.max(0,r[1]-v)/m)}return[d,g]}}}function vr(t){return t}function dr(t,e,n,r){var i=ae(e)/n[0],o=ne(e)/n[1];return r?Math.min(t,Math.max(i,o)):Math.min(t,Math.min(i,o))}function gr(t,e,n){var r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(r=Math.max(r,n),r/=Math.log(1+50*Math.max(0,n/t-1))/50+1),_e(r,n/2,2*e)}function mr(t,e,n,r,i){return n=void 0===n||n,function(o,a,u,s){if(void 0!==o){var l=r?dr(t,r,u,i):t;return n&&s?gr(o,l,e):_e(o,e,l)}}}function br(t){if(void 0!==t)return 0}function _r(t){if(void 0!==t)return t}function wr(t){return Math.pow(t,3)}function Sr(t){return 1-wr(1-t)}function Or(t){return 3*t*t-2*t*t*t}function xr(t){return t}function kr(t,e,n,r,i,o){o=o||[];for(var a=0,u=e;u<n;u+=r){var s=t[u],l=t[u+1];o[a++]=i[0]*s+i[2]*l+i[4],o[a++]=i[1]*s+i[3]*l+i[5]}return o&&o.length!=a&&(o.length=a),o}function Pr(t,e,n,r,i,o,a){a=a||[];for(var u=Math.cos(i),s=Math.sin(i),l=o[0],c=o[1],f=0,h=e;h<n;h+=r){var y=t[h]-l,p=t[h+1]-c;a[f++]=l+y*u-p*s,a[f++]=c+y*s+p*u;for(var v=h+2;v<h+r;++v)a[f++]=t[v]}return a&&a.length!=f&&(a.length=f),a}function Er(t){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Er(t)}function jr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Er(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Er(i)?i:String(i)),r)}var i}function Rr(t,e){return Rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Rr(t,e)}function Tr(t){return Tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tr(t)}Jn(Pn),Jn(Mn),ir=Pn,or=function(t,e,n){var r=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(r));for(var i=0;i<r;i+=n){e[i]=wn*t[i]/180;var o=_n*Math.log(Math.tan(Math.PI*(+t[i+1]+90)/360));o>xn?o=xn:o<-xn&&(o=-xn),e[i+1]=o}return e},ar=function(t,e,n){var r=t.length;n=n>1?n:2,void 0===e&&(e=n>2?t.slice():new Array(r));for(var i=0;i<r;i+=n)e[i]=180*t[i]/wn,e[i+1]=360*Math.atan(Math.exp(t[i+1]/_n))/Math.PI-90;return e},Mn.forEach((function(t){ir.forEach((function(e){Ln(t,e,or),Ln(e,t,ar)}))}));var Cr=[1,0,0,1,0,0],Ir=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rr(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Tr(r);if(i){var n=Tr(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=b((function(e,n,r){if(!r)return t.getSimplifiedGeometry(n);var i=t.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})),t}return e=a,n=[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return X()}},{key:"closestPointXY",value:function(t,e,n,r){return X()}},{key:"containsXY",value:function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}},{key:"getClosestPoint",value:function(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return X()}},{key:"getExtent",value:function(t){if(this.extentRevision_!=this.getRevision()){var e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Nt(e),this.extentRevision_=this.getRevision()}return function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}},{key:"rotate",value:function(t,e){X()}},{key:"scale",value:function(t,e,n){X()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return X()}},{key:"getType",value:function(){return X()}},{key:"applyTransform",value:function(t){X()}},{key:"intersectsExtent",value:function(t){return X()}},{key:"translate",value:function(t,e){X()}},{key:"transform",value:function(t,e){var n=qn(t),r="tile-pixels"==n.getUnits()?function(t,r,i){var o=n.getExtent(),a=n.getWorldExtent(),u=ne(a)/ne(o);return Et(Cr,a[0],a[3],u,-u,0,0,0),kr(t,0,t.length,i,Cr,r),er(n,e)(t,r,i)}:er(n,e);return this.applyTransform(r),this}}],n&&jr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function Mr(t){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mr(t)}function Ar(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Mr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Mr(i)?i:String(i)),r)}var i}function Fr(t,e){return Fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fr(t,e)}function Lr(t){return Lr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lr(t)}var Dr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fr(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Lr(r);if(i){var n=Lr(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Mr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(t=o.call(this)).layout="XY",t.stride=2,t.flatCoordinates,t}return e=a,n=[{key:"computeExtent",value:function(t){return Xt(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return X()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=Br(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){X()}},{key:"setLayout",value:function(t,e,n){var r;if(t)r=Br(t);else{for(var i=0;i<n;++i){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(r=e.length)}this.layout=t,this.stride=r}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();Pr(n,0,n.length,r,t,e,n),this.changed()}}},{key:"scale",value:function(t,e,n){void 0===e&&(e=t),n||(n=Qt(this.getExtent()));var r=this.getFlatCoordinates();if(r){var i=this.getStride();!function(t,e,n,r,i,o,a,u){u=u||[];for(var s=a[0],l=a[1],c=0,f=0;f<n;f+=r){var h=t[f]-s,y=t[f+1]-l;u[c++]=s+i*h,u[c++]=l+o*y;for(var p=f+2;p<f+r;++p)u[c++]=t[p]}u&&u.length!=c&&(u.length=c)}(r,0,r.length,i,t,e,n,r),this.changed()}}},{key:"translate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var r=this.getStride();!function(t,e,n,r,i,o,a){a=a||[];for(var u=0,s=0;s<n;s+=r){a[u++]=t[s]+i,a[u++]=t[s+1]+o;for(var l=s+2;l<s+r;++l)a[u++]=t[l]}a&&a.length!=u&&(a.length=u)}(n,0,n.length,r,t,e,n),this.changed()}}}],n&&Ar(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ir);function Br(t){var e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}const Gr=Dr;function zr(t,e,n,r,i,o,a){var u,s=t[e],l=t[e+1],c=t[n]-s,f=t[n+1]-l;if(0===c&&0===f)u=e;else{var h=((i-s)*c+(o-l)*f)/(c*c+f*f);if(h>1)u=n;else{if(h>0){for(var y=0;y<r;++y)a[y]=ke(t[e+y],t[n+y],h);return void(a.length=r)}u=e}}for(var p=0;p<r;++p)a[p]=t[u+p];a.length=r}function Nr(t,e,n,r,i){var o=t[e],a=t[e+1];for(e+=r;e<n;e+=r){var u=t[e],s=t[e+1],l=Se(o,a,u,s);l>i&&(i=l),o=u,a=s}return i}function Wr(t,e,n,r,i,o,a,u,s,l,c){if(e==n)return l;var f,h;if(0===i){if((h=Se(a,u,t[e],t[e+1]))<l){for(f=0;f<r;++f)s[f]=t[e+f];return s.length=r,h}return l}c=c||[NaN,NaN];for(var y=e+r;y<n;)if(zr(t,y-r,y,r,a,u,c),(h=Se(a,u,c[0],c[1]))<l){for(l=h,f=0;f<r;++f)s[f]=c[f];s.length=r,y+=r}else y+=r*Math.max((Math.sqrt(h)-Math.sqrt(l))/i|0,1);if(o&&(zr(t,n-r,e,r,a,u,c),(h=Se(a,u,c[0],c[1]))<l)){for(l=h,f=0;f<r;++f)s[f]=c[f];s.length=r}return l}function Xr(t,e,n,r){for(var i=0,o=n.length;i<o;++i)for(var a=n[i],u=0;u<r;++u)t[e++]=a[u];return e}function Yr(t,e,n,r,i,o,a){var u=(n-e)/r;if(u<3){for(;e<n;e+=r)o[a++]=t[e],o[a++]=t[e+1];return a}var s=new Array(u);s[0]=1,s[u-1]=1;for(var l=[e,n-r],c=0;l.length>0;){for(var f=l.pop(),h=l.pop(),y=0,p=t[h],v=t[h+1],d=t[f],g=t[f+1],m=h+r;m<f;m+=r){var b=we(t[m],t[m+1],p,v,d,g);b>y&&(c=m,y=b)}y>i&&(s[(c-e)/r]=1,h+r<c&&l.push(h,c),c+r<f&&l.push(c,f))}for(var _=0;_<u;++_)s[_]&&(o[a++]=t[e+_*r],o[a++]=t[e+_*r+1]);return a}function Kr(t,e){return e*Math.round(t/e)}function Zr(t,e,n,r,i,o,a){if(e==n)return a;var u,s,l=Kr(t[e],i),c=Kr(t[e+1],i);e+=r,o[a++]=l,o[a++]=c;do{if(u=Kr(t[e],i),s=Kr(t[e+1],i),(e+=r)==n)return o[a++]=u,o[a++]=s,a}while(u==l&&s==c);for(;e<n;){var f=Kr(t[e],i),h=Kr(t[e+1],i);if(e+=r,f!=u||h!=s){var y=u-l,p=s-c,v=f-l,d=h-c;y*d==p*v&&(y<0&&v<y||y==v||y>0&&v>y)&&(p<0&&d<p||p==d||p>0&&d>p)?(u=f,s=h):(o[a++]=u,o[a++]=s,l=u,c=s,u=f,s=h)}}return o[a++]=u,o[a++]=s,a}function Vr(t,e,n,r,i,o,a,u){for(var s=0,l=n.length;s<l;++s){var c=n[s];a=Zr(t,e,c,r,i,o,a),u.push(a),e=c}return a}function Ur(t,e,n,r,i){i=void 0!==i?i:[];for(var o=0,a=e;a<n;a+=r)i[o++]=t.slice(a,a+r);return i.length=o,i}function qr(t,e,n,r,i){i=void 0!==i?i:[];for(var o=0,a=0,u=n.length;a<u;++a){var s=n[a];i[o++]=Ur(t,e,s,r,i[o]),e=s}return i.length=o,i}function Hr(t,e,n,r,i){i=void 0!==i?i:[];for(var o=0,a=0,u=n.length;a<u;++a){var s=n[a];i[o++]=1===s.length&&s[0]===e?[]:qr(t,e,s,r,i[o]),e=s[s.length-1]}return i.length=o,i}function Jr(t,e,n,r){for(var i=0,o=t[n-r],a=t[n-r+1];e<n;e+=r){var u=t[e],s=t[e+1];i+=a*u-o*s,o=u,a=s}return i/2}function Qr(t){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qr(t)}function $r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Qr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Qr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Qr(i)?i:String(i)),r)}var i}function ti(t,e){return ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ti(t,e)}function ei(t){return ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ei(t)}var ni=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ti(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ei(r);if(i){var n=ei(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Qr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this)).maxDelta_=-1,n.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?n.setCoordinates(t,e):n.setFlatCoordinates(e,t),n}return e=a,n=[{key:"clone",value:function(){return new a(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,r){return r<Ft(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Nr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Wr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,r))}},{key:"getArea",value:function(){return Jr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return Ur(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=Yr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new a(e,"XY")}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Xr(this.flatCoordinates,0,t,this.stride),this.changed()}}],n&&$r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gr);const ri=ni;function ii(t){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(t)}function oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ii(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ii(i)?i:String(i)),r)}var i}function ai(t,e){return ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ai(t,e)}function ui(t){return ui=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ui(t)}var si=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ai(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ui(r);if(i){var n=ui(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ii(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this)).setCoordinates(t,e),n}return e=a,n=[{key:"clone",value:function(){var t=new a(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,r){var i=this.flatCoordinates,o=Se(t,e,i[0],i[1]);if(o<r){for(var a=this.stride,u=0;u<a;++u)n[u]=i[u];return n.length=a,o}return r}},{key:"getCoordinates",value:function(){return this.flatCoordinates.slice()}},{key:"computeExtent",value:function(t){return Wt(this.flatCoordinates,t)}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(t){return Bt(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}],n&&oi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gr);const li=si;function ci(t,e,n,r,i){return!Ut(i,(function(i){return!fi(t,e,n,r,i[0],i[1])}))}function fi(t,e,n,r,i,o){for(var a=0,u=t[n-r],s=t[n-r+1];e<n;e+=r){var l=t[e],c=t[e+1];s<=o?c>o&&(l-u)*(o-s)-(i-u)*(c-s)>0&&a++:c<=o&&(l-u)*(o-s)-(i-u)*(c-s)<0&&a--,u=l,s=c}return 0!==a}function hi(t,e,n,r,i,o){if(0===n.length)return!1;if(!fi(t,e,n[0],r,i,o))return!1;for(var a=1,u=n.length;a<u;++a)if(fi(t,n[a-1],n[a],r,i,o))return!1;return!0}function yi(t,e,n,r,i,o,a){for(var u,s,l,c,h,y,p,v=i[o+1],d=[],g=0,m=n.length;g<m;++g){var b=n[g];for(c=t[b-r],y=t[b-r+1],u=e;u<b;u+=r)h=t[u],p=t[u+1],(v<=y&&p<=v||y<=v&&v<=p)&&(l=(v-y)/(p-y)*(h-c)+c,d.push(l)),c=h,y=p}var _=NaN,w=-1/0;for(d.sort(f),c=d[0],u=1,s=d.length;u<s;++u){h=d[u];var S=Math.abs(h-c);S>w&&hi(t,e,n,r,l=(c+h)/2,v)&&(_=l,w=S),c=h}return isNaN(_)&&(_=i[o]),a?(a.push(_,v,w),a):[_,v,w]}function pi(t,e,n,r,i){var o=Zt([1/0,1/0,-1/0,-1/0],t,e,n,r);return!!ue(i,o)&&(!!Dt(i,o)||o[0]>=i[0]&&o[2]<=i[2]||o[1]>=i[1]&&o[3]<=i[3]||function(t,e,n,r,o){var a,u,s;for(e+=r;e<n;e+=r)if(u=t.slice(e-r,e),s=t.slice(e,e+r),a=function(t,e,n){var r=!1,i=Gt(t,e),o=Gt(t,n);if(i===Tt.INTERSECTING||o===Tt.INTERSECTING)r=!0;else{var a,u,s=t[0],l=t[1],c=t[2],f=t[3],h=e[0],y=e[1],p=n[0],v=n[1],d=(v-y)/(p-h);o&Tt.ABOVE&&!(i&Tt.ABOVE)&&(r=(a=p-(v-f)/d)>=s&&a<=c),r||!(o&Tt.RIGHT)||i&Tt.RIGHT||(r=(u=v-(p-c)*d)>=l&&u<=f),r||!(o&Tt.BELOW)||i&Tt.BELOW||(r=(a=p-(v-l)/d)>=s&&a<=c),r||!(o&Tt.LEFT)||i&Tt.LEFT||(r=(u=v-(p-s)*d)>=l&&u<=f)}return r}(i,u,s))return a;return!1}(t,e,n,r))}function vi(t,e,n,r,i){return!!(pi(t,e,n,r,i)||fi(t,e,n,r,i[0],i[1])||fi(t,e,n,r,i[0],i[3])||fi(t,e,n,r,i[2],i[1])||fi(t,e,n,r,i[2],i[3]))}function di(t,e,n,r){for(;e<n-r;){for(var i=0;i<r;++i){var o=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=o}e+=r,n-=r}}function gi(t,e,n,r){for(var i=0,o=t[n-r],a=t[n-r+1];e<n;e+=r){var u=t[e],s=t[e+1];i+=(u-o)*(s+a),o=u,a=s}return 0===i?void 0:i>0}function mi(t,e,n,r,i){i=void 0!==i&&i;for(var o=0,a=n.length;o<a;++o){var u=n[o],s=gi(t,e,u,r);(0===o?i&&s||!i&&!s:i&&!s||!i&&s)&&di(t,e,u,r),e=u}return e}function bi(t){return bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bi(t)}function _i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==bi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==bi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===bi(i)?i:String(i)),r)}var i}function wi(t,e){return wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wi(t,e)}function Si(t){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Si(t)}var Oi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wi(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Si(r);if(i){var n=Si(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===bi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=o.call(this)).ends_=[],r.flatInteriorPointRevision_=-1,r.flatInteriorPoint_=null,r.maxDelta_=-1,r.maxDeltaRevision_=-1,r.orientedRevision_=-1,r.orientedFlatCoordinates_=null,void 0!==e&&n?(r.setFlatCoordinates(e,t),r.ends_=n):r.setCoordinates(t,e),r}return e=a,n=[{key:"appendLinearRing",value:function(t){this.flatCoordinates?p(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new a(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,r){return r<Ft(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,r,i){for(var o=0,a=n.length;o<a;++o){var u=n[o];i=Nr(t,e,u,r,i),e=u}return i}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,r,i,o,a,u,s,l,c){c=c||[NaN,NaN];for(var f=0,h=n.length;f<h;++f){var y=n[f];l=Wr(t,e,y,r,i,o,a,u,s,l,c),e=y}return l}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,r))}},{key:"containsXY",value:function(t,e){return hi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return function(t,e,n,r){for(var i=0,o=0,a=n.length;o<a;++o){var u=n[o];i+=Jr(t,e,u,r),e=u}return i}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?mi(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,qr(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Qt(this.getExtent());this.flatInteriorPoint_=yi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new li(this.getFlatInteriorPoint(),"XYM")}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new ri(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,r=[],i=0,o=0,a=n.length;o<a;++o){var u=n[o],s=new ri(e.slice(i,u),t);r.push(s),i=u}return r}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,n,r,i){i=void 0!==i&&i;for(var o=0,a=n.length;o<a;++o){var u=n[o],s=gi(t,e,u,r);if(0===o){if(i&&s||!i&&!s)return!1}else if(i&&!s||!i&&s)return!1;e=u}return!0}(t,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=mi(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],n=[];return e.length=Vr(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new a(e,"XY",n)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(t){return function(t,e,n,r,i){if(!vi(t,e,n[0],r,i))return!1;if(1===n.length)return!0;for(var o=1,a=n.length;o<a;++o)if(ci(t,n[o-1],n[o],r,i)&&!pi(t,n[o-1],n[o],r,i))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=function(t,e,n,r,i){i=i||[];for(var o=0,a=0,u=n.length;a<u;++a){var s=Xr(t,e,n[a],r);i[o++]=s,e=s}return i.length=o,i}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}],n&&_i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gr);const xi=Oi;function ki(t){if(se(t))throw new Error("Cannot create polygon from empty extent");var e=t[0],n=t[1],r=t[2],i=t[3],o=[e,n,e,i,r,i,r,n,e,n];return new Oi(o,"XY",[o.length])}function Pi(t){return Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(t)}function Ei(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Pi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Pi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Pi(i)?i:String(i)),r)}var i}function ji(t,e){return ji=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ji(t,e)}function Ri(t){return Ri=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ri(t)}var Ti=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ji(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ri(r);if(i){var n=Ri(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Pi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).on,e.once,e.un,t=Object.assign({},t),e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=Qn(t.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.nextCenter_=null,e.nextResolution_,e.nextRotation_,e.cancelAnchor_=void 0,t.projection&&function(t){Kn=!(void 0===t||t)}(),t.center&&(t.center=cr(t.center,e.projection_)),t.extent&&(t.extent=hr(t.extent,e.projection_)),e.applyOptions_(t),e}return e=a,n=[{key:"applyOptions_",value:function(t){var e=Object.assign({},t);for(var n in cn)delete e[n];this.setProperties(e,!0);var r=function(t){var e,n,r,i=void 0!==t.minZoom?t.minZoom:0,o=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2,u=void 0!==t.multiWorld&&t.multiWorld,s=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,c=Qn(t.projection,"EPSG:3857"),f=c.getExtent(),y=t.constrainOnlyCenter,p=t.extent;if(u||p||!c.isGlobal()||(y=!1,p=f),void 0!==t.resolutions){var v=t.resolutions;n=v[i],r=void 0!==v[o]?v[o]:v[v.length-1],e=t.constrainResolution?function(t,e,n,r){return e=void 0===e||e,function(i,o,a,u){if(void 0!==i){var s=t[0],l=t[t.length-1],c=n?dr(s,n,a,r):s;if(u)return e?gr(i,c,l):_e(i,l,c);var f=Math.min(c,i),y=Math.floor(h(t,f,o));return t[y]>c&&y<t.length-1?t[y+1]:t[y]}}}(v,s,!y&&p,l):mr(n,r,s,!y&&p,l)}else{var d=(f?Math.max(ae(f),ne(f)):360*yn.degrees/c.getMetersPerUnit())/hn/Math.pow(2,0),g=d/Math.pow(2,28);void 0!==(n=t.maxResolution)?i=0:n=d/Math.pow(a,i),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,o):d/Math.pow(a,o):g),o=i+Math.floor(Math.log(n/r)/Math.log(a)),r=n/Math.pow(a,o-i),e=t.constrainResolution?function(t,e,n,r,i,o){return r=void 0===r||r,n=void 0!==n?n:0,function(a,u,s,l){if(void 0!==a){var c=i?dr(e,i,s,o):e;if(l)return r?gr(a,c,n):_e(a,n,c);var f=Math.ceil(Math.log(e/c)/Math.log(t)-1e-9),h=-u*(.5-1e-9)+.5,y=Math.min(c,a),p=Math.floor(Math.log(e/y)/Math.log(t)+h),v=Math.max(f,p);return _e(e/Math.pow(t,v),n,c)}}}(a,n,r,s,!y&&p,l):mr(n,r,s,!y&&p,l)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:i,zoomFactor:a}}(t);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=r.minZoom;var i=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return pr(t.extent,t.constrainOnlyCenter,e)}var n=Qn(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var r=n.getExtent().slice();return r[0]=-1/0,r[2]=1/0,pr(r,!1,!1)}return vr}(t),o=r.constraint,a=function(t){var e,n,r;if(void 0===t.enableRotation||t.enableRotation){var i=t.constrainRotation;return void 0===i||!0===i?(r=Oe(5),function(t,e){return e||void 0===t?t:Math.abs(t)<=r?0:t}):!1===i?_r:"number"==typeof i?(e=i,n=2*Math.PI/e,function(t,e){return e?t:void 0!==t?t=Math.floor(t/n+.5)*n:void 0}):_r}return br}(t);this.constraints_={center:i,resolution:o,rotation:a},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e=this.padding_;this.padding_=t;var n=this.getCenterInternal();if(n){var r=t||[0,0,0,0];e=e||[0,0,0,0];var i=this.getResolution(),o=i/2*(r[3]-e[3]+e[1]-r[1]),a=i/2*(r[0]-e[0]+e[2]-r[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var r=arguments[n];r.center&&((r=Object.assign({},r)).center=cr(r.center,this.getProjection())),r.anchor&&((r=Object.assign({},r)).anchor=cr(r.anchor,this.getProjection())),e[n]=r}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,n=arguments.length;n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n);for(var r=0;r<n&&!this.isDef();++r){var i=arguments[r];i.center&&this.setCenterInternal(i.center),void 0!==i.zoom?this.setZoom(i.zoom):i.resolution&&this.setResolution(i.resolution),void 0!==i.rotation&&this.setRotation(i.rotation)}if(r!==n){for(var o=Date.now(),a=this.targetCenter_.slice(),u=this.targetResolution_,s=this.targetRotation_,l=[];r<n;++r){var c=arguments[r],f={start:o,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||Or,callback:e};if(c.center&&(f.sourceCenter=a,f.targetCenter=c.center.slice(),a=f.targetCenter),void 0!==c.zoom?(f.sourceResolution=u,f.targetResolution=this.getResolutionForZoom(c.zoom),u=f.targetResolution):c.resolution&&(f.sourceResolution=u,f.targetResolution=c.resolution,u=f.targetResolution),void 0!==c.rotation){f.sourceRotation=s;var h=xe(c.rotation-s+Math.PI,2*Math.PI)-Math.PI;f.targetRotation=s+h,s=f.targetRotation}Ii(f)?f.complete=!0:o+=f.duration,l.push(f)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}else e&&Ci(e,!0)}},{key:"getAnimating",value:function(){return this.hints_[0]>0}},{key:"getInteracting",value:function(){return this.hints_[1]>0}},{key:"cancelAnimations",value:function(){var t;this.setHint(0,-this.hints_[0]);for(var e=0,n=this.animations_.length;e<n;++e){var r=this.animations_[e];if(r[0].callback&&Ci(r[0].callback,!1),!t)for(var i=0,o=r.length;i<o;++i){var a=r[i];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var r=this.animations_[n],i=!0,o=0,a=r.length;o<a;++o){var u=r[o];if(!u.complete){var s=t-u.start,l=u.duration>0?s/u.duration:1;l>=1?(u.complete=!0,l=1):i=!1;var c=u.easing(l);if(u.sourceCenter){var f=u.sourceCenter[0],h=u.sourceCenter[1],y=u.targetCenter[0],p=u.targetCenter[1];this.nextCenter_=u.targetCenter;var v=f+c*(y-f),d=h+c*(p-h);this.targetCenter_=[v,d]}if(u.sourceResolution&&u.targetResolution){var g=1===c?u.targetResolution:u.sourceResolution+c*(u.targetResolution-u.sourceResolution);if(u.anchor){var m=this.getViewportSize_(this.getRotation()),b=this.constraints_.resolution(g,0,m,!0);this.targetCenter_=this.calculateCenterZoom(b,u.anchor)}this.nextResolution_=u.targetResolution,this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==u.sourceRotation&&void 0!==u.targetRotation){var _=1===c?xe(u.targetRotation+Math.PI,2*Math.PI)-Math.PI:u.sourceRotation+c*(u.targetRotation-u.sourceRotation);if(u.anchor){var w=this.constraints_.rotation(_,!0);this.targetCenter_=this.calculateCenterRotate(w,u.anchor)}this.nextRotation_=u.targetRotation,this.targetRotation_=_}if(this.applyTargetState_(!0),e=!0,!u.complete)break}}if(i){this.animations_[n]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;var S=r[0].callback;S&&Ci(S,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,r,i,o=this.getCenterInternal();return void 0!==o&&(Bn(n=[o[0]-e[0],o[1]-e[1]],t-this.getRotation()),i=e,(r=n)[0]+=+i[0],r[1]+=+i[1]),n}},{key:"calculateCenterZoom",value:function(t,e){var n,r=this.getCenterInternal(),i=this.getResolution();return void 0!==r&&void 0!==i&&(n=[e[0]-t*(e[0]-r[0])/i,e[1]-t*(e[1]-r[1])/i]),n}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var n=e[0],r=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(r*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?lr(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(cn.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){return fr(this.calculateExtentInternal(t),this.getProjection())}},{key:"calculateExtentInternal",value:function(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal();kt(e,"The view center is not defined");var n=this.getResolution();kt(void 0!==n,"The view resolution is not defined");var r=this.getRotation();return kt(void 0!==r,"The view rotation is not defined"),te(e,n,r,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(cn.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal(hr(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){e=e||this.getViewportSizeMinusPadding_();var n=ae(t)/e[0],r=ne(t)/e[1];return Math.max(n,r)}},{key:"getResolutionForValueFunction",value:function(t){t=t||2;var e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(e/n)/Math.log(t);return function(n){return e/Math.pow(t,n*r)}}},{key:"getRotation",value:function(){return this.get(cn.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/e;return function(t){return Math.log(n/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){var e=this.getViewportSize_(t),n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}},{key:"getState",value:function(){var t=this.getProjection(),e=this.getResolution(),n=this.getRotation(),r=this.getCenterInternal(),i=this.padding_;if(i){var o=this.getViewportSizeMinusPadding_();r=Mi(r,this.getViewportSize_(),[o[0]/2+i[3],o[1]/2+i[0]],e,n)}return{center:r.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}},{key:"getViewStateAndExtent",value:function(){return{viewState:this.getState(),extent:this.calculateExtent()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,n,r=this.minZoom_||0;if(this.resolutions_){var i=h(this.resolutions_,t,1);r=i,e=this.resolutions_[i],n=i==this.resolutions_.length-1?2:e/this.resolutions_[i+1]}else e=this.maxResolution_,n=this.zoomFactor_;return r+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=_e(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,_e(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var n;if(kt(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,"Invalid extent or geometry provided as `geometry`"),Array.isArray(t))kt(!se(t),"Cannot fit empty extent provided as `geometry`"),n=ki(hr(t,this.getProjection()));else if("Circle"===t.getType()){var r=hr(t.getExtent(),this.getProjection());(n=ki(r)).rotate(this.getRotation(),Qt(r))}else{var i=sr();n=i?t.clone().transform(i,this.getProjection()):t}this.fitInternal(n,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),n=Math.cos(e),r=Math.sin(-e),i=t.getFlatCoordinates(),o=t.getStride(),a=1/0,u=1/0,s=-1/0,l=-1/0,c=0,f=i.length;c<f;c+=o){var h=i[c]*n-i[c+1]*r,y=i[c]*r+i[c+1]*n;a=Math.min(a,h),u=Math.min(u,y),s=Math.max(s,h),l=Math.max(l,y)}return[a,u,s,l]}},{key:"fitInternal",value:function(t,e){var n=(e=e||{}).size;n||(n=this.getViewportSizeMinusPadding_());var r,i=void 0!==e.padding?e.padding:[0,0,0,0],o=void 0!==e.nearest&&e.nearest;r=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;var a=this.rotatedExtentForGeometry(t),u=this.getResolutionForExtentInternal(a,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]);u=isNaN(u)?r:Math.max(u,r),u=this.getConstrainedResolution(u,o?0:1);var s=this.getRotation(),l=Math.sin(s),c=Math.cos(s),f=Qt(a);f[0]+=(i[1]-i[3])/2*u,f[1]+=(i[0]-i[2])/2*u;var h=f[0]*c-f[1]*l,y=f[1]*c+f[0]*l,p=this.getConstrainedCenter([h,y],u),v=e.callback?e.callback:m;void 0!==e.duration?this.animateInternal({resolution:u,center:p,duration:e.duration,easing:e.easing},v):(this.targetResolution_=u,this.targetCenter_=p,this.applyTargetState_(!1,!0),Ci(v,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal(cr(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){this.setCenterInternal(Mi(t,e,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,n,r){var i,o=this.padding_;if(o&&t){var a=this.getViewportSizeMinusPadding_(-n),u=Mi(t,r,[a[0]/2+o[3],a[1]/2+o[0]],e,n);i=[t[0]-u[0],t[1]-u[1]]}return i}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=lr(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){e=e&&cr(e,this.getProjection()),this.adjustResolutionInternal(t,e)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,r,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=cr(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(r,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t?cr(t,this.getProjection()):t)}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var n=this.getAnimating()||this.getInteracting()||e,r=this.constraints_.rotation(this.targetRotation_,n),i=this.getViewportSize_(r),o=this.constraints_.resolution(this.targetResolution_,0,i,n),a=this.constraints_.center(this.targetCenter_,o,i,n,this.calculateCenterShift(this.targetCenter_,o,r,i));this.get(cn.ROTATION)!==r&&this.set(cn.ROTATION,r),this.get(cn.RESOLUTION)!==o&&(this.set(cn.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),a&&this.get(cn.CENTER)&&Dn(this.get(cn.CENTER),a)||this.set(cn.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){t=void 0!==t?t:200;var r=e||0,i=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(i),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,i,o));if(0===t&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=i,this.targetCenter_=u,void this.applyTargetState_();n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===i&&this.getCenterInternal()&&Dn(this.getCenterInternal(),u)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:u,resolution:a,duration:t,easing:Sr,anchor:n}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(1,1)}},{key:"endInteraction",value:function(t,e,n){n=n&&cr(n,this.getProjection()),this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,n){this.getInteracting()&&(this.setHint(1,-1),this.resolveConstraints(t,e,n))}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}},{key:"getConstrainedResolution",value:function(t,e){e=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}],n&&Ei(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function Ci(t,e){setTimeout((function(){t(e)}),0)}function Ii(t){return!(t.sourceCenter&&t.targetCenter&&!Dn(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}function Mi(t,e,n,r,i){var o=Math.cos(-i),a=Math.sin(-i),u=t[0]*o-t[1]*a,s=t[1]*o+t[0]*a;return[(u+=(e[0]/2-n[0])*r)*o-(s+=(n[1]-e[1]/2)*r)*(a=-a),s*o+u*a]}const Ai=Ti;function Fi(t){return Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fi(t)}function Li(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Fi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Fi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Fi(i)?i:String(i)),r)}var i}function Di(){return Di="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Gi(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Di.apply(this,arguments)}function Bi(t,e){return Bi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bi(t,e)}function Gi(t){return Gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gi(t)}function zi(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}const Ni=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bi(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Gi(r);if(i){var n=Gi(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Fi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=Object.assign({},t);delete n.source,(e=o.call(this,n)).on,e.once,e.un,e.mapPrecomposeKey_=null,e.mapRenderKey_=null,e.sourceChangeKey_=null,e.renderer_=null,e.sourceReady_=!1,e.rendered=!1,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addChangeListener(Qe,e.handleSourcePropertyChange_);var r=t.source?t.source:null;return e.setSource(r),e}return e=a,(n=[{key:"getLayersArray",value:function(t){return(t=t||[]).push(this),t}},{key:"getLayerStatesArray",value:function(t){return(t=t||[]).push(this.getLayerState()),t}},{key:"getSource",value:function(){return this.get(Qe)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():"undefined"}},{key:"handleSourceChange_",value:function(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}},{key:"handleSourcePropertyChange_",value:function(){var t=this;this.sourceChangeKey_&&(L(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;var e=this.getSource();e&&(this.sourceChangeKey_=A(e,E,this.handleSourceChange_,this),"ready"===e.getState()&&(this.sourceReady_=!0,setTimeout((function(){t.dispatchEvent("sourceready")}),0))),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}},{key:"getData",value:function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}},{key:"isVisible",value:function(t){var e,n,r=this,i=this.getMapInternal();!t&&i&&(t=i.getView()),!(e=t instanceof Ai?{viewState:t.getState(),extent:t.calculateExtent()}:t).layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray()),n=e.layerStatesArray?e.layerStatesArray.find((function(t){return t.layer===r})):this.getLayerState();var o=this.getExtent();return zi(n,e.viewState)&&(!o||ue(o,e.extent))}},{key:"getAttributions",value:function(t){if(!this.isVisible(t))return[];var e,n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];var r=e(t instanceof Ai?t.getViewStateAndExtent():t);return Array.isArray(r)||(r=[r]),r}},{key:"render",value:function(t,e){var n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}},{key:"unrender",value:function(){this.rendered=!1}},{key:"setMapInternal",value:function(t){t||this.unrender(),this.set("map",t)}},{key:"getMapInternal",value:function(){return this.get("map")}},{key:"setMap",value:function(t){this.mapPrecomposeKey_&&(L(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(L(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=A(t,sn,(function(t){var e=t.frameState.layerStatesArray,n=this.getLayerState(!1);kt(!e.some((function(t){return t.layer===n.layer})),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}),this),this.mapRenderKey_=A(this,E,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(Qe,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),Di(Gi(a.prototype),"disposeInternal",this).call(this)}}])&&Li(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(on);function Wi(t){return Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wi(t)}function Xi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Wi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Wi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Wi(i)?i:String(i)),r)}var i}function Yi(t,e){return Yi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Yi(t,e)}function Ki(t){return Ki=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ki(t)}var Zi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Yi(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ki(r);if(i){var n=Ki(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Wi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).map_=t,e}return e=a,n=[{key:"dispatchRenderEvent",value:function(t,e){X()}},{key:"calculateMatrices2D",value:function(t){var e=t.viewState,n=t.coordinateToPixelTransform,r=t.pixelToCoordinateTransform;Et(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),jt(r,n)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i,o,a,u){var s,l=e.viewState;function c(t,e,n,r){return i.call(o,e,t?n:null,r)}var f=l.projection,h=Gn(t.slice(),f),y=[[0,0]];if(f.canWrapX()&&r){var p=ae(f.getExtent());y.push([-p,0],[p,0])}for(var v=e.layerStatesArray,d=v.length,g=[],m=[],b=0;b<y.length;b++)for(var _=d-1;_>=0;--_){var w=v[_],S=w.layer;if(S.hasRenderer()&&zi(w,l)&&a.call(u,S)){var O=S.getRenderer(),x=S.getSource();if(O&&x){var k=x.getWrapX()?h:t,P=c.bind(null,w.managed);m[0]=k[0]+y[b][0],m[1]=k[1]+y[b][1],s=O.forEachFeatureAtCoordinate(m,e,n,P,g)}if(s)return s}}if(0!==g.length){var E=1/g.length;return g.forEach((function(t,e){return t.distanceSq+=e*E})),g.sort((function(t,e){return t.distanceSq-e.distanceSq})),g.some((function(t){return s=t.callback(t.feature,t.layer,t.geometry)})),s}}},{key:"hasFeatureAtCoordinate",value:function(t,e,n,r,i,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,r,d,this,i,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){X()}},{key:"flushDeclutterItems",value:function(t){}},{key:"scheduleExpireIconCache",value:function(t){Xe.canExpireCache()&&t.postRenderFunctions.push(Vi)}}],n&&Xi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(c);function Vi(t,e){Xe.expire()}const Ui=Zi;function qi(t){return qi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qi(t)}function Hi(t,e){return Hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Hi(t,e)}function Ji(t){return Ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ji(t)}const Qi=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hi(t,e)}(o,t);var e,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ji(n);if(r){var i=Ji(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===qi(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t,e,n,r){var a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(a=i.call(this,t)).inversePixelTransform=e,a.frameState=n,a.context=r,a}return e=o,Object.defineProperty(e,"prototype",{writable:!1}),e}(a);var $i="ol-hidden",to="ol-unselectable",eo="ol-control",no="ol-collapsed",ro=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),io=["style","variant","weight","size","lineHeight","family"],oo=function(t){var e=t.match(ro);if(!e)return null;for(var n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},r=0,i=io.length;r<i;++r){var o=e[r+1];void 0!==o&&(n[io[r]]=o)}return n.families=n.family.split(/,\s?/),n};function ao(t,e,n,r){var i;return i=n&&n.length?n.shift():St?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}function uo(t){var e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function so(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function lo(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}var co,fo,ho="10px sans-serif",yo="#000",po="round",vo=[],go="round",mo="#000",bo="center",_o="middle",wo=[0,0,0,0],So=new nt,Oo=null,xo={},ko=function(){var t,e,n="32px ",r=["monospace","serif"],i=r.length,o="wmytzilWMYTZIL@#/&?$%10";function a(t,a,u){for(var s=!0,l=0;l<i;++l){var c=r[l];if(e=jo(t+" "+a+" "+n+c,o),u!=c){var f=jo(t+" "+a+" "+n+u+","+c,o);s=s&&f!=e}}return!!s}function u(){for(var e=!0,n=So.getKeys(),r=0,i=n.length;r<i;++r){var o=n[r];So.get(o)<100&&(a.apply(this,o.split("\n"))?(_(xo),Oo=null,co=void 0,So.set(o,100)):(So.set(o,So.get(o)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var n=oo(e);if(n)for(var r=n.families,i=0,o=r.length;i<o;++i){var s=r[i],l=n.style+"\n"+n.weight+"\n"+s;void 0===So.get(l)&&(So.set(l,100,!0),a(n.style,n.weight,s)||(So.set(l,0,!0),void 0===t&&(t=setInterval(u,32))))}}}(),Po=function(t){var e=xo[t];if(null==e){if(St){var n=oo(t),r=Eo(t,"g");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(r.actualBoundingBoxAscent+r.actualBoundingBoxDescent)}else fo||((fo=document.createElement("div")).innerHTML="M",fo.style.minHeight="0",fo.style.maxHeight="none",fo.style.height="auto",fo.style.padding="0",fo.style.border="none",fo.style.position="absolute",fo.style.display="block",fo.style.left="-99999px"),fo.style.font=t,document.body.appendChild(fo),e=fo.offsetHeight,document.body.removeChild(fo);xo[t]=e}return e};function Eo(t,e){return Oo||(Oo=ao(1,1)),t!=co&&(Oo.font=t,co=Oo.font),Oo.measureText(e)}function jo(t,e){return Eo(t,e).width}function Ro(t,e,n){if(e in n)return n[e];var r=e.split("\n").reduce((function(e,n){return Math.max(e,jo(t,n))}),0);return n[e]=r,r}function To(t){return To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},To(t)}function Co(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==To(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==To(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===To(i)?i:String(i)),r)}var i}function Io(){return Io="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ao(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Io.apply(this,arguments)}function Mo(t,e){return Mo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mo(t,e)}function Ao(t){return Ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ao(t)}const Fo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mo(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ao(r);if(i){var n=Ao(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===To(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t)).fontChangeListenerKey_=A(So,u,t.redrawText.bind(t)),e.element_=document.createElement("div");var n=e.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",e.element_.className=to+" ol-layers";var r=t.getViewport();return r.insertBefore(e.element_,r.firstChild||null),e.children_=[],e.renderedVisible_=!0,e.declutterLayers_=[],e}return e=a,(n=[{key:"dispatchRenderEvent",value:function(t,e){var n=this.getMap();if(n.hasListener(t)){var r=new Qi(t,void 0,e);n.dispatchEvent(r)}}},{key:"disposeInternal",value:function(){L(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),Io(Ao(a.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(sn,t);var e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),n=t.viewState;this.children_.length=0;var r=this.declutterLayers_;r.length=0;for(var i=null,o=0,a=e.length;o<a;++o){var u=e[o];t.layerIndex=o;var s=u.layer,l=s.getSourceState();if(!zi(u,n)||"ready"!=l&&"undefined"!=l)s.unrender();else{var c=s.render(t,i);c&&(c!==i&&(this.children_.push(c),i=c),"getDeclutter"in s&&r.push(s))}}this.flushDeclutterItems(t),function(t,e){for(var n=t.childNodes,r=0;;++r){var i=n[r],o=e[r];if(!i&&!o)break;i!==o&&(i?o?t.insertBefore(o,i):(t.removeChild(i),--r):t.appendChild(o))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}},{key:"flushDeclutterItems",value:function(t){for(var e=this.declutterLayers_,n=e.length-1;n>=0;--n)e[n].renderDeclutter(t);e.length=0}}])&&Co(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ui);function Lo(t){return Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lo(t)}function Do(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Lo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Lo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Lo(i)?i:String(i)),r)}var i}function Bo(t,e,n){return e&&Do(t.prototype,e),n&&Do(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Go(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&No(t,e)}function No(t,e){return No=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},No(t,e)}function Wo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Xo(t);if(e){var i=Xo(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Lo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Xo(t){return Xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xo(t)}var Yo=function(t){zo(n,t);var e=Wo(n);function n(t,r){var i;return Go(this,n),(i=e.call(this,t)).layer=r,i}return Bo(n)}(a),Ko="layers";const Zo=function(t){zo(n,t);var e=Wo(n);function n(t){var r;Go(this,n),t=t||{};var i=Object.assign({},t);delete i.layers;var o=t.layers;return(r=e.call(this,i)).on,r.once,r.un,r.layersListenerKeys_=[],r.listenerKeys_={},r.addChangeListener(Ko,r.handleLayersChanged_),o?Array.isArray(o)?o=new vt(o.slice(),{unique:!0}):kt("function"==typeof o.getArray,"Expected `layers` to be an array or a `Collection`"):o=new vt(void 0,{unique:!0}),r.setLayers(o),r}return Bo(n,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(L),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(A(t,rt,this.handleLayersAdd_,this),A(t,it,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(L);_(this.listenerKeys_);for(var n=t.getArray(),r=0,i=n.length;r<i;r++){var o=n[r];this.registerLayerListeners_(o),this.dispatchEvent(new Yo("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(t){var e=[A(t,u,this.handleLayerChange_,this),A(t,E,this.handleLayerChange_,this)];t instanceof n&&e.push(A(t,"addlayer",this.handleLayerGroupAdd_,this),A(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[K(t)]=e}},{key:"handleLayerGroupAdd_",value:function(t){this.dispatchEvent(new Yo("addlayer",t.layer))}},{key:"handleLayerGroupRemove_",value:function(t){this.dispatchEvent(new Yo("removelayer",t.layer))}},{key:"handleLayersAdd_",value:function(t){var e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Yo("addlayer",e)),this.changed()}},{key:"handleLayersRemove_",value:function(t){var e=t.element,n=K(e);this.listenerKeys_[n].forEach(L),delete this.listenerKeys_[n],this.dispatchEvent(new Yo("removelayer",e)),this.changed()}},{key:"getLayers",value:function(){return this.get(Ko)}},{key:"setLayers",value:function(t){var e=this.getLayers();if(e)for(var n=e.getArray(),r=0,i=n.length;r<i;++r)this.dispatchEvent(new Yo("removelayer",n[r]));this.set(Ko,t)}},{key:"getLayersArray",value:function(t){return t=void 0!==t?t:[],this.getLayers().forEach((function(e){e.getLayersArray(t)})),t}},{key:"getLayerStatesArray",value:function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));var r=this.getLayerState(),i=r.zIndex;t||void 0!==r.zIndex||(i=0);for(var o=n,a=e.length;o<a;o++){var u=e[o];u.opacity*=r.opacity,u.visible=u.visible&&r.visible,u.maxResolution=Math.min(u.maxResolution,r.maxResolution),u.minResolution=Math.max(u.minResolution,r.minResolution),u.minZoom=Math.max(u.minZoom,r.minZoom),u.maxZoom=Math.min(u.maxZoom,r.maxZoom),void 0!==r.extent&&(void 0!==u.extent?u.extent=re(u.extent,r.extent):u.extent=r.extent),void 0===u.zIndex&&(u.zIndex=i)}return e}},{key:"getSourceState",value:function(){return"ready"}}]),n}(on);function Vo(t){return Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(t)}function Uo(t,e){return Uo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Uo(t,e)}function qo(t){return qo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qo(t)}const Ho=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uo(t,e)}(o,t);var e,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=qo(n);if(r){var i=qo(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Vo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=i.call(this,t)).map=e,r.frameState=void 0!==n?n:null,r}return e=o,Object.defineProperty(e,"prototype",{writable:!1}),e}(a);function Jo(t){return Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jo(t)}function Qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Jo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Jo(i)?i:String(i)),r)}var i}function $o(){return $o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ea(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},$o.apply(this,arguments)}function ta(t,e){return ta=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ta(t,e)}function ea(t){return ea=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ea(t)}const na=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ta(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ea(r);if(i){var n=ea(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Jo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r,i,u){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(s=o.call(this,t,e,i)).originalEvent=n,s.pixel_=null,s.coordinate_=null,s.dragging=void 0!==r&&r,s.activePointers=u,s}return e=a,(n=[{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}},{key:"preventDefault",value:function(){$o(ea(a.prototype),"preventDefault",this).call(this),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){$o(ea(a.prototype),"stopPropagation",this).call(this),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}])&&Qo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ho),ra={SINGLECLICK:"singleclick",CLICK:R,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ia="pointerdown";function oa(t){return oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oa(t)}function aa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==oa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==oa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===oa(i)?i:String(i)),r)}var i}function ua(){return ua="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ca(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ua.apply(this,arguments)}function sa(t,e){return sa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sa(t,e)}function la(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ca(t){return ca=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ca(t)}const fa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sa(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ca(r);if(i){var n=ca(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===oa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return la(t)}(this,t)});function a(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,t)).map_=t,n.clickTimeoutId_,n.emulateClicks_=!1,n.dragging_=!1,n.dragListenerKeys_=[],n.moveTolerance_=void 0===e?1:e,n.down_=null;var r=n.map_.getViewport();return n.activePointers_=[],n.trackedTouches_={},n.element_=r,n.pointerdownListenerKey_=A(r,ia,n.handlePointerDown_,la(n)),n.originalPointerMoveEvent_,n.relayedListenerKey_=A(r,"pointermove",n.relayMoveEvent_,la(n)),n.boundHandleTouchMove_=n.handleTouchMove_.bind(la(n)),n.element_.addEventListener(I,n.boundHandleTouchMove_,!!xt&&{passive:!1}),n}return e=a,(n=[{key:"emulateClick_",value:function(t){var e=this,n=new na(ra.CLICK,this.map_,t);this.dispatchEvent(n),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new na(ra.DBLCLICK,this.map_,t),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout((function(){e.clickTimeoutId_=void 0;var n=new na(ra.SINGLECLICK,e.map_,t);e.dispatchEvent(n)}),250)}},{key:"updateActivePointers_",value:function(t){var e=t,n=e.pointerId;if(e.type==ra.POINTERUP||e.type==ra.POINTERCANCEL){for(var r in delete this.trackedTouches_[n],this.trackedTouches_)if(this.trackedTouches_[r].target!==e.target){delete this.trackedTouches_[r];break}}else e.type!=ra.POINTERDOWN&&e.type!=ra.POINTERMOVE||(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}},{key:"handlePointerUp_",value:function(t){this.updateActivePointers_(t);var e=new na(ra.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(L),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(t){return 0===t.button}},{key:"handlePointerDown_",value:function(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);var e=new na(ra.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),0===this.dragListenerKeys_.length){var n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(A(n,ra.POINTERMOVE,this.handlePointerMove_,this),A(n,ra.POINTERUP,this.handlePointerUp_,this),A(this.element_,ra.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(A(this.element_.getRootNode(),ra.POINTERUP,this.handlePointerUp_,this))}}},{key:"handlePointerMove_",value:function(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;var e=new na(ra.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}},{key:"relayMoveEvent_",value:function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new na(ra.POINTERMOVE,this.map_,t,e))}},{key:"handleTouchMove_",value:function(t){var e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}},{key:"isMoving_",value:function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&(L(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(I,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(L(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(L),this.dragListenerKeys_.length=0,this.element_=null,ua(ca(a.prototype),"disposeInternal",this).call(this)}}])&&aa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(P),ha="postrender",ya="loadstart",pa="loadend",va="layergroup",da="size",ga="target",ma="view";function ba(t){return ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ba(t)}function _a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ba(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ba(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ba(i)?i:String(i)),r)}var i}var wa=1/0;function Sa(t){return Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sa(t)}function Oa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Sa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Sa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Sa(i)?i:String(i)),r)}var i}function xa(){return xa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ea(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},xa.apply(this,arguments)}function ka(t,e){return ka=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ka(t,e)}function Pa(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ea(t){return Ea=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ea(t)}const ja=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ka(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ea(r);if(i){var n=Ea(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Sa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Pa(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(n=o.call(this,(function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()}))).boundHandleTileChange_=n.handleTileChange.bind(Pa(n)),n.tileChangeCallback_=e,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return e=a,(n=[{key:"enqueue",value:function(t){var e=xa(Ea(a.prototype),"enqueue",this).call(this,t);return e&&t[0].addEventListener(E,this.boundHandleTileChange_),e}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var e=t.target,n=e.getState();if(2===n||3===n||4===n){3!==n&&e.removeEventListener(E,this.boundHandleTileChange_);var r=e.getKey();r in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[r],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(t,e){for(var n,r,i=0;this.tilesLoading_<t&&i<e&&this.getCount()>0;)r=(n=this.dequeue()[0]).getKey(),0!==n.getState()||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++i,n.load())}}])&&Oa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}var e,n;return e=t,(n=[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,_(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var r=this.keyFunction_(n);return delete this.queuedElements_[r],n}},{key:"enqueue",value:function(t){kt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");var e=this.priorityFunction_(t);return e!=wa&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var e=this.elements_,n=this.priorities_,r=e.length,i=e[t],o=n[t],a=t;t<r>>1;){var u=this.getLeftChildIndex_(t),s=this.getRightChildIndex_(t),l=s<r&&n[s]<n[u]?s:u;e[t]=e[l],n[t]=n[l],t=l}e[t]=i,n[t]=o,this.siftDown_(a,t)}},{key:"siftDown_",value:function(t,e){for(var n=this.elements_,r=this.priorities_,i=n[e],o=r[e];e>t;){var a=this.getParentIndex_(e);if(!(r[a]>o))break;n[e]=n[a],r[e]=r[a],e=a}n[e]=i,r[e]=o}},{key:"reprioritize",value:function(){var t,e,n,r=this.priorityFunction_,i=this.elements_,o=this.priorities_,a=0,u=i.length;for(e=0;e<u;++e)(n=r(t=i[e]))==wa?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=n,i[a++]=t);i.length=a,o.length=a,this.heapify_()}}])&&_a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Ra(t){return Ra="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ra(t)}function Ta(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ra(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ra(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ra(i)?i:String(i)),r)}var i}function Ca(){return Ca="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ma(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Ca.apply(this,arguments)}function Ia(t,e){return Ia=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ia(t,e)}function Ma(t){return Ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ma(t)}const Aa=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ia(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ma(r);if(i){var n=Ma(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ra(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),e=o.call(this);var n=t.element;return!n||t.target||n.style.pointerEvents||(n.style.pointerEvents="auto"),e.element=n||null,e.target_=null,e.map_=null,e.listenerKeys=[],t.render&&(e.render=t.render),t.target&&e.setTarget(t.target),e}return e=a,(n=[{key:"disposeInternal",value:function(){lo(this.element),Ca(Ma(a.prototype),"disposeInternal",this).call(this)}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(t){this.map_&&lo(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)L(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==m&&this.listenerKeys.push(A(t,ha,this.render,this)),t.render())}},{key:"render",value:function(t){}},{key:"setTarget",value:function(t){this.target_="string"==typeof t?document.getElementById(t):t}}])&&Ta(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function Fa(t){return Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fa(t)}function La(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Fa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Fa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Fa(i)?i:String(i)),r)}var i}function Da(t,e){return Da=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Da(t,e)}function Ba(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ga(t){return Ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ga(t)}const za=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Da(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ga(r);if(i){var n=Ga(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Fa(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ba(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this,{element:document.createElement("div"),render:t.render,target:t.target})).ulElement_=document.createElement("ul"),e.collapsed_=void 0===t.collapsed||t.collapsed,e.userCollapsed_=e.collapsed_,e.overrideCollapsible_=void 0!==t.collapsible,e.collapsible_=void 0===t.collapsible||t.collapsible,e.collapsible_||(e.collapsed_=!1);var n=void 0!==t.className?t.className:"ol-attribution",r=void 0!==t.tipLabel?t.tipLabel:"Attributions",i=void 0!==t.expandClassName?t.expandClassName:n+"-expand",u=void 0!==t.collapseLabel?t.collapseLabel:"",s=void 0!==t.collapseClassName?t.collapseClassName:n+"-collapse";"string"==typeof u?(e.collapseLabel_=document.createElement("span"),e.collapseLabel_.textContent=u,e.collapseLabel_.className=s):e.collapseLabel_=u;var l=void 0!==t.label?t.label:"i";"string"==typeof l?(e.label_=document.createElement("span"),e.label_.textContent=l,e.label_.className=i):e.label_=l;var c=e.collapsible_&&!e.collapsed_?e.collapseLabel_:e.label_;e.toggleButton_=document.createElement("button"),e.toggleButton_.setAttribute("type","button"),e.toggleButton_.setAttribute("aria-expanded",String(!e.collapsed_)),e.toggleButton_.title=r,e.toggleButton_.appendChild(c),e.toggleButton_.addEventListener(R,e.handleClick_.bind(Ba(e)),!1);var f=n+" "+to+" "+eo+(e.collapsed_&&e.collapsible_?" "+no:"")+(e.collapsible_?"":" ol-uncollapsible"),h=e.element;return h.className=f,h.appendChild(e.toggleButton_),h.appendChild(e.ulElement_),e.renderedAttributions_=[],e.renderedVisible_=!0,e}return e=a,(n=[{key:"collectSourceAttributions_",value:function(t){var e=Array.from(new Set(this.getMap().getAllLayers().flatMap((function(e){return e.getAttributions(t)})))),n=!this.getMap().getAllLayers().some((function(t){return t.getSource()&&!1===t.getSource().getAttributionsCollapsible()}));return this.overrideCollapsible_||this.setCollapsible(n),e}},{key:"updateElement_",value:function(t){if(t){var e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!v(e,this.renderedAttributions_)){!function(t){for(;t.lastChild;)t.removeChild(t.lastChild)}(this.ulElement_);for(var r=0,i=e.length;r<i;++r){var o=document.createElement("li");o.innerHTML=e[r],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"handleClick_",value:function(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}},{key:"handleToggle_",value:function(){this.element.classList.toggle(no),this.collapsed_?so(this.collapseLabel_,this.label_):so(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"render",value:function(t){this.updateElement_(t.frameState)}}])&&La(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Aa);function Na(t){return Na="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Na(t)}function Wa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Na(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Na(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Na(i)?i:String(i)),r)}var i}function Xa(t,e){return Xa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xa(t,e)}function Ya(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ka(t){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ka(t)}var Za=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xa(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ka(r);if(i){var n=Ka(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Na(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ya(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},e=o.call(this,{element:document.createElement("div"),render:t.render,target:t.target});var n=void 0!==t.className?t.className:"ol-rotate",r=void 0!==t.label?t.label:"",i=void 0!==t.compassClassName?t.compassClassName:"ol-compass";e.label_=null,"string"==typeof r?(e.label_=document.createElement("span"),e.label_.className=i,e.label_.textContent=r):(e.label_=r,e.label_.classList.add(i));var u=t.tipLabel?t.tipLabel:"Reset rotation",s=document.createElement("button");s.className=n+"-reset",s.setAttribute("type","button"),s.title=u,s.appendChild(e.label_),s.addEventListener(R,e.handleClick_.bind(Ya(e)),!1);var l=n+" "+to+" "+eo,c=e.element;return c.className=l,c.appendChild(s),e.callResetNorth_=t.resetNorth?t.resetNorth:void 0,e.duration_=void 0!==t.duration?t.duration:250,e.autoHide_=void 0===t.autoHide||t.autoHide,e.rotation_=void 0,e.autoHide_&&e.element.classList.add($i),e}return e=a,n=[{key:"handleClick_",value:function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:Sr}):t.setRotation(0))}}},{key:"render",value:function(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var r="rotate("+n+"rad)";if(this.autoHide_){var i=this.element.classList.contains($i);i||0!==n?i&&0!==n&&this.element.classList.remove($i):this.element.classList.add($i)}this.label_.style.transform=r}this.rotation_=n}}}],n&&Wa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Aa);const Va=Za;function Ua(t){return Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ua(t)}function qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ua(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ua(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ua(i)?i:String(i)),r)}var i}function Ha(t,e){return Ha=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ha(t,e)}function Ja(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qa(t){return Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qa(t)}const $a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ha(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qa(r);if(i){var n=Qa(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ua(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ja(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},e=o.call(this,{element:document.createElement("div"),target:t.target});var n=void 0!==t.className?t.className:"ol-zoom",r=void 0!==t.delta?t.delta:1,i=void 0!==t.zoomInClassName?t.zoomInClassName:n+"-in",u=void 0!==t.zoomOutClassName?t.zoomOutClassName:n+"-out",s=void 0!==t.zoomInLabel?t.zoomInLabel:"+",l=void 0!==t.zoomOutLabel?t.zoomOutLabel:"",c=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",f=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button");h.className=i,h.setAttribute("type","button"),h.title=c,h.appendChild("string"==typeof s?document.createTextNode(s):s),h.addEventListener(R,e.handleClick_.bind(Ja(e),r),!1);var y=document.createElement("button");y.className=u,y.setAttribute("type","button"),y.title=f,y.appendChild("string"==typeof l?document.createTextNode(l):l),y.addEventListener(R,e.handleClick_.bind(Ja(e),-r),!1);var p=n+" "+to+" "+eo,v=e.element;return v.className=p,v.appendChild(h),v.appendChild(y),e.duration_=void 0!==t.duration?t.duration:250,e}return e=a,(n=[{key:"handleClick_",value:function(t,e){e.preventDefault(),this.zoomByDelta_(t)}},{key:"zoomByDelta_",value:function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var r=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:r,duration:this.duration_,easing:Sr})):e.setZoom(r)}}}}])&&qa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Aa),tu="active";function eu(t){return eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eu(t)}function nu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==eu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==eu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===eu(i)?i:String(i)),r)}var i}function ru(t,e){return ru=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ru(t,e)}function iu(t){return iu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},iu(t)}function ou(t,e,n,r){var i=t.getZoom();if(void 0!==i){var o=t.getConstrainedZoom(i+e),a=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:a,anchor:n,duration:void 0!==r?r:250,easing:Sr})}}const au=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ru(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=iu(r);if(i){var n=iu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===eu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).on,e.once,e.un,t&&t.handleEvent&&(e.handleEvent=t.handleEvent),e.map_=null,e.setActive(!0),e}return e=a,(n=[{key:"getActive",value:function(){return this.get(tu)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(t){return!0}},{key:"setActive",value:function(t){this.set(tu,t)}},{key:"setMap",value:function(t){this.map_=t}}])&&nu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function uu(t){return uu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uu(t)}function su(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==uu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==uu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===uu(i)?i:String(i)),r)}var i}function lu(t,e){return lu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lu(t,e)}function cu(t){return cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cu(t)}const fu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lu(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=cu(r);if(i){var n=cu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===uu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this)).delta_=t.delta?t.delta:1,e.duration_=void 0!==t.duration?t.duration:250,e}return e=a,(n=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==ra.DBLCLICK){var n=t.originalEvent,r=t.map,i=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_;ou(r.getView(),o,i,this.duration_),n.preventDefault(),e=!0}return!e}}])&&su(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(au);function hu(t){return hu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hu(t)}function yu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==hu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==hu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===hu(i)?i:String(i)),r)}var i}function pu(t,e){return pu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pu(t,e)}function vu(t){return vu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vu(t)}function du(t){for(var e=t.length,n=0,r=0,i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}const gu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pu(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=vu(r);if(i){var n=vu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===hu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},e=o.call(this,t),t.handleDownEvent&&(e.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(e.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(e.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(e.handleUpEvent=t.handleUpEvent),t.stopDown&&(e.stopDown=t.stopDown),e.handlingDownUpSequence=!1,e.targetPointers=[],e}return e=a,(n=[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(t){return!1}},{key:"handleDragEvent",value:function(t){}},{key:"handleEvent",value:function(t){if(!t.originalEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ra.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ra.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==ra.POINTERDOWN){var r=this.handleDownEvent(t);this.handlingDownUpSequence=r,e=this.stopDown(r)}else t.type==ra.POINTERMOVE&&this.handleMoveEvent(t);return!e}},{key:"handleMoveEvent",value:function(t){}},{key:"handleUpEvent",value:function(t){return!1}},{key:"stopDown",value:function(t){return t}},{key:"updateTrackedPointers_",value:function(t){t.activePointers&&(this.targetPointers=t.activePointers)}}])&&yu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(au);function mu(t){var e=arguments;return function(t){for(var n=!0,r=0,i=e.length;r<i&&(n=n&&e[r](t));++r);return n}}var bu=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},_u=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){var e=t.map.getTargetElement(),n=t.map.getOwnerDocument().activeElement;return e.contains(n)}(t)},wu=d,Su=function(t){var e=t.originalEvent;return 0==e.button&&!(bt&&_t&&e.ctrlKey)},Ou=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},xu=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},ku=function(t){var e=t.originalEvent,n=e.target.tagName;return"INPUT"!==n&&"SELECT"!==n&&"TEXTAREA"!==n&&!e.target.isContentEditable},Pu=function(t){var e=t.originalEvent;return kt(void 0!==e,"mapBrowserEvent must originate from a pointer event"),"mouse"==e.pointerType},Eu=function(t){var e=t.originalEvent;return kt(void 0!==e,"mapBrowserEvent must originate from a pointer event"),e.isPrimary&&0===e.button};function ju(t){return ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ju(t)}function Ru(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ju(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ju(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ju(i)?i:String(i)),r)}var i}function Tu(t,e){return Tu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Tu(t,e)}function Cu(t){return Cu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Cu(t)}const Iu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Tu(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Cu(r);if(i){var n=Cu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ju(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this,{stopDown:g})).kinetic_=t.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1;var n=t.condition?t.condition:mu(Ou,Eu);return e.condition_=t.onFocusOnly?mu(_u,n):n,e.noKinetic_=!1,e}return e=a,(n=[{key:"handleDragEvent",value:function(t){var e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());var n,r,i=this.targetPointers,o=e.getEventPixel(du(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(o[0],o[1]),this.lastCentroid){var a=[this.lastCentroid[0]-o[0],o[1]-this.lastCentroid[1]],u=t.map.getView();n=a,r=u.getResolution(),n[0]*=r,n[1]*=r,Bn(a,u.getRotation()),u.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=o,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var r=this.kinetic_.getDistance(),i=this.kinetic_.getAngle(),o=n.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),u=e.getCoordinateFromPixelInternal([a[0]-r*Math.cos(i),a[1]-r*Math.sin(i)]);n.animateInternal({center:n.getConstrainedCenter(u),duration:500,easing:Sr})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}])&&Ru(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(gu);function Mu(t){return Mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mu(t)}function Au(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Mu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Mu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Mu(i)?i:String(i)),r)}var i}function Fu(t,e){return Fu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Fu(t,e)}function Lu(t){return Lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lu(t)}const Du=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fu(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Lu(r);if(i){var n=Lu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Mu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this,{stopDown:g})).condition_=t.condition?t.condition:bu,e.lastAngle_=void 0,e.duration_=void 0!==t.duration?t.duration:250,e}return e=a,(n=[{key:"handleDragEvent",value:function(t){if(Pu(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==br){var r=e.getSize(),i=t.pixel,o=Math.atan2(r[1]/2-i[1],i[0]-r[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_;n.adjustRotationInternal(-a)}this.lastAngle_=o}}}},{key:"handleUpEvent",value:function(t){return!Pu(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!(!Pu(t)||!Su(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0,0))}}])&&Au(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(gu);function Bu(t){return Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bu(t)}function Gu(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Bu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Bu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Bu(i)?i:String(i)),r)}var i}function zu(t,e){return zu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zu(t,e)}function Nu(t){return Nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Nu(t)}var Wu=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zu(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Nu(r);if(i){var n=Nu(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Bu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).geometry_=null,e.element_=document.createElement("div"),e.element_.style.position="absolute",e.element_.style.pointerEvents="auto",e.element_.className="ol-box "+t,e.map_=null,e.startPixel_=null,e.endPixel_=null,e}return e=a,n=[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var t=this.startPixel_,e=this.endPixel_,n="px",r=this.element_.style;r.left=Math.min(t[0],e[0])+n,r.top=Math.min(t[1],e[1])+n,r.width=Math.abs(e[0]-t[0])+n,r.height=Math.abs(e[1]-t[1])+n}},{key:"setMap",value:function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new xi([n])}},{key:"getGeometry",value:function(){return this.geometry_}}],n&&Gu(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(c);const Xu=Wu;function Yu(t){return Yu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yu(t)}function Ku(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Yu(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Yu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Yu(i)?i:String(i)),r)}var i}function Zu(t,e,n){return e&&Ku(t.prototype,e),n&&Ku(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Vu(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Uu(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qu(t,e)}function qu(t,e){return qu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qu(t,e)}function Hu(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Ju(t);if(e){var i=Ju(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===Yu(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Ju(t){return Ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ju(t)}var Qu=function(t){Uu(n,t);var e=Hu(n);function n(t,r,i){var o;return Vu(this,n),(o=e.call(this,t)).coordinate=r,o.mapBrowserEvent=i,o}return Zu(n)}(a);function $u(t){return $u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$u(t)}function ts(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===$u(i)?i:String(i)),r)}var i}function es(t,e){return es=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},es(t,e)}function ns(t){return ns=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ns(t)}const rs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&es(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ns(r);if(i){var n=ns(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===$u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=(t=t||{}).condition?t.condition:xu;return(e=o.call(this,{condition:n,className:t.className||"ol-dragzoom",minArea:t.minArea})).duration_=void 0!==t.duration?t.duration:200,e.out_=void 0!==t.out&&t.out,e}return e=a,(n=[{key:"onBoxEnd",value:function(t){var e=this.getMap().getView(),n=this.getGeometry();if(this.out_){var r=e.rotatedExtentForGeometry(n),i=e.getResolutionForExtentInternal(r),o=e.getResolution()/i;(n=n.clone()).scale(o*o)}e.fitInternal(n,{duration:this.duration_,easing:Sr})}}])&&ts(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){Uu(n,t);var e=Hu(n);function n(t){var r;return Vu(this,n),(r=e.call(this)).on,r.once,r.un,t=t||{},r.box_=new Xu(t.className||"ol-dragbox"),r.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(r.onBoxEnd=t.onBoxEnd),r.startPixel_=null,r.condition_=t.condition?t.condition:Su,r.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:r.defaultBoxEndCondition,r}return Zu(n,[{key:"defaultBoxEndCondition",value:function(t,e,n){var r=n[0]-e[0],i=n[1]-e[1];return r*r+i*i>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Qu("boxdrag",t.coordinate,t))}},{key:"handleUpEvent",value:function(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Qu(e?"boxend":"boxcancel",t.coordinate,t)),!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Qu("boxstart",t.coordinate,t)),!0)}},{key:"onBoxEnd",value:function(t){}}]),n}(gu)),is="ArrowLeft",os="ArrowRight",as="ArrowDown";function us(t){return us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},us(t)}function ss(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==us(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==us(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===us(i)?i:String(i)),r)}var i}function ls(t,e){return ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ls(t,e)}function cs(t){return cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cs(t)}const fs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ls(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=cs(r);if(i){var n=cs(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===us(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this)).defaultCondition_=function(t){return Ou(t)&&ku(t)},e.condition_=void 0!==t.condition?t.condition:e.defaultCondition_,e.duration_=void 0!==t.duration?t.duration:100,e.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128,e}return e=a,(n=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==T){var n=t.originalEvent,r=n.key;if(this.condition_(t)&&(r==as||r==is||r==os||"ArrowUp"==r)){var i=t.map.getView(),o=i.getResolution()*this.pixelDelta_,a=0,u=0;r==as?u=-o:r==is?a=-o:r==os?a=o:u=o;var s=[a,u];Bn(s,i.getRotation()),function(t,e,n){var r=t.getCenterInternal();if(r){var i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:xr,center:t.getConstrainedCenter(i)})}}(i,s,this.duration_),n.preventDefault(),e=!0}}return!e}}])&&ss(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(au);function hs(t){return hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hs(t)}function ys(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==hs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==hs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===hs(i)?i:String(i)),r)}var i}function ps(t,e){return ps=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ps(t,e)}function vs(t){return vs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vs(t)}const ds=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ps(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=vs(r);if(i){var n=vs(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===hs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this)).condition_=t.condition?t.condition:function(t){return!function(t){var e=t.originalEvent;return _t?e.metaKey:e.ctrlKey}(t)&&ku(t)},e.delta_=t.delta?t.delta:1,e.duration_=void 0!==t.duration?t.duration:100,e}return e=a,(n=[{key:"handleEvent",value:function(t){var e=!1;if(t.type==T||t.type==C){var n=t.originalEvent,r=n.key;if(this.condition_(t)&&("+"===r||"-"===r)){var i=t.map,o="+"===r?this.delta_:-this.delta_;ou(i.getView(),o,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}])&&ys(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(au);function gs(t){return gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(t)}function ms(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==gs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==gs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===gs(i)?i:String(i)),r)}var i}const bs=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}var e,n;return e=t,(n=[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var r=this.points_[e+2]-this.points_[n+2];if(r<1e3/60)return!1;var i=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,i),this.initialVelocity_=Math.sqrt(i*i+o*o)/r,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}])&&ms(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _s(t){return _s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_s(t)}function ws(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==_s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==_s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===_s(i)?i:String(i)),r)}var i}function Ss(t,e){return Ss=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ss(t,e)}function Os(t){return Os=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Os(t)}const xs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ss(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Os(r);if(i){var n=Os(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===_s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this,t)).totalDelta_=0,e.lastDelta_=0,e.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,e.duration_=void 0!==t.duration?t.duration:250,e.timeout_=void 0!==t.timeout?t.timeout:80,e.useAnchor_=void 0===t.useAnchor||t.useAnchor,e.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;var n=t.condition?t.condition:wu;return e.condition_=t.onFocusOnly?mu(_u,n):n,e.lastAnchor_=null,e.startTime_=void 0,e.timeoutId_,e.mode_=void 0,e.trackpadEventGap_=400,e.trackpadTimeoutId_,e.deltaPerZoom_=300,e}return e=a,(n=[{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.condition_(t))return!0;if(t.type!==M)return!0;var e,n=t.map,r=t.originalEvent;if(r.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==M&&(e=r.deltaY,mt&&r.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=wt),r.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var i=Date.now();void 0===this.startTime_&&(this.startTime_=i),(!this.mode_||i-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?"trackpad":"wheel");var o=n.getView();if("trackpad"===this.mode_&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=i,!1;this.totalDelta_+=e;var a=Math.max(this.timeout_-(i-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),a),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var n=-_e(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),ou(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}])&&ws(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(au);function ks(t){return ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(t)}function Ps(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ks(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ks(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ks(i)?i:String(i)),r)}var i}function Es(t,e){return Es=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Es(t,e)}function js(t){return js=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},js(t)}const Rs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Es(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=js(r);if(i){var n=js(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ks(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=t=t||{};return n.stopDown||(n.stopDown=g),(e=o.call(this,n)).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==t.threshold?t.threshold:.3,e.duration_=void 0!==t.duration?t.duration:250,e}return e=a,(n=[{key:"handleDragEvent",value:function(t){var e=0,n=this.targetPointers[0],r=this.targetPointers[1],i=Math.atan2(r.clientY-n.clientY,r.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=i-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=i;var a=t.map,u=a.getView();u.getConstraints().rotation!==br&&(this.anchor_=a.getCoordinateFromPixelInternal(a.getEventPixel(du(this.targetPointers))),this.rotating_&&(a.render(),u.adjustRotationInternal(e,this.anchor_)))}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])&&Ps(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(gu);function Ts(t){return Ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(t)}function Cs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ts(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ts(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ts(i)?i:String(i)),r)}var i}function Is(t,e){return Is=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Is(t,e)}function Ms(t){return Ms=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ms(t)}const As=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Is(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ms(r);if(i){var n=Ms(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ts(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=t=t||{};return n.stopDown||(n.stopDown=g),(e=o.call(this,n)).anchor_=null,e.duration_=void 0!==t.duration?t.duration:400,e.lastDistance_=void 0,e.lastScaleDelta_=1,e}return e=a,(n=[{key:"handleDragEvent",value:function(t){var e=1,n=this.targetPointers[0],r=this.targetPointers[1],i=n.clientX-r.clientX,o=n.clientY-r.clientY,a=Math.sqrt(i*i+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var u=t.map,s=u.getView();1!=e&&(this.lastScaleDelta_=e),this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(du(this.targetPointers))),u.render(),s.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}])&&Cs(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(gu);function Fs(t){return t[0]>0&&t[1]>0}function Ls(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function Ds(t){return Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ds(t)}function Bs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ds(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ds(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ds(i)?i:String(i)),r)}var i}function Gs(){return Gs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ws(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Gs.apply(this,arguments)}function zs(t,e){return zs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zs(t,e)}function Ns(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ws(t){return Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ws(t)}function Xs(t){t instanceof Ni?t.setMapInternal(null):t instanceof Zo&&t.getLayers().forEach(Xs)}function Ys(t,e){if(t instanceof Ni)t.setMapInternal(e);else if(t instanceof Zo)for(var n=t.getLayers().getArray(),r=0,i=n.length;r<i;++r)Ys(n[r],e)}var Ks=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zs(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ws(r);if(i){var n=Ws(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ds(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Ns(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{},(e=o.call(this)).on,e.once,e.un;var n=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,r,i,o={},a=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Zo({layers:t.layers});return o[va]=a,o[ga]=t.target,o[ma]=t.view instanceof Ai?t.view:new Ai,void 0!==t.controls&&(Array.isArray(t.controls)?n=new vt(t.controls.slice()):(kt("function"==typeof t.controls.getArray,"Expected `controls` to be an array or an `ol/Collection.js`"),n=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new vt(t.interactions.slice()):(kt("function"==typeof t.interactions.getArray,"Expected `interactions` to be an array or an `ol/Collection.js`"),r=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?i=new vt(t.overlays.slice()):(kt("function"==typeof t.overlays.getArray,"Expected `overlays` to be an array or an `ol/Collection.js`"),i=t.overlays):i=new vt,{controls:n,interactions:r,keyboardEventTarget:e,overlays:i,values:o}}(t);e.renderComplete_,e.loaded_=!0,e.boundHandleBrowserEvent_=e.handleBrowserEvent.bind(Ns(e)),e.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,e.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:wt,e.postRenderTimeoutHandle_,e.animationDelayKey_,e.animationDelay_=e.animationDelay_.bind(Ns(e)),e.coordinateToPixelTransform_=[1,0,0,1,0,0],e.pixelToCoordinateTransform_=[1,0,0,1,0,0],e.frameIndex_=0,e.frameState_=null,e.previousExtent_=null,e.viewPropertyListenerKey_=null,e.viewChangeListenerKey_=null,e.layerGroupPropertyListenerKeys_=null,e.viewport_=document.createElement("div"),e.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),e.viewport_.style.position="relative",e.viewport_.style.overflow="hidden",e.viewport_.style.width="100%",e.viewport_.style.height="100%",e.overlayContainer_=document.createElement("div"),e.overlayContainer_.style.position="absolute",e.overlayContainer_.style.zIndex="0",e.overlayContainer_.style.width="100%",e.overlayContainer_.style.height="100%",e.overlayContainer_.style.pointerEvents="none",e.overlayContainer_.className="ol-overlaycontainer",e.viewport_.appendChild(e.overlayContainer_),e.overlayContainerStopEvent_=document.createElement("div"),e.overlayContainerStopEvent_.style.position="absolute",e.overlayContainerStopEvent_.style.zIndex="0",e.overlayContainerStopEvent_.style.width="100%",e.overlayContainerStopEvent_.style.height="100%",e.overlayContainerStopEvent_.style.pointerEvents="none",e.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",e.viewport_.appendChild(e.overlayContainerStopEvent_),e.mapBrowserEventHandler_=null,e.moveTolerance_=t.moveTolerance,e.keyboardEventTarget_=n.keyboardEventTarget,e.targetChangeHandlerKeys_=null,e.targetElement_=null,e.resizeObserver_=new ResizeObserver((function(){return e.updateSize()})),e.controls=n.controls||function(t){t=t||{};var e=new vt;return(void 0===t.zoom||t.zoom)&&e.push(new $a(t.zoomOptions)),(void 0===t.rotate||t.rotate)&&e.push(new Va(t.rotateOptions)),(void 0===t.attribution||t.attribution)&&e.push(new za(t.attributionOptions)),e}(),e.interactions=n.interactions||function(t){t=t||{};var e=new vt,n=new bs(-.005,.05,100);return(void 0===t.altShiftDragRotate||t.altShiftDragRotate)&&e.push(new Du),(void 0===t.doubleClickZoom||t.doubleClickZoom)&&e.push(new fu({delta:t.zoomDelta,duration:t.zoomDuration})),(void 0===t.dragPan||t.dragPan)&&e.push(new Iu({onFocusOnly:t.onFocusOnly,kinetic:n})),(void 0===t.pinchRotate||t.pinchRotate)&&e.push(new Rs),(void 0===t.pinchZoom||t.pinchZoom)&&e.push(new As({duration:t.zoomDuration})),(void 0===t.keyboard||t.keyboard)&&(e.push(new fs),e.push(new ds({delta:t.zoomDelta,duration:t.zoomDuration}))),(void 0===t.mouseWheelZoom||t.mouseWheelZoom)&&e.push(new xs({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(void 0===t.shiftDragZoom||t.shiftDragZoom)&&e.push(new rs({duration:t.zoomDuration})),e}({onFocusOnly:!0}),e.overlays_=n.overlays,e.overlayIdIndex_={},e.renderer_=null,e.postRenderFunctions_=[],e.tileQueue_=new ja(e.getTilePriority.bind(Ns(e)),e.handleTileChange_.bind(Ns(e))),e.addChangeListener(va,e.handleLayerGroupChanged_),e.addChangeListener(ma,e.handleViewChanged_),e.addChangeListener(da,e.handleSizeChanged_),e.addChangeListener(ga,e.handleTargetChanged_),e.setProperties(n.values);var r=Ns(e);return!t.view||t.view instanceof Ai||t.view.then((function(t){r.setView(new Ai(t))})),e.controls.addEventListener(rt,(function(t){t.element.setMap(Ns(e))})),e.controls.addEventListener(it,(function(t){t.element.setMap(null)})),e.interactions.addEventListener(rt,(function(t){t.element.setMap(Ns(e))})),e.interactions.addEventListener(it,(function(t){t.element.setMap(null)})),e.overlays_.addEventListener(rt,(function(t){e.addOverlayInternal_(t.element)})),e.overlays_.addEventListener(it,(function(t){var n=t.element.getId();void 0!==n&&delete e.overlayIdIndex_[n.toString()],t.element.setMap(null)})),e.controls.forEach((function(t){t.setMap(Ns(e))})),e.interactions.forEach((function(t){t.setMap(Ns(e))})),e.overlays_.forEach(e.addOverlayInternal_.bind(Ns(e))),e}return e=a,(n=[{key:"addControl",value:function(t){this.getControls().push(t)}},{key:"addInteraction",value:function(t){this.getInteractions().push(t)}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"handleLayerAdd_",value:function(t){Ys(t.layer,this)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),Gs(Ws(a.prototype),"disposeInternal",this).call(this)}},{key:"forEachFeatureAtPixel",value:function(t,e,n){if(this.frameState_&&this.renderer_){var r=this.getCoordinateFromPixelInternal(t),i=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance:0,o=void 0!==n.layerFilter?n.layerFilter:d,a=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(r,this.frameState_,i,a,e,null,o,null)}}},{key:"getFeaturesAtPixel",value:function(t,e){var n=[];return this.forEachFeatureAtPixel(t,(function(t){n.push(t)}),e),n}},{key:"getAllLayers",value:function(){var t=[];return function e(n){n.forEach((function(n){n instanceof Zo?e(n.getLayers()):t.push(n)}))}(this.getLayers()),t}},{key:"hasFeatureAtPixel",value:function(t,e){if(!this.frameState_||!this.renderer_)return!1;var n=this.getCoordinateFromPixelInternal(t),r=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:d,i=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,i,o,r,null)}},{key:"getEventCoordinate",value:function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}},{key:"getEventCoordinateInternal",value:function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}},{key:"getEventPixel",value:function(t){var e=this.viewport_.getBoundingClientRect(),n=this.getSize(),r=e.width/n[0],i=e.height/n[1],o="changedTouches"in t?t.changedTouches[0]:t;return[(o.clientX-e.left)/r,(o.clientY-e.top)/i]}},{key:"getTarget",value:function(){return this.get(ga)}},{key:"getTargetElement",value:function(){return this.targetElement_}},{key:"getCoordinateFromPixel",value:function(t){return lr(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(t){var e=this.frameState_;return e?Pt(e.pixelToCoordinateTransform,t.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(va)}},{key:"setLayers",value:function(t){var e=this.getLayerGroup();if(t instanceof vt)e.setLayers(t);else{var n=e.getLayers();n.clear(),n.extend(t)}}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e];if(r.visible){var i=r.layer.getRenderer();if(i&&!i.ready)return!0;var o=r.layer.getSource();if(o&&o.loading)return!0}}return!1}},{key:"getPixelFromCoordinate",value:function(t){var e=cr(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}},{key:"getPixelFromCoordinateInternal",value:function(t){var e=this.frameState_;return e?Pt(e.coordinateToPixelTransform,t.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(da)}},{key:"getView",value:function(){return this.get(ma)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getOwnerDocument",value:function(){var t=this.getTargetElement();return t?t.ownerDocument:document}},{key:"getTilePriority",value:function(t,e,n,r){return function(t,e,n,r,i){if(!t||!(n in t.wantedTiles))return wa;if(!t.wantedTiles[n][e.getKey()])return wa;var o=t.viewState.center,a=r[0]-o[0],u=r[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+u*u)/i}(this.frameState_,t,e,n,r)}},{key:"handleBrowserEvent",value:function(t,e){e=e||t.type;var n=new na(e,this,t);this.handleMapBrowserEvent(n)}},{key:"handleMapBrowserEvent",value:function(t){if(this.frameState_){var e=t.originalEvent,n=e.type;if(n===ia||n===M||n===T){var r=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():r,o=e.target;if(this.overlayContainerStopEvent_.contains(o)||!(i===r?r.documentElement:i).contains(o))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t))for(var a=this.getInteractions().getArray().slice(),u=a.length-1;u>=0;u--){var s=a[u];if(s.getMap()===this&&s.getActive()&&this.getTargetElement()&&(!s.handleEvent(t)||t.propagationStopped))break}}}},{key:"handlePostRender",value:function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,r=n;if(t){var i=t.viewHints;if(i[0]||i[1]){var o=Date.now()-t.time>8;n=o?0:8,r=o?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}t&&this.renderer_&&!t.animate&&(!0===this.renderComplete_?(this.hasListener(ln)&&this.renderer_.dispatchRenderEvent(ln,t),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new Ho(pa,this,t)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new Ho(ya,this,t))));for(var a=this.postRenderFunctions_,u=0,s=a.length;u<s;++u)a[u](this,t);a.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){if(this.mapBrowserEventHandler_){for(var t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)L(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(j,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(M,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,lo(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);var n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}var r=this.getTarget(),i="string"==typeof r?document.getElementById(r):r;if(this.targetElement_=i,i){for(var o in i.appendChild(this.viewport_),this.renderer_||(this.renderer_=new Fo(this)),this.mapBrowserEventHandler_=new fa(this,this.moveTolerance_),ra)this.mapBrowserEventHandler_.addEventListener(ra[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(j,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(M,this.boundHandleBrowserEvent_,!!xt&&{passive:!1});var a=this.keyboardEventTarget_?this.keyboardEventTarget_:i;this.targetChangeHandlerKeys_=[A(a,T,this.handleBrowserEvent,this),A(a,C,this.handleBrowserEvent,this)];var u=i.getRootNode();u instanceof ShadowRoot&&this.resizeObserver_.observe(u.host),this.resizeObserver_.observe(i)}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&(L(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(L(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=A(t,u,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=A(t,E,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(L),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Yo("addlayer",t)),this.layerGroupPropertyListenerKeys_=[A(t,u,this.render,this),A(t,E,this.render,this),A(t,"addlayer",this.handleLayerAdd_,this),A(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"animationDelay_",value:function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var r=t[e].layer;r.hasRenderer()&&r.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"flushDeclutterItems",value:function(){var t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}},{key:"removeControl",value:function(t){return this.getControls().remove(t)}},{key:"removeInteraction",value:function(t){return this.getInteractions().remove(t)}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"handleLayerRemove_",value:function(t){Xs(t.layer)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var e=this,n=this.getSize(),r=this.getView(),i=this.frameState_,o=null;if(void 0!==n&&Fs(n)&&r&&r.isDef()){var a=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=r.getState();if(o={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:te(u.center,u.resolution,u.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:u,viewHints:a,wantedTiles:{},mapId:K(this),renderTargets:{}},u.nextCenter&&u.nextResolution){var s=isNaN(u.nextRotation)?u.rotation:u.nextRotation;o.nextExtent=te(u.nextCenter,u.nextResolution,s,n)}}this.frameState_=o,this.renderer_.renderFrame(o),o&&(o.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,o.postRenderFunctions),i&&(!this.previousExtent_||!se(this.previousExtent_)&&!Yt(o.extent,this.previousExtent_))&&(this.dispatchEvent(new Ho("movestart",this,i)),this.previousExtent_=Nt(this.previousExtent_)),this.previousExtent_&&!o.viewHints[0]&&!o.viewHints[1]&&!Yt(o.extent,this.previousExtent_)&&(this.dispatchEvent(new Ho("moveend",this,o)),At(o.extent,this.previousExtent_))),this.dispatchEvent(new Ho(ha,this,o)),this.renderComplete_=this.hasListener(ya)||this.hasListener(pa)||this.hasListener(ln)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout((function(){e.postRenderTimeoutHandle_=void 0,e.handlePostRender()}),0))}},{key:"setLayerGroup",value:function(t){var e=this.getLayerGroup();e&&this.handleLayerRemove_(new Yo("removelayer",e)),this.set(va,t)}},{key:"setSize",value:function(t){this.set(da,t)}},{key:"setTarget",value:function(t){this.set(ga,t)}},{key:"setView",value:function(t){if(!t||t instanceof Ai)this.set(ma,t);else{this.set(ma,new Ai);var e=this;t.then((function(t){e.setView(new Ai(t))}))}}},{key:"updateSize",value:function(){var t=this.getTargetElement(),e=void 0;if(t){var n=getComputedStyle(t),r=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),i=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);isNaN(r)||isNaN(i)||!Fs(e=[r,i])&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Yn("No map visible because the map container's width or height are 0.")}var o=this.getSize();!e||o&&v(e,o)||(this.setSize(e),this.updateViewportSize_(e))}},{key:"updateViewportSize_",value:function(t){var e=this.getView();e&&e.setViewportSize(t)}}])&&Bs(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);const Zs=Ks;function Vs(t){return Vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vs(t)}function Us(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Vs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Vs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Vs(i)?i:String(i)),r)}var i}function qs(t,e){return qs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qs(t,e)}function Hs(t){return Hs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hs(t)}var Js=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qs(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Hs(r);if(i){var n=Hs(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Vs(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).on,e.once,e.un,e.id_=void 0,e.geometryName_="geometry",e.style_=null,e.styleFunction_=void 0,e.geometryChangeKey_=null,e.addChangeListener(e.geometryName_,e.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var n=t;e.setGeometry(n)}else{var r=t;e.setProperties(r)}return e}return e=a,n=[{key:"clone",value:function(){var t=new a(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var n=this.getStyle();return n&&t.setStyle(n),t}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&(L(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=A(t,E,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(t){this.set(this.geometryName_,t)}},{key:"setStyle",value:function(t){var e,n;this.style_=t,this.styleFunction_=t?"function"==typeof(e=t)?e:(Array.isArray(e)?n=e:(kt("function"==typeof e.getZIndex,"Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),n=[e]),function(){return n}):void 0,this.changed()}},{key:"setId",value:function(t){this.id_=t,this.changed()}},{key:"setGeometryName",value:function(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}],n&&Us(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);const Qs=Js;function $s(t){return $s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(t)}function tl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===$s(i)?i:String(i)),r)}var i}function el(t,e){return el=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},el(t,e)}function nl(t){return nl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},nl(t)}const rl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&el(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=nl(r);if(i){var n=nl(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===$s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),n=n||{},(r=o.call(this)).tileCoord=t,r.state=e,r.interimTile=null,r.key="",r.transition_=void 0===n.transition?250:n.transition,r.transitionStarts_={},r.interpolate=!!n.interpolate,r}return e=a,(n=[{key:"changed",value:function(){this.dispatchEvent(E)}},{key:"release",value:function(){3===this.state&&this.setState(4)}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){var t=this.interimTile;if(!t)return this;do{if(2==t.getState())return this.transition_=0,t;t=t.interimTile}while(t);return this}},{key:"refreshInterimChain",value:function(){var t=this.interimTile;if(t){var e=this;do{if(2==t.getState()){t.interimTile=null;break}1==t.getState()?e=t:0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){X()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var r=e-n+1e3/60;return r>=this.transition_?1:wr(r/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])&&tl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(P);function il(t){return il="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},il(t)}function ol(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==il(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==il(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===il(i)?i:String(i)),r)}var i}function al(t,e){return al=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},al(t,e)}function ul(t){return ul=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ul(t)}const sl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&al(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ul(r);if(i){var n=ul(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===il(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r,i,u){var s;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(s=o.call(this,t,e,u)).crossOrigin_=r,s.src_=n,s.key=n,s.image_=new Image,null!==r&&(s.image_.crossOrigin=r),s.unlisten_=null,s.tileLoadFunction_=i,s}return e=a,(n=[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){var t;this.state=3,this.unlistenImage_(),this.image_=((t=ao(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}},{key:"handleImageLoad_",value:function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){var t,e,n,r,i,o,a,u;3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(t=this.image_,e=this.handleImageLoad_.bind(this),n=this.handleImageError_.bind(this),i=!0,o=!1,a=!1,u=[F(r=t,"load",(function(){a=!0,o||e()}))],r.src&&Ot?(o=!0,r.decode().then((function(){i&&e()})).catch((function(t){i&&(a?e():n())}))):u.push(F(r,"error",n)),function(){i=!1,u.forEach(L)}))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&ol(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(rl);function ll(t){return ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ll(t)}function cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==ll(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ll(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===ll(i)?i:String(i)),r)}var i}const fl=function(){function t(e,n,r,i,o,a){var u=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sourceProj_=e,this.targetProj_=n;var s={},l=er(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return s[e]||(s[e]=l(t)),s[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=o*o,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&ae(i)>=ae(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?ae(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?ae(this.targetProj_.getExtent()):null;var c=ie(r),f=oe(r),h=Jt(r),y=Ht(r),p=this.transformInv_(c),v=this.transformInv_(f),d=this.transformInv_(h),g=this.transformInv_(y),m=10+(a?Math.max(0,Math.ceil(Math.log2(qt(r)/(a*a*256*256)))):0);if(this.addQuad_(c,f,h,y,p,v,d,g,m),this.wrapsXInSource_){var b=1/0;this.triangles_.forEach((function(t,e,n){b=Math.min(b,t.source[0][0],t.source[1][0],t.source[2][0])})),this.triangles_.forEach((function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-b>u.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-b>u.sourceWorldWidth_/2&&(e[0][0]-=u.sourceWorldWidth_),e[1][0]-b>u.sourceWorldWidth_/2&&(e[1][0]-=u.sourceWorldWidth_),e[2][0]-b>u.sourceWorldWidth_/2&&(e[2][0]-=u.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<u.sourceWorldWidth_/2&&(t.source=e)}}))}s={}}var e,n;return e=t,(n=[{key:"addTriangle_",value:function(t,e,n,r,i,o){this.triangles_.push({source:[r,i,o],target:[t,e,n]})}},{key:"addQuad_",value:function(t,e,n,r,i,o,a,u,s){var l=It([i,o,a,u]),c=this.sourceWorldWidth_?ae(l)/this.sourceWorldWidth_:null,f=this.sourceWorldWidth_,h=this.sourceProj_.canWrapX()&&c>.5&&c<1,y=!1;if(s>0&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(y=ae(It([t,e,n,r]))/this.targetWorldWidth_>.25||y),!h&&this.sourceProj_.isGlobal()&&c&&(y=c>.25||y)),!(!y&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3]))||ue(l,this.maxSourceExtent_)){var p=0;if(!(y||isFinite(i[0])&&isFinite(i[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(u[0])&&isFinite(u[1])))if(s>0)y=!0;else if(1!=(p=(isFinite(i[0])&&isFinite(i[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(u[0])&&isFinite(u[1])?0:1))&&2!=p&&4!=p&&8!=p)return;if(s>0){if(!y){var v,d=[(t[0]+n[0])/2,(t[1]+n[1])/2],g=this.transformInv_(d);v=h?(xe(i[0],f)+xe(a[0],f))/2-xe(g[0],f):(i[0]+a[0])/2-g[0];var m=(i[1]+a[1])/2-g[1];y=v*v+m*m>this.errorThresholdSquared_}if(y){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var b=[(e[0]+n[0])/2,(e[1]+n[1])/2],_=this.transformInv_(b),w=[(r[0]+t[0])/2,(r[1]+t[1])/2],S=this.transformInv_(w);this.addQuad_(t,e,b,w,i,o,_,S,s-1),this.addQuad_(w,b,n,r,S,_,a,u,s-1)}else{var O=[(t[0]+e[0])/2,(t[1]+e[1])/2],x=this.transformInv_(O),k=[(n[0]+r[0])/2,(n[1]+r[1])/2],P=this.transformInv_(k);this.addQuad_(t,O,k,r,i,x,P,u,s-1),this.addQuad_(O,e,n,k,x,o,a,P,s-1)}return}}if(h){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&p)&&this.addTriangle_(t,n,r,i,a,u),0==(14&p)&&this.addTriangle_(t,n,e,i,a,o),p&&(0==(13&p)&&this.addTriangle_(e,r,t,o,u,i),0==(7&p)&&this.addTriangle_(e,r,n,o,u,a))}}},{key:"calculateSourceExtent",value:function(){var t=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach((function(e,n,r){var i=e.source;Kt(t,i[0]),Kt(t,i[1]),Kt(t,i[2])})),t}},{key:"getTriangles",value:function(){return this.triangles_}}])&&cl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var hl,yl=[];function pl(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function vl(t,e){return Math.abs(t[4*e]-210)>2||Math.abs(t[4*e+3]-191.25)>2}function dl(t,e,n,r){var i=nr(n,e,t),o=Hn(e,r,n),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var u=t.getMetersPerUnit();void 0!==u&&(o/=u);var s=t.getExtent();if(!s||Lt(s,i)){var l=Hn(t,o,i)/o;isFinite(l)&&l>0&&(o/=l)}return o}function gl(t){return gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gl(t)}function ml(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==gl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==gl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===gl(i)?i:String(i)),r)}var i}function bl(){return bl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sl(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},bl.apply(this,arguments)}function _l(t,e){return _l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_l(t,e)}function wl(t,e){if(e&&("object"===gl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Sl(t){return Sl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sl(t)}const Ol=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_l(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Sl(r);if(i){var n=Sl(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return wl(this,t)});function a(t,e,n,r,i,u,s,l,c,f,h,y){var p;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(p=o.call(this,i,0,y)).renderEdges_=void 0!==h&&h,p.pixelRatio_=s,p.gutter_=l,p.canvas_=null,p.sourceTileGrid_=e,p.targetTileGrid_=r,p.wrappedTileCoord_=u||i,p.sourceTiles_=[],p.sourcesListenerKeys_=null,p.sourceZ_=0;var v=r.getTileCoordExtent(p.wrappedTileCoord_),d=p.targetTileGrid_.getExtent(),g=p.sourceTileGrid_.getExtent(),m=d?re(v,d):v;if(0===qt(m))return p.state=4,wl(p);var b=t.getExtent();b&&(g=g?re(g,b):b);var _=r.getResolution(p.wrappedTileCoord_[0]),w=function(t,e,n,r){var i=Qt(n),o=dl(t,e,i,r);return(!isFinite(o)||o<=0)&&Ut(n,(function(n){return o=dl(t,e,n,r),isFinite(o)&&o>0})),o}(t,n,m,_);if(!isFinite(w)||w<=0)return p.state=4,wl(p);var S=void 0!==f?f:.5;if(p.triangulation_=new fl(t,n,m,g,w*S,_),0===p.triangulation_.getTriangles().length)return p.state=4,wl(p);p.sourceZ_=e.getZForResolution(w);var O=p.triangulation_.calculateSourceExtent();if(g&&(t.canWrapX()?(O[1]=_e(O[1],g[1],g[3]),O[3]=_e(O[3],g[1],g[3])):O=re(O,g)),qt(O)){for(var x=e.getTileRangeForExtentAndZ(O,p.sourceZ_),k=x.minX;k<=x.maxX;k++)for(var P=x.minY;P<=x.maxY;P++){var E=c(p.sourceZ_,k,P,s);E&&p.sourceTiles_.push(E)}0===p.sourceTiles_.length&&(p.state=4)}else p.state=4;return p}return e=a,(n=[{key:"getImage",value:function(){return this.canvas_}},{key:"reproject_",value:function(){var t=this,e=[];if(this.sourceTiles_.forEach((function(n){n&&2==n.getState()&&e.push({extent:t.sourceTileGrid_.getTileCoordExtent(n.tileCoord),image:n.getImage()})})),this.sourceTiles_.length=0,0===e.length)this.state=3;else{var n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i="number"==typeof r?r:r[0],o="number"==typeof r?r:r[1],a=this.targetTileGrid_.getResolution(n),u=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=function(t,e,n,r,i,o,a,u,s,l,c,f,h){var y=ao(Math.round(n*t),Math.round(n*e),yl);if(f||(y.imageSmoothingEnabled=!1),0===s.length)return y.canvas;function p(t){return Math.round(t*n)/n}y.scale(n,n),y.globalCompositeOperation="lighter";var v,d=[1/0,1/0,-1/0,-1/0];if(s.forEach((function(t,e,n){var r,i;r=d,(i=t.extent)[0]<r[0]&&(r[0]=i[0]),i[2]>r[2]&&(r[2]=i[2]),i[1]<r[1]&&(r[1]=i[1]),i[3]>r[3]&&(r[3]=i[3])})),!h||1!==s.length||0!==l){var g=ae(d),m=ne(d);v=ao(Math.round(n*g/r),Math.round(n*m/r),yl),f||(v.imageSmoothingEnabled=!1);var b=n/r;s.forEach((function(t,e,n){var r=t.extent[0]-d[0],i=-(t.extent[3]-d[3]),o=ae(t.extent),a=ne(t.extent);t.image.width>0&&t.image.height>0&&v.drawImage(t.image,l,l,t.image.width-2*l,t.image.height-2*l,r*b,i*b,o*b,a*b)}))}var _=ie(a);return u.getTriangles().forEach((function(t,e,i){var a=t.source,u=t.target,l=a[0][0],c=a[0][1],h=a[1][0],g=a[1][1],m=a[2][0],b=a[2][1],w=p((u[0][0]-_[0])/o),S=p(-(u[0][1]-_[1])/o),O=p((u[1][0]-_[0])/o),x=p(-(u[1][1]-_[1])/o),k=p((u[2][0]-_[0])/o),P=p(-(u[2][1]-_[1])/o),E=l,j=c;l=0,c=0;var R=function(t){for(var e=t.length,n=0;n<e;n++){for(var r=n,i=Math.abs(t[n][n]),o=n+1;o<e;o++){var a=Math.abs(t[o][n]);a>i&&(i=a,r=o)}if(0===i)return null;var u=t[r];t[r]=t[n],t[n]=u;for(var s=n+1;s<e;s++)for(var l=-t[s][n]/t[n][n],c=n;c<e+1;c++)n==c?t[s][c]=0:t[s][c]+=l*t[n][c]}for(var f=new Array(e),h=e-1;h>=0;h--){f[h]=t[h][e]/t[h][h];for(var y=h-1;y>=0;y--)t[y][e]-=t[y][h]*f[h]}return f}([[h-=E,g-=j,0,0,O-w],[m-=E,b-=j,0,0,k-w],[0,0,h,g,x-S],[0,0,m,b,P-S]]);if(R){if(y.save(),y.beginPath(),function(){if(void 0===hl){var t=ao(6,6,yl);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",pl(t,4,5,4,0),pl(t,4,5,0,5);var e=t.getImageData(0,0,3,3).data;hl=vl(e,0)||vl(e,4)||vl(e,8),uo(t),yl.push(t.canvas)}return hl}()||!f){y.moveTo(O,x);for(var T=w-O,C=S-x,I=0;I<4;I++)y.lineTo(O+p((I+1)*T/4),x+p(I*C/3)),3!=I&&y.lineTo(O+p((I+1)*T/4),x+p((I+1)*C/3));y.lineTo(k,P)}else y.moveTo(O,x),y.lineTo(w,S),y.lineTo(k,P);var M;if(y.clip(),y.transform(R[0],R[2],R[1],R[3],w,S),y.translate(d[0]-E,d[3]-j),v)M=v.canvas,y.scale(r/n,-r/n);else{var A=s[0],F=A.extent;M=A.image,y.scale(ae(F)/M.width,-ne(F)/M.height)}y.drawImage(M,0,0),y.restore()}})),v&&(uo(v),yl.push(v.canvas)),c&&(y.save(),y.globalCompositeOperation="source-over",y.strokeStyle="black",y.lineWidth=1,u.getTriangles().forEach((function(t,e,n){var r=t.target,i=(r[0][0]-_[0])/o,a=-(r[0][1]-_[1])/o,u=(r[1][0]-_[0])/o,s=-(r[1][1]-_[1])/o,l=(r[2][0]-_[0])/o,c=-(r[2][1]-_[1])/o;y.beginPath(),y.moveTo(u,s),y.lineTo(i,a),y.lineTo(l,c),y.closePath(),y.stroke()})),y.restore()),y.canvas}(i,o,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),a,s,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}},{key:"load",value:function(){var t=this;if(0==this.state){this.state=1,this.changed();var e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((function(n){var r=n.getState();if(0==r||1==r){e++;var i=A(n,E,(function(t){var r=n.getState();2!=r&&3!=r&&4!=r||(L(i),0==--e&&(this.unlistenSources_(),this.reproject_()))}),t);t.sourcesListenerKeys_.push(i)}})),0===e?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(t,e,n){0==t.getState()&&t.load()}))}}},{key:"unlistenSources_",value:function(){this.sourcesListenerKeys_.forEach(L),this.sourcesListenerKeys_=null}},{key:"release",value:function(){this.canvas_&&(uo(this.canvas_.getContext("2d")),yl.push(this.canvas_),this.canvas_=null),bl(Sl(a.prototype),"release",this).call(this)}}])&&ml(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(rl);function xl(t){return xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xl(t)}function kl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==xl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==xl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===xl(i)?i:String(i)),r)}var i}function Pl(t,e,n,r){return void 0!==r?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function El(t,e,n){return t+"/"+e+"/"+n}function jl(t){return El(t[0],t[1],t[2])}function Rl(t){return Rl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(t)}function Tl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Rl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Rl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Rl(i)?i:String(i)),r)}var i}function Cl(){return Cl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ml(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Cl.apply(this,arguments)}function Il(t,e){return Il=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Il(t,e)}function Ml(t){return Ml=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ml(t)}const Al=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Il(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ml(r);if(i){var n=Ml(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Rl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.apply(this,arguments)}return e=a,(n=[{key:"clear",value:function(){for(;this.getCount()>0;)this.pop().release();Cl(Ml(a.prototype),"clear",this).call(this)}},{key:"expireCache",value:function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}},{key:"pruneExceptNewestZ",value:function(){var t=this;if(0!==this.getCount()){var e=this.peekFirstKey().split("/").map(Number)[0];this.forEach((function(n){n.tileCoord[0]!==e&&(t.remove(jl(n.tileCoord)),n.release())}))}}}])&&Tl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}var e,n;return e=t,(n=[{key:"canExpireCache",value:function(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(t){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(t){return this.entries_.hasOwnProperty(t)}},{key:"forEach",value:function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer}},{key:"get",value:function(t,e){var n=this.entries_[t];return kt(void 0!==n,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}},{key:"remove",value:function(t){var e=this.entries_[t];return kt(void 0!==e,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e}},{key:"getValues",value:function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"peek",value:function(t){var e;return null===(e=this.entries_[t])||void 0===e?void 0:e.value_}},{key:"pop",value:function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}},{key:"replace",value:function(t,e){this.get(t),this.entries_[t].value_=e}},{key:"set",value:function(t,e){kt(!(t in this.entries_),"Tried to set a value for a key that is used already");var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}},{key:"setSize",value:function(t){this.highWaterMark=t}}])&&kl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Fl(t){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(t)}function Ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Fl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Fl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Fl(i)?i:String(i)),r)}var i}function Dl(t,e){return Dl=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Dl(t,e)}function Bl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Gl(t){return Gl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gl(t)}function zl(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}const Nl=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dl(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Gl(r);if(i){var n=Gl(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Fl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Bl(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).projection=qn(t.projection),e.attributions_=zl(t.attributions),e.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,e.loading=!1,e.state_=void 0!==t.state?t.state:"ready",e.wrapX_=void 0!==t.wrapX&&t.wrapX,e.interpolate_=!!t.interpolate,e.viewResolver=null,e.viewRejector=null;var n=Bl(e);return e.viewPromise_=new Promise((function(t,e){n.viewResolver=t,n.viewRejector=e})),e}return e=a,(n=[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(t){return null}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=zl(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])&&Ll(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function Wl(t){return Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(t)}function Xl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Wl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Wl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Wl(i)?i:String(i)),r)}var i}var Yl=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}var e,n;return e=t,(n=[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])&&Xl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Kl(t,e,n,r,i){return void 0!==i?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new Yl(t,e,n,r)}const Zl=Yl;function Vl(t){return Vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(t)}function Ul(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Vl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Vl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Vl(i)?i:String(i)),r)}var i}var ql=[0,0,0];const Hl=function(){function t(e){var n,r,i,o=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,kt((n=this.resolutions_,!0,r=function(t,e){return e-t}||f,n.every((function(t,e){if(0===e)return!0;var i=r(n[e-1],t);return!(i>0||0===i)}))),"`resolutions` must be sorted in descending order"),!e.origins)for(var a=0,u=this.resolutions_.length-1;a<u;++a)if(i){if(this.resolutions_[a]/this.resolutions_[a+1]!==i){i=void 0;break}}else i=this.resolutions_[a]/this.resolutions_[a+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,kt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));var s=e.extent;void 0===s||this.origin_||this.origins_||(this.origin_=ie(s)),kt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,kt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:hn,kt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=void 0!==s?s:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map((function(t,e){var n=new Zl(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(s){var r=o.getTileRangeForExtentAndZ(s,e);n.minX=Math.max(r.minX,n.minX),n.maxX=Math.min(r.maxX,n.maxX),n.minY=Math.max(r.minY,n.minY),n.maxY=Math.min(r.maxY,n.maxY)}return n})):s&&this.calculateTileRanges_(s)}var e,n;return e=t,(n=[{key:"forEachTileCoord",value:function(t,e,n){for(var r=this.getTileRangeForExtentAndZ(t,e),i=r.minX,o=r.maxX;i<=o;++i)for(var a=r.minY,u=r.maxY;a<=u;++a)n([e,i,a])}},{key:"forEachTileCoordParentTileRange",value:function(t,e,n,r){var i,o,a=null,u=t[0]-1;for(2===this.zoomFactor_?(i=t[1],o=t[2]):a=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(e(u,void 0!==i&&void 0!==o?Kl(i=Math.floor(i/2),i,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(a,u,n)))return!0;--u}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(t){return this.origin_?this.origin_:this.origins_[t]}},{key:"getResolution",value:function(t){return this.resolutions_[t]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var r=2*t[1],i=2*t[2];return Kl(r,r+1,i,i+1,e)}var o=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null}},{key:"getTileRangeForTileCoordAndZ",value:function(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;var r=t[0],i=t[1],o=t[2];if(e===r)return Kl(i,o,i,o,n);if(this.zoomFactor_){var a=Math.pow(this.zoomFactor_,e-r),u=Math.floor(i*a),s=Math.floor(o*a);return e<r?Kl(u,u,s,s,n):Kl(u,Math.floor(a*(i+1))-1,s,Math.floor(a*(o+1))-1,n)}var l=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(l,e,n)}},{key:"getTileRangeForExtentAndZ",value:function(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,ql);var r=ql[1],i=ql[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,ql),Kl(r,ql[1],i,ql[2],n)}},{key:"getTileCoordCenter",value:function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Ls(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*r[0]*n,e[1]-(t[2]+.5)*r[1]*n]}},{key:"getTileCoordExtent",value:function(t,e){var n=this.getOrigin(t[0]),r=this.getResolution(t[0]),i=Ls(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*i[0]*r,a=n[1]-(t[2]+1)*i[1]*r;return zt(o,a,o+i[0]*r,a+i[1]*r,e)}},{key:"getTileCoordForCoordAndResolution",value:function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}},{key:"getTileCoordForXYAndResolution_",value:function(t,e,n,r,i){var o=this.getZForResolution(n),a=n/this.getResolution(o),u=this.getOrigin(o),s=Ls(this.getTileSize(o),this.tmpSize_),l=a*(t-u[0])/n/s[0],c=a*(u[1]-e)/n/s[1];return r?(l=je(l,5)-1,c=je(c,5)-1):(l=Ee(l,5),c=Ee(c,5)),Pl(o,l,c,i)}},{key:"getTileCoordForXYAndZ_",value:function(t,e,n,r,i){var o=this.getOrigin(n),a=this.getResolution(n),u=Ls(this.getTileSize(n),this.tmpSize_),s=(t-o[0])/a/u[0],l=(o[1]-e)/a/u[1];return r?(s=je(s,5)-1,l=je(l,5)-1):(s=Ee(s,5),l=Ee(l,5)),Pl(n,s,l,i)}},{key:"getTileCoordForCoordAndZ",value:function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}},{key:"getTileCoordResolution",value:function(t){return this.resolutions_[t[0]]}},{key:"getTileSize",value:function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}},{key:"getFullTileRange",value:function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}},{key:"getZForResolution",value:function(t,e){return _e(h(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}},{key:"tileCoordIntersectsViewport",value:function(t,e){return vi(e,0,e.length,2,this.getTileCoordExtent(t))}},{key:"calculateTileRanges_",value:function(t){for(var e=this.resolutions_.length,n=new Array(e),r=this.minZoom;r<e;++r)n[r]=this.getTileRangeForExtentAndZ(t,r);this.fullTileRanges_=n}}])&&Ul(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jl(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,n,r){return function(t,e,n,r){r=void 0!==r?r:"top-left";var i=Ql(t,undefined,n);return new Hl({extent:t,origin:$t(t,r),resolutions:i,tileSize:n})}($l(t),0,void 0,void 0)}(t),t.setDefaultTileGrid(e)),e}function Ql(t,e,n,r){e=void 0!==e?e:fn,n=Ls(void 0!==n?n:hn);var i=ne(t),o=ae(t);r=r>0?r:Math.max(o/n[0],i/n[1]);for(var a=e+1,u=new Array(a),s=0;s<a;++s)u[s]=r/Math.pow(2,s);return u}function $l(t){var e=(t=qn(t)).getExtent();if(!e){var n=180*yn.degrees/t.getMetersPerUnit();e=zt(-n,-n,n,n)}return e}function tc(t){return tc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tc(t)}function ec(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==tc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==tc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===tc(i)?i:String(i)),r)}var i}function rc(t,e,n){return e&&nc(t.prototype,e),n&&nc(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ic(){return ic="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},ic.apply(this,arguments)}function oc(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ac(t,e)}function ac(t,e){return ac=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ac(t,e)}function uc(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=sc(t);if(e){var i=sc(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===tc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function sc(t){return sc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sc(t)}var lc=function(t){oc(n,t);var e=uc(n);function n(t){var r;return ec(this,n),(r=e.call(this,{attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate})).on,r.once,r.un,r.opaque_=void 0!==t.opaque&&t.opaque,r.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,r.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,r.tileGrid&&Ls(r.tileGrid.getTileSize(r.tileGrid.getMinZoom()),[256,256]),r.tileCache=new Al(t.cacheSize||0),r.tmpSize=[0,0],r.key_=t.key||"",r.tileOptions={transition:t.transition,interpolate:t.interpolate},r.zDirection=t.zDirection?t.zDirection:0,r}return rc(n,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}},{key:"forEachLoadedTile",value:function(t,e,n,r){var i=this.getTileCacheForProjection(t);if(!i)return!1;for(var o,a,u,s=!0,l=n.minX;l<=n.maxX;++l)for(var c=n.minY;c<=n.maxY;++c)a=El(e,l,c),u=!1,i.containsKey(a)&&(u=2===(o=i.get(a)).getState())&&(u=!1!==r(o)),u||(s=!1);return s}},{key:"getGutterForProjection",value:function(t){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(t){this.key_!==t&&(this.key_=t,this.changed())}},{key:"getOpaque",value:function(t){return this.opaque_}},{key:"getResolutions",value:function(t){var e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}},{key:"getTile",value:function(t,e,n,r,i){return X()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(t){return this.tileGrid?this.tileGrid:Jl(t)}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();return kt(null===e||$n(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}},{key:"getTilePixelRatio",value:function(t){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(t,e,n){var r,i,o,a=this.getTileGridForProjection(n),u=this.getTilePixelRatio(e),s=Ls(a.getTileSize(t),this.tmpSize);return 1==u?s:(r=s,i=u,void 0===(o=this.tmpSize)&&(o=[0,0]),o[0]=r[0]*i+.5|0,o[1]=r[1]*i+.5|0,o)}},{key:"getTileCoordForTileUrlFunction",value:function(t,e){e=void 0!==e?e:this.getProjection();var n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=function(t,e,n){var r=e[0],i=t.getTileCoordCenter(e),o=$l(n);if(!Lt(o,i)){var a=ae(o),u=Math.ceil((o[0]-i[0])/a);return i[0]+=a*u,t.getTileCoordForCoordAndZ(i,r)}return e}(n,t,e)),function(t,e){var n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o=e.getFullTileRange(n);return!o||o.containsXY(r,i)}(t,n)?t:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),ic(sc(n.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(t,e){var n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}},{key:"useTile",value:function(t,e,n,r){}}]),n}(Nl),cc=function(t){oc(n,t);var e=uc(n);function n(t,r){var i;return ec(this,n),(i=e.call(this,t)).tile=r,i}return rc(n)}(a);function fc(t,e){var n=/\{z\}/g,r=/\{x\}/g,i=/\{y\}/g,o=/\{-y\}/g;return function(a,u,s){if(a)return t.replace(n,a[0].toString()).replace(r,a[1].toString()).replace(i,a[2].toString()).replace(o,(function(){var t=a[0],n=e.getFullTileRange(t);if(!n)throw new Error("The {-y} placeholder requires a tile grid with extent");return(n.getHeight()-a[2]-1).toString()}))}}function hc(t){return hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hc(t)}function yc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==hc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==hc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===hc(i)?i:String(i)),r)}var i}function pc(t,e){return pc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pc(t,e)}function vc(t){return vc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},vc(t)}function dc(t){return dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dc(t)}function gc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==dc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==dc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===dc(i)?i:String(i)),r)}var i}function mc(){return mc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_c(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},mc.apply(this,arguments)}function bc(t,e){return bc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bc(t,e)}function _c(t){return _c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_c(t)}var wc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bc(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_c(r);if(i){var n=_c(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===dc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Sc,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,e.tileClass=void 0!==t.tileClass?t.tileClass:sl,e.tileCacheForProjection={},e.tileGridForProjection={},e.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,e.renderReprojectionEdges_=!1,e}return e=a,n=[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(t,e){var n=this.getTileCacheForProjection(t);for(var r in this.tileCache.expireCache(this.tileCache==n?e:{}),this.tileCacheForProjection){var i=this.tileCacheForProjection[r];i.expireCache(i==n?e:{})}}},{key:"getGutterForProjection",value:function(t){return this.getProjection()&&t&&!$n(this.getProjection(),t)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var t=mc(_c(a.prototype),"getKey",this).call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t}},{key:"getOpaque",value:function(t){return!(this.getProjection()&&t&&!$n(this.getProjection(),t))&&mc(_c(a.prototype),"getOpaque",this).call(this,t)}},{key:"getTileGridForProjection",value:function(t){var e=this.getProjection();if(this.tileGrid&&(!e||$n(e,t)))return this.tileGrid;var n=K(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Jl(t)),this.tileGridForProjection[n]}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();if(!e||$n(e,t))return this.tileCache;var n=K(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Al(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}},{key:"createTile_",value:function(t,e,n,r,i,o){var a=[t,e,n],u=this.getTileCoordForTileUrlFunction(a,i),s=u?this.tileUrlFunction(u,r,i):void 0,l=new this.tileClass(a,void 0!==s?0:4,void 0!==s?s:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return l.key=o,l.addEventListener(E,this.handleTileChange.bind(this)),l}},{key:"getTile",value:function(t,e,n,r,i){var o=this,a=this.getProjection();if(!a||!i||$n(a,i))return this.getTileInternal(t,e,n,r,a||i);var u,s=this.getTileCacheForProjection(i),l=[t,e,n],c=jl(l);s.containsKey(c)&&(u=s.get(c));var f=this.getKey();if(u&&u.key==f)return u;var h=this.getTileGridForProjection(a),y=this.getTileGridForProjection(i),p=this.getTileCoordForTileUrlFunction(l,i),v=new Ol(a,h,i,y,l,p,this.getTilePixelRatio(r),this.getGutter(),(function(t,e,n,r){return o.getTileInternal(t,e,n,r,a)}),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=f,u?(v.interimTile=u,v.refreshInterimChain(),s.replace(c,v)):s.set(c,v),v}},{key:"getTileInternal",value:function(t,e,n,r,i){var o=null,a=El(t,e,n),u=this.getKey();if(this.tileCache.containsKey(a)){if((o=this.tileCache.get(a)).key!=u){var s=o;o=this.createTile_(t,e,n,r,i,u),0==s.getState()?o.interimTile=s.interimTile:o.interimTile=s,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,n,r,i,u),this.tileCache.set(a,o);return o}},{key:"setRenderReprojectionEdges",value:function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}},{key:"setTileGridForProjection",value:function(t,e){var n=qn(t);if(n){var r=K(n);r in this.tileGridForProjection||(this.tileGridForProjection[r]=e)}}},{key:"clear",value:function(){for(var t in mc(_c(a.prototype),"clear",this).call(this),this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}],n&&gc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pc(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=vc(r);if(i){var n=vc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===hc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).generateTileUrlFunction_=e.tileUrlFunction===a.prototype.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(e.tileUrlFunction=t.tileUrlFunction),e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.tileLoadingKeys_={},e}return e=a,(n=[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(t){var e,n=t.target,r=K(n),i=n.getState();1==i?(this.tileLoadingKeys_[r]=!0,e="tileloadstart"):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],e=3==i?"tileloaderror":2==i?"tileloadend":void 0),null!=e&&this.dispatchEvent(new cc(e,n))}},{key:"setTileLoadFunction",value:function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}},{key:"setTileUrlFunction",value:function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}},{key:"setUrl",value:function(t){var e=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var r,i=n[1].charCodeAt(0),o=n[2].charCodeAt(0);for(r=i;r<=o;++r)e.push(t.replace(n[0],String.fromCharCode(r)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),u=parseInt(n[1],10);u<=a;u++)e.push(t.replace(n[0],u.toString()));return e}return e.push(t),e}(t);this.urls=e,this.setUrls(e)}},{key:"setUrls",value:function(t){this.urls=t;var e=t.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=fc(t[i],e);return function(t){return 1===t.length?t[0]:function(e,n,r){if(e){var i=function(t){return(t[1]<<t[0])+t[2]}(e),o=xe(i,t.length);return t[o](e,n,r)}}}(r)}(t,this.tileGrid),e):this.setKey(e)}},{key:"tileUrlFunction",value:function(t,e,n){}},{key:"useTile",value:function(t,e,n){var r=El(t,e,n);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}])&&yc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(lc));function Sc(t,e){t.getImage().src=e}function Oc(t){return Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oc(t)}function xc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Oc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Oc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Oc(i)?i:String(i)),r)}var i}function kc(t,e){return kc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kc(t,e)}function Pc(t){return Pc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pc(t)}function Ec(t){return Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ec(t)}function jc(t,e){return jc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jc(t,e)}function Rc(t){return Rc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Rc(t)}const Tc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jc(t,e)}(o,t);var e,n,r,i=(n=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Rc(n);if(r){var i=Rc(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ec(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'];var n=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",r=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";return i.call(this,{attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:r,wrapX:t.wrapX,zDirection:t.zDirection})}return e=o,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kc(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pc(r);if(i){var n=Pc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Oc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",r=void 0!==t.tileGrid?t.tileGrid:function(t){var e=t||{},n=e.extent||qn("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:Ql(n,e.maxZoom,e.tileSize,e.maxResolution)};return new Hl(r)}({extent:$l(n),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});return(e=o.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:n,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).gutter_=void 0!==t.gutter?t.gutter:0,e}return e=a,(n=[{key:"getGutter",value:function(){return this.gutter_}}])&&xc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(wc)),Cc="preload",Ic="useInterimTilesOnError";function Mc(t){return Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(t)}function Ac(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Mc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Mc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Mc(i)?i:String(i)),r)}var i}function Fc(){return Fc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Fc.apply(this,arguments)}function Lc(t,e){return Lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Lc(t,e)}function Dc(t){return Dc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dc(t)}const Bc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lc(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Dc(r);if(i){var n=Dc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Mc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{};var n=Object.assign({},t);return delete n.preload,delete n.useInterimTilesOnError,(e=o.call(this,n)).on,e.once,e.un,e.setPreload(void 0!==t.preload?t.preload:0),e.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),e}return e=a,(n=[{key:"getPreload",value:function(){return this.get(Cc)}},{key:"setPreload",value:function(t){this.set(Cc,t)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(Ic)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(Ic,t)}},{key:"getData",value:function(t){return Fc(Dc(a.prototype),"getData",this).call(this,t)}}])&&Ac(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ni);function Gc(t){return Gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gc(t)}function zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Gc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Gc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Gc(i)?i:String(i)),r)}var i}function Nc(){return Nc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Nc.apply(this,arguments)}function Wc(t,e){return Wc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wc(t,e)}function Xc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yc(t){return Yc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yc(t)}function Kc(t){return Kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kc(t)}function Zc(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Kc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Kc(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Kc(i)?i:String(i)),r)}var i}function Vc(){return Vc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qc(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Vc.apply(this,arguments)}function Uc(t,e){return Uc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Uc(t,e)}function qc(t){return qc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},qc(t)}var Hc=[],Jc=null,Qc=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Uc(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=qc(r);if(i){var n=qc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Kc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t)).container=null,e.renderedResolution,e.tempTransform=[1,0,0,1,0,0],e.pixelTransform=[1,0,0,1,0,0],e.inversePixelTransform=[1,0,0,1,0,0],e.context=null,e.containerReused=!1,e.pixelContext_=null,e.frameState=null,e}return e=a,n=[{key:"getImageData",value:function(t,e,n){var r;Jc||(Jc=ao(1,1,void 0,{willReadFrequently:!0})),Jc.clearRect(0,0,1,1);try{Jc.drawImage(t,e,n,1,1,0,0,1,1),r=Jc.getImageData(0,0,1,1).data}catch(t){return Jc=null,null}return r}},{key:"getBackground",value:function(t){var e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0}},{key:"useContainer",value:function(t,e,n){var r,i,o=this.getLayer().getClassName();if(t&&t.className===o&&(!n||t&&t.style.backgroundColor&&v(De(t.style.backgroundColor),De(n)))){var a=t.firstElementChild;a instanceof HTMLCanvasElement&&(i=a.getContext("2d"))}if(i&&i.canvas.style.transform===e?(this.container=t,this.context=i,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){(r=document.createElement("div")).className=o;var u=r.style;u.position="absolute",u.width="100%",u.height="100%";var s=(i=ao()).canvas;r.appendChild(s),(u=s.style).position="absolute",u.left="0",u.transformOrigin="top left",this.container=r,this.context=i}this.containerReused||!n||this.container.style.backgroundColor||(this.container.style.backgroundColor=n)}},{key:"clipUnrotated",value:function(t,e,n){var r=ie(n),i=oe(n),o=Jt(n),a=Ht(n);Pt(e.coordinateToPixelTransform,r),Pt(e.coordinateToPixelTransform,i),Pt(e.coordinateToPixelTransform,o),Pt(e.coordinateToPixelTransform,a);var u=this.inversePixelTransform;Pt(u,r),Pt(u,i),Pt(u,o),Pt(u,a),t.save(),t.beginPath(),t.moveTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}},{key:"dispatchRenderEvent_",value:function(t,e,n){var r=this.getLayer();if(r.hasListener(t)){var i=new Qi(t,this.inversePixelTransform,n,e);r.dispatchEvent(i)}}},{key:"preRender",value:function(t,e){this.frameState=e,this.dispatchRenderEvent_(an,t,e)}},{key:"postRender",value:function(t,e){this.dispatchRenderEvent_(un,t,e)}},{key:"getRenderTransform",value:function(t,e,n,r,i,o,a){var u=i/2,s=o/2,l=r/e,c=-l,f=-t[0]+a,h=-t[1];return Et(this.tempTransform,u,s,l,c,-n,f,h)}},{key:"disposeInternal",value:function(){delete this.frameState,Vc(qc(a.prototype),"disposeInternal",this).call(this)}}],n&&Zc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wc(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yc(r);if(i){var n=Yc(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Gc(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Xc(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this)).ready=!0,e.boundHandleImageChange_=e.handleImageChange_.bind(Xc(e)),e.layer_=t,e.declutterExecutorGroup=null,e}return e=a,(n=[{key:"getFeatures",value:function(t){return X()}},{key:"getData",value:function(t){return null}},{key:"prepareFrame",value:function(t){return X()}},{key:"renderFrame",value:function(t,e){return X()}},{key:"loadedTileCallback",value:function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}},{key:"createLoadedTileFinder",value:function(t,e,n){var r=this;return function(i,o){var a=r.loadedTileCallback.bind(r,n,i);return t.forEachLoadedTile(e,i,o,a)}}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i){}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){var e=t.target;2!==e.getState()&&3!==e.getState()||this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var e=t.getState();return 2!=e&&3!=e&&t.addEventListener(E,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}},{key:"disposeInternal",value:function(){delete this.layer_,Nc(Yc(a.prototype),"disposeInternal",this).call(this)}}])&&zc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(W));const $c=Qc;function tf(t){return tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tf(t)}function ef(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==tf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==tf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===tf(i)?i:String(i)),r)}var i}function nf(){return nf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=of(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},nf.apply(this,arguments)}function rf(t,e){return rf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},rf(t,e)}function of(t){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},of(t)}var af=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&rf(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=of(r);if(i){var n=of(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===tf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t)).extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=[1/0,1/0,-1/0,-1/0],e.tmpTileRange_=new Zl(0,0,0,0),e}return e=a,n=[{key:"isDrawableTile",value:function(t){var e=this.getLayer(),n=t.getState(),r=e.getUseInterimTilesOnError();return 2==n||4==n||3==n&&!r}},{key:"getTile",value:function(t,e,n,r){var i=r.pixelRatio,o=r.viewState.projection,a=this.getLayer(),u=a.getSource().getTile(t,e,n,i,o);return 3==u.getState()&&a.getUseInterimTilesOnError()&&a.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(u)||(u=u.getInterimTile()),u}},{key:"getData",value:function(t){var e=this.frameState;if(!e)return null;var n=this.getLayer(),r=Pt(e.pixelToCoordinateTransform,t.slice()),i=n.getExtent();if(i&&!Lt(i,r))return null;for(var o=e.pixelRatio,a=e.viewState.projection,u=e.viewState,s=n.getRenderSource(),l=s.getTileGridForProjection(u.projection),c=s.getTilePixelRatio(e.pixelRatio),f=l.getZForResolution(u.resolution);f>=l.getMinZoom();--f){var h=l.getTileCoordForCoordAndZ(r,f),y=s.getTile(f,h[1],h[2],o,a);if(!(y instanceof sl||y instanceof Ol)||y instanceof Ol&&4===y.getState())return null;if(2===y.getState()){var p=l.getOrigin(f),v=Ls(l.getTileSize(f)),d=l.getResolution(f),g=Math.floor(c*((r[0]-p[0])/d-h[1]*v[0])),m=Math.floor(c*((p[1]-r[1])/d-h[2]*v[1])),b=Math.round(c*s.getGutterForProjection(u.projection));return this.getImageData(y.getImage(),g+b,m+b)}}return null}},{key:"loadedTileCallback",value:function(t,e,n){return!!this.isDrawableTile(n)&&nf(of(a.prototype),"loadedTileCallback",this).call(this,t,e,n)}},{key:"prepareFrame",value:function(t){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(t,e){var n=t.layerStatesArray[t.layerIndex],r=t.viewState,i=r.projection,o=r.resolution,a=r.center,u=r.rotation,s=t.pixelRatio,l=this.getLayer(),c=l.getSource(),h=c.getRevision(),y=c.getTileGridForProjection(i),p=y.getZForResolution(o,c.zDirection),v=y.getResolution(p),d=t.extent,g=t.viewState.resolution,m=c.getTilePixelRatio(s),b=Math.round(ae(d)/g*s),_=Math.round(ne(d)/g*s),w=n.extent&&hr(n.extent,i);w&&(d=re(d,hr(n.extent,i)));var S=v*b/2/m,O=v*_/2/m,x=[a[0]-S,a[1]-O,a[0]+S,a[1]+O],k=y.getTileRangeForExtentAndZ(d,p),P={};P[p]={};var E=this.createLoadedTileFinder(c,i,P),j=this.tmpExtent,R=this.tmpTileRange_;this.newTiles_=!1;for(var T=u?ee(r.center,g,u,t.size):void 0,C=k.minX;C<=k.maxX;++C)for(var I=k.minY;I<=k.maxY;++I)if(!u||y.tileCoordIntersectsViewport([p,C,I],T)){var M=this.getTile(p,C,I,t);if(this.isDrawableTile(M)){var A=K(this);if(2==M.getState()){P[p][M.tileCoord.toString()]=M;var F=M.inTransition(A);F&&1!==n.opacity&&(M.endTransition(A),F=!1),this.newTiles_||!F&&this.renderedTiles.includes(M)||(this.newTiles_=!0)}if(1===M.getAlpha(A,t.time))continue}var L=y.getTileCoordChildTileRange(M.tileCoord,R,j),D=!1;L&&(D=E(p+1,L)),D||y.forEachTileCoordParentTileRange(M.tileCoord,E,R,j)}var B=v/o*s/m;Et(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,u,-b/2,-_/2);var G=Rt(this.pixelTransform);this.useContainer(e,G,this.getBackground(t));var z=this.context,N=z.canvas;jt(this.inversePixelTransform,this.pixelTransform),Et(this.tempTransform,b/2,_/2,B,B,0,-b/2,-_/2),N.width!=b||N.height!=_?(N.width=b,N.height=_):this.containerReused||z.clearRect(0,0,b,_),w&&this.clipUnrotated(z,t,w),c.getInterpolate()||(z.imageSmoothingEnabled=!1),this.preRender(z,t),this.renderedTiles.length=0;var W,X,Y,Z=Object.keys(P).map(Number);Z.sort(f),1!==n.opacity||this.containerReused&&!c.getOpaque(t.viewState.projection)?(W=[],X=[]):Z=Z.reverse();for(var V=Z.length-1;V>=0;--V){var U=Z[V],q=c.getTilePixelSize(U,s,i),H=y.getResolution(U)/v,J=q[0]*H*B,Q=q[1]*H*B,$=y.getTileCoordForCoordAndZ(ie(x),U),tt=y.getTileCoordExtent($),et=Pt(this.tempTransform,[m*(tt[0]-x[0])/v,m*(x[3]-tt[3])/v]),nt=m*c.getGutterForProjection(i),rt=P[U];for(var it in rt){var ot=rt[it],at=ot.tileCoord,ut=$[1]-at[1],st=Math.round(et[0]-(ut-1)*J),lt=$[2]-at[2],ct=Math.round(et[1]-(lt-1)*Q),ft=Math.round(et[0]-ut*J),ht=Math.round(et[1]-lt*Q),yt=st-ft,pt=ct-ht,vt=p===U,dt=vt&&1!==ot.getAlpha(K(this),t.time),gt=!1;if(!dt)if(W){Y=[ft,ht,ft+yt,ht,ft+yt,ht+pt,ft,ht+pt];for(var mt=0,bt=W.length;mt<bt;++mt)if(p!==U&&U<X[mt]){var _t=W[mt];ue([ft,ht,ft+yt,ht+pt],[_t[0],_t[3],_t[4],_t[7]])&&(gt||(z.save(),gt=!0),z.beginPath(),z.moveTo(Y[0],Y[1]),z.lineTo(Y[2],Y[3]),z.lineTo(Y[4],Y[5]),z.lineTo(Y[6],Y[7]),z.moveTo(_t[6],_t[7]),z.lineTo(_t[4],_t[5]),z.lineTo(_t[2],_t[3]),z.lineTo(_t[0],_t[1]),z.clip())}W.push(Y),X.push(U)}else z.clearRect(ft,ht,yt,pt);this.drawTileImage(ot,t,ft,ht,yt,pt,nt,vt),W&&!dt?(gt&&z.restore(),this.renderedTiles.unshift(ot)):this.renderedTiles.push(ot),this.updateUsedTiles(t.usedTiles,c,ot)}}return this.renderedRevision=h,this.renderedResolution=v,this.extentChanged=!this.renderedExtent_||!Yt(this.renderedExtent_,x),this.renderedExtent_=x,this.renderedPixelRatio=s,this.renderedProjection=i,this.manageTilePyramid(t,c,y,s,i,d,p,l.getPreload()),this.scheduleExpireCache(t,c),this.postRender(z,t),n.extent&&z.restore(),z.imageSmoothingEnabled=!0,G!==N.style.transform&&(N.style.transform=G),this.container}},{key:"drawTileImage",value:function(t,e,n,r,i,o,a,u){var s=this.getTileImage(t);if(s){var l=K(this),c=e.layerStatesArray[e.layerIndex],f=c.opacity*(u?t.getAlpha(l,e.time):1),h=f!==this.context.globalAlpha;h&&(this.context.save(),this.context.globalAlpha=f),this.context.drawImage(s,a,a,s.width-2*a,s.height-2*a,n,r,i,o),h&&this.context.restore(),f!==c.opacity?e.animate=!0:u&&t.endTransition(l)}}},{key:"getImage",value:function(){var t=this.context;return t?t.canvas:null}},{key:"getTileImage",value:function(t){return t.getImage()}},{key:"scheduleExpireCache",value:function(t,e){if(e.canExpireCache()){var n=function(t,e,n){var r=K(t);r in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[r])}.bind(null,e);t.postRenderFunctions.push(n)}}},{key:"updateUsedTiles",value:function(t,e,n){var r=K(e);r in t||(t[r]={}),t[r][n.getKey()]=!0}},{key:"manageTilePyramid",value:function(t,e,n,r,i,o,a,u,s){var l=K(e);l in t.wantedTiles||(t.wantedTiles[l]={});var c,f,h,y,p,v,d=t.wantedTiles[l],g=t.tileQueue,m=n.getMinZoom(),b=t.viewState.rotation,_=b?ee(t.viewState.center,t.viewState.resolution,b,t.size):void 0,w=0;for(v=m;v<=a;++v)for(f=n.getTileRangeForExtentAndZ(o,v,f),h=n.getResolution(v),y=f.minX;y<=f.maxX;++y)for(p=f.minY;p<=f.maxY;++p)b&&!n.tileCoordIntersectsViewport([v,y,p],_)||(a-v<=u?(++w,0==(c=e.getTile(v,y,p,r,i)).getState()&&(d[c.getKey()]=!0,g.isKeyQueued(c.getKey())||g.enqueue([c,l,n.getTileCoordCenter(c.tileCoord),h])),void 0!==s&&s(c)):e.useTile(v,y,p,i));e.updateCacheSize(w,i)}}],n&&ef(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}($c);const uf=af;function sf(t){return sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sf(t)}function lf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==sf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==sf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===sf(i)?i:String(i)),r)}var i}function cf(t,e){return cf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cf(t,e)}function ff(t){return ff=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ff(t)}const hf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cf(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ff(r);if(i){var n=ff(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===sf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,t)}return e=a,(n=[{key:"createRenderer",value:function(){return new uf(this)}}])&&lf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Bc);var yf=n(257);function pf(t){return pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pf(t)}function vf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==pf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==pf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===pf(i)?i:String(i)),r)}var i}const df=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=Ls(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}var e,n;return e=t,(n=[{key:"clone",value:function(){var e=this.getScale();return new t({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getDeclutterMode",value:function(){return this.declutterMode_}},{key:"getAnchor",value:function(){return X()}},{key:"getImage",value:function(t){return X()}},{key:"getHitDetectionImage",value:function(){return X()}},{key:"getPixelRatio",value:function(t){return 1}},{key:"getImageState",value:function(){return X()}},{key:"getImageSize",value:function(){return X()}},{key:"getOrigin",value:function(){return X()}},{key:"getSize",value:function(){return X()}},{key:"setDisplacement",value:function(t){this.displacement_=t}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=Ls(t)}},{key:"listenImageChange",value:function(t){X()}},{key:"load",value:function(){X()}},{key:"unlistenImageChange",value:function(t){X()}}])&&vf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function gf(t){return Array.isArray(t)?Ge(t):t}function mf(t){return mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(t)}function bf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==mf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==mf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===mf(i)?i:String(i)),r)}var i}function _f(t,e){return _f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_f(t,e)}function wf(t){return wf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wf(t)}const Sf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_f(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=wf(r);if(i){var n=wf(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===mf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=void 0!==t.rotateWithView&&t.rotateWithView;return(e=o.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==t.rotation?t.rotation:0,scale:void 0!==t.scale?t.scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})).canvases_,e.hitDetectionCanvas_=null,e.fill_=void 0!==t.fill?t.fill:null,e.origin_=[0,0],e.points_=t.points,e.radius_=void 0!==t.radius?t.radius:t.radius1,e.radius2_=t.radius2,e.angle_=void 0!==t.angle?t.angle:0,e.stroke_=void 0!==t.stroke?t.stroke:null,e.size_,e.renderOptions_,e.render(),e}return e=a,(n=[{key:"clone",value:function(){var t=this.getScale(),e=new a({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},{key:"getAnchor",value:function(){var t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t,this.render()}},{key:"getHitDetectionImage",value:function(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}},{key:"getImage",value:function(t){var e=this.canvases_[t];if(!e){var n=this.renderOptions_,r=ao(n.size*t,n.size*t);this.draw_(n,r,t),e=r.canvas,this.canvases_[t]=e}return e}},{key:"getPixelRatio",value:function(t){return t}},{key:"getImageSize",value:function(){return this.size_}},{key:"getImageState",value:function(){return 2}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius_}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t,this.render()}},{key:"listenImageChange",value:function(t){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(t){}},{key:"calculateLineJoinSize_",value:function(t,e,n){if(0===e||this.points_===1/0||"bevel"!==t&&"miter"!==t)return e;var r=this.radius_,i=void 0===this.radius2_?r:this.radius2_;if(r<i){var o=r;r=i,i=o}var a=void 0===this.radius2_?this.points_:2*this.points_,u=2*Math.PI/a,s=i*Math.sin(u),l=r-Math.sqrt(i*i-s*s),c=Math.sqrt(s*s+l*l),f=c/s;if("miter"===t&&f<=n)return f*e;var h=e/2/f,y=e/2*(l/c),p=Math.sqrt((r+h)*(r+h)+y*y)-r;if(void 0===this.radius2_||"bevel"===t)return 2*p;var v=r*Math.sin(u),d=i-Math.sqrt(r*r-v*v),g=Math.sqrt(v*v+d*d)/v;if(g<=n){var m=g*e/2-i-r;return 2*Math.max(p,m)}return 2*p}},{key:"createRenderOptions",value:function(){var t,e,n,r,i,o,a,u=po,s=go,l=0,c=null,f=0,h=0;this.stroke_&&(t=gf(null!==(e=this.stroke_.getColor())&&void 0!==e?e:mo),h=null!==(n=this.stroke_.getWidth())&&void 0!==n?n:1,c=this.stroke_.getLineDash(),f=null!==(r=this.stroke_.getLineDashOffset())&&void 0!==r?r:0,s=null!==(i=this.stroke_.getLineJoin())&&void 0!==i?i:go,u=null!==(o=this.stroke_.getLineCap())&&void 0!==o?o:po,l=null!==(a=this.stroke_.getMiterLimit())&&void 0!==a?a:10);var y=this.calculateLineJoinSize_(s,h,l),p=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:t,strokeWidth:h,size:Math.ceil(2*p+y),lineCap:u,lineDash:c,lineDashOffset:f,lineJoin:s,miterLimit:l}}},{key:"render",value:function(){this.renderOptions_=this.createRenderOptions();var t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}},{key:"draw_",value:function(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){var r=this.fill_.getColor();null===r&&(r=yo),e.fillStyle=gf(r),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}},{key:"createHitDetectionCanvas_",value:function(t){var e;if(this.fill_){var n=this.fill_.getColor(),r=0;"string"==typeof n&&(n=De(n)),null===n?r=1:Array.isArray(n)&&(r=4===n.length?n[3]:1),0===r&&(e=ao(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}},{key:"createPath_",value:function(t){var e=this.points_,n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{var r=void 0===this.radius2_?n:this.radius2_;void 0!==this.radius2_&&(e*=2);for(var i=this.angle_-Math.PI/2,o=2*Math.PI/e,a=0;a<e;a++){var u=i+a*o,s=a%2==0?n:r;t.lineTo(s*Math.cos(u),s*Math.sin(u))}t.closePath()}}},{key:"drawHitDetectionCanvas_",value:function(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=yo,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}])&&bf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(df);function Of(t){return Of="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Of(t)}function xf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Of(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Of(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Of(i)?i:String(i)),r)}var i}function kf(t,e){return kf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kf(t,e)}function Pf(t){return Pf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Pf(t)}const Ef=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kf(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pf(r);if(i){var n=Pf(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Of(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{radius:5},o.call(this,{points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:void 0!==t.scale?t.scale:1,rotation:void 0!==t.rotation?t.rotation:0,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,displacement:void 0!==t.displacement?t.displacement:[0,0],declutterMode:t.declutterMode})}return e=a,(n=[{key:"clone",value:function(){var t=this.getScale(),e=new a({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}},{key:"setRadius",value:function(t){this.radius_=t,this.render()}}])&&xf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Sf);function jf(t){return jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(t)}function Rf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==jf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==jf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===jf(i)?i:String(i)),r)}var i}const Tf=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.color_=void 0!==e.color?e.color:null}var e,n;return e=t,(n=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(t){this.color_=t}}])&&Rf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Cf(t){return Cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cf(t)}function If(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Cf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Cf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Cf(i)?i:String(i)),r)}var i}const Mf=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}var e,n;return e=t,(n=[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(t){this.color_=t}},{key:"setLineCap",value:function(t){this.lineCap_=t}},{key:"setLineDash",value:function(t){this.lineDash_=t}},{key:"setLineDashOffset",value:function(t){this.lineDashOffset_=t}},{key:"setLineJoin",value:function(t){this.lineJoin_=t}},{key:"setMiterLimit",value:function(t){this.miterLimit_=t}},{key:"setWidth",value:function(t){this.width_=t}}])&&If(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Af(t){return Af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Af(t)}function Ff(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Af(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Af(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Af(i)?i:String(i)),r)}var i}var Lf=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.geometry_=null,this.geometryFunction_=Gf,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.hitDetectionRenderer_=void 0!==e.hitDetectionRenderer?e.hitDetectionRenderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}var e,n;return e=t,(n=[{key:"clone",value:function(){var e,n,r=this.getGeometry();return r&&"object"===Af(r)&&(r=r.clone()),new t({geometry:null!==(e=r)&&void 0!==e?e:void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:null!==(n=this.getRenderer())&&void 0!==n?n:void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(t){this.renderer_=t}},{key:"setHitDetectionRenderer",value:function(t){this.hitDetectionRenderer_=t}},{key:"getHitDetectionRenderer",value:function(){return this.hitDetectionRenderer_}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(t){this.text_=t}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Gf,this.geometry_=t}},{key:"setZIndex",value:function(t){this.zIndex_=t}}])&&Ff(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Df=null;function Bf(t,e){if(!Df){var n=new Tf({color:"rgba(255,255,255,0.4)"}),r=new Mf({color:"#3399CC",width:1.25});Df=[new Lf({image:new Ef({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return Df}function Gf(t){return t.getGeometry()}const zf=Lf;function Nf(t){return Nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(t)}function Wf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Nf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Nf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Nf(i)?i:String(i)),r)}var i}function Xf(t,e){return Xf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xf(t,e)}function Yf(t){return Yf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yf(t)}var Kf=null,Zf=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xf(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yf(r);if(i){var n=Yf(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Nf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r,i){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(u=o.call(this)).hitDetectionImage_=null,u.image_=t,u.crossOrigin_=n,u.canvas_={},u.color_=i,u.imageState_=void 0===r?0:r,u.size_=t&&t.width&&t.height?[t.width,t.height]:null,u.src_=e,u.tainted_,u}return e=a,(n=[{key:"initializeImage_",value:function(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}},{key:"isTainted_",value:function(){if(void 0===this.tainted_&&2===this.imageState_){Kf||(Kf=ao(1,1,void 0,{willReadFrequently:!0})),Kf.drawImage(this.image_,0,0);try{Kf.getImageData(0,0,1,1),this.tainted_=!1}catch(t){Kf=null,this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(E)}},{key:"handleImageError_",value:function(){this.imageState_=3,this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=2,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}},{key:"getImage",value:function(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}},{key:"getPixelRatio",value:function(t){return this.replaceColor_(t),this.canvas_[t]?t:1}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){var t=this.size_[0],e=this.size_[1],n=ao(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){var t,e,n=this;if(0===this.imageState_){this.image_||this.initializeImage_(),this.imageState_=1;try{void 0!==this.src_&&(this.image_.src=this.src_)}catch(t){this.handleImageError_()}this.image_ instanceof HTMLImageElement&&(t=this.image_,e=this.src_,e&&(t.src=e),t.src&&Ot?new Promise((function(e,n){return t.decode().then((function(){return e(t)})).catch((function(r){return t.complete&&t.width?e(t):n(r)}))})):function(t,e){return new Promise((function(e,n){function r(){o(),e(t)}function i(){o(),n(new Error("Image load error"))}function o(){t.removeEventListener("load",r),t.removeEventListener("error",i)}t.addEventListener("load",r),t.addEventListener("error",i)}))}(t)).then((function(t){n.image_=t,n.handleImageLoad_()})).catch(this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(t){if(this.color_&&!this.canvas_[t]&&2===this.imageState_){var e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);var r=n.getContext("2d");r.scale(t,t),r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=Te(this.color_),r.fillRect(0,0,n.width/t,n.height/t),r.globalCompositeOperation="destination-in",r.drawImage(e,0,0),this.canvas_[t]=n}}}])&&Wf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(P);function Vf(t){return Vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(t)}function Uf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function qf(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Vf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Vf(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Vf(i)?i:String(i)),r)}var i}function Hf(){return Hf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Hf.apply(this,arguments)}function Jf(t,e){return Jf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Jf(t,e)}function Qf(t,e){if(e&&("object"===Vf(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function $f(t){return $f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$f(t)}function th(t,e,n,r){return void 0!==n&&void 0!==r?[n/t,r/e]:void 0!==n?n/t:void 0!==r?r/e:1}const eh=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Jf(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$f(r);if(i){var n=$f(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return Qf(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var n=void 0!==(t=t||{}).opacity?t.opacity:1,r=void 0!==t.rotation?t.rotation:0,i=void 0!==t.scale?t.scale:1,u=void 0!==t.rotateWithView&&t.rotateWithView;(e=o.call(this,{opacity:n,rotation:r,scale:i,displacement:void 0!==t.displacement?t.displacement:[0,0],rotateWithView:u,declutterMode:t.declutterMode})).anchor_=void 0!==t.anchor?t.anchor:[.5,.5],e.normalizedAnchor_=null,e.anchorOrigin_=void 0!==t.anchorOrigin?t.anchorOrigin:"top-left",e.anchorXUnits_=void 0!==t.anchorXUnits?t.anchorXUnits:"fraction",e.anchorYUnits_=void 0!==t.anchorYUnits?t.anchorYUnits:"fraction",e.crossOrigin_=void 0!==t.crossOrigin?t.crossOrigin:null;var s,l,c,f=void 0!==t.img?t.img:null,h=t.src;if(kt(!(void 0!==h&&f),"`image` and `src` cannot be provided at the same time"),void 0!==h&&0!==h.length||!f||(h=f.src||K(f)),kt(void 0!==h&&h.length>0,"A defined and non-empty `src` or `image` must be provided"),kt(!((void 0!==t.width||void 0!==t.height)&&void 0!==t.scale),"`width` or `height` cannot be provided together with `scale`"),void 0!==t.src?s=0:void 0!==f&&(s=f instanceof HTMLImageElement?f.complete?f.src?2:0:1:2),e.color_=void 0!==t.color?De(t.color):null,e.iconImage_=function(t,e,n,r,i){var o=void 0===e?void 0:Xe.get(e,n,i);return o||(o=new Zf(t,t instanceof HTMLImageElement?t.src||void 0:e,n,r,i),Xe.set(e,n,i,o)),o}(f,h,e.crossOrigin_,s,e.color_),e.offset_=void 0!==t.offset?t.offset:[0,0],e.offsetOrigin_=void 0!==t.offsetOrigin?t.offsetOrigin:"top-left",e.origin_=null,e.size_=void 0!==t.size?t.size:null,void 0!==t.width||void 0!==t.height){var y,p;if(t.size){var v=(l=t.size,c=2,function(t){if(Array.isArray(t))return t}(l)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(l,c)||function(t,e){if(t){if("string"==typeof t)return Uf(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uf(t,e):void 0}}(l,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());y=v[0],p=v[1]}else{var d=e.getImage(1);if(d.width&&d.height)y=d.width,p=d.height;else if(d instanceof HTMLImageElement)return e.initialOptions_=t,e.listenImageChange((function n(){if(e.unlistenImageChange(n),e.initialOptions_){var r=e.iconImage_.getSize();e.setScale(th(r[0],r[1],t.width,t.height))}})),Qf(e)}void 0!==y&&e.setScale(th(y,p,t.width,t.height))}return e}return e=a,(n=[{key:"clone",value:function(){var t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new a({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}},{key:"getAnchor",value:function(){var t=this.normalizedAnchor_;if(!t){t=this.anchor_;var e=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!e)return null;t=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(t[0]*=e[0]),"fraction"==this.anchorYUnits_&&(t[1]*=e[1])}if("top-left"!=this.anchorOrigin_){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[0]=-t[0]+e[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(t[1]=-t[1]+e[1])}this.normalizedAnchor_=t}var n=this.getDisplacement(),r=this.getScaleArray();return[t[0]-n[0]/r[0],t[1]+n[1]/r[1]]}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getPixelRatio",value:function(t){return this.iconImage_.getPixelRatio(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(){return this.iconImage_.getHitDetectionImage()}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_;if("top-left"!=this.offsetOrigin_){var e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[0]=n[0]-e[0]-t[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"getWidth",value:function(){var t=this.getScaleArray();return this.size_?this.size_[0]*t[0]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[0]*t[0]:void 0}},{key:"getHeight",value:function(){var t=this.getScaleArray();return this.size_?this.size_[1]*t[1]:2==this.iconImage_.getImageState()?this.iconImage_.getSize()[1]*t[1]:void 0}},{key:"setScale",value:function(t){delete this.initialOptions_,Hf($f(a.prototype),"setScale",this).call(this,t)}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(E,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(E,t)}}])&&qf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(df);function nh(t){return nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(t)}function rh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==nh(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==nh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===nh(i)?i:String(i)),r)}var i}const ih=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.scaleArray_=Ls(void 0!==e.scale?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new Tf({color:"#333"}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}var e,n;return e=t,(n=[{key:"clone",value:function(){var e=this.getScale();return new t({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}},{key:"getOverflow",value:function(){return this.overflow_}},{key:"getFont",value:function(){return this.font_}},{key:"getMaxAngle",value:function(){return this.maxAngle_}},{key:"getPlacement",value:function(){return this.placement_}},{key:"getRepeat",value:function(){return this.repeat_}},{key:"getOffsetX",value:function(){return this.offsetX_}},{key:"getOffsetY",value:function(){return this.offsetY_}},{key:"getFill",value:function(){return this.fill_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getScaleArray",value:function(){return this.scaleArray_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"getText",value:function(){return this.text_}},{key:"getTextAlign",value:function(){return this.textAlign_}},{key:"getJustify",value:function(){return this.justify_}},{key:"getTextBaseline",value:function(){return this.textBaseline_}},{key:"getBackgroundFill",value:function(){return this.backgroundFill_}},{key:"getBackgroundStroke",value:function(){return this.backgroundStroke_}},{key:"getPadding",value:function(){return this.padding_}},{key:"setOverflow",value:function(t){this.overflow_=t}},{key:"setFont",value:function(t){this.font_=t}},{key:"setMaxAngle",value:function(t){this.maxAngle_=t}},{key:"setOffsetX",value:function(t){this.offsetX_=t}},{key:"setOffsetY",value:function(t){this.offsetY_=t}},{key:"setPlacement",value:function(t){this.placement_=t}},{key:"setRepeat",value:function(t){this.repeat_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setFill",value:function(t){this.fill_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t,this.scaleArray_=Ls(void 0!==t?t:1)}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"setText",value:function(t){this.text_=t}},{key:"setTextAlign",value:function(t){this.textAlign_=t}},{key:"setJustify",value:function(t){this.justify_=t}},{key:"setTextBaseline",value:function(t){this.textBaseline_=t}},{key:"setBackgroundFill",value:function(t){this.backgroundFill_=t}},{key:"setBackgroundStroke",value:function(t){this.backgroundStroke_=t}},{key:"setPadding",value:function(t){this.padding_=t}}])&&rh(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var oh,ah;function uh(t,e,n){return uh=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&sh(i,n.prototype),i},uh.apply(null,arguments)}function sh(t,e){return sh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sh(t,e)}function lh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||vh(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ch(t){return ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(t)}function fh(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mh(r.key),r)}}function hh(t,e,n){return e&&fh(t.prototype,e),n&&fh(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function yh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ph(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=vh(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function vh(t,e){if(t){if("string"==typeof t)return dh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dh(t,e):void 0}}function dh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gh(t,e,n){return(e=mh(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mh(t){var e=function(t,e){if("object"!==ch(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ch(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ch(e)?e:String(e)}var bh=0,_h=0,wh=1<<bh++,Sh=1<<bh++,Oh=1<<bh++,xh=1<<bh++,kh=1<<bh++,Ph=Math.pow(2,5)-1,Eh=(gh(oh={},wh,"boolean"),gh(oh,Sh,"number"),gh(oh,Oh,"string"),gh(oh,xh,"color"),gh(oh,kh,"number[]"),oh),jh=Object.keys(Eh).map(Number).sort(f);function Rh(t){var e,n,r=[],i=ph(jh);try{for(i.s();!(e=i.n()).done;){var o=e.value;(t&(n=o))===n&&r.push(Eh[o])}}catch(t){i.e(t)}finally{i.f()}return 0===r.length?"untyped":r.length<3?r.join(" or "):r.slice(0,-1).join(", ")+", or "+r[r.length-1]}function Th(t,e){return!!(t&e)}function Ch(t,e){return t===e}var Ih=hh((function t(e,n){yh(this,t),this.type=e,this.value=n})),Mh=hh((function t(e,n){yh(this,t),this.type=e,this.operator=n;for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];this.args=i}));function Ah(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function Fh(t,e,n){switch(ch(t)){case"boolean":return new Ih(wh,t);case"number":return new Ih(Sh,t);case"string":var r=Oh;return function(t){try{return Le(t),!0}catch(t){return!1}}(t)&&(r|=xh),Ch(r&n,_h)||(r&=n),new Ih(r,t)}if(!Array.isArray(t))throw new Error("Expression must be an array or a primitive value");if(0===t.length)throw new Error("Empty expression");if("string"==typeof t[0])return function(t,e,n){var r=t[0],i=Dh[r];if(!i)throw new Error("Unknown operator: ".concat(r));return i(t,e,n)}(t,e,n);var i,o=ph(t);try{for(o.s();!(i=o.n()).done;)if("number"!=typeof i.value)throw new Error("Expected an array of numbers")}catch(t){o.e(t)}finally{o.f()}var a=kh;return 3!==t.length&&4!==t.length||(a|=xh),n&&(a&=n),new Ih(a,t)}var Lh={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},Dh=(gh(ah={},Lh.Get,Xh((function(t){var e=lh(t,2),n=(e[0],e[1]);return void 0!==n?function(t){switch(t){case"string":return Oh;case"color":return xh;case"number":return Sh;case"boolean":return wh;case"number[]":return kh;default:throw new Error("Unrecognized type hint: ".concat(t))}}(n.value):Ph}),Gh(1,2),(function(t,e){var n=Fh(t[1],e);if(!(n instanceof Ih))throw new Error("Expected a literal argument for get operation");if("string"!=typeof n.value)throw new Error("Expected a string argument for get operation");return e.properties.add(n.value),3===t.length?[n,Fh(t[2],e)]:[n]}))),gh(ah,Lh.Var,Xh((function(t){return lh(t,1)[0].type}),Gh(1,1),(function(t,e,n,r){var i=t[1];if("string"!=typeof i)throw new Error("Expected a string argument for var operation");if(e.variables.add(i),!("variables"in e.style)||void 0===e.style.variables[i])return[new Ih(Ph,i)];var o=Fh(e.style.variables[i],e);if(o.value=i,r&&!Th(r,o.type))throw new Error("The variable ".concat(i," has type ").concat(Rh(o.type)," but the following type was expected: ").concat(Rh(r)));return[o]}))),gh(ah,Lh.Id,Xh(Sh|Oh,Bh,(function(t,e){e.featureId=!0}))),gh(ah,Lh.Concat,Xh(Oh,Gh(2,1/0),zh(Ph))),gh(ah,Lh.GeometryType,Xh(Oh,Bh)),gh(ah,Lh.Resolution,Xh(Sh,Bh)),gh(ah,Lh.Zoom,Xh(Sh,Bh)),gh(ah,Lh.Time,Xh(Sh,Bh)),gh(ah,Lh.Any,Xh(wh,Gh(2,1/0),zh(wh))),gh(ah,Lh.All,Xh(wh,Gh(2,1/0),zh(wh))),gh(ah,Lh.Not,Xh(wh,Gh(1,1),zh(wh))),gh(ah,Lh.Equal,Xh(wh,Gh(2,2),zh(Ph),Nh)),gh(ah,Lh.NotEqual,Xh(wh,Gh(2,2),zh(Ph),Nh)),gh(ah,Lh.GreaterThan,Xh(wh,Gh(2,2),zh(Ph),Nh)),gh(ah,Lh.GreaterThanOrEqualTo,Xh(wh,Gh(2,2),zh(Ph),Nh)),gh(ah,Lh.LessThan,Xh(wh,Gh(2,2),zh(Ph),Nh)),gh(ah,Lh.LessThanOrEqualTo,Xh(wh,Gh(2,2),zh(Ph),Nh)),gh(ah,Lh.Multiply,Xh((function(t){for(var e=Sh|xh,n=0;n<t.length;n++)e&=t[n].type;return e}),Gh(2,1/0),zh(Sh|xh),Nh)),gh(ah,Lh.Divide,Xh(Sh,Gh(2,2),zh(Sh))),gh(ah,Lh.Add,Xh(Sh,Gh(2,1/0),zh(Sh))),gh(ah,Lh.Subtract,Xh(Sh,Gh(2,2),zh(Sh))),gh(ah,Lh.Clamp,Xh(Sh,Gh(3,3),zh(Sh))),gh(ah,Lh.Mod,Xh(Sh,Gh(2,2),zh(Sh))),gh(ah,Lh.Pow,Xh(Sh,Gh(2,2),zh(Sh))),gh(ah,Lh.Abs,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Floor,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Ceil,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Round,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Sin,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Cos,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Atan,Xh(Sh,Gh(1,2),zh(Sh))),gh(ah,Lh.Sqrt,Xh(Sh,Gh(1,1),zh(Sh))),gh(ah,Lh.Match,Xh((function(t){for(var e=Ph,n=2;n<t.length;n+=2)e&=t[n].type;return e&t[t.length-1].type}),Gh(4,1/0),Wh,(function(t,e,n,r){for(var i=t.length-1,o=Fh(t[1],e).type,a=Fh(t[t.length-1],e),u=void 0!==r?r&a.type:a.type,s=new Array(i-2),l=0;l<i-2;l+=2){var c=Fh(t[l+2],e),f=Fh(t[l+3],e);o&=c.type,u&=f.type,s[l]=c,s[l+1]=f}var h=Oh|Sh|wh;if(!Th(h,o))throw new Error("Expected an input of type ".concat(Rh(h)," for the interpolate operation")+", got ".concat(Rh(o)," instead"));if(Ch(u,_h))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(t));for(var y=0;y<i-2;y+=2){var p=Fh(t[y+2],e,o),v=Fh(t[y+3],e,u);s[y]=p,s[y+1]=v}return[Fh(t[1],e,o)].concat(s,[Fh(t[t.length-1],e,u)])}))),gh(ah,Lh.Between,Xh(wh,Gh(3,3),zh(Sh))),gh(ah,Lh.Interpolate,Xh((function(t){for(var e=xh|Sh,n=3;n<t.length;n+=2)e&=t[n].type;return e}),Gh(6,1/0),Wh,(function(t,e,n,r){var i,o=t[1];switch(o[0]){case"linear":i=1;break;case"exponential":if("number"!=typeof(i=o[1]))throw new Error("Expected a number base for exponential interpolation"+", got ".concat(JSON.stringify(i)," instead"));break;default:i=null}if(!i)throw new Error("Invalid interpolation type: ".concat(JSON.stringify(o)));i=Fh(i,e);var a=Fh(t[2],e);if(!Th(Sh,a.type))throw new Error("Expected an input of type number for the interpolate operation"+", got ".concat(Rh(a.type)," instead"));a=Fh(t[2],e,Sh);for(var u=new Array(t.length-3),s=0;s<u.length;s+=2){var l=Fh(t[s+3],e);if(!Th(Sh,l.type))throw new Error("Expected all stop input values in the interpolate operation to be of type number"+", got ".concat(Rh(l.type)," at position ").concat(s+2," instead"));var c=Fh(t[s+4],e);if(!Th(Sh|xh,c.type))throw new Error("Expected all stop output values in the interpolate operation to be a number or color"+", got ".concat(Rh(c.type)," at position ").concat(s+3," instead"));l=Fh(t[s+3],e,Sh),c=Fh(t[s+4],e,Sh|xh),u[s]=l,u[s+1]=c}return[i,a].concat(u)}))),gh(ah,Lh.Case,Xh((function(t){for(var e=Ph,n=1;n<t.length;n+=2)e&=t[n].type;return e&t[t.length-1].type}),Gh(3,1/0),(function(t,e){var n=t[0],r=t.length-1;if(r%2==0)throw new Error("An odd amount of arguments was expected for operation ".concat(n,", got ").concat(JSON.stringify(r)," instead"))}),(function(t,e,n,r){for(var i=Fh(t[t.length-1],e),o=void 0!==r?r&i.type:i.type,a=new Array(t.length-1),u=0;u<a.length-1;u+=2){var s=Fh(t[u+1],e),l=Fh(t[u+2],e);if(!Th(wh,s.type))throw new Error("Expected all conditions in the case operation to be of type boolean"+", got ".concat(Rh(s.type)," at position ").concat(u," instead"));o&=l.type,a[u]=s,a[u+1]=l}if(Ch(o,_h))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(t));for(var c=0;c<a.length-1;c+=2)a[c+1]=Fh(t[c+2],e,o);return a[a.length-1]=Fh(t[t.length-1],e,o),a}))),gh(ah,Lh.In,Xh(wh,Gh(2,2),(function(t,e){var n=t[2];if(!Array.isArray(n))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if("string"==typeof n[0]){if("literal"!==n[0])throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(n[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');n=n[1]}for(var r=Oh|Sh,i=new Array(n.length),o=0;o<i.length;o++){var a=Fh(n[o],e);r&=a.type,i[o]=a}if(Ch(r,_h))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(t));return[Fh(t[1],e,r)].concat(i)}))),gh(ah,Lh.Number,Xh(Sh,Gh(1,1/0),zh(Ph))),gh(ah,Lh.String,Xh(Oh,Gh(1,1/0),zh(Ph))),gh(ah,Lh.Array,Xh((function(t){return 3===t.length||4===t.length?kh|xh:kh}),Gh(1,1/0),zh(Sh))),gh(ah,Lh.Color,Xh(xh,Gh(3,4),zh(Sh))),gh(ah,Lh.Band,Xh(Sh,Gh(1,3),zh(Sh))),gh(ah,Lh.Palette,Xh(xh,Gh(2,2),(function(t,e){var n=Fh(t[1],e,Sh);if(n.type!==Sh)throw new Error("The first argument of palette must be an number, got ".concat(Rh(n.type)," instead"));var r=t[2];if(!Array.isArray(r))throw new Error("The second argument of palette must be an array");for(var i=new Array(r.length),o=0;o<i.length;o++){var a=Fh(r[o],e,xh);if(!(a instanceof Ih))throw new Error("The palette color at index ".concat(o," must be a literal value"));if(!Th(a.type,xh))throw new Error("The palette color at index ".concat(o," should be of type color, got ").concat(Rh(a.type)," instead"));i[o]=a}return[n].concat(i)}))),ah);function Bh(t,e){var n=t[0];if(1!==t.length)throw new Error("Expected no arguments for ".concat(n," operation"));return[]}function Gh(t,e){return function(n,r){var i=n[0],o=n.length-1;if(t===e){if(o!==t){var a=1===t?"":"s";throw new Error("Expected ".concat(t," argument").concat(a," for ").concat(i,", got ").concat(o))}}else if(o<t||o>e){var u=e===1/0?"".concat(t," or more"):"".concat(t," to ").concat(e);throw new Error("Expected ".concat(u," arguments for ").concat(i,", got ").concat(o))}}}function zh(t){return function(e,n){for(var r=e[0],i=e.length-1,o=new Array(i),a=0;a<i;++a){var u=Fh(e[a+1],n);if(!Th(t,u.type)){var s=Rh(t),l=Rh(u.type);throw new Error("Unexpected type for argument ".concat(a," of ").concat(r," operation")+", got ".concat(s," but expected ").concat(l))}u.type&=t,o[a]=u}return o}}function Nh(t,e,n){for(var r=t[0],i=t.length-1,o=Ph,a=0;a<n.length;++a)o&=n[a].type;if(o===_h)throw new Error("No common type could be found for arguments of ".concat(r," operation"));for(var u=new Array(i),s=0;s<i;++s)u[s]=Fh(t[s+1],e,o);return u}function Wh(t,e){var n=t[0],r=t.length-1;if(r%2==1)throw new Error("An even amount of arguments was expected for operation ".concat(n,", got ").concat(JSON.stringify(r)," instead"))}function Xh(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(e,r,i){for(var o=e[0],a=[],u=0;u<n.length;u++)a=n[u](e,r,a,i)||a;var s,l="function"==typeof t?t(a):t;if(void 0!==i){if(!Th(l,i))throw new Error("The following expression was expected to return ".concat(Rh(i),", but returns ").concat(Rh(l)," instead: ").concat(JSON.stringify(e)));l&=i}if(l===_h)throw new Error("No matching type was found for the following expression: ".concat(JSON.stringify(e)));return uh(Mh,[l,o].concat(function(t){if(Array.isArray(t))return dh(t)}(s=a)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(s)||vh(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))}}function Yh(t){return Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yh(t)}function Kh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Zh(t,e,n){var r=Fh(t,n);if(!Th(e,r.type)){var i=Rh(e),o=Rh(r.type);throw new Error("Expected expression to be of type ".concat(i,", got ").concat(o))}return Vh(r,n)}function Vh(t,e){if(t instanceof Ih){if(t.type===xh&&"string"==typeof t.value){var n=Le(t.value);return function(){return n}}return function(){return t.value}}var r=t.operator;switch(r){case Lh.Number:case Lh.String:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=Vh(t.args[o],e);switch(n){case Lh.Number:case Lh.String:return function(t){for(var e=0;e<r;++e){var o=i[e](t);if(Yh(o)===n)return o}throw new Error("Expected one of the values to be a ".concat(n))};default:throw new Error("Unsupported assertion operator ".concat(n))}}(t,e);case Lh.Get:case Lh.Var:return function(t,e){var n=t.args[0].value;switch(t.operator){case Lh.Get:return function(t){return t.properties[n]};case Lh.Var:return function(t){return t.variables[n]};default:throw new Error("Unsupported accessor operator ".concat(t.operator))}}(t);case Lh.Id:return function(t){return t.featureId};case Lh.Concat:var i=t.args.map((function(t){return Vh(t,e)}));return function(t){var e,n;return(e="").concat.apply(e,function(t){if(Array.isArray(t))return Kh(t)}(n=i.map((function(e){return e(t).toString()})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Kh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kh(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())};case Lh.Resolution:return function(t){return t.resolution};case Lh.Any:case Lh.All:case Lh.Not:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=Vh(t.args[o],e);switch(n){case Lh.Any:return function(t){for(var e=0;e<r;++e)if(i[e](t))return!0;return!1};case Lh.All:return function(t){for(var e=0;e<r;++e)if(!i[e](t))return!1;return!0};case Lh.Not:return function(t){return!i[0](t)};default:throw new Error("Unsupported logical operator ".concat(n))}}(t,e);case Lh.Equal:case Lh.NotEqual:case Lh.LessThan:case Lh.LessThanOrEqualTo:case Lh.GreaterThan:case Lh.GreaterThanOrEqualTo:return function(t,e){var n=t.operator,r=Vh(t.args[0],e),i=Vh(t.args[1],e);switch(n){case Lh.Equal:return function(t){return r(t)===i(t)};case Lh.NotEqual:return function(t){return r(t)!==i(t)};case Lh.LessThan:return function(t){return r(t)<i(t)};case Lh.LessThanOrEqualTo:return function(t){return r(t)<=i(t)};case Lh.GreaterThan:return function(t){return r(t)>i(t)};case Lh.GreaterThanOrEqualTo:return function(t){return r(t)>=i(t)};default:throw new Error("Unsupported comparison operator ".concat(n))}}(t,e);case Lh.Multiply:case Lh.Divide:case Lh.Add:case Lh.Subtract:case Lh.Clamp:case Lh.Mod:case Lh.Pow:case Lh.Abs:case Lh.Floor:case Lh.Ceil:case Lh.Round:case Lh.Sin:case Lh.Cos:case Lh.Atan:case Lh.Sqrt:return function(t,e){for(var n=t.operator,r=t.args.length,i=new Array(r),o=0;o<r;++o)i[o]=Vh(t.args[o],e);switch(n){case Lh.Multiply:return function(t){for(var e=1,n=0;n<r;++n)e*=i[n](t);return e};case Lh.Divide:return function(t){return i[0](t)/i[1](t)};case Lh.Add:return function(t){for(var e=0,n=0;n<r;++n)e+=i[n](t);return e};case Lh.Subtract:return function(t){return i[0](t)-i[1](t)};case Lh.Clamp:return function(t){var e=i[0](t),n=i[1](t);if(e<n)return n;var r=i[2](t);return e>r?r:e};case Lh.Mod:return function(t){return i[0](t)%i[1](t)};case Lh.Pow:return function(t){return Math.pow(i[0](t),i[1](t))};case Lh.Abs:return function(t){return Math.abs(i[0](t))};case Lh.Floor:return function(t){return Math.floor(i[0](t))};case Lh.Ceil:return function(t){return Math.ceil(i[0](t))};case Lh.Round:return function(t){return Math.round(i[0](t))};case Lh.Sin:return function(t){return Math.sin(i[0](t))};case Lh.Cos:return function(t){return Math.cos(i[0](t))};case Lh.Atan:return 2===r?function(t){return Math.atan2(i[0](t),i[1](t))}:function(t){return Math.atan(i[0](t))};case Lh.Sqrt:return function(t){return Math.sqrt(i[0](t))};default:throw new Error("Unsupported numeric operator ".concat(n))}}(t,e);case Lh.Match:return function(t,e){for(var n=t.args.length,r=new Array(n),i=0;i<n;++i)r[i]=Vh(t.args[i],e);return function(t){for(var e=r[0](t),i=1;i<n;i+=2)if(e===r[i](t))return r[i+1](t);return r[n-1](t)}}(t,e);case Lh.Interpolate:return function(t,e){for(var n=t.args.length,r=new Array(n),i=0;i<n;++i)r[i]=Vh(t.args[i],e);return function(t){for(var e,i,o=r[0](t),a=r[1](t),u=2;u<n;u+=2){var s=r[u](t),l=r[u+1](t),c=Array.isArray(l);if(c&&(l=Ae(l)),s>=a)return 2===u?l:c?qh(o,a,e,i,s,l):Uh(o,a,e,i,s,l);e=s,i=l}return i}}(t,e);default:throw new Error("Unsupported operator ".concat(r))}}function Uh(t,e,n,r,i,o){var a=i-n;if(0===a)return r;var u=e-n;return r+(1===t?u/a:(Math.pow(t,u)-1)/(Math.pow(t,a)-1))*(o-r)}function qh(t,e,n,r,i,o){if(0==i-n)return r;var a,u,s=Fe(r),l=Fe(o),c=l[2]-s[2];return c>180?c-=360:c<-180&&(c+=360),Be((a=[Uh(t,e,n,s[0],i,l[0]),Uh(t,e,n,s[1],i,l[1]),s[2]+Uh(t,e,n,0,i,c),Uh(t,e,n,r[3],i,o[3])],(u=he.rgb(ve.xyz(a)))[3]=a[3],u))}function Hh(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Jh(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jh(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){u=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function Jh(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qh(t){return!0}function $h(t){for(var e=Ah(),n=t.length,r=new Array(n),i=0;i<n;++i)r[i]=ty(t[i],e);var o={variables:{},properties:{},resolution:NaN,featureId:null},a=new Array(n);return function(t,i){if(o.properties=t.getPropertiesInternal(),o.resolution=i,e.featureId){var u=t.getId();o.featureId=void 0!==u?u:null}for(var s=0,l=0;l<n;++l){var c=r[l](o);c&&(a[s]=c,s+=1)}return a.length=s,a}}function ty(t,e){var n=ey(t,"",e),r=ny(t,"",e),i=function(t,e){var n="text-",r=iy(t,n+"value",e);if(!r)return null;var i=ey(t,n,e),o=ey(t,n+"background-",e),a=ny(t,n,e),u=ny(t,n+"background-",e),s=iy(t,n+"font",e),l=ry(t,n+"max-angle",e),c=ry(t,n+"offset-x",e),f=ry(t,n+"offset-y",e),h=oy(t,n+"overflow",e),y=iy(t,n+"placement",e),p=ry(t,n+"repeat",e),v=ly(t,n+"scale",e),d=oy(t,n+"rotate-with-view",e),g=ry(t,n+"rotation",e),m=iy(t,n+"align",e),b=iy(t,n+"justify",e),_=iy(t,n+"baseline",e),w=uy(t,n+"padding",e),S=new ih({});return function(t){if(S.setText(r(t)),i&&S.setFill(i(t)),o&&S.setBackgroundFill(o(t)),a&&S.setStroke(a(t)),u&&S.setBackgroundStroke(u(t)),s&&S.setFont(s(t)),l&&S.setMaxAngle(l(t)),c&&S.setOffsetX(c(t)),f&&S.setOffsetY(f(t)),h&&S.setOverflow(h(t)),y){var e=y(t);if("point"!==e&&"line"!==e)throw new Error("Expected point or line for text-placement");S.setPlacement(e)}if(p&&S.setRepeat(p(t)),v&&S.setScale(v(t)),d&&S.setRotateWithView(d(t)),g&&S.setRotation(g(t)),m){var n=m(t);if("left"!==n&&"center"!==n&&"right"!==n&&"end"!==n&&"start"!==n)throw new Error("Expected left, right, center, start, or end for text-align");S.setTextAlign(n)}if(b){var O=b(t);if("left"!==O&&"right"!==O&&"center"!==O)throw new Error("Expected left, right, or center for text-justify");S.setJustify(O)}if(_){var x=_(t);if("bottom"!==x&&"top"!==x&&"middle"!==x&&"alphabetic"!==x&&"hanging"!==x)throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");S.setTextBaseline(x)}return w&&S.setPadding(w(t)),S}}(t,e),o=function(t,e){return"icon-src"in t?function(t,e){var n="icon-",r=n+"src",i=vy(t[r],r),o=sy(t,n+"anchor",e),a=ly(t,n+"scale",e),u=ry(t,n+"opacity",e),s=sy(t,n+"displacement",e),l=ry(t,n+"rotation",e),c=oy(t,n+"rotate-with-view",e),f=fy(t,n+"anchor-origin"),h=hy(t,n+"anchor-x-units"),y=hy(t,n+"anchor-y-units"),p=function(t,e){var n=t[e];if(void 0!==n)return gy(n,e)}(t,n+"color"),v=function(t,e){var n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error("Expected a string for ".concat(e));return n}}(t,n+"cross-origin"),d=function(t,e){var n=t[e];if(void 0!==n)return py(n,e)}(t,n+"offset"),g=fy(t,n+"offset-origin"),m=cy(t,n+"width"),b=cy(t,n+"height"),_=function(t,e){var n=t[e];if(void 0!==n){if("number"==typeof n)return Ls(n);if(!Array.isArray(n))throw new Error("Expected a number or size array for ".concat(e));if(2!==n.length||"number"!=typeof n[0]||"number"!=typeof n[1])throw new Error("Expected a number or size array for ".concat(e));return n}}(t,n+"size"),w=yy(t,n+"declutter"),S=new eh({src:i,anchorOrigin:f,anchorXUnits:h,anchorYUnits:y,color:p,crossOrigin:v,offset:d,offsetOrigin:g,height:b,width:m,size:_,declutterMode:w});return function(t){return u&&S.setOpacity(u(t)),s&&S.setDisplacement(s(t)),l&&S.setRotation(l(t)),c&&S.setRotateWithView(c(t)),a&&S.setScale(a(t)),o&&S.setAnchor(o(t)),S}}(t,e):"shape-points"in t?function(t,e){var n="shape-",r=n+"points",i=dy(t[r],r),o=ey(t,n,e),a=ny(t,n,e),u=ly(t,n+"scale",e),s=sy(t,n+"displacement",e),l=ry(t,n+"rotation",e),c=oy(t,n+"rotate-with-view",e),f=cy(t,n+"radius"),h=cy(t,n+"radius1"),y=cy(t,n+"radius2"),p=cy(t,n+"angle"),v=yy(t,n+"declutter-mode"),d=new Sf({points:i,radius:f,radius1:h,radius2:y,angle:p,declutterMode:v});return function(t){return o&&d.setFill(o(t)),a&&d.setStroke(a(t)),s&&d.setDisplacement(s(t)),l&&d.setRotation(l(t)),c&&d.setRotateWithView(c(t)),u&&d.setScale(u(t)),d}}(t,e):"circle-radius"in t?function(t,e){var n="circle-",r=ey(t,n,e),i=ny(t,n,e),o=ry(t,n+"radius",e),a=ly(t,n+"scale",e),u=sy(t,n+"displacement",e),s=ry(t,n+"rotation",e),l=oy(t,n+"rotate-with-view",e),c=yy(t,n+"declutter-mode"),f=new Ef({radius:5,declutterMode:c});return function(t){return o&&f.setRadius(o(t)),r&&f.setFill(r(t)),i&&f.setStroke(i(t)),u&&f.setDisplacement(u(t)),s&&f.setRotation(s(t)),l&&f.setRotateWithView(l(t)),a&&f.setScale(a(t)),f}}(t,e):null}(t,e),a=ry(t,"z-index",e);if(!(n||r||i||o||w(t)))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));var u=new zf;return function(t){var e=!0;if(n){var s=n(t);s&&(e=!1),u.setFill(s)}if(r){var l=r(t);l&&(e=!1),u.setStroke(l)}if(i){var c=i(t);c&&(e=!1),u.setText(c)}if(o){var f=o(t);f&&(e=!1),u.setImage(f)}return a&&u.setZIndex(a(t)),e?null:u}}function ey(t,e,n){var r=ay(t,e+"fill-color",n);if(!r)return null;var i=new Tf;return function(t){var e=r(t);return"none"===e?null:(i.setColor(e),i)}}function ny(t,e,n){var r=ry(t,e+"stroke-width",n),i=ay(t,e+"stroke-color",n);if(!r&&!i)return null;var o=iy(t,e+"stroke-line-cap",n),a=iy(t,e+"stroke-line-join",n),u=uy(t,e+"stroke-line-dash",n),s=ry(t,e+"stroke-line-dash-offset",n),l=ry(t,e+"stroke-miter-limit",n),c=new Mf;return function(t){if(i){var e=i(t);if("none"===e)return null;c.setColor(e)}if(r&&c.setWidth(r(t)),o){var n=o(t);if("butt"!==n&&"round"!==n&&"square"!==n)throw new Error("Expected butt, round, or square line cap");c.setLineCap(n)}if(a){var f=a(t);if("bevel"!==f&&"round"!==f&&"miter"!==f)throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(f)}return u&&c.setLineDash(u(t)),s&&c.setLineDashOffset(s(t)),l&&c.setMiterLimit(l(t)),c}}function ry(t,e,n){if(e in t){var r=Zh(t[e],Sh,n);return function(t){return dy(r(t),e)}}}function iy(t,e,n){if(!(e in t))return null;var r=Zh(t[e],Oh,n);return function(t){return vy(r(t),e)}}function oy(t,e,n){if(!(e in t))return null;var r=Zh(t[e],wh,n);return function(t){var n=r(t);if("boolean"!=typeof n)throw new Error("Expected a boolean for ".concat(e));return n}}function ay(t,e,n){if(!(e in t))return null;var r=Zh(t[e],xh|Oh,n);return function(t){return gy(r(t),e)}}function uy(t,e,n){if(!(e in t))return null;var r=Zh(t[e],kh,n);return function(t){return py(r(t),e)}}function sy(t,e,n){if(!(e in t))return null;var r=Zh(t[e],kh,n);return function(t){var n=py(r(t),e);if(2!==n.length)throw new Error("Expected two numbers for ".concat(e));return n}}function ly(t,e,n){if(!(e in t))return null;var r=Zh(t[e],kh|Sh,n);return function(t){return function(t,e){if("number"==typeof t)return t;var n=py(t,e);if(2!==n.length)throw new Error("Expected an array of two numbers for ".concat(e));return n}(r(t),e)}}function cy(t,e){var n=t[e];if(void 0!==n){if("number"!=typeof n)throw new Error("Expected a number for ".concat(e));return n}}function fy(t,e){var n=t[e];if(void 0!==n){if("bottom-left"!==n&&"bottom-right"!==n&&"top-left"!==n&&"top-right"!==n)throw new Error("Expected bottom-left, bottom-right, top-left, or top-right for ".concat(e));return n}}function hy(t,e){var n=t[e];if(void 0!==n){if("pixels"!==n&&"fraction"!==n)throw new Error("Expected pixels or fraction for ".concat(e));return n}}function yy(t,e){var n=t[e];if(void 0!==n){if("string"!=typeof n)throw new Error("Expected a string for ".concat(e));if("declutter"!==n&&"obstacle"!==n&&"none"!==n)throw new Error("Expected declutter, obstacle, or none for ".concat(e));return n}}function py(t,e){if(!Array.isArray(t))throw new Error("Expected an array for ".concat(e));for(var n=t.length,r=0;r<n;++r)if("number"!=typeof t[r])throw new Error("Expected an array of numbers for ".concat(e));return t}function vy(t,e){if("string"!=typeof t)throw new Error("Expected a string for ".concat(e));return t}function dy(t,e){if("number"!=typeof t)throw new Error("Expected a number for ".concat(e));return t}function gy(t,e){if("string"==typeof t)return t;var n=py(t,e),r=n.length;if(r<3||r>4)throw new Error("Expected a color with 3 or 4 values for ".concat(e));return n}function my(t){return my="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},my(t)}function by(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==my(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==my(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===my(i)?i:String(i)),r)}var i}function _y(){return _y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Sy(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},_y.apply(this,arguments)}function wy(t,e){return wy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},wy(t,e)}function Sy(t){return Sy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sy(t)}var Oy="renderOrder";const xy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wy(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Sy(r);if(i){var n=Sy(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===my(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),t=t||{};var n=Object.assign({},t);return delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,(e=o.call(this,n)).declutter_=void 0!==t.declutter&&t.declutter,e.renderBuffer_=void 0!==t.renderBuffer?t.renderBuffer:100,e.style_=null,e.styleFunction_=void 0,e.setStyle(t.style),e.updateWhileAnimating_=void 0!==t.updateWhileAnimating&&t.updateWhileAnimating,e.updateWhileInteracting_=void 0!==t.updateWhileInteracting&&t.updateWhileInteracting,e}return e=a,(n=[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(t){return _y(Sy(a.prototype),"getFeatures",this).call(this,t)}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(Oy)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"renderDeclutter",value:function(t){t.declutterTree||(t.declutterTree=new yf(9)),this.getRenderer().renderDeclutter(t)}},{key:"setRenderOrder",value:function(t){this.set(Oy,t)}},{key:"setStyle",value:function(t){var e,n,r;this.style_=function(t){if(void 0===t)return Bf;if(!t)return null;if("function"==typeof t)return t;if(t instanceof zf)return t;if(!Array.isArray(t))return $h([t]);if(0===t.length)return[];var e=t.length,n=t[0];if(n instanceof zf){for(var r=new Array(e),i=0;i<e;++i){var o=t[i];if(!(o instanceof zf))throw new Error("Expected a list of style instances");r[i]=o}return r}if("style"in n){for(var a=new Array(e),u=0;u<e;++u){var s=t[u];if(!("style"in s))throw new Error("Expected a list of rules with a style property");a[u]=s}return function(t){var e=Ah(),n=function(t,e){for(var n=t.length,r=new Array(n),i=0;i<n;++i){var o=t[i],a="filter"in o?Zh(o.filter,wh,e):Qh,u=void 0;if(Array.isArray(o.style)){var s=o.style.length;u=new Array(s);for(var l=0;l<s;++l)u[l]=ty(o.style[l],e)}else u=[ty(o.style,e)];r[i]={filter:a,styles:u}}return function(e){for(var i=[],o=!1,a=0;a<n;++a)if((0,r[a].filter)(e)&&(!t[a].else||!o)){o=!0;var u,s=Hh(r[a].styles);try{for(s.s();!(u=s.n()).done;){var l=(0,u.value)(e);l&&i.push(l)}}catch(t){s.e(t)}finally{s.f()}}return i}}(t,e),r={variables:{},properties:{},resolution:NaN,featureId:null};return function(t,i){if(r.properties=t.getPropertiesInternal(),r.resolution=i,e.featureId){var o=t.getId();r.featureId=void 0!==o?o:null}return n(r)}}(a)}return $h(t)}(t),this.styleFunction_=null===t?void 0:("function"==typeof(e=this.style_)?n=e:(Array.isArray(e)?r=e:(kt("function"==typeof e.getZIndex,"Expected an `Style` or an array of `Style`"),r=[e]),n=function(){return r}),n),this.changed()}}])&&by(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ni);var ky={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Py=[ky.FILL],Ey=[ky.STROKE],jy=[ky.BEGIN_PATH],Ry=[ky.CLOSE_PATH];const Ty=ky;function Cy(t){return Cy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cy(t)}function Iy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Cy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Cy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Cy(i)?i:String(i)),r)}var i}const My=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"drawCustom",value:function(t,e,n,r){}},{key:"drawGeometry",value:function(t){}},{key:"setStyle",value:function(t){}},{key:"drawCircle",value:function(t,e){}},{key:"drawFeature",value:function(t,e){}},{key:"drawGeometryCollection",value:function(t,e){}},{key:"drawLineString",value:function(t,e){}},{key:"drawMultiLineString",value:function(t,e){}},{key:"drawMultiPoint",value:function(t,e){}},{key:"drawMultiPolygon",value:function(t,e){}},{key:"drawPoint",value:function(t,e){}},{key:"drawPolygon",value:function(t,e){}},{key:"drawText",value:function(t,e){}},{key:"setFillStrokeStyle",value:function(t,e){}},{key:"setImageStyle",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}}])&&Iy(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ay(t){return Ay="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ay(t)}function Fy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Ay(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Ay(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Ay(i)?i:String(i)),r)}var i}function Ly(t,e){return Ly=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ly(t,e)}function Dy(t){return Dy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Dy(t)}var By=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ly(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Dy(r);if(i){var n=Dy(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ay(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this)).tolerance=t,i.maxExtent=e,i.pixelRatio=r,i.maxLineWidth=0,i.resolution=n,i.beginGeometryInstruction1_=null,i.beginGeometryInstruction2_=null,i.bufferedMaxExtent_=null,i.instructions=[],i.coordinates=[],i.tmpCoordinate_=[],i.hitDetectionInstructions=[],i.state={},i}return e=a,n=[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map((function(t){return t*e}))}},{key:"appendFlatPointCoordinates",value:function(t,e){for(var n=this.getBufferedMaxExtent(),r=this.tmpCoordinate_,i=this.coordinates,o=i.length,a=0,u=t.length;a<u;a+=e)r[0]=t[a],r[1]=t[a+1],Lt(n,r)&&(i[o++]=r[0],i[o++]=r[1]);return o}},{key:"appendFlatLineCoordinates",value:function(t,e,n,r,i,o){var a=this.coordinates,u=a.length,s=this.getBufferedMaxExtent();o&&(e+=r);var l,c,f,h=t[e],y=t[e+1],p=this.tmpCoordinate_,v=!0;for(l=e+r;l<n;l+=r)p[0]=t[l],p[1]=t[l+1],(f=Gt(s,p))!==c?(v&&(a[u++]=h,a[u++]=y,v=!1),a[u++]=p[0],a[u++]=p[1]):f===Tt.INTERSECTING?(a[u++]=p[0],a[u++]=p[1],v=!1):v=!0,h=p[0],y=p[1],c=f;return(i&&v||l===e+r)&&(a[u++]=h,a[u++]=y),u}},{key:"drawCustomCoordinates_",value:function(t,e,n,r,i){for(var o=0,a=n.length;o<a;++o){var u=n[o],s=this.appendFlatLineCoordinates(t,e,u,r,!1,!1);i.push(s),e=u}return e}},{key:"drawCustom",value:function(t,e,n,r){this.beginGeometry(t,e);var i,o,a,u,s,l=t.getType(),c=t.getStride(),f=this.coordinates.length;switch(l){case"MultiPolygon":i=t.getOrientedFlatCoordinates(),u=[];var h=t.getEndss();s=0;for(var y=0,p=h.length;y<p;++y){var v=[];s=this.drawCustomCoordinates_(i,s,h[y],c,v),u.push(v)}this.instructions.push([Ty.CUSTOM,f,u,t,n,Hr]),this.hitDetectionInstructions.push([Ty.CUSTOM,f,u,t,r||n,Hr]);break;case"Polygon":case"MultiLineString":a=[],i="Polygon"==l?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),s=this.drawCustomCoordinates_(i,0,t.getEnds(),c,a),this.instructions.push([Ty.CUSTOM,f,a,t,n,qr]),this.hitDetectionInstructions.push([Ty.CUSTOM,f,a,t,r||n,qr]);break;case"LineString":case"Circle":i=t.getFlatCoordinates(),o=this.appendFlatLineCoordinates(i,0,i.length,c,!1,!1),this.instructions.push([Ty.CUSTOM,f,o,t,n,Ur]),this.hitDetectionInstructions.push([Ty.CUSTOM,f,o,t,r||n,Ur]);break;case"MultiPoint":i=t.getFlatCoordinates(),(o=this.appendFlatPointCoordinates(i,c))>f&&(this.instructions.push([Ty.CUSTOM,f,o,t,n,Ur]),this.hitDetectionInstructions.push([Ty.CUSTOM,f,o,t,r||n,Ur]));break;case"Point":i=t.getFlatCoordinates(),this.coordinates.push(i[0],i[1]),o=this.coordinates.length,this.instructions.push([Ty.CUSTOM,f,o,t,n]),this.hitDetectionInstructions.push([Ty.CUSTOM,f,o,t,r||n])}this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e){this.beginGeometryInstruction1_=[Ty.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Ty.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e=this.hitDetectionInstructions;e.reverse();var n,r,i=e.length,o=-1;for(t=0;t<i;++t)(r=(n=e[t])[0])==Ty.END_GEOMETRY?o=t:r==Ty.BEGIN_GEOMETRY&&(n[2]=t,y(this.hitDetectionInstructions,o,t),o=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var n=this.state;if(t){var r=t.getColor();n.fillStyle=gf(r||yo)}else n.fillStyle=void 0;if(e){var i=e.getColor();n.strokeStyle=gf(i||mo);var o=e.getLineCap();n.lineCap=void 0!==o?o:po;var a=e.getLineDash();n.lineDash=a?a.slice():vo;var u=e.getLineDashOffset();n.lineDashOffset=u||0;var s=e.getLineJoin();n.lineJoin=void 0!==s?s:go;var l=e.getWidth();n.lineWidth=void 0!==l?l:1;var c=e.getMiterLimit();n.miterLimit=void 0!==c?c:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,n=[Ty.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(!0),n}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[Ty.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}},{key:"updateStrokeStyle",value:function(t,e){var n=t.strokeStyle,r=t.lineCap,i=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,u=t.lineWidth,s=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=r||i!=t.currentLineDash&&!v(t.currentLineDash,i)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=u||t.currentMiterLimit!=s)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=r,t.currentLineDash=i,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=u,t.currentMiterLimit=s)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[Ty.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=At(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;Mt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}],n&&Fy(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(My);const Gy=By;function zy(t){return zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zy(t)}function Ny(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==zy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==zy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===zy(i)?i:String(i)),r)}var i}function Wy(){return Wy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Yy(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Wy.apply(this,arguments)}function Xy(t,e){return Xy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xy(t,e)}function Yy(t){return Yy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yy(t)}const Ky=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xy(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yy(r);if(i){var n=Yy(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===zy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this,t,e,n,r)).hitDetectionImage_=null,i.image_=null,i.imagePixelRatio_=void 0,i.anchorX_=void 0,i.anchorY_=void 0,i.height_=void 0,i.opacity_=void 0,i.originX_=void 0,i.originY_=void 0,i.rotateWithView_=void 0,i.rotation_=void 0,i.scale_=void 0,i.width_=void 0,i.declutterMode_=void 0,i.declutterImageWithText_=void 0,i}return e=a,(n=[{key:"drawPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),r=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([Ty.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ty.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),r=t.getStride(),i=this.coordinates.length,o=this.appendFlatPointCoordinates(n,r);this.instructions.push([Ty.DRAW_IMAGE,i,o,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Ty.DRAW_IMAGE,i,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,Wy(Yy(a.prototype),"finish",this).call(this)}},{key:"setImageStyle",value:function(t,e){var n=t.getAnchor(),r=t.getSize(),i=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=r[1],this.opacity_=t.getOpacity(),this.originX_=i[0],this.originY_=i[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=r[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}])&&Ny(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gy);function Zy(t){return Zy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zy(t)}function Vy(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Zy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Zy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Zy(i)?i:String(i)),r)}var i}function Uy(){return Uy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hy(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Uy.apply(this,arguments)}function qy(t,e){return qy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qy(t,e)}function Hy(t){return Hy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hy(t)}const Jy=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qy(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Hy(r);if(i){var n=Hy(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Zy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,t,e,n,r)}return e=a,(n=[{key:"drawFlatCoordinates_",value:function(t,e,n,r){var i=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,n,r,!1,!1),a=[Ty.MOVE_TO_LINE_TO,i,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n}},{key:"drawLineString",value:function(t,e){var n=this.state,r=n.strokeStyle,i=n.lineWidth;if(void 0!==r&&void 0!==i){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Ty.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,vo,0],jy);var o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push(Ey),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e){var n=this.state,r=n.strokeStyle,i=n.lineWidth;if(void 0!==r&&void 0!==i){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Ty.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,vo,0],jy);for(var o=t.getEnds(),a=t.getFlatCoordinates(),u=t.getStride(),s=0,l=0,c=o.length;l<c;++l)s=this.drawFlatCoordinates_(a,s,o[l],u);this.hitDetectionInstructions.push(Ey),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ey),this.reverseHitDetectionInstructions(),this.state=null,Uy(Hy(a.prototype),"finish",this).call(this)}},{key:"applyStroke",value:function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ey),t.lastStroke=this.coordinates.length),t.lastStroke=0,Uy(Hy(a.prototype),"applyStroke",this).call(this,t),this.instructions.push(jy)}}])&&Vy(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gy);function Qy(t){return Qy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qy(t)}function $y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Qy(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Qy(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Qy(i)?i:String(i)),r)}var i}function tp(){return tp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=np(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},tp.apply(this,arguments)}function ep(t,e){return ep=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ep(t,e)}function np(t){return np=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},np(t)}var rp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ep(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=np(r);if(i){var n=np(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Qy(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,t,e,n,r)}return e=a,n=[{key:"drawFlatCoordinatess_",value:function(t,e,n,r){var i=this.state,o=void 0!==i.fillStyle,a=void 0!==i.strokeStyle,u=n.length;this.instructions.push(jy),this.hitDetectionInstructions.push(jy);for(var s=0;s<u;++s){var l=n[s],c=this.coordinates.length,f=this.appendFlatLineCoordinates(t,e,l,r,!0,!a),h=[Ty.MOVE_TO_LINE_TO,c,f];this.instructions.push(h),this.hitDetectionInstructions.push(h),a&&(this.instructions.push(Ry),this.hitDetectionInstructions.push(Ry)),e=l}return o&&(this.instructions.push(Py),this.hitDetectionInstructions.push(Py)),a&&(this.instructions.push(Ey),this.hitDetectionInstructions.push(Ey)),e}},{key:"drawCircle",value:function(t,e){var n=this.state,r=n.fillStyle,i=n.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Ty.SET_FILL_STYLE,yo]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Ty.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,vo,0]);var o=t.getFlatCoordinates(),a=t.getStride(),u=this.coordinates.length;this.appendFlatLineCoordinates(o,0,o.length,a,!1,!1);var s=[Ty.CIRCLE,u];this.instructions.push(jy,s),this.hitDetectionInstructions.push(jy,s),void 0!==n.fillStyle&&(this.instructions.push(Py),this.hitDetectionInstructions.push(Py)),void 0!==n.strokeStyle&&(this.instructions.push(Ey),this.hitDetectionInstructions.push(Ey)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e){var n=this.state,r=n.fillStyle,i=n.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Ty.SET_FILL_STYLE,yo]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Ty.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,vo,0]);var o=t.getEnds(),a=t.getOrientedFlatCoordinates(),u=t.getStride();this.drawFlatCoordinatess_(a,0,o,u),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e){var n=this.state,r=n.fillStyle,i=n.strokeStyle;if(void 0!==r||void 0!==i){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([Ty.SET_FILL_STYLE,yo]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Ty.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,vo,0]);for(var o=t.getEndss(),a=t.getOrientedFlatCoordinates(),u=t.getStride(),s=0,l=0,c=o.length;l<c;++l)s=this.drawFlatCoordinatess_(a,s,o[l],u);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,n=0,r=e.length;n<r;++n)e[n]=Kr(e[n],t);return tp(np(a.prototype),"finish",this).call(this)}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}],n&&$y(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gy);const ip=rp;function op(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ap(t,e,n,r,i){for(var o=[],a=n,u=0,s=e.slice(n,2);u<t&&a+i<r;){var l=(w=s.slice(-2),S=2,function(t){if(Array.isArray(t))return t}(w)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(w,S)||function(t,e){if(t){if("string"==typeof t)return op(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?op(t,e):void 0}}(w,S)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=l[0],f=l[1],h=e[a+i],y=e[a+i+1],p=Math.sqrt((h-c)*(h-c)+(y-f)*(y-f));if((u+=p)>=t){var v=(t-u+p)/p,d=ke(c,h,v),g=ke(f,y,v);s.push(d,g),o.push(s),s=[d,g],u==t&&(a+=i),u=0}else if(u<t)s.push(e[a+i],e[a+i+1]),a+=i;else{var m=p-u,b=ke(c,h,m/p),_=ke(f,y,m/p);s.push(b,_),o.push(s),s=[b,_],u=0,a+=i}}var w,S;return u>0&&o.push(s),o}function up(t,e,n,r,i){var o,a,u,s,l,c,f,h,y,p=n,v=n,d=0,g=0,m=n;for(o=n;o<r;o+=i){var b=e[o],_=e[o+1];void 0!==s&&(h=b-s,y=_-l,u=Math.sqrt(h*h+y*y),void 0!==c&&(g+=a,Math.acos((c*h+f*y)/(a*u))>t&&(g>d&&(d=g,p=m,v=o),g=0,m=o-i)),a=u,c=h,f=y),s=b,l=_}return(g+=u)>d?[m,o]:[p,v]}function sp(t){return sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(t)}function lp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==sp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==sp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===sp(i)?i:String(i)),r)}var i}function cp(){return cp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=hp(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},cp.apply(this,arguments)}function fp(t,e){return fp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fp(t,e)}function hp(t){return hp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},hp(t)}var yp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},pp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fp(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=hp(r);if(i){var n=hp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===sp(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(i=o.call(this,t,e,n,r)).labels_=null,i.text_="",i.textOffsetX_=0,i.textOffsetY_=0,i.textRotateWithView_=void 0,i.textRotation_=0,i.textFillState_=null,i.fillStates={},i.fillStates[yo]={fillStyle:yo},i.textStrokeState_=null,i.strokeStates={},i.textState_={},i.textStates={},i.textKey_="",i.fillKey_="",i.strokeKey_="",i.declutterImageWithText_=void 0,i}return e=a,n=[{key:"finish",value:function(){var t=cp(hp(a.prototype),"finish",this).call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}},{key:"drawText",value:function(t,e){var n=this.textFillState_,r=this.textStrokeState_,i=this.textState_;if(""!==this.text_&&i&&(n||r)){var o=this.coordinates,a=o.length,u=t.getType(),s=null,l=t.getStride();if("line"!==i.placement||"LineString"!=u&&"MultiLineString"!=u&&"Polygon"!=u&&"MultiPolygon"!=u){var c=i.overflow?null:[];switch(u){case"Point":case"MultiPoint":s=t.getFlatCoordinates();break;case"LineString":s=t.getFlatMidpoint();break;case"Circle":s=t.getCenter();break;case"MultiLineString":s=t.getFlatMidpoints(),l=2;break;case"Polygon":s=t.getFlatInteriorPoint(),i.overflow||c.push(s[2]/this.resolution),l=3;break;case"MultiPolygon":var f=t.getFlatInteriorPoints();s=[];for(var h=0,y=f.length;h<y;h+=3)i.overflow||c.push(f[h+2]/this.resolution),s.push(f[h],f[h+1]);if(0===s.length)return;l=2}var p=this.appendFlatPointCoordinates(s,l);if(p===a)return;if(c&&(p-a)/2!=s.length/l){var v=a/2;c=c.filter((function(t,e){var n=o[2*(v+e)]===s[e*l]&&o[2*(v+e)+1]===s[e*l+1];return n||--v,n}))}this.saveTextStates_(),(i.backgroundFill||i.backgroundStroke)&&(this.setFillStrokeStyle(i.backgroundFill,i.backgroundStroke),i.backgroundFill&&this.updateFillStyle(this.state,this.createFill),i.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var d=i.padding;if(d!=wo&&(i.scale[0]<0||i.scale[1]<0)){var g=i.padding[0],m=i.padding[1],b=i.padding[2],_=i.padding[3];i.scale[0]<0&&(m=-m,_=-_),i.scale[1]<0&&(g=-g,b=-b),d=[g,m,b,_]}var w=this.pixelRatio;this.instructions.push([Ty.DRAW_IMAGE,a,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,d==wo?wo:d.map((function(t){return t*w})),!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]);var S=1/w,O=this.state.fillStyle;i.backgroundFill&&(this.state.fillStyle=yo,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([Ty.DRAW_IMAGE,a,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[S,S],NaN,void 0,this.declutterImageWithText_,d,!!i.backgroundFill,!!i.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?yo:this.fillKey_,this.textOffsetX_,this.textOffsetY_,c]),i.backgroundFill&&(this.state.fillStyle=O,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}else{if(!ue(this.getBufferedMaxExtent(),t.getExtent()))return;var x;if(s=t.getFlatCoordinates(),"LineString"==u)x=[s.length];else if("MultiLineString"==u)x=t.getEnds();else if("Polygon"==u)x=t.getEnds().slice(0,1);else if("MultiPolygon"==u){var k=t.getEndss();x=[];for(var P=0,E=k.length;P<E;++P)x.push(k[P][0])}this.beginGeometry(t,e);for(var j=i.repeat,R=j?void 0:i.textAlign,T=0,C=0,I=x.length;C<I;++C)for(var M,A=0,F=(M=j?ap(j*this.resolution,s,T,x[C],l):[s.slice(T,x[C])]).length;A<F;++A){var L=M[A],D=0,B=L.length;if(null==R){var G=up(i.maxAngle,L,0,L.length,2);D=G[0],B=G[1]}for(var z=D;z<B;z+=l)o.push(L[z],L[z+1]);var N=o.length;T=x[C],this.drawChars_(a,N),a=N}this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var i=this.textKey_;i in this.textStates||(this.textStates[i]={font:e.font,textAlign:e.textAlign||bo,justify:e.justify,textBaseline:e.textBaseline||_o,scale:e.scale});var o=this.fillKey_;n&&(o in this.fillStates||(this.fillStates[o]={fillStyle:n.fillStyle}))}},{key:"drawChars_",value:function(t,e){var n=this.textStrokeState_,r=this.textState_,i=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();var u=this.pixelRatio,s=yp[r.textBaseline],l=this.textOffsetY_*u,c=this.text_,f=n?n.lineWidth*Math.abs(r.scale[0])/2:0;this.instructions.push([Ty.DRAW_CHARS,t,e,s,r.overflow,a,r.maxAngle,u,l,i,f*u,c,o,1]),this.hitDetectionInstructions.push([Ty.DRAW_CHARS,t,e,s,r.overflow,a?yo:a,r.maxAngle,u,l,i,f*u,c,o,1/u])}},{key:"setTextStyle",value:function(t,e){var n,r,i;if(t){var o=t.getFill();o?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=gf(o.getColor()||yo)):(r=null,this.textFillState_=r);var a=t.getStroke();if(a){(i=this.textStrokeState_)||(i={},this.textStrokeState_=i);var u=a.getLineDash(),s=a.getLineDashOffset(),l=a.getWidth(),c=a.getMiterLimit();i.lineCap=a.getLineCap()||po,i.lineDash=u?u.slice():vo,i.lineDashOffset=void 0===s?0:s,i.lineJoin=a.getLineJoin()||go,i.lineWidth=void 0===l?1:l,i.miterLimit=void 0===c?10:c,i.strokeStyle=gf(a.getColor()||mo)}else i=null,this.textStrokeState_=i;n=this.textState_;var f=t.getFont()||ho;ko(f);var h=t.getScaleArray();n.overflow=t.getOverflow(),n.font=f,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||_o,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||wo,n.scale=void 0===h?[1,1]:h;var y=t.getOffsetX(),p=t.getOffsetY(),v=t.getRotateWithView(),d=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===y?0:y,this.textOffsetY_=void 0===p?0:p,this.textRotateWithView_=void 0!==v&&v,this.textRotation_=void 0===d?0:d,this.strokeKey_=i?("string"==typeof i.strokeStyle?i.strokeStyle:K(i.strokeStyle))+i.lineCap+i.lineDashOffset+"|"+i.lineWidth+i.lineJoin+i.miterLimit+"["+i.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+K(r.fillStyle):""}else this.text_="";this.declutterImageWithText_=e}}],n&&lp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(Gy);function vp(t){return vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vp(t)}function dp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==vp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==vp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===vp(i)?i:String(i)),r)}var i}var gp={Circle:ip,Default:Gy,Image:Ky,LineString:Jy,Polygon:ip,Text:pp};const mp=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}var e,n;return e=t,(n=[{key:"finish",value:function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var n=this.buildersByZIndex_[e];for(var r in n){var i=n[r].finish();t[e][r]=i}}return t}},{key:"getBuilder",value:function(t,e){var n=void 0!==t?t.toString():"0",r=this.buildersByZIndex_[n];void 0===r&&(r={},this.buildersByZIndex_[n]=r);var i=r[e];return void 0===i&&(i=new(0,gp[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),r[e]=i),i}}])&&dp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function bp(t,e,n,r,i,o,a,u,s,l,c,f){var h=t[e],y=t[e+1],p=0,v=0,d=0,g=0;function m(){p=h,v=y,h=t[e+=r],y=t[e+1],g+=d,d=Math.sqrt((h-p)*(h-p)+(y-v)*(y-v))}do{m()}while(e<n-r&&g+d<o);for(var b=0===d?0:(o-g)/d,_=ke(p,h,b),w=ke(v,y,b),S=e-r,O=g,x=o+u*s(l,i,c);e<n-r&&g+d<x;)m();var k,P=ke(p,h,b=0===d?0:(x-g)/d),E=ke(v,y,b);if(f){var j=[_,w,P,E];Pr(j,0,4,2,f,j,j),k=j[0]>j[2]}else k=_>P;var R,T=Math.PI,C=[],I=S+r===e;if(d=0,g=O,h=t[e=S],y=t[e+1],I){m(),R=Math.atan2(y-v,h-p),k&&(R+=R>0?-T:T);var M=(P+_)/2,A=(E+w)/2;return C[0]=[M,A,(x-o)/2,R,i],C}for(var F=0,L=(i=i.replace(/\n/g," ")).length;F<L;){m();var D=Math.atan2(y-v,h-p);if(k&&(D+=D>0?-T:T),void 0!==R){var B=D-R;if(B+=B>T?-2*T:B<-T?2*T:0,Math.abs(B)>a)return null}R=D;for(var G=F,z=0;F<L;++F){var N=u*s(l,i[k?L-F-1:F],c);if(e+r<n&&g+d<o+z+N/2)break;z+=N}if(F!==G){var W=k?i.substring(L-G,L-F):i.substring(G,F),X=ke(p,h,b=0===d?0:(o+z/2-g)/d),Y=ke(v,y,b);C.push([X,Y,z/2,D,W]),o+=z}}return C}function _p(t,e,n,r){for(var i=t[e],o=t[e+1],a=0,u=e+r;u<n;u+=r){var s=t[u],l=t[u+1];a+=Math.sqrt((s-i)*(s-i)+(l-o)*(l-o)),i=s,o=l}return a}function wp(t){return wp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(t)}function Sp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==wp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==wp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===wp(i)?i:String(i)),r)}var i}var Op=[1/0,1/0,-1/0,-1/0],xp=[],kp=[],Pp=[],Ep=[];function jp(t){return t[3].declutterBox}var Rp=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Tp(t,e){return"start"===e?e=Rp.test(t)?"right":"left":"end"===e&&(e=Rp.test(t)?"left":"right"),yp[e]}function Cp(t,e,n){return n>0&&t.push("\n",""),t.push(e,""),t}var Ip=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={}}var e,n;return e=t,n=[{key:"createLabel",value:function(t,e,n,r){var i=t+e+n+r;if(this.labels_[i])return this.labels_[i];var o=r?this.strokeStates[r]:null,a=n?this.fillStates[n]:null,u=this.textStates[e],s=this.pixelRatio,l=[u.scale[0]*s,u.scale[1]*s],c=Array.isArray(t),f=u.justify?yp[u.justify]:Tp(Array.isArray(t)?t[0]:t,u.textAlign||bo),h=r&&o.lineWidth?o.lineWidth:0,y=c?t:t.split("\n").reduce(Cp,[]),p=function(t,e){for(var n=[],r=[],i=[],o=0,a=0,u=0,s=0,l=0,c=e.length;l<=c;l+=2){var f=e[l];if("\n"!==f&&l!==c){var h=e[l+1]||t.font,y=jo(h,f);n.push(y),a+=y;var p=Po(h);r.push(p),s=Math.max(s,p)}else o=Math.max(o,a),i.push(a),a=0,u+=s}return{width:o,height:u,widths:n,heights:r,lineWidths:i}}(u,y),v=p.width,d=p.height,g=p.widths,m=p.heights,b=p.lineWidths,_=v+h,w=[],S=(_+2)*l[0],O=(d+h)*l[1],x={width:S<0?Math.floor(S):Math.ceil(S),height:O<0?Math.floor(O):Math.ceil(O),contextInstructions:w};1==l[0]&&1==l[1]||w.push("scale",l),r&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",h),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset)),n&&w.push("fillStyle",a.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");for(var k,P=.5-f,E=f*_+P*h,j=[],R=[],T=0,C=0,I=0,M=0,A=0,F=y.length;A<F;A+=2){var L=y[A];if("\n"!==L){var D=y[A+1]||u.font;D!==k&&(r&&j.push("font",D),n&&R.push("font",D),k=D),T=Math.max(T,m[I]);var B=[L,E+P*g[I]+f*(g[I]-b[M]),.5*(h+T)+C];E+=g[I],r&&j.push("strokeText",B),n&&R.push("fillText",B),++I}else C+=T,T=0,E=f*_+P*h,++M}return Array.prototype.push.apply(w,j),Array.prototype.push.apply(w,R),this.labels_[i]=x,x}},{key:"replayTextBackground_",value:function(t,e,n,r,i,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,i),t.lineTo.apply(t,e),o&&(this.alignFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}},{key:"calculateImageOrLabelDimensions_",value:function(t,e,n,r,i,o,a,u,s,l,c,f,h,y,p,v){var d,g=n-(a*=f[0]),m=r-(u*=f[1]),b=i+s>t?t-s:i,_=o+l>e?e-l:o,w=y[3]+b*f[0]+y[1],S=y[0]+_*f[1]+y[2],O=g-y[3],x=m-y[0];return(p||0!==c)&&(xp[0]=O,Ep[0]=O,xp[1]=x,kp[1]=x,kp[0]=O+w,Pp[0]=kp[0],Pp[1]=x+S,Ep[1]=Pp[1]),0!==c?(Pt(d=Et([1,0,0,1,0,0],n,r,1,1,c,-n,-r),xp),Pt(d,kp),Pt(d,Pp),Pt(d,Ep),zt(Math.min(xp[0],kp[0],Pp[0],Ep[0]),Math.min(xp[1],kp[1],Pp[1],Ep[1]),Math.max(xp[0],kp[0],Pp[0],Ep[0]),Math.max(xp[1],kp[1],Pp[1],Ep[1]),Op)):zt(Math.min(O,O+w),Math.min(x,x+S),Math.max(O,O+w),Math.max(x,x+S),Op),h&&(g=Math.round(g),m=Math.round(m)),{drawImageX:g,drawImageY:m,drawImageW:b,drawImageH:_,originX:s,originY:l,declutterBox:{minX:Op[0],minY:Op[1],maxX:Op[2],maxY:Op[3],value:v},canvasTransform:d,scale:f}}},{key:"replayImageOrLabel_",value:function(t,e,n,r,i,o,a){var u=!(!o&&!a),s=r.declutterBox,l=t.canvas,c=a?a[2]*r.scale[0]/2:0;return s.minX-c<=l.width/e&&s.maxX+c>=0&&s.minY-c<=l.height/e&&s.maxY+c>=0&&(u&&this.replayTextBackground_(t,xp,kp,Pp,Ep,o,a),function(t,e,n,r,i,o,a,u,s,l,c){t.save(),1!==n&&(t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(s,l),t.scale(c[0],c[1]),function(t,e){for(var n=t.contextInstructions,r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}(r,t)):c[0]<0||c[1]<0?(t.translate(s,l),t.scale(c[0],c[1]),t.drawImage(r,i,o,a,u,0,0,a,u)):t.drawImage(r,i,o,a,u,s,l,a*c[0],u*c[1]),t.restore()}(t,r.canvasTransform,i,n,r.originX,r.originY,r.drawImageW,r.drawImageH,r.drawImageX,r.drawImageY,r.scale)),!0}},{key:"fill_",value:function(t){if(this.alignFill_){var e=Pt(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}},{key:"drawLabelWithPointPlacement_",value:function(t,e,n,r){var i=this.textStates[e],o=this.createLabel(t,e,r,n),a=this.strokeStates[n],u=this.pixelRatio,s=Tp(Array.isArray(t)?t[0]:t,i.textAlign||bo),l=yp[i.textBaseline||_o],c=a&&a.lineWidth?a.lineWidth:0;return{label:o,anchorX:s*(o.width/u-2*i.scale[0])+2*(.5-s)*c,anchorY:l*o.height/u+2*(.5-l)*c}}},{key:"execute_",value:function(t,e,n,r,i,o,a,u){var s,l,c;this.pixelCoordinates_&&v(n,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=kr(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),c=n,(l=this.renderedTransform_)[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5]);for(var f,h,y,p,d,g,m,b,_,w,S,O,x,k,P,E,j=0,R=r.length,T=0,C=0,I=0,M=null,A=null,F=this.coordinateCache_,L=this.viewRotation_,D=Math.round(1e12*Math.atan2(-n[1],n[0]))/1e12,B={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:L},G=this.instructions!=r||this.overlaps?0:200;j<R;){var z=r[j];switch(z[0]){case Ty.BEGIN_GEOMETRY:x=z[1],E=z[3],x.getGeometry()?void 0===a||ue(a,E.getExtent())?++j:j=z[2]+1:j=z[2];break;case Ty.BEGIN_PATH:C>G&&(this.fill_(t),C=0),I>G&&(t.stroke(),I=0),C||I||(t.beginPath(),p=NaN,d=NaN),++j;break;case Ty.CIRCLE:var N=s[T=z[1]],W=s[T+1],X=s[T+2]-N,Y=s[T+3]-W,K=Math.sqrt(X*X+Y*Y);t.moveTo(N+K,W),t.arc(N,W,K,0,2*Math.PI,!0),++j;break;case Ty.CLOSE_PATH:t.closePath(),++j;break;case Ty.CUSTOM:T=z[1],f=z[2];var Z=z[3],V=z[4],U=6==z.length?z[5]:void 0;B.geometry=Z,B.feature=x,j in F||(F[j]=[]);var q=F[j];U?U(s,T,f,2,q):(q[0]=s[T],q[1]=s[T+1],q.length=2),V(q,B),++j;break;case Ty.DRAW_IMAGE:T=z[1],f=z[2],b=z[3],h=z[4],y=z[5];var H=z[6],J=z[7],Q=z[8],$=z[9],tt=z[10],et=z[11],nt=z[12],rt=z[13],it=z[14],ot=z[15];if(!b&&z.length>=20){_=z[19],w=z[20],S=z[21],O=z[22];var at=this.drawLabelWithPointPlacement_(_,w,S,O);b=at.label,z[3]=b;var ut=z[23];h=(at.anchorX-ut)*this.pixelRatio,z[4]=h;var st=z[24];y=(at.anchorY-st)*this.pixelRatio,z[5]=y,H=b.height,z[6]=H,rt=b.width,z[13]=rt}var lt=void 0;z.length>25&&(lt=z[25]);var ct=void 0,ft=void 0,ht=void 0;z.length>17?(ct=z[16],ft=z[17],ht=z[18]):(ct=wo,ft=!1,ht=!1),tt&&D?et+=L:tt||D||(et-=L);for(var yt=0;T<f;T+=2)if(!(lt&&lt[yt++]<rt/this.pixelRatio)){var pt=this.calculateImageOrLabelDimensions_(b.width,b.height,s[T],s[T+1],rt,H,h,y,Q,$,et,nt,i,ct,ft||ht,x),vt=[t,e,b,pt,J,ft?M:null,ht?A:null];if(u){if("none"===it)continue;if("obstacle"===it){u.insert(pt.declutterBox);continue}var dt=void 0,gt=void 0;if(ot){var mt=f-T;if(!ot[mt]){ot[mt]=vt;continue}if(dt=ot[mt],delete ot[mt],gt=jp(dt),u.collides(gt))continue}if(u.collides(pt.declutterBox))continue;dt&&(u.insert(gt),this.replayImageOrLabel_.apply(this,dt)),u.insert(pt.declutterBox)}this.replayImageOrLabel_.apply(this,vt)}++j;break;case Ty.DRAW_CHARS:var bt=z[1],_t=z[2],wt=z[3],St=z[4];O=z[5];var Ot=z[6],xt=z[7],kt=z[8];S=z[9];var Pt=z[10];_=z[11],w=z[12];var Et=[z[13],z[13]],jt=this.textStates[w],Rt=jt.font,Tt=[jt.scale[0]*xt,jt.scale[1]*xt],Ct=void 0;Rt in this.widths_?Ct=this.widths_[Rt]:(Ct={},this.widths_[Rt]=Ct);var It=_p(s,bt,_t,2),Mt=Math.abs(Tt[0])*Ro(Rt,_,Ct);if(St||Mt<=It){var At=bp(s,bt,_t,2,_,(It-Mt)*Tp(_,this.textStates[w].textAlign),Ot,Math.abs(Tt[0]),Ro,Rt,Ct,D?0:this.viewRotation_);t:if(At){var Ft=[],Lt=void 0,Dt=void 0,Bt=void 0,Gt=void 0,zt=void 0;if(S)for(Lt=0,Dt=At.length;Lt<Dt;++Lt){Bt=(zt=At[Lt])[4],Gt=this.createLabel(Bt,w,"",S),h=zt[2]+(Tt[0]<0?-Pt:Pt),y=wt*Gt.height+2*(.5-wt)*Pt*Tt[1]/Tt[0]-kt;var Nt=this.calculateImageOrLabelDimensions_(Gt.width,Gt.height,zt[0],zt[1],Gt.width,Gt.height,h,y,0,0,zt[3],Et,!1,wo,!1,x);if(u&&u.collides(Nt.declutterBox))break t;Ft.push([t,e,Gt,Nt,1,null,null])}if(O)for(Lt=0,Dt=At.length;Lt<Dt;++Lt){Bt=(zt=At[Lt])[4],Gt=this.createLabel(Bt,w,O,""),h=zt[2],y=wt*Gt.height-kt;var Wt=this.calculateImageOrLabelDimensions_(Gt.width,Gt.height,zt[0],zt[1],Gt.width,Gt.height,h,y,0,0,zt[3],Et,!1,wo,!1,x);if(u&&u.collides(Wt.declutterBox))break t;Ft.push([t,e,Gt,Wt,1,null,null])}u&&u.load(Ft.map(jp));for(var Xt=0,Yt=Ft.length;Xt<Yt;++Xt)this.replayImageOrLabel_.apply(this,Ft[Xt])}}++j;break;case Ty.END_GEOMETRY:if(void 0!==o){var Kt=o(x=z[1],E);if(Kt)return Kt}++j;break;case Ty.FILL:G?C++:this.fill_(t),++j;break;case Ty.MOVE_TO_LINE_TO:for(T=z[1],f=z[2],k=s[T],m=(P=s[T+1])+.5|0,(g=k+.5|0)===p&&m===d||(t.moveTo(k,P),p=g,d=m),T+=2;T<f;T+=2)g=(k=s[T])+.5|0,m=(P=s[T+1])+.5|0,T!=f-2&&g===p&&m===d||(t.lineTo(k,P),p=g,d=m);++j;break;case Ty.SET_FILL_STYLE:M=z,this.alignFill_=z[2],C&&(this.fill_(t),C=0,I&&(t.stroke(),I=0)),t.fillStyle=z[1],++j;break;case Ty.SET_STROKE_STYLE:A=z,I&&(t.stroke(),I=0),this.setStrokeStyle_(t,z),++j;break;case Ty.STROKE:G?I++:t.stroke(),++j;break;default:++j}}C&&this.fill_(t),I&&t.stroke()}},{key:"execute",value:function(t,e,n,r,i,o){this.viewRotation_=r,this.execute_(t,e,n,this.instructions,i,void 0,void 0,o)}},{key:"executeHitDetection",value:function(t,e,n,r,i){return this.viewRotation_=n,this.execute_(t,1,e,this.hitDetectionInstructions,!0,r,i)}}],n&&Sp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();const Mp=Ip;function Ap(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fp(t){return Fp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fp(t)}function Lp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Fp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Fp(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Fp(i)?i:String(i)),r)}var i}var Dp=["Polygon","Circle","LineString","Image","Text","Default"],Bp=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=a,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(o)}var e,n;return e=t,n=[{key:"clip",value:function(t,e){var n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}},{key:"createExecutors_",value:function(t){for(var e in t){var n=this.executorsByZIndex_[e];void 0===n&&(n={},this.executorsByZIndex_[e]=n);var r=t[e];for(var i in r){var o=r[i];n[i]=new Mp(this.resolution_,this.pixelRatio_,this.overlaps_,o)}}}},{key:"hasExecutors",value:function(t){for(var e in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[e],r=0,i=t.length;r<i;++r)if(t[r]in n)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i,o){var a=2*(r=Math.round(r))+1,u=Et(this.hitDetectionTransform_,r+.5,r+.5,1/e,-1/e,-n,-t[0],-t[1]),s=!this.hitDetectionContext_;s&&(this.hitDetectionContext_=ao(a,a,void 0,{willReadFrequently:!0}));var l,c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):s||c.clearRect(0,0,a,a),void 0!==this.renderBuffer_&&(Kt(l=[1/0,1/0,-1/0,-1/0],t),Mt(l,e*(this.renderBuffer_+r),l));var h,y=function(t){if(void 0!==Gp[t])return Gp[t];for(var e=2*t+1,n=t*t,r=new Array(n+1),i=0;i<=t;++i)for(var o=0;o<=t;++o){var a=i*i+o*o;if(a>n)break;var u=r[a];u||(u=[],r[a]=u),u.push(4*((t+i)*e+(t+o))+3),i>0&&u.push(4*((t-i)*e+(t+o))+3),o>0&&(u.push(4*((t+i)*e+(t-o))+3),i>0&&u.push(4*((t-i)*e+(t-o))+3))}for(var s=[],l=0,c=r.length;l<c;++l)r[l]&&s.push.apply(s,function(t){if(Array.isArray(t))return Ap(t)}(f=r[l])||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(f)||function(t,e){if(t){if("string"==typeof t)return Ap(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ap(t,e):void 0}}(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var f;return Gp[t]=s,s}(r);function p(t,e){for(var n=c.getImageData(0,0,a,a).data,u=0,s=y.length;u<s;u++)if(n[y[u]]>0){if(!o||"Image"!==h&&"Text"!==h||o.includes(t)){var l=(y[u]-3)/4,f=r-l%a,p=r-(l/a|0),v=i(t,e,f*f+p*p);if(v)return v}c.clearRect(0,0,a,a);break}}var v,d,g,m,b,_=Object.keys(this.executorsByZIndex_).map(Number);for(_.sort(f),v=_.length-1;v>=0;--v){var w=_[v].toString();for(g=this.executorsByZIndex_[w],d=Dp.length-1;d>=0;--d)if(void 0!==(m=g[h=Dp[d]])&&(b=m.executeHitDetection(c,u,n,p,l)))return b}}},{key:"getClipCoords",value:function(t){var e=this.maxExtent_;if(!e)return null;var n=e[0],r=e[1],i=e[2],o=e[3],a=[n,r,n,o,i,o,i,r];return kr(a,0,8,2,t,a),a}},{key:"isEmpty",value:function(){return w(this.executorsByZIndex_)}},{key:"execute",value:function(t,e,n,r,i,o,a){var u,s,l,c,h,y,p=Object.keys(this.executorsByZIndex_).map(Number);for(p.sort(f),this.maxExtent_&&(t.save(),this.clip(t,n)),o=o||Dp,a&&p.reverse(),u=0,s=p.length;u<s;++u){var v=p[u].toString();for(h=this.executorsByZIndex_[v],l=0,c=o.length;l<c;++l)void 0!==(y=h[o[l]])&&y.execute(t,e,n,r,i,a)}this.maxExtent_&&t.restore()}}],n&&Lp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Gp={};const zp=Bp;function Np(t){return Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(t)}function Wp(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Np(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Np(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Np(i)?i:String(i)),r)}var i}function Xp(t,e){return Xp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Xp(t,e)}function Yp(t){return Yp=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yp(t)}var Kp=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xp(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Yp(r);if(i){var n=Yp(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Np(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,n,r,i,u,s){var l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(l=o.call(this)).context_=t,l.pixelRatio_=e,l.extent_=n,l.transform_=r,l.transformRotation_=r?Pe(Math.atan2(r[1],r[0]),10):0,l.viewRotation_=i,l.squaredTolerance_=u,l.userTransform_=s,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=[0,0],l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=[0,0],l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=[1,0,0,1,0,0],l}return e=a,n=[{key:"drawImages_",value:function(t,e,n,r){if(this.image_){var i=kr(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,u=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=u*this.imageOpacity_);var s=this.imageRotation_;0===this.transformRotation_&&(s-=this.viewRotation_),this.imageRotateWithView_&&(s+=this.viewRotation_);for(var l=0,c=i.length;l<c;l+=2){var f=i[l]-this.imageAnchorX_,h=i[l+1]-this.imageAnchorY_;if(0!==s||1!=this.imageScale_[0]||1!=this.imageScale_[1]){var y=f+this.imageAnchorX_,p=h+this.imageAnchorY_;Et(a,y,p,1,1,s,-y,-p),o.save(),o.transform.apply(o,a),o.translate(y,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,f,h,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(o.globalAlpha=u)}}},{key:"drawText_",value:function(t,e,n,r){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var i=kr(t,e,n,r,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.textRotation_;for(0===this.transformRotation_&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=r){var u=i[e]+this.textOffsetX_,s=i[e+1]+this.textOffsetY_;0!==a||1!=this.textScale_[0]||1!=this.textScale_[1]?(o.save(),o.translate(u-this.textOffsetX_,s-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,u,s),this.textFillState_&&o.fillText(this.text_,u,s))}}}},{key:"moveToLineTo_",value:function(t,e,n,r,i){var o=this.context_,a=kr(t,e,n,r,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var u=a.length;i&&(u-=2);for(var s=2;s<u;s+=2)o.lineTo(a[s],a[s+1]);return i&&o.closePath(),n}},{key:"drawRings_",value:function(t,e,n,r){for(var i=0,o=n.length;i<o;++i)e=this.moveToLineTo_(t,e,n[i],r,!0);return e}},{key:"drawCircle",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ue(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,n){var r=t.getFlatCoordinates();if(!r)return null;var i=t.getStride();return kr(r,0,r.length,i,e,n)}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],r=e[3]-e[1],i=Math.sqrt(n*n+r*r),o=this.context_;o.beginPath(),o.arc(e[0],e[1],i,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),n=0,r=e.length;n<r;++n)this.drawGeometry(e[n])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ue(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var r=t.getFlatMidpoint();this.drawText_(r,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(ue(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,r=t.getFlatCoordinates(),i=0,o=t.getEnds(),a=t.getStride();n.beginPath();for(var u=0,s=o.length;u<s;++u)i=this.moveToLineTo_(r,i,o[u],a,!1);n.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ue(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ue(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getOrientedFlatCoordinates(),r=0,i=t.getEndss(),o=t.getStride();e.beginPath();for(var a=0,u=i.length;a<u;++a){var s=i[a];r=this.drawRings_(n,r,s,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),v(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,n=this.contextTextState_,r=t.textAlign?t.textAlign:bo;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=r&&(n.textAlign=r,e.textAlign=r),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=r,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:r,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){var n=this;if(t){var r=t.getColor();this.fillState_={fillStyle:gf(r||yo)}}else this.fillState_=null;if(e){var i=e.getColor(),o=e.getLineCap(),a=e.getLineDash(),u=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),f=a||vo;this.strokeState_={lineCap:void 0!==o?o:po,lineDash:1===this.pixelRatio_?f:f.map((function(t){return t*n.pixelRatio_})),lineDashOffset:(u||0)*this.pixelRatio_,lineJoin:void 0!==s?s:go,lineWidth:(void 0!==l?l:1)*this.pixelRatio_,miterLimit:void 0!==c?c:10,strokeStyle:gf(i||mo)}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){var e;if(t&&(e=t.getSize())){var n=t.getPixelRatio(this.pixelRatio_),r=t.getAnchor(),i=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=r[0]*n,this.imageAnchorY_=r[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=i[0],this.imageOriginY_=i[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();var o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/n,o[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}else this.image_=null}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var n=e.getColor();this.textFillState_={fillStyle:gf(n||yo)}}else this.textFillState_=null;var r=t.getStroke();if(r){var i=r.getColor(),o=r.getLineCap(),a=r.getLineDash(),u=r.getLineDashOffset(),s=r.getLineJoin(),l=r.getWidth(),c=r.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:po,lineDash:a||vo,lineDashOffset:u||0,lineJoin:void 0!==s?s:go,lineWidth:void 0!==l?l:1,miterLimit:void 0!==c?c:10,strokeStyle:gf(i||mo)}}else this.textStrokeState_=null;var f=t.getFont(),h=t.getOffsetX(),y=t.getOffsetY(),p=t.getRotateWithView(),v=t.getRotation(),d=t.getScaleArray(),g=t.getText(),m=t.getTextAlign(),b=t.getTextBaseline();this.textState_={font:void 0!==f?f:ho,textAlign:void 0!==m?m:bo,textBaseline:void 0!==b?b:_o},this.text_=void 0!==g?Array.isArray(g)?g.reduce((function(t,e,n){return t+(n%2?" ":e)}),""):g:"",this.textOffsetX_=void 0!==h?this.pixelRatio_*h:0,this.textOffsetY_=void 0!==y?this.pixelRatio_*y:0,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0!==v?v:0,this.textScale_=[this.pixelRatio_*d[0],this.pixelRatio_*d[1]]}else this.text_=""}}],n&&Wp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(My);const Zp=Kp;var Vp=.5,Up={Point:function(t,e,n,r,i){var o,a=n.getImage(),u=n.getText();if(a){if(2!=a.getImageState())return;var s=t;if(i){var l=a.getDeclutterMode();if("none"!==l)if(s=i,"obstacle"===l){var c=t.getBuilder(n.getZIndex(),"Image");c.setImageStyle(a,o),c.drawPoint(e,r)}else u&&u.getText()&&(o={})}var f=s.getBuilder(n.getZIndex(),"Image");f.setImageStyle(a,o),f.drawPoint(e,r)}if(u&&u.getText()){var h=t;i&&(h=i);var y=h.getBuilder(n.getZIndex(),"Text");y.setTextStyle(u,o),y.drawText(e,r)}},LineString:function(t,e,n,r,i){var o=n.getStroke();if(o){var a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawLineString(e,r)}var u=n.getText();if(u&&u.getText()){var s=(i||t).getBuilder(n.getZIndex(),"Text");s.setTextStyle(u),s.drawText(e,r)}},Polygon:function(t,e,n,r,i){var o=n.getFill(),a=n.getStroke();if(o||a){var u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(o,a),u.drawPolygon(e,r)}var s=n.getText();if(s&&s.getText()){var l=(i||t).getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,r)}},MultiPoint:function(t,e,n,r,i){var o,a=n.getImage(),u=n.getText();if(a){if(2!=a.getImageState())return;var s=t;if(i){var l=a.getDeclutterMode();if("none"!==l)if(s=i,"obstacle"===l){var c=t.getBuilder(n.getZIndex(),"Image");c.setImageStyle(a,o),c.drawMultiPoint(e,r)}else u&&u.getText()&&(o={})}var f=s.getBuilder(n.getZIndex(),"Image");f.setImageStyle(a,o),f.drawMultiPoint(e,r)}if(u&&u.getText()){var h=t;i&&(h=i);var y=h.getBuilder(n.getZIndex(),"Text");y.setTextStyle(u,o),y.drawText(e,r)}},MultiLineString:function(t,e,n,r,i){var o=n.getStroke();if(o){var a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,o),a.drawMultiLineString(e,r)}var u=n.getText();if(u&&u.getText()){var s=(i||t).getBuilder(n.getZIndex(),"Text");s.setTextStyle(u),s.drawText(e,r)}},MultiPolygon:function(t,e,n,r,i){var o=n.getFill(),a=n.getStroke();if(a||o){var u=t.getBuilder(n.getZIndex(),"Polygon");u.setFillStrokeStyle(o,a),u.drawMultiPolygon(e,r)}var s=n.getText();if(s&&s.getText()){var l=(i||t).getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,r)}},GeometryCollection:function(t,e,n,r,i){var o,a,u=e.getGeometriesArray();for(o=0,a=u.length;o<a;++o)(0,Up[u[o].getType()])(t,u[o],n,r,i)},Circle:function(t,e,n,r,i){var o=n.getFill(),a=n.getStroke();if(o||a){var u=t.getBuilder(n.getZIndex(),"Circle");u.setFillStrokeStyle(o,a),u.drawCircle(e,r)}var s=n.getText();if(s&&s.getText()){var l=(i||t).getBuilder(n.getZIndex(),"Text");l.setTextStyle(s),l.drawText(e,r)}}};function qp(t,e){return parseInt(K(t),10)-parseInt(K(e),10)}function Hp(t,e){return.5*t/e}function Jp(t,e,n,r,i,o,a){var u=!1,s=n.getImage();if(s){var l=s.getImageState();2==l||3==l?s.unlistenImageChange(i):(0==l&&s.load(),s.listenImageChange(i),u=!0)}return function(t,e,n,r,i,o){var a=n.getGeometryFunction()(e);if(a){var u=a.simplifyTransformed(r,i);n.getRenderer()?Qp(t,u,n,e):(0,Up[u.getType()])(t,u,n,e,o)}}(t,e,n,r,o,a),u}function Qp(t,e,n,r){if("GeometryCollection"!=e.getType())t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer());else for(var i=e.getGeometries(),o=0,a=i.length;o<a;++o)Qp(t,i[o],n,r)}function $p(t){return $p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(t)}function tv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==$p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===$p(i)?i:String(i)),r)}var i}function ev(t,e){return ev=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ev(t,e)}function nv(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function rv(t){return rv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},rv(t)}var iv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ev(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=rv(r);if(i){var n=rv(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===$p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return nv(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=o.call(this,t)).boundHandleStyleImageChange_=e.handleStyleImageChange_.bind(nv(e)),e.animatingOrInteracting_,e.hitDetectionImageData_=null,e.renderedFeatures_=null,e.renderedRevision_=-1,e.renderedResolution_=NaN,e.renderedExtent_=[1/0,1/0,-1/0,-1/0],e.wrappedRenderedExtent_=[1/0,1/0,-1/0,-1/0],e.renderedRotation_,e.renderedCenter_=null,e.renderedProjection_=null,e.renderedRenderOrder_=null,e.replayGroup_=null,e.replayGroupChanged=!0,e.declutterExecutorGroup=null,e.clipping=!0,e.compositionContext_=null,e.opacity_=1,e}return e=a,n=[{key:"renderWorlds",value:function(t,e,n){var r=e.extent,i=e.viewState,o=i.center,a=i.resolution,u=i.projection,s=i.rotation,l=u.getExtent(),c=this.getLayer().getSource(),f=e.pixelRatio,h=e.viewHints,y=!(h[0]||h[1]),p=this.compositionContext_,v=Math.round(e.size[0]*f),d=Math.round(e.size[1]*f),g=c.getWrapX()&&u.canWrapX(),m=g?ae(l):null,b=g?Math.ceil((r[2]-l[2])/m)+1:1,_=g?Math.floor((r[0]-l[0])/m):0;do{var w=this.getRenderTransform(o,a,s,f,v,d,_*m);t.execute(p,1,w,s,y,void 0,n)}while(++_<b)}},{key:"setupCompositionContext_",value:function(){if(1!==this.opacity_){var t=ao(this.context.canvas.width,this.context.canvas.height,Hc);this.compositionContext_=t}else this.compositionContext_=this.context}},{key:"releaseCompositionContext_",value:function(){if(1!==this.opacity_){var t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,uo(this.compositionContext_),Hc.push(this.compositionContext_.canvas),this.compositionContext_=null}}},{key:"renderDeclutter",value:function(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}},{key:"renderFrame",value:function(t,e){var n=t.pixelRatio,r=t.layerStatesArray[t.layerIndex];!function(t,e,n){!function(t,e,n,r,i,o,a){t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a}(t,e,0,0,n,0,0)}(this.pixelTransform,1/n,1/n),jt(this.inversePixelTransform,this.pixelTransform);var i=Rt(this.pixelTransform);this.useContainer(e,i,this.getBackground(t));var o=this.context,a=o.canvas,u=this.replayGroup_,s=this.declutterExecutorGroup,l=u&&!u.isEmpty()||s&&!s.isEmpty();if(!l&&!this.getLayer().hasListener(an)&&!this.getLayer().hasListener(un))return null;var c=Math.round(t.size[0]*n),f=Math.round(t.size[1]*n);a.width!=c||a.height!=f?(a.width=c,a.height=f,a.style.transform!==i&&(a.style.transform=i)):this.containerReused||o.clearRect(0,0,c,f),this.preRender(o,t);var h=t.viewState,y=h.projection;this.opacity_=r.opacity,this.setupCompositionContext_();var p=!1;if(l&&r.extent&&this.clipping){var v=hr(r.extent,y);(p=(l=ue(v,t.extent))&&!Dt(v,t.extent))&&this.clipUnrotated(this.compositionContext_,t,v)}return l&&this.renderWorlds(u,t),p&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(o,t),this.renderedRotation_!==h.rotation&&(this.renderedRotation_=h.rotation,this.hitDetectionImageData_=null),this.container}},{key:"getFeatures",value:function(t){var e=this;return new Promise((function(n){if(!e.hitDetectionImageData_&&!e.animatingOrInteracting_){var r=[e.context.canvas.width,e.context.canvas.height];Pt(e.pixelTransform,r);var i=e.renderedCenter_,o=e.renderedResolution_,a=e.renderedRotation_,u=e.renderedProjection_,s=e.wrappedRenderedExtent_,l=e.getLayer(),c=[],h=r[0]*Vp,y=r[1]*Vp;c.push(e.getRenderTransform(i,o,a,Vp,h,y,0).slice());var p=l.getSource(),v=u.getExtent();if(p.getWrapX()&&u.canWrapX()&&!Dt(v,s)){for(var d,g=s[0],m=ae(v),b=0;g<v[0];)d=m*--b,c.push(e.getRenderTransform(i,o,a,Vp,h,y,d).slice()),g+=m;for(b=0,g=s[2];g>v[2];)d=m*++b,c.push(e.getRenderTransform(i,o,a,Vp,h,y,d).slice()),g-=m}e.hitDetectionImageData_=function(t,e,n,r,i,o,a){var u=ao(t[0]*Vp,t[1]*Vp);u.imageSmoothingEnabled=!1;for(var s=u.canvas,l=new Zp(u,Vp,i,null,a),c=n.length,h=Math.floor(16777215/c),y={},p=1;p<=c;++p){var v=n[p-1],d=v.getStyleFunction()||r;if(d){var g=d(v,o);if(g){Array.isArray(g)||(g=[g]);for(var m=(p*h).toString(16).padStart(7,"#00000"),b=0,_=g.length;b<_;++b){var w=g[b],S=w.getGeometryFunction()(v);if(S&&ue(i,S.getExtent())){var O=w.clone(),x=O.getFill();x&&x.setColor(m);var k=O.getStroke();k&&(k.setColor(m),k.setLineDash(null)),O.setText(void 0);var P=w.getImage();if(P){var E=P.getImageSize();if(!E)continue;var j=ao(E[0],E[1],void 0,{alpha:!1}),R=j.canvas;j.fillStyle=m,j.fillRect(0,0,R.width,R.height),O.setImage(new eh({img:R,anchor:P.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:P.getOrigin(),opacity:1,size:P.getSize(),scale:P.getScale(),rotation:P.getRotation(),rotateWithView:P.getRotateWithView()}))}var T=O.getZIndex()||0,C=y[T];C||(C={},y[T]=C,C.Polygon=[],C.Circle=[],C.LineString=[],C.Point=[]);var I=S.getType();if("GeometryCollection"===I)for(var M=S.getGeometriesArrayRecursive(),A=0,F=M.length;A<F;++A){var L=M[A];C[L.getType().replace("Multi","")].push(L,O)}else C[I.replace("Multi","")].push(S,O)}}}}}for(var D=Object.keys(y).map(Number).sort(f),B=0,G=D.length;B<G;++B){var z=y[D[B]];for(var N in z)for(var W=z[N],X=0,Y=W.length;X<Y;X+=2){l.setStyle(W[X+1]);for(var K=0,Z=e.length;K<Z;++K)l.setTransform(e[K]),l.drawGeometry(W[X])}}return u.getImageData(0,0,s.width,s.height)}(r,c,e.renderedFeatures_,l.getStyleFunction(),s,o,a)}n(function(t,e,n){var r=[];if(n){var i=Math.floor(Math.round(t[0])*Vp),o=Math.floor(Math.round(t[1])*Vp),a=4*(_e(i,0,n.width-1)+_e(o,0,n.height-1)*n.width),u=n.data[a],s=n.data[a+1],l=n.data[a+2]+256*(s+256*u),c=Math.floor(16777215/e.length);l&&l%c==0&&r.push(e[l/c-1])}return r}(t,e.renderedFeatures_,e.hitDetectionImageData_))}))}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,r,i){var o=this;if(this.replayGroup_){var a,u=e.viewState.resolution,s=e.viewState.rotation,l=this.getLayer(),c={},f=function(t,e,n){var o=K(t),a=c[o];if(a){if(!0!==a&&n<a.distanceSq){if(0===n)return c[o]=!0,i.splice(i.lastIndexOf(a),1),r(t,l,e);a.geometry=e,a.distanceSq=n}}else{if(0===n)return c[o]=!0,r(t,l,e);i.push(c[o]={feature:t,layer:l,geometry:e,distanceSq:n,callback:r})}},h=[this.replayGroup_];return this.declutterExecutorGroup&&h.push(this.declutterExecutorGroup),h.some((function(r){return a=r.forEachFeatureAtCoordinate(t,u,s,n,f,r===o.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map((function(t){return t.value})):null)})),a}}},{key:"handleFontsChanged",value:function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}},{key:"handleStyleImageChange_",value:function(t){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(t){var e=this,n=this.getLayer(),r=n.getSource();if(!r)return!1;var i=t.viewHints[0],o=t.viewHints[1],a=n.getUpdateWhileAnimating(),u=n.getUpdateWhileInteracting();if(this.ready&&!a&&i||!u&&o)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=t.extent,l=t.viewState,c=l.projection,f=l.resolution,h=t.pixelRatio,y=n.getRevision(),p=n.getRenderBuffer(),d=n.getRenderOrder();void 0===d&&(d=qp);var g=l.center.slice(),m=Mt(s,p*f),b=m.slice(),_=[m.slice()],w=c.getExtent();if(r.getWrapX()&&c.canWrapX()&&!Dt(w,t.extent)){var S=ae(w),O=Math.max(ae(m)/2,S);m[0]=w[0]-O,m[2]=w[2]+O,Gn(g,c);var x=le(_[0],c);x[0]<w[0]&&x[2]<w[2]?_.push([x[0]+S,x[1],x[2]+S,x[3]]):x[0]>w[0]&&x[2]>w[2]&&_.push([x[0]-S,x[1],x[2]-S,x[3]])}if(this.ready&&this.renderedResolution_==f&&this.renderedRevision_==y&&this.renderedRenderOrder_==d&&Dt(this.wrappedRenderedExtent_,m))return v(this.renderedExtent_,b)||(this.hitDetectionImageData_=null,this.renderedExtent_=b),this.renderedCenter_=g,this.replayGroupChanged=!1,!0;this.replayGroup_=null;var k,P=new mp(Hp(f,h),m,f,h);this.getLayer().getDeclutter()&&(k=new mp(Hp(f,h),m,f,h));var E,j=sr();if(j){for(var R=0,T=_.length;R<T;++R){var C=fr(_[R],c);r.loadFeatures(C,yr(f,c),j)}E=tr(j,c)}else for(var I=0,M=_.length;I<M;++I)r.loadFeatures(_[I],f,c);var A=function(t,e){var n=Hp(t,e);return n*n}(f,h),F=!0,L=function(t){var r,i=t.getStyleFunction()||n.getStyleFunction();if(i&&(r=i(t,f)),r){var o=e.renderFeature(t,A,r,P,E,k);F=F&&!o}},D=fr(m,c),B=r.getFeaturesInExtent(D);d&&B.sort(d);for(var G=0,z=B.length;G<z;++G)L(B[G]);this.renderedFeatures_=B,this.ready=F;var N=P.finish(),W=new zp(m,f,h,r.getOverlaps(),N,n.getRenderBuffer());return k&&(this.declutterExecutorGroup=new zp(m,f,h,r.getOverlaps(),k.finish(),n.getRenderBuffer())),this.renderedResolution_=f,this.renderedRevision_=y,this.renderedRenderOrder_=d,this.renderedExtent_=b,this.wrappedRenderedExtent_=m,this.renderedCenter_=g,this.renderedProjection_=c,this.replayGroup_=W,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(t,e,n,r,i,o){if(!n)return!1;var a=!1;if(Array.isArray(n))for(var u=0,s=n.length;u<s;++u)a=Jp(r,t,n[u],e,this.boundHandleStyleImageChange_,i,o)||a;else a=Jp(r,t,n,e,this.boundHandleStyleImageChange_,i,o);return a}}],n&&tv(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}($c);const ov=iv;function av(t){return av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},av(t)}function uv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==av(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==av(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===av(i)?i:String(i)),r)}var i}function sv(t,e){return sv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sv(t,e)}function lv(t){return lv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lv(t)}const cv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sv(t,e)}(a,t);var e,n,r,i,o=(r=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=lv(r);if(i){var n=lv(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===av(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),o.call(this,t)}return e=a,(n=[{key:"createRenderer",value:function(){return new ov(this)}}])&&uv(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(xy);function fv(t){return fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fv(t)}function hv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==fv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==fv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===fv(i)?i:String(i)),r)}var i}const yv=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rbush_=new yf(e),this.items_={}}var e,n;return e=t,(n=[{key:"insert",value:function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[K(e)]=n}},{key:"load",value:function(t,e){for(var n=new Array(e.length),r=0,i=e.length;r<i;r++){var o=t[r],a=e[r],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[r]=u,this.items_[K(a)]=u}this.rbush_.load(n)}},{key:"remove",value:function(t){var e=K(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}},{key:"update",value:function(t,e){var n=this.items_[K(e)];Yt([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))}},{key:"getAll",value:function(){return this.rbush_.all().map((function(t){return t.value}))}},{key:"getInExtent",value:function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map((function(t){return t.value}))}},{key:"forEach",value:function(t){return this.forEach_(this.getAll(),t)}},{key:"forEachInExtent",value:function(t,e){return this.forEach_(this.getInExtent(t),e)}},{key:"forEach_",value:function(t,e){for(var n,r=0,i=t.length;r<i;r++)if(n=e(t[r]))return n;return n}},{key:"isEmpty",value:function(){return w(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(t){var e=this.rbush_.toJSON();return zt(e.minX,e.minY,e.maxX,e.maxY,t)}},{key:"concat",value:function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]}}])&&hv(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function pv(t,e,n,r,i,o,a){var u,s,l=(n-e)/r;if(1===l)u=e;else if(2===l)u=e,s=i;else if(0!==l){for(var c=t[e],h=t[e+1],y=0,p=[0],v=e+r;v<n;v+=r){var d=t[v],g=t[v+1];y+=Math.sqrt((d-c)*(d-c)+(g-h)*(g-h)),p.push(y),c=d,h=g}var m=i*y,b=function(t,e,n){var r,i;n=n||f;for(var o=0,a=t.length,u=!1;o<a;)(i=+n(t[r=o+(a-o>>1)],e))<0?o=r+1:(a=r,u=!i);return u?o:~o}(p,m);b<0?(s=(m-p[-b-2])/(p[-b-1]-p[-b-2]),u=e+(-b-2)*r):u=e+b*r}a=a>1?a:2,o=o||new Array(a);for(var _=0;_<a;++_)o[_]=void 0===u?NaN:void 0===s?t[u+_]:ke(t[u+_],t[u+r+_],s);return o}function vv(t){return vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vv(t)}function dv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==vv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==vv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===vv(i)?i:String(i)),r)}var i}var gv=[1,0,0,1,0,0],mv=function(){function t(e,n,r,i,o,a){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.styleFunction,this.extent_,this.id_=a,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r,this.properties_=o,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}var e,n;return e=t,n=[{key:"get",value:function(t){return this.properties_[t]}},{key:"getExtent",value:function(){return this.extent_||(this.extent_="Point"===this.type_?Wt(this.flatCoordinates_):Xt(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}},{key:"getFlatInteriorPoint",value:function(){if(!this.flatInteriorPoints_){var t=Qt(this.getExtent());this.flatInteriorPoints_=yi(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}},{key:"getFlatInteriorPoints",value:function(){if(!this.flatInteriorPoints_){var t=function(t,e){for(var n,r=[],i=0,o=0,a=0,u=e.length;a<u;++a){var s=e[a],l=gi(t,i,s,2);if(void 0===n&&(n=l),l===n)r.push(e.slice(o,a+1));else{if(0===r.length)continue;r[r.length-1].push(e[o])}o=a+1,i=s}return r}(this.flatCoordinates_,this.ends_),e=function(t,e,n,r){for(var i=[],o=[1/0,1/0,-1/0,-1/0],a=0,u=n.length;a<u;++a){var s=n[a];o=Xt(t,e,s[0],2),i.push((o[0]+o[2])/2,(o[1]+o[3])/2),e=s[s.length-1]}return i}(this.flatCoordinates_,0,t);this.flatInteriorPoints_=function(t,e,n,r,i){for(var o=[],a=0,u=n.length;a<u;++a){var s=n[a];o=yi(t,e,s,2,i,2*a,o),e=s[s.length-1]}return o}(this.flatCoordinates_,0,t,0,e)}return this.flatInteriorPoints_}},{key:"getFlatMidpoint",value:function(){return this.flatMidpoints_||(this.flatMidpoints_=pv(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}},{key:"getFlatMidpoints",value:function(){if(!this.flatMidpoints_){this.flatMidpoints_=[];for(var t=this.flatCoordinates_,e=0,n=this.ends_,r=0,i=n.length;r<i;++r){var o=n[r],a=pv(t,e,o,2,.5);p(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}},{key:"getId",value:function(){return this.id_}},{key:"getOrientedFlatCoordinates",value:function(){return this.flatCoordinates_}},{key:"getGeometry",value:function(){return this}},{key:"getSimplifiedGeometry",value:function(t){return this}},{key:"simplifyTransformed",value:function(t,e){return this}},{key:"getProperties",value:function(){return this.properties_}},{key:"getPropertiesInternal",value:function(){return this.properties_}},{key:"getStride",value:function(){return this.stride_}},{key:"getStyleFunction",value:function(){return this.styleFunction}},{key:"getType",value:function(){return this.type_}},{key:"transform",value:function(t){var e=(t=qn(t)).getExtent(),n=t.getWorldExtent();if(e&&n){var r=ne(n)/ne(e);Et(gv,n[0],n[3],r,-r,0,0,0),kr(this.flatCoordinates_,0,this.flatCoordinates_.length,2,gv,this.flatCoordinates_)}}},{key:"applyTransform",value:function(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}},{key:"clone",value:function(){return new t(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}},{key:"getEnds",value:function(){return this.ends_}},{key:"enableSimplifyTransformed",value:function(){var e=this;return this.simplifyTransformed=b((function(n,r){if(n===e.squaredTolerance_)return e.simplifiedGeometry_;e.simplifiedGeometry_=e.clone(),r&&e.simplifiedGeometry_.applyTransform(r);var i,o=e.simplifiedGeometry_.getFlatCoordinates();switch(e.type_){case"LineString":o.length=Yr(o,0,e.simplifiedGeometry_.flatCoordinates_.length,e.simplifiedGeometry_.stride_,n,o,0),i=[o.length];break;case"MultiLineString":i=[],o.length=function(t,e,n,r,i,o,a,u){for(var s=0,l=n.length;s<l;++s){var c=n[s];a=Yr(t,e,c,r,i,o,a),u.push(a),e=c}return a}(o,0,e.simplifiedGeometry_.ends_,e.simplifiedGeometry_.stride_,n,o,0,i);break;case"Polygon":i=[],o.length=Vr(o,0,e.simplifiedGeometry_.ends_,e.simplifiedGeometry_.stride_,Math.sqrt(n),o,0,i)}return i&&(e.simplifiedGeometry_=new t(e.type_,o,i,2,e.properties_,e.id_)),e.squaredTolerance_=n,e.simplifiedGeometry_})),this}}],n&&dv(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();mv.prototype.getFlatCoordinates=mv.prototype.getOrientedFlatCoordinates;const bv=mv,_v="addfeature",wv="removefeature";function Sv(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Ov(t,e){return function(n,r,i,o,a){var u=this;!function(t,e,n,r,i,o,a){var u=new XMLHttpRequest;u.open("GET","function"==typeof t?t(n,r,i):t,!0),"arraybuffer"==e.getType()&&(u.responseType="arraybuffer"),u.withCredentials=false,u.onload=function(t){if(!u.status||u.status>=200&&u.status<300){var r,s=e.getType();"json"==s?r=JSON.parse(u.responseText):"text"==s?r=u.responseText:"xml"==s?(r=u.responseXML)||(r=(new DOMParser).parseFromString(u.responseText,"application/xml")):"arraybuffer"==s&&(r=u.response),r?o(e.readFeatures(r,{extent:n,featureProjection:i}),e.readProjection(r)):a()}else a()},u.onerror=a,u.send()}(t,e,n,r,i,(function(t,e){u.addFeatures(t),void 0!==o&&o(t)}),a||m)}}function xv(t){return xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(t)}function kv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Pv(){return Pv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Mv(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},Pv.apply(this,arguments)}function Ev(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==xv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==xv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===xv(i)?i:String(i)),r)}var i}function jv(t,e,n){return e&&Ev(t.prototype,e),n&&Ev(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Rv(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tv(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Cv(t,e)}function Cv(t,e){return Cv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Cv(t,e)}function Iv(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Mv(t);if(e){var i=Mv(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"===xv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function Mv(t){return Mv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Mv(t)}var Av=function(t){Tv(n,t);var e=Iv(n);function n(t,r,i){var o;return Rv(this,n),(o=e.call(this,t)).feature=r,o.features=i,o}return jv(n)}(a);const Fv=function(t){Tv(n,t);var e=Iv(n);function n(t){var r;Rv(this,n),t=t||{},(r=e.call(this,{attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===t.wrapX||t.wrapX})).on,r.once,r.un,r.loader_=m,r.format_=t.format,r.overlaps_=void 0===t.overlaps||t.overlaps,r.url_=t.url,void 0!==t.loader?r.loader_=t.loader:void 0!==r.url_&&(kt(r.format_,"`format` must be set when `url` is set"),r.loader_=Ov(r.url_,r.format_)),r.strategy_=void 0!==t.strategy?t.strategy:Sv;var i,o,a=void 0===t.useSpatialIndex||t.useSpatialIndex;return r.featuresRtree_=a?new yv:null,r.loadedExtentsRtree_=new yv,r.loadingExtentsCount_=0,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(t.features)?o=t.features:t.features&&(o=(i=t.features).getArray()),a||void 0!==i||(i=new vt(o)),void 0!==o&&r.addFeaturesInternal(o),void 0!==i&&r.bindFeaturesCollection_(i),r}return jv(n,[{key:"addFeature",value:function(t){this.addFeatureInternal(t),this.changed()}},{key:"addFeatureInternal",value:function(t){var e=K(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var r=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(r,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Av(_v,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)}},{key:"setupChangeEvents_",value:function(t,e){e instanceof bv||(this.featureChangeKeys_[t]=[A(e,E,this.handleFeatureChange_,this),A(e,u,this.handleFeatureChange_,this)])}},{key:"addToIndex_",value:function(t,e){var n=!0;if(void 0!==e.getId()){var r=String(e.getId());if(r in this.idIndex_)if(e instanceof bv){var i=this.idIndex_[r];i instanceof bv?Array.isArray(i)?i.push(e):this.idIndex_[r]=[i,e]:n=!1}else n=!1;else this.idIndex_[r]=e}return n&&(kt(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}},{key:"addFeatures",value:function(t){this.addFeaturesInternal(t),this.changed()}},{key:"addFeaturesInternal",value:function(t){for(var e=[],n=[],r=[],i=0,o=t.length;i<o;i++){var a=t[i],u=K(a);this.addToIndex_(u,a)&&n.push(a)}for(var s=0,l=n.length;s<l;s++){var c=n[s],f=K(c);this.setupChangeEvents_(f,c);var h=c.getGeometry();if(h){var y=h.getExtent();e.push(y),r.push(c)}else this.nullGeometryFeatures_[f]=c}if(this.featuresRtree_&&this.featuresRtree_.load(e,r),this.hasListener(_v))for(var p=0,v=n.length;p<v;p++)this.dispatchEvent(new Av(_v,n[p]))}},{key:"bindFeaturesCollection_",value:function(t){var e=this,n=!1;this.addEventListener(_v,(function(e){n||(n=!0,t.push(e.feature),n=!1)})),this.addEventListener(wv,(function(e){n||(n=!0,t.remove(e.feature),n=!1)})),t.addEventListener(rt,(function(t){n||(n=!0,e.addFeature(t.element),n=!1)})),t.addEventListener(it,(function(t){n||(n=!0,e.removeFeature(t.element),n=!1)})),this.featuresCollection_=t}},{key:"clear",value:function(t){var e=this;if(t){for(var n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(L);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var r in this.featuresRtree_.forEach((function(t){e.removeFeatureInternal(t)})),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var i=new Av("clear");this.dispatchEvent(i),this.changed()}},{key:"forEachFeature",value:function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureAtCoordinateDirect",value:function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,(function(n){var r=n.getGeometry();if(r instanceof bv||r.intersectsCoordinate(t))return e(n)}))}},{key:"forEachFeatureInExtent",value:function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureIntersectingExtent",value:function(t,e){return this.forEachFeatureInExtent(t,(function(n){var r=n.getGeometry();if(r instanceof bv||r.intersectsExtent(t)){var i=e(n);if(i)return i}}))}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),w(this.nullGeometryFeatures_)||p(t,Object.values(this.nullGeometryFeatures_))),t}},{key:"getFeaturesAtCoordinate",value:function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,(function(t){e.push(t)})),e}},{key:"getFeaturesInExtent",value:function(t,e){var n,r=this;if(this.featuresRtree_){var i;if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);var o=function(t,e){if(e.canWrapX()){var n=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[n[0],t[1],n[2],t[3]]];le(t,e);var r=ae(n);if(ae(t)>r)return[[n[0],t[1],n[2],t[3]]];if(t[0]<n[0])return[[t[0]+r,t[1],n[2],t[3]],[n[0],t[1],t[2],t[3]]];if(t[2]>n[2])return[[t[0],t[1],n[2],t[3]],[n[0],t[1],t[2]-r,t[3]]]}return[t]}(t,e);return(i=[]).concat.apply(i,function(t){if(Array.isArray(t))return kv(t)}(n=o.map((function(t){return r.featuresRtree_.getInExtent(t)})))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return kv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kv(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}},{key:"getClosestFeatureToCoordinate",value:function(t,e){var n=t[0],r=t[1],i=null,o=[NaN,NaN],a=1/0,u=[-1/0,-1/0,1/0,1/0];return e=e||d,this.featuresRtree_.forEachInExtent(u,(function(t){if(e(t)){var s=t.getGeometry(),l=a;if((a=s instanceof bv?0:s.closestPointXY(n,r,o,a))<l){i=t;var c=Math.sqrt(a);u[0]=n-c,u[1]=r-c,u[2]=n+c,u[3]=r+c}}})),i}},{key:"getExtent",value:function(t){return this.featuresRtree_.getExtent(t)}},{key:"getFeatureById",value:function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null}},{key:"getFeatureByUid",value:function(t){var e=this.uidIndex_[t];return void 0!==e?e:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(t){var e=t.target,n=K(e),r=e.getGeometry();if(r){var i=r.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(i,e)):this.featuresRtree_&&this.featuresRtree_.update(i,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var a=o.toString();this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new Av("changefeature",e))}},{key:"hasFeature",value:function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:K(t)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&w(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}},{key:"loadFeatures",value:function(t,e,n){for(var r=this,i=this.loadedExtentsRtree_,o=this.strategy_(t,e,n),a=function(){var t=o[u];i.forEachInExtent(t,(function(e){return Dt(e.extent,t)}))||(++r.loadingExtentsCount_,r.dispatchEvent(new Av("featuresloadstart")),r.loader_.call(r,t,e,n,(function(t){--r.loadingExtentsCount_,r.dispatchEvent(new Av("featuresloadend",void 0,t))}),(function(){--r.loadingExtentsCount_,r.dispatchEvent(new Av("featuresloaderror"))})),i.insert(t,{extent:t.slice()}))},u=0,s=o.length;u<s;++u)a();this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),Pv(Mv(n.prototype),"refresh",this).call(this)}},{key:"removeLoadedExtent",value:function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,(function(n){if(Yt(n.extent,t))return e=n,!0})),e&&n.remove(e)}},{key:"removeFeature",value:function(t){if(t){var e=K(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}}},{key:"removeFeatureInternal",value:function(t){var e=K(t),n=this.featureChangeKeys_[e];if(n){n.forEach(L),delete this.featureChangeKeys_[e];var r=t.getId();return void 0!==r&&delete this.idIndex_[r.toString()],delete this.uidIndex_[e],this.dispatchEvent(new Av(wv,t)),t}}},{key:"removeFromIdIndex_",value:function(t){var e=!1;for(var n in this.idIndex_){var r=this.idIndex_[n];if(t instanceof bv&&Array.isArray(r)&&r.includes(t))r.splice(r.indexOf(t),1);else if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}}return e}},{key:"setLoader",value:function(t){this.loader_=t}},{key:"setUrl",value:function(t){kt(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Ov(t,this.format_))}}]),n}(Nl);function Lv(t){return Lv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(t)}function Dv(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Bv(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dv(Object(n),!0).forEach((function(e){Gv(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dv(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Gv(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==Lv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Lv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Lv(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zv(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,a,u=[],s=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(t){l=!0,i=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Nv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nv(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nv(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const Wv=function(n){var r,i,o=n.centerNode,a=n.onMapLoaded,u=n.style,s=(n.features,zv((0,t.useState)(),2)),l=s[0],c=s[1],f=zv((0,t.useState)(),2),h=f[0],y=f[1],p=(0,t.useRef)(),v=(0,t.useRef)();if(v.current=l,o){var d=o.getMetadata();d.has("GeoLocation")&&(r=parseFloat(d.get("GeoLocation").lat),i=parseFloat(d.get("GeoLocation").lon))}if(!r||!i)return"function"==typeof a&&a(null,"Could not find latitude / longitude"),null;(0,t.useEffect)((function(){ur=qn("EPSG:4326");var t=[i,r],e=new li(t),n=new Zs({target:p.current,layers:[new hf({source:new Tc}),new cv({source:new Fv({features:[new Qs(e)]}),style:{"circle-radius":5,"circle-fill-color":"red"}})],view:new Ai({center:t,zoom:15}),controls:[]});n.on("click",g),c(n)}),[]);var g=function(t){var e=nr(v.current.getCoordinateFromPixel(t.pixel),"EPSG:3857","EPSG:4326");y(e)},m=u&&u.height||"100%";return e().createElement("div",{style:Bv(Bv({},u),{},{width:"100%",height:m})},e().createElement("div",{ref:p,style:{height:"100%",width:"100%"},className:"map-container"}),e().createElement("div",{className:"clicked-coord-label"},e().createElement("p",null,h?function(t,e,n){return t?"{x}, {y}".replace("{x}",t[0].toFixed(n)).replace("{y}",t[1].toFixed(n)):""}(h,0,5):"")))},Xv=require("pydio");var Yv=n.n(Xv);const Kv=require("react-redux");function Zv(t){return Zv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(t)}var Vv;function Uv(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==Zv(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Zv(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===Zv(i)?i:String(i)),r)}var i}function qv(t,e){return qv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qv(t,e)}function Hv(t){return Hv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hv(t)}var Jv=Yv().requireLib("hoc").EditorActions,Qv=(0,Kv.connect)(null,Jv)(Vv=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qv(t,e)}(u,t);var n,r,i,o,a=(i=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Hv(i);if(o){var n=Hv(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Zv(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=a.call(this,t)).state={},e}return n=u,r=[{key:"componentDidMount",value:function(){var t=this.props.editorModify;this.props.isActive&&t({fixedToolbar:!1})}},{key:"componentWillReceiveProps",value:function(t){var e=this.props.editorModify;t.isActive&&e({fixedToolbar:!1})}},{key:"onMapLoaded",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e&&this.setState({error:e})}},{key:"render",value:function(){var t=this.state.error,n=this.props,r=n.style,i=n.node;return t?e().createElement("div",{style:{margin:"auto",display:"flex",flexDirection:"column",justifyContent:"space-between",flex:1}},e().createElement("div",{style:{margin:"auto",color:"white"}},t)):e().createElement(Wv,{style:r,features:[],centerNode:i})}}],r&&Uv(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),u}(t.Component))||Vv})(),window.PydioMaps=r})();