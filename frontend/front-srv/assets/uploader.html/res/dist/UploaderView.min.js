(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};e.r(t),e.d(t,{DropUploader:()=>ne,TransfersList:()=>V});const r=require("react");var n=e.n(r);const o=require("pydio");var i=e.n(o);const a=require("material-ui");function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===l(o)?o:String(o)),n)}var o}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}var f=i().requireLib("hoc").ThemedContainers.Popover,p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}(y,e);var t,r,o,p,d=(o=y,p=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=c(o);if(p){var r=c(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function y(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),d.apply(this,arguments)}return t=y,(r=[{key:"updateField",value:function(e,t){var r=this.props.configs;if("autostart"===e){var n=r.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send",!0);n=!n,r.updateOption("upload_auto_send",n,!0)}else if("autoclose"===e){var o=r.getOptionAsBool("DEFAULT_AUTO_CLOSE","upload_auto_close",!0);o=!o,r.updateOption("upload_auto_close",o,!0)}else if("existing"===e)r.updateOption("upload_existing",t.target.getSelectedValue());else if("show_processed"===e){var i=r.getOptionAsBool("UPLOAD_SHOW_PROCESSED","upload_show_processed",!1);i=!i,r.updateOption("upload_show_processed",i,!0)}this.setState({random:Math.random()})}},{key:"radioChange",value:function(e,t){this.props.configs.updateOption("upload_existing",t),this.setState({random:Math.random()})}},{key:"render",value:function(){var e=this,t=this.props.configs,r=i().getInstance(),o=t.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send"),l=t.getOptionAsBool("DEFAULT_AUTO_CLOSE","upload_auto_close"),s=t.getOption("DEFAULT_EXISTING","upload_existing");return n().createElement(f,{open:this.props.open,anchorEl:this.props.anchorEl,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(t){e.props.onDismiss(t)}},n().createElement("div",{style:{width:320,paddingBottom:6}},n().createElement(a.Subheader,null,r.MessageHash["html_uploader.options"]),n().createElement("div",{style:{padding:"0 16px",marginTop:-6}},n().createElement(a.Checkbox,{style:{margin:"8px 0"},checked:o,labelPosition:"right",onCheck:this.updateField.bind(this,"autostart"),label:r.MessageHash[337],labelStyle:{fontSize:14}}),n().createElement(a.Checkbox,{style:{margin:"8px 0"},checked:l,labelPosition:"right",onCheck:this.updateField.bind(this,"autoclose"),label:r.MessageHash[338],labelStyle:{fontSize:14}})),n().createElement(a.Subheader,null,r.MessageHash["html_uploader.options.existing"]),n().createElement("div",{style:{padding:16,fontSize:14,paddingTop:0}},n().createElement(a.RadioButtonGroup,{ref:"group",name:"shipSpeed",defaultSelected:s,onChange:this.radioChange.bind(this)},n().createElement(a.RadioButton,{value:"alert",label:r.MessageHash["html_uploader.options.existing.alert"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"rename-folders",label:r.MessageHash["html_uploader.options.existing.folders"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"rename",label:r.MessageHash["html_uploader.options.existing.merge"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"overwrite",label:r.MessageHash["html_uploader.options.existing.overwrite"]})))))}}])&&s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),y}(n().Component);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===d(o)?o:String(o)),n)}var o}function h(e,t){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},h(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(u,e);var t,r,o,l,s=(o=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(o);if(l){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),s.apply(this,arguments)}return t=u,(r=[{key:"clear",value:function(e){var t=UploaderModel.Store.getInstance();switch(e){case"all":t.clearAll();break;case"loaded":t.clearStatus("loaded");break;case"error":t.clearStatus("error")}this.props.onDismiss()}},{key:"render",value:function(){var e=this,t=i().getMessages();return n().createElement(a.Popover,{open:this.props.open,anchorEl:this.props.anchorEl,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:function(t){e.props.onDismiss(t)}},n().createElement(a.Menu,{style:{width:146},desktop:!0},n().createElement(a.Subheader,{style:{lineHeight:"26px"}},t["html_uploader.clear-header"]),n().createElement(a.MenuItem,{primaryText:t["html_uploader.clear-finished"],onClick:function(){e.clear("loaded")}}),n().createElement(a.MenuItem,{primaryText:t["html_uploader.clear-failed"],onClick:function(){e.clear("error")}}),n().createElement(a.MenuItem,{primaryText:t["html_uploader.clear-all"],onClick:function(){e.clear("all")}})))}}])&&y(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n().Component);const b=require("pydio/util/path");var v=e.n(b);const S=require("pydio/lang/observable");function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function O(e){return function(e){if(Array.isArray(e))return _(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==w(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===w(o)?o:String(o)),n)}var o}function k(e,t){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},k(e,t)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k(e,t)}(l,e);var t,r,n,o,a=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(n);if(o){var r=j(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}(this,e)});function l(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=a.call(this))._status=l.StatusNew,r._type=e,r._id=Math.random(),r._errorMessage=null;var o=i().getInstance();return r._repositoryId=n?n.getRepositoryId():o.user.activeRepository,r._exists=!1,r._progress=0,r.children={folders:[],files:[],pg:{}},r._targetNode=t,n&&(r._parent=n,e===l.TypeFolder?n.children.folders.push(P(r)):n.children.files.push(P(r))),r}return t=l,r=[{key:"getId",value:function(){return this._id}},{key:"getParent",value:function(){return this._parent}},{key:"getLabel",value:function(){return this._label&&this._label.normalize?this._label.normalize("NFC"):this._label}},{key:"updateTargetNode",value:function(e){this._targetNode=e}},{key:"getTargetNode",value:function(){return this._targetNode}},{key:"updateLabel",value:function(e){this._label=e,this.notify("update_label",e)}},{key:"getFullPath",value:function(){return this._parent.getFullPath()+"/"+this.getLabel()}},{key:"getProgress",value:function(){return this._progress}},{key:"setExists",value:function(){this._exists=!0}},{key:"getExists",value:function(){return this._exists}},{key:"getType",value:function(){return this._type}},{key:"getStatus",value:function(){return this._status}},{key:"setStatus",value:function(e){this._status=e,this.notify("status",e)}},{key:"updateRepositoryId",value:function(e){this._repositoryId=e}},{key:"getRepositoryId",value:function(){return this._repositoryId}},{key:"getErrorMessage",value:function(){return this._errorMessage||""}},{key:"onError",value:function(e){this._errorMessage=e,this.setStatus(l.StatusError)}},{key:"process",value:function(e){this._doProcess(e)}},{key:"abort",value:function(e){this._doAbort&&this._doAbort(e)}},{key:"pause",value:function(){if(this._doPause){var e=this._doPause();this.setStatus(e)}}},{key:"resume",value:function(){this._doResume&&(this._doResume(),this.setStatus(l.StatusLoading))}},{key:"addChild",value:function(e){var t=this;this.children.pg[e.getId()]=0,e.observe("progress",(function(r){t.children.pg[e.getId()]=r,t.recomputeProgress()})),this.notify("child_added")}},{key:"recomputeProgress",value:function(){var e=this,t=Object.keys(this.children.pg).map((function(t){return e.children.pg[t]}));if(t.length){var r=t.reduce((function(e,t){return e+t}));this._progress=r/t.length,this.notify("progress",this._progress)}}},{key:"removeChild",value:function(e){e.abort(),e.walk((function(e){e.abort()}),(function(){return!0}),l.TypeFile);var t=e.getId(),r=this.children.folders.indexOf(e),n=this.children.files.indexOf(e),o=!1;r>-1?(this.children.folders=LangUtils.arrayWithout(this.children.folders,r),o=!0):n>-1&&(this.children.files=LangUtils.arrayWithout(this.children.files,n),o=!0),o&&(e.stopObserving("progress"),delete this.children.pg[t],this.recomputeProgress(),this.notify("children"))}},{key:"getChildren",value:function(){return[].concat(O(this.children.folders),O(this.children.files))}},{key:"walk",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.TypeBoth,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return!1},o=!1;if(r===l.TypeBoth||r===l.TypeFile)for(var i=this.children.files,a=0;a<i.length;a++){if(n(i[a])){o=!0;break}t(i[a])&&e(i[a])}o||this.children.folders.forEach((function(o){r!==l.TypeFolder&&r!==l.TypeBoth||!t(o)||e(o),n(o)||o.walk(e,t,r,n)}))}},{key:"collectWithLimit",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"both",n=[];return this.walk((function(e){n.push(e)}),t,r,(function(t){return n.length>=e})),n}}],r&&E(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(e.n(S)());C.StatusNew="new",C.StatusAnalyze="analyse",C.StatusFolders="folders",C.StatusLoading="loading",C.StatusLoaded="loaded",C.StatusError="error",C.StatusPause="pause",C.StatusCannotPause="cannot-pause",C.StatusMultiPause="multi-pause",C.TypeFolder="folder",C.TypeFile="file",C.TypeBoth="both";const T=require("material-ui/styles");function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t,r){return(t=D(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,D(n.key),n)}}function D(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===R(t)?t:String(t)}function A(e,t){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},A(e,t)}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(u,e);var t,r,o,l,s=(o=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(o);if(l){var r=F(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={open:!1,showAll:!1,status:e.item.getStatus(),previewUrl:null,progress:e.item.getProgress()||0},t}return t=u,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props.item;if(this._pgObserver=function(t){e.setState({progress:t})},this._statusObserver=function(t){e.setState({status:t})},t.observe("progress",this._pgObserver),t.observe("status",this._statusObserver),t.observe("children",(function(){e.forceUpdate()})),t instanceof UploaderModel.UploadItem&&/\.(jpe?g|png|gif)$/i.test(t.getFile().name)){if(t.previewUrl)return void this.setState({previewUrl:t.previewUrl});var r=new FileReader;r.addEventListener("load",(function(){t.previewUrl=r.result,e.setState({previewUrl:r.result})}),!1),r.readAsDataURL(t.getFile())}}},{key:"componentWillUnmount",value:function(){var e=this.props.item;e.stopObserving("progress",this._pgObserver),e.stopObserving("status",this._statusObserver)}},{key:"remove",value:function(){var e=this.props.item;e.getParent()&&e.getParent().removeChild(e)}},{key:"abort",value:function(){this.props.item.abort()}},{key:"retry",value:function(){var e=this.props,t=e.item,r=e.store;t.setStatus(C.StatusNew),r.processNext()}},{key:"render",value:function(){var e,t,r,o,l,s,c=this,f=this.props,p=f.item,d=f.className,y=f.style,h=f.limit,m=f.level,g=f.extensions,b=f.store,S=f.muiTheme,w=this.state,O=w.open,_=w.showAll,E=w.progress,k=w.status,P=w.previewUrl,j=p.getChildren(),T=p instanceof UploaderModel.FolderItem,R=p instanceof UploaderModel.PartItem,x=p instanceof UploaderModel.Session,M=i().getMessages(),B={main:I(I({},y),{},{fontSize:14}),line:{paddingLeft:24*(m-1),display:"flex",alignItems:"center",paddingTop:m>1?10:16,paddingBottom:6,cursor:j.length?"pointer":"default",borderLeft:1===m?"3px solid transparent":""},secondaryLine:{color:S.palette.mui3["on-surface-variant"],display:"flex",alignItems:"center",fontSize:11},leftIcon:{display:"inline-block",width:50,textAlign:"center",fontSize:18},previewImage:{display:"inline-block",backgroundColor:"#eee",backgroundSize:"cover",height:32,width:32,borderRadius:"50%"},label:{fontSize:15,fontWeight:T?500:400,fontStyle:R?"italic":null,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},errMessage:{fontSize:11,flex:2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pgBar:{position:"relative"},rightButton:{display:"inline-block",width:48,textAlign:"center",cursor:"pointer",fontSize:16},toggleIcon:{marginLeft:4}},D=[];if(j.length){if(O||x&&k!==C.StatusAnalyze){var A=_?j:j.slice(0,h);D=A.map((function(e){return n().createElement(u,{key:e.getId(),item:e,limit:h,level:m+1,extensions:g,store:b,muiTheme:S})})),j.length>A.length&&D.push(n().createElement("div",{style:I(I({},B.line),{},{cursor:"pointer",borderLeft:"",paddingLeft:20*m}),onClick:function(){c.setState({showAll:!0})}},n().createElement("span",{style:B.leftIcon,className:"mdi mdi-plus-box-outline"}),n().createElement("span",{style:{flex:1,fontStyle:"italic"}},M["html_uploader.list.show-more"].replace("%d",j.length-A.length))))}l=function(){c.setState({open:!O})},o=n().createElement("span",{onClick:l,style:B.toggleIcon,className:"mdi mdi-chevron-"+(O?"down":"right")})}if(T)e="mdi mdi-folder",t=n().createElement("span",{className:"mdi mdi-close-circle-outline",onClick:function(){c.remove()}}),100===E&&(s="#4caf50");else if(R)e="mdi mdi-package-up",100===E&&(s="#4caf50");else{e="mdi mdi-file";var F=v().getFileExtension(p.getFullPath());g.has(F)&&(e="mimefont mdi mdi-"+g.get(F).fontIcon),k===C.StatusLoading||k===C.StatusCannotPause||k===C.StatusMultiPause?t=n().createElement("span",{className:"mdi mdi-stop",onClick:function(){return c.abort()}}):k===C.StatusError?(s="#e53935",t=n().createElement("span",{className:"mdi mdi-restart",style:{color:"#e53935"},onClick:function(){c.retry()}})):(s="#4caf50",t=n().createElement("span",{className:"mdi mdi-close-circle-outline",onClick:function(){c.remove()}}))}var U,z=v().getBasename(p.getFullPath()),L=n().createElement(a.LinearProgress,{style:{backgroundColor:"#eeeeee",height:3},color:s,min:0,max:100,value:E,mode:"determinate"});if(x){if(k!==C.StatusAnalyze)return n().createElement("div",null,D);z=i().getMessages()["html_uploader.analyze.step"],L=null,l=null,o=null,t=n().createElement(a.CircularProgress,{size:16,thickness:2,style:{marginTop:1}})}r=P?n().createElement("span",{style:I(I({},B.leftIcon),{},{marginTop:-4,marginBottom:-5})},n().createElement("div",{style:I({background:"url("+P+")"},B.previewImage)})):n().createElement("span",{style:B.leftIcon},n().createElement("span",{className:e,style:{display:"block",width:B.previewImage.width,height:B.previewImage.height,lineHeight:B.previewImage.width+"px",backgroundColor:S.palette.mui3["mimefont-background"],borderRadius:"50%",marginLeft:8}}));var N=I({},B.secondaryLine),H=T?"dir":R?"part":"file";return"error"===k?(N.opacity=1,U=n().createElement("span",{style:B.errMessage,title:p.getErrorMessage()},p.getErrorMessage())):(U=M["html_uploader.status."+H+"."+k]||M["html_uploader.status."+k]||k,p.getSize&&(U=p.getHumanSize()+" - "+U),k===C.StatusAnalyze&&p.getAnalyzeStatus&&p.getAnalyzeStatus()&&(U+=" ("+p.getAnalyzeStatus()+")"),k===C.StatusLoading&&p.getRetry&&p.getRetry()>0&&(U+=" ("+M["html_uploader.attempt"]+" "+(1+p.getRetry())+")")),n().createElement("div",{style:B.main,className:"upload-"+k+" "+(d||"")},n().createElement("div",{style:B.line},r,n().createElement("div",{style:{flex:1,overflow:"hidden",paddingLeft:4}},n().createElement("div",{onClick:l,style:B.label},z," ",o),n().createElement("div",{style:N},U),n().createElement("div",{style:B.pgBar},L)),n().createElement("span",{style:B.rightButton},t)),D)}}])&&B(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n().Component);const z=require("pydio/util/dom");var L=e.n(z);function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function H(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==N(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===N(o)?o:String(o)),n)}var o}function q(e,t){return q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},q(e,t)}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}var V=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q(e,t)}(s,e);var t,r,o,a,l=(o=s,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=W(o);if(a){var r=W(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function s(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),l.call(this,e)}return t=s,(r=[{key:"render",value:function(){var e,t=this.props,r=t.sessions,o=t.store,a=t.muiTheme,l=t.onPickFile,s=t.onPickFolder,u=L().getBeziersTransition().replace("all ","color "),c=i().getMessages();if(r){var f=!0,p=i().getInstance().Registry.getFilesExtensions(),d=r.map((function(e){return e.getChildren().length&&(f=!1),n().createElement(U,{item:e,store:o,style:{},limit:10,level:0,extensions:p,muiTheme:a})}));f||(e=n().createElement("div",{style:{height:"100%",overflowY:"auto",padding:10,paddingBottom:20}},d))}var y=n().createElement("div",{style:{display:"flex",alignItems:"center",height:"100%",width:"100%",transition:u},className:"drop-transfer-list"},n().createElement("div",{style:{textAlign:"center",width:"100%",fontWeight:500,fontSize:18,padding:24,lineHeight:"28px"}},n().createElement("div",{className:"mdi mdi-cloud-upload",style:{fontSize:110}}),n().createElement("div",null,c["html_uploader.drophere"]," ",c["html_uploader.drop-or"]," ",n().createElement("a",{onClick:l},c["html_uploader.drop-pick-file"]),s&&n().createElement("span",null," ",c["html_uploader.drop-or"]," ",n().createElement("a",{onClick:s},c["html_uploader.drop-pick-folder"])))),n().createElement("style",{type:"text/css",dangerouslySetInnerHTML:{__html:"\n            .drop-transfer-list{\n                color:rgba(3, 169, 244, 0.5);\n            }\n            .transparent-dropzone.active .drop-transfer-list{\n                color:rgba(3, 169, 244, 0.8);\n            }\n            .drop-transfer-list a,.drop-transfer-list a:hover {\n                color:rgba(3, 169, 244, 1);\n                cursor: pointer;\n            }\n        "}}));return n().createElement("div",{style:{display:"flex",height:"calc(100% - 10px)",margin:10,overflow:"hidden",borderRadius:a.borderRadius,backgroundColor:a.palette.mui3.surface}},n().createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"}},y),e&&n().createElement("div",{style:{width:420,minWidth:420,maxWidth:420}},e))}}])&&H(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(n().Component);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function $(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==G(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===G(o)?o:String(o)),n)}var o}function Q(e,t){return Q=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Q(e,t)}function X(e){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},X(e)}V=(0,T.muiThemeable)()(V);var Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Q(e,t)}(u,e);var t,r,o,l,s=(o=u,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=X(o);if(l){var r=X(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=s.call(this,e)).state={value:"rename-folders",saveValue:!1},t}return t=u,(r=[{key:"cancel",value:function(){this.props.onCancel()}},{key:"submit",value:function(){var e=this.state,t=e.value,r=e.saveValue;this.props.onConfirm(t,r)}},{key:"checkChange",value:function(e,t){this.setState({saveValue:t})}},{key:"radioChange",value:function(e,t){this.setState({value:t})}},{key:"render",value:function(){var e=i().getInstance(),t=this.state,r=t.value,o=t.saveValue;return n().createElement("div",{style:{position:"absolute",padding:16,fontSize:14,top:49,left:0,right:0,bottom:0,display:"flex",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.7)"}},n().createElement(a.Paper,{style:{width:500,padding:16,fontSize:14,margin:"0 auto"},zDepth:2},n().createElement("div",null,n().createElement("h5",null,e.MessageHash[124]),n().createElement(a.RadioButtonGroup,{ref:"group",name:"shipSpeed",defaultSelected:r,onChange:this.radioChange.bind(this)},n().createElement(a.RadioButton,{value:"rename-folders",label:e.MessageHash["html_uploader.confirm.rename.all"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"rename",label:e.MessageHash["html_uploader.confirm.rename.merge"],style:{paddingBottom:8}}),n().createElement(a.RadioButton,{value:"overwrite",label:e.MessageHash["html_uploader.confirm.overwrite"]}))),n().createElement("div",{style:{display:"flex",marginTop:30,alignItems:"center"}},n().createElement(a.Checkbox,{label:e.MessageHash["html_uploader.confirm.save.choice"],checked:o,onCheck:this.checkChange.bind(this)}),n().createElement("span",{style:{flex:1}}),n().createElement(a.FlatButton,{label:e.MessageHash[54],onClick:this.cancel.bind(this)}),n().createElement(a.RaisedButton,{primary:!0,label:e.MessageHash[48],onClick:this.submit.bind(this)}))))}}])&&$(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(n().Component);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Z(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==Z(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===Z(o)?o:String(o)),n)}var o}function K(e,t){return K=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},K(e,t)}function ee(e){return ee=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ee(e)}var te=i().requireLib("hoc").dropProvider,re=i().requireLib("form").FileDropZone,ne=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&K(e,t)}(c,t);var r,o,l,s,u=(l=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ee(l);if(s){var r=ee(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),t=u.call(this,e);var r=UploaderModel.Store.getInstance();return t._storeObserver=function(){t.setState({sessions:r.getSessions(),storeRunning:r.isRunning()})},r.observe("update",t._storeObserver),r.observe("auto_close",(function(){t.props.onDismiss&&t.props.onDismiss()})),t.state={showOptions:!1,configs:UploaderModel.Configs.getInstance(),sessions:r.getSessions(),storeRunning:r.isRunning(),confirmDialog:e.confirmDialog},t}return r=c,(o=[{key:"componentWillReceiveProps",value:function(e){e.confirmDialog!==this.state.confirmDialog&&this.setState({confirmDialog:e.confirmDialog})}},{key:"componentWillUnmount",value:function(){this._storeObserver&&(UploaderModel.Store.getInstance().stopObserving("update",this._storeObserver),UploaderModel.Store.getInstance().stopObserving("auto_close"))}},{key:"onDrop",value:function(e){var t=i().getInstance().getContextHolder().getContextNode();UploaderModel.Store.getInstance().handleDropEventResults(null,e,t)}},{key:"onFolderPicked",value:function(e){var t=i().getInstance().getContextHolder().getContextNode();UploaderModel.Store.getInstance().handleFolderPickerResult(e,t)}},{key:"start",value:function(e){e.preventDefault(),UploaderModel.Store.getInstance().resume()}},{key:"pause",value:function(e){UploaderModel.Store.getInstance().pause()}},{key:"openClear",value:function(e){e.preventDefault(),this.setState({showClear:!0,clearAnchorEl:e.currentTarget})}},{key:"toggleOptions",value:function(e){e.preventDefault&&e.preventDefault();var t=this.state,r=t.showOptions,n=void 0!==r&&r;t.currentTarget,this.setState({showOptions:!n,optionsAnchorEl:e.currentTarget})}},{key:"openFilePicker",value:function(e){e.preventDefault(),this.refs.dropzone.open()}},{key:"openFolderPicker",value:function(e){e.preventDefault(),this.refs.dropzone.openFolderPicker()}},{key:"dialogSubmit",value:function(e,t){var r=this.state.configs;UploaderModel.Store.getInstance().getSessions().forEach((function(t){"confirm"===t.getStatus()&&t.prepare(e)})),t&&r.updateOption("upload_existing",e),this.setState({confirmDialog:!1}),i().getInstance().getController().fireAction("upload")}},{key:"dialogCancel",value:function(){var e=UploaderModel.Store.getInstance();e.getSessions().forEach((function(t){"confirm"===t.getStatus()&&e.removeSession(t)})),this.setState({confirmDialog:!1}),i().getInstance().getController().fireAction("upload")}},{key:"supportsFolder",value:function(){var t=!1,r=e.g.document.createElement("input");return r.setAttribute("type","file"),"webkitdirectory"in r&&(t=!0),r=null,t}},{key:"render",value:function(){var e=this,t=i().getInstance().MessageHash,r=this.props,o=r.showDismiss,l=r.onDismiss,s=this.props.connectDropTarget||function(e){return e},u=this.state,c=u.configs,f=u.showOptions,d=u.optionsAnchorEl,y=u.showClear,h=u.clearAnchorEl,m=u.sessions,b=(u.storeRunning,u.confirmDialog),v=UploaderModel.Store.getInstance(),S=!0;return m.forEach((function(e){e.getChildren().length&&(S=!1)})),s(n().createElement("div",{style:{position:"relative"}},n().createElement("div",{style:{position:"relative",display:"flex",alignItems:"center",paddingLeft:16,paddingRight:16,paddingTop:8,width:"100%"}},n().createElement("h3",{style:{marginBottom:16,display:"none"}},t["html_uploader.dialog.title"]),n().createElement(a.FlatButton,{icon:n().createElement(a.FontIcon,{style:{fontSize:16},className:"mdi mdi-play"}),label:t["html_uploader.start"],onClick:this.start.bind(this),disabled:v.isRunning()||!v.hasQueue()}),n().createElement(a.FlatButton,{icon:n().createElement(a.FontIcon,{style:{fontSize:16},className:"mdi mdi-pause"}),label:t["html_uploader.pause"],onClick:this.pause.bind(this),disabled:!v.isRunning()}),n().createElement(a.FlatButton,{icon:n().createElement(a.FontIcon,{style:{fontSize:16},className:"mdi mdi-delete"}),label:n().createElement("span",null,t["html_uploader.clear"],n().createElement("span",{className:"mdi mdi-menu-down"})),onClick:this.openClear.bind(this),disabled:S}),n().createElement("span",{style:{flex:1}}),n().createElement(a.FlatButton,{primary:!0,label:t["html_uploader.options"],onClick:this.toggleOptions.bind(this)}),o&&n().createElement(a.IconButton,{iconClassName:"mdi mdi-close",style:{padding:14},onClick:function(){return l()}})),n().createElement(re,{className:"transparent-dropzone",ref:"dropzone",multiple:!0,enableFolders:!0,supportClick:!1,ignoreNativeDrop:!0,onDrop:this.onDrop.bind(this),onFolderPicked:this.onFolderPicked.bind(this),style:{width:"100%",height:420}},n().createElement(V,{sessions:m,autoStart:c.getOptionAsBool("DEFAULT_AUTO_START","upload_auto_send"),onDismiss:this.props.onDismiss,store:v,onPickFile:function(t){e.openFilePicker(t)},onPickFolder:this.supportsFolder()?function(t){e.openFolderPicker(t)}:null})),n().createElement(p,{configs:c,open:f,anchorEl:d,onDismiss:function(t){e.toggleOptions(t)}}),n().createElement(g,{configs:c,open:y,anchorEl:h,onDismiss:function(){e.setState({showClear:!1,clearAnchorEl:null})}}),b&&n().createElement(Y,{onConfirm:this.dialogSubmit.bind(this),onCancel:this.dialogCancel.bind(this)})))}}])&&J(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),c}(n().Component);ne=te(ne),window.UploaderView=t})();