!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.PydioComponents=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define(["react"],t):"object"==typeof exports?exports.ScrollArea=t(require("react")):e.ScrollArea=t(e.React)}(this,function(e){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),n(31);var r=n(13),i=o(r);t.default=i.default},function(t,n){t.exports=e},function(e,t,n){e.exports=n(19)()},function(e,t){"use strict";function n(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="number"==typeof e[n]?e[n]:e[n].val);return t}t.__esModule=!0,t.default=n,e.exports=t.default},function(e,t,n){(function(t){(function(){var n,o,r;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-r)/1e6},o=t.hrtime,n=function(){var e;return e=o(),1e9*e[0]+e[1]},r=n()):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(t,n(10))},function(e,t,n){(function(t){for(var o=n(23),r="undefined"==typeof window?t:window,i=["moz","webkit"],a="AnimationFrame",l=r["request"+a],s=r["cancel"+a]||r["cancelRequest"+a],u=0;!l&&u<i.length;u++)l=r[i[u]+"Request"+a],s=r[i[u]+"Cancel"+a]||r[i[u]+"CancelRequest"+a];if(!l||!s){var c=0,f=0,p=[],d=1e3/60;l=function(e){if(0===p.length){var t=o(),n=Math.max(0,d-(t-c));c=n+t,setTimeout(function(){var e=p.slice(0);p.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(c)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return p.push({handle:++f,callback:e,cancelled:!1}),f},s=function(e){for(var t=0;t<p.length;t++)p[t].handle===e&&(p[t].cancelled=!0)}}e.exports=function(e){return l.call(r,e)},e.exports.cancel=function(){s.apply(r,arguments)},e.exports.polyfill=function(e){e||(e=r),e.requestAnimationFrame=l,e.cancelAnimationFrame=s}}).call(t,function(){return this}())},function(e,t){"use strict";function n(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=0);return t}t.__esModule=!0,t.default=n,e.exports=t.default},function(e,t){"use strict";function n(e,t,n){for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){if(0!==n[o])return!1;var r="number"==typeof t[o]?t[o]:t[o].val;if(e[o]!==r)return!1}return!0}t.__esModule=!0,t.default=n,e.exports=t.default},function(e,t){"use strict";function n(e,t,n,r,i,a,l){var s=-i*(t-r),u=-a*n,c=s+u,f=n+c*e,p=t+f*e;return Math.abs(f)<l&&Math.abs(p-r)<l?(o[0]=r,o[1]=0,o):(o[0]=p,o[1]=f,o)}t.__esModule=!0,t.default=n;var o=[0,0];e.exports=t.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){return p?f.default.findDOMNode(e):e}function i(){d||p||(d=!0,console.error("With React 0.14 and later versions, you no longer need to wrap <ScrollArea> child into a function."))}function a(){!d&&p&&(d=!0,console.error("With React 0.13, you need to wrap <ScrollArea> child into a function."))}function l(e){return e<0?0:e}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e},n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]=t(e[o]));return n}function u(e){var t=e.version;if("string"!=typeof t)return!0;var n=t.split("."),o=parseInt(n[0],10),r=parseInt(n[1],10);return 0===o&&13===r}Object.defineProperty(t,"__esModule",{value:!0}),t.findDOMNode=r,t.warnAboutFunctionChild=i,t.warnAboutElementChild=a,t.positiveOrZero=l,t.modifyObjValues=s,t.isReact13=u;var c=n(1),f=o(c),p=u(f.default),d=!1},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function i(e){if(f===clearTimeout)return clearTimeout(e);if((f===o||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function a(){y&&d&&(y=!1,d.length?h=d.concat(h):v=-1,h.length&&l())}function l(){if(!y){var e=r(a);y=!0;for(var t=h.length;t;){for(d=h,h=[];++v<t;)d&&d[v].run();v=-1,t=h.length}d=null,y=!1,i(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var c,f,p=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:o}catch(e){f=o}}();var d,h=[],y=!1,v=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new s(e,t)),1!==h.length||y||r(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=u,p.addListener=u,p.once=u,p.off=u,p.removeListener=u,p.removeAllListeners=u,p.emit=u,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t){"use strict";t.__esModule=!0,t.default={noWobble:{stiffness:170,damping:26},gentle:{stiffness:120,damping:14},wobbly:{stiffness:180,damping:12},stiff:{stiffness:210,damping:20}},e.exports=t.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e.default:e}t.__esModule=!0;var r=n(24);t.Motion=o(r);var i=n(25);t.StaggeredMotion=o(i);var a=n(26);t.TransitionMotion=o(a);var l=n(29);t.spring=o(l);var s=n(11);t.presets=o(s);var u=n(3);t.stripStyle=o(u);var c=n(28);t.reorderKeys=o(c)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=n(1),f=o(c),p=n(2),d=o(p),h=n(18),y=o(h),v=n(12),m=n(9),b=n(14),S=o(b),g={wheel:"wheel",api:"api",touch:"touch",touchEnd:"touchEnd",mousemove:"mousemove",keyPress:"keypress"},w=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={topPosition:0,leftPosition:0,realHeight:0,containerHeight:0,realWidth:0,containerWidth:0},n.scrollArea={refresh:function(){n.setSizesToState()},scrollTop:function(){n.scrollTop()},scrollBottom:function(){n.scrollBottom()},scrollYTo:function(e){n.scrollYTo(e)},scrollLeft:function(){n.scrollLeft()},scrollRight:function(){n.scrollRight()},scrollXTo:function(e){n.scrollXTo(e)}},n.evntsPreviousValues={clientX:0,clientY:0,deltaX:0,deltaY:0},n.bindedHandleWindowResize=n.handleWindowResize.bind(n),n}return a(t,e),u(t,[{key:"getChildContext",value:function(){return{scrollArea:this.scrollArea}}},{key:"componentDidMount",value:function(){this.props.contentWindow&&this.props.contentWindow.addEventListener("resize",this.bindedHandleWindowResize),this.lineHeightPx=(0,y.default)((0,m.findDOMNode)(this.content)),this.setSizesToState()}},{key:"componentWillUnmount",value:function(){this.props.contentWindow&&this.props.contentWindow.removeEventListener("resize",this.bindedHandleWindowResize)}},{key:"componentDidUpdate",value:function(){this.setSizesToState()}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,o=t.className,r=t.contentClassName,i=t.ownerDocument,a=this.props.smoothScrolling&&(this.state.eventType===g.wheel||this.state.eventType===g.api||this.state.eventType===g.touchEnd||this.state.eventType===g.keyPress),l=this.canScrollY()?f.default.createElement(S.default,{ownerDocument:i,realSize:this.state.realHeight,containerSize:this.state.containerHeight,position:this.state.topPosition,onMove:this.handleScrollbarMove.bind(this),onPositionChange:this.handleScrollbarYPositionChange.bind(this),containerStyle:this.props.verticalContainerStyle,scrollbarStyle:this.props.verticalScrollbarStyle,smoothScrolling:a,minScrollSize:this.props.minScrollSize,onFocus:this.focusContent.bind(this),type:"vertical"}):null,u=this.canScrollX()?f.default.createElement(S.default,{ownerDocument:i,realSize:this.state.realWidth,containerSize:this.state.containerWidth,position:this.state.leftPosition,onMove:this.handleScrollbarMove.bind(this),onPositionChange:this.handleScrollbarXPositionChange.bind(this),containerStyle:this.props.horizontalContainerStyle,scrollbarStyle:this.props.horizontalScrollbarStyle,smoothScrolling:a,minScrollSize:this.props.minScrollSize,onFocus:this.focusContent.bind(this),type:"horizontal"}):null;"function"==typeof n?((0,m.warnAboutFunctionChild)(),n=n()):(0,m.warnAboutElementChild)();var c="scrollarea "+(o||""),p="scrollarea-content "+(r||""),d={marginTop:-this.state.topPosition,marginLeft:-this.state.leftPosition},h=a?(0,m.modifyObjValues)(d,function(e){return(0,v.spring)(e)}):d;return f.default.createElement(v.Motion,{style:h},function(t){return f.default.createElement("div",{ref:function(t){return e.wrapper=t},className:c,style:e.props.style,onWheel:e.handleWheel.bind(e)},f.default.createElement("div",{ref:function(t){return e.content=t},style:s({},e.props.contentStyle,t),className:p,onTouchStart:e.handleTouchStart.bind(e),onTouchMove:e.handleTouchMove.bind(e),onTouchEnd:e.handleTouchEnd.bind(e),onKeyDown:e.handleKeyDown.bind(e),tabIndex:e.props.focusableTabIndex},n),l,u)})}},{key:"setStateFromEvent",value:function(e,t){this.props.onScroll&&this.props.onScroll(e),this.setState(s({},e,{eventType:t}))}},{key:"handleTouchStart",value:function(e){var t=e.touches;if(1===t.length){var n=t[0],o=n.clientX,r=n.clientY;this.eventPreviousValues=s({},this.eventPreviousValues,{clientY:r,clientX:o,timestamp:Date.now()})}}},{key:"handleTouchMove",value:function(e){this.canScroll()&&(e.preventDefault(),e.stopPropagation());var t=e.touches;if(1===t.length){var n=t[0],o=n.clientX,r=n.clientY,i=this.eventPreviousValues.clientY-r,a=this.eventPreviousValues.clientX-o;this.eventPreviousValues=s({},this.eventPreviousValues,{deltaY:i,deltaX:a,clientY:r,clientX:o,timestamp:Date.now()}),this.setStateFromEvent(this.composeNewState(-a,-i))}}},{key:"handleTouchEnd",value:function(e){var t=this.eventPreviousValues,n=t.deltaX,o=t.deltaY,r=t.timestamp;void 0===n&&(n=0),void 0===o&&(o=0),Date.now()-r<200&&this.setStateFromEvent(this.composeNewState(10*-n,10*-o),g.touchEnd),this.eventPreviousValues=s({},this.eventPreviousValues,{deltaY:0,deltaX:0})}},{key:"handleScrollbarMove",value:function(e,t){this.setStateFromEvent(this.composeNewState(t,e))}},{key:"handleScrollbarXPositionChange",value:function(e){this.scrollXTo(e)}},{key:"handleScrollbarYPositionChange",value:function(e){this.scrollYTo(e)}},{key:"handleWheel",value:function(e){var t=e.deltaY,n=e.deltaX;if(this.props.swapWheelAxes){var o=[n,t];t=o[0],n=o[1]}1===e.deltaMode&&(t*=this.lineHeightPx,n*=this.lineHeightPx),t*=this.props.speed,n*=this.props.speed;var r=this.composeNewState(-n,-t);(r.topPosition&&this.state.topPosition!==r.topPosition||r.leftPosition&&this.state.leftPosition!==r.leftPosition||this.props.stopScrollPropagation)&&(e.preventDefault(),e.stopPropagation()),this.setStateFromEvent(r,g.wheel),this.focusContent()}},{key:"handleKeyDown",value:function(e){if("input"!==e.target.tagName.toLowerCase()&&"textarea"!==e.target.tagName.toLowerCase()&&!e.target.isContentEditable){var t=0,n=0,o=this.lineHeightPx?this.lineHeightPx:10;switch(e.keyCode){case 33:t=this.state.containerHeight-o;break;case 34:t=-this.state.containerHeight+o;break;case 37:n=o;break;case 38:t=o;break;case 39:n=-o;break;case 40:t=-o}if(0!==t||0!==n){var r=this.composeNewState(n,t);e.preventDefault(),e.stopPropagation(),this.setStateFromEvent(r,g.keyPress)}}}},{key:"handleWindowResize",value:function(){var e=this.computeSizes();e=this.getModifiedPositionsIfNeeded(e),this.setStateFromEvent(e)}},{key:"composeNewState",value:function(e,t){var n=this.computeSizes();return this.canScrollY(n)?n.topPosition=this.computeTopPosition(t,n):n.topPosition=0,this.canScrollX(n)&&(n.leftPosition=this.computeLeftPosition(e,n)),n}},{key:"computeTopPosition",value:function(e,t){var n=this.state.topPosition-e;return this.normalizeTopPosition(n,t)}},{key:"computeLeftPosition",value:function(e,t){var n=this.state.leftPosition-e;return this.normalizeLeftPosition(n,t)}},{key:"normalizeTopPosition",value:function(e,t){return e>t.realHeight-t.containerHeight&&(e=t.realHeight-t.containerHeight),e<0&&(e=0),e}},{key:"normalizeLeftPosition",value:function(e,t){return e>t.realWidth-t.containerWidth?e=t.realWidth-t.containerWidth:e<0&&(e=0),e}},{key:"computeSizes",value:function(){return{realHeight:this.content.offsetHeight,containerHeight:this.wrapper.offsetHeight,realWidth:this.content.offsetWidth,containerWidth:this.wrapper.offsetWidth}}},{key:"setSizesToState",value:function(){var e=this.computeSizes();e.realHeight===this.state.realHeight&&e.realWidth===this.state.realWidth||this.setStateFromEvent(this.getModifiedPositionsIfNeeded(e))}},{key:"scrollTop",value:function(){this.scrollYTo(0)}},{key:"scrollBottom",value:function(){this.scrollYTo(this.state.realHeight-this.state.containerHeight)}},{key:"scrollLeft",value:function(){this.scrollXTo(0)}},{key:"scrollRight",value:function(){this.scrollXTo(this.state.realWidth-this.state.containerWidth)}},{key:"scrollYTo",value:function(e){if(this.canScrollY()){var t=this.normalizeTopPosition(e,this.computeSizes());this.setStateFromEvent({topPosition:t},g.api)}}},{key:"scrollXTo",value:function(e){if(this.canScrollX()){var t=this.normalizeLeftPosition(e,this.computeSizes());this.setStateFromEvent({leftPosition:t},g.api)}}},{key:"canScrollY",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return e.realHeight>e.containerHeight&&this.props.vertical}},{key:"canScrollX",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return e.realWidth>e.containerWidth&&this.props.horizontal}},{key:"canScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;return this.canScrollY(e)||this.canScrollX(e)}},{key:"getModifiedPositionsIfNeeded",value:function(e){var t=e.realHeight-e.containerHeight;this.state.topPosition>=t&&(e.topPosition=this.canScrollY(e)?(0,m.positiveOrZero)(t):0);var n=e.realWidth-e.containerWidth;return this.state.leftPosition>=n&&(e.leftPosition=this.canScrollX(e)?(0,m.positiveOrZero)(n):0),e}},{key:"focusContent",value:function(){this.content&&(0,m.findDOMNode)(this.content).focus()}}]),t}(f.default.Component);t.default=w,w.childContextTypes={scrollArea:d.default.object},w.propTypes={className:d.default.string,style:d.default.object,speed:d.default.number,contentClassName:d.default.string,contentStyle:d.default.object,vertical:d.default.bool,verticalContainerStyle:d.default.object,verticalScrollbarStyle:d.default.object,horizontal:d.default.bool,horizontalContainerStyle:d.default.object,horizontalScrollbarStyle:d.default.object,onScroll:d.default.func,contentWindow:d.default.any,ownerDocument:d.default.any,smoothScrolling:d.default.bool,minScrollSize:d.default.number,swapWheelAxes:d.default.bool,stopScrollPropagation:d.default.bool,focusableTabIndex:d.default.number},w.defaultProps={speed:1,vertical:!0,horizontal:!0,smoothScrolling:!1,swapWheelAxes:!1,contentWindow:"object"===("undefined"==typeof window?"undefined":l(window))?window:void 0,ownerDocument:"object"===("undefined"==typeof document?"undefined":l(document))?document:void 0,focusableTabIndex:1}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(1),c=o(u),f=n(2),p=o(f),d=n(12),h=n(9),y=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),o=n.calculateState(e);return n.state={position:o.position,scrollSize:o.scrollSize,isDragging:!1,lastClientPosition:0},"vertical"===e.type?n.bindedHandleMouseMove=n.handleMouseMoveForVertical.bind(n):n.bindedHandleMouseMove=n.handleMouseMoveForHorizontal.bind(n),n.bindedHandleMouseUp=n.handleMouseUp.bind(n),n}return a(t,e),s(t,[{key:"componentDidMount",value:function(){this.props.ownerDocument&&(this.props.ownerDocument.addEventListener("mousemove",this.bindedHandleMouseMove),this.props.ownerDocument.addEventListener("mouseup",this.bindedHandleMouseUp))}},{key:"componentWillReceiveProps",value:function(e){this.setState(this.calculateState(e))}},{key:"componentWillUnmount",value:function(){this.props.ownerDocument&&(this.props.ownerDocument.removeEventListener("mousemove",this.bindedHandleMouseMove),this.props.ownerDocument.removeEventListener("mouseup",this.bindedHandleMouseUp))}},{key:"calculateFractionalPosition",value:function(e,t,n){var o=e-t;return 1-(o-n)/o}},{key:"calculateState",value:function(e){var t=this.calculateFractionalPosition(e.realSize,e.containerSize,e.position),n=e.containerSize*e.containerSize/e.realSize,o=n<e.minScrollSize?e.minScrollSize:n,r=(e.containerSize-o)*t;return{scrollSize:o,position:Math.round(r)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.smoothScrolling,o=t.isDragging,r=t.type,i=t.scrollbarStyle,a=t.containerStyle,s="horizontal"===r,u="vertical"===r,f=this.createScrollStyles(),p=n?(0,h.modifyObjValues)(f,function(e){return(0,d.spring)(e)}):f,y="scrollbar-container "+(o?"active":"")+" "+(s?"horizontal":"")+" "+(u?"vertical":"");return c.default.createElement(d.Motion,{style:p},function(t){return c.default.createElement("div",{className:y,style:a,onMouseDown:e.handleScrollBarContainerClick.bind(e),ref:function(t){return e.scrollbarContainer=t}},c.default.createElement("div",{className:"scrollbar",style:l({},i,t),onMouseDown:e.handleMouseDown.bind(e)}))})}},{key:"handleScrollBarContainerClick",value:function(e){e.preventDefault();var t=this.computeMultiplier(),n=this.isVertical()?e.clientY:e.clientX,o=this.scrollbarContainer.getBoundingClientRect(),r=o.top,i=o.left,a=this.isVertical()?r:i,l=n-a,s=this.props.containerSize*this.props.containerSize/this.props.realSize;this.setState({isDragging:!0,lastClientPosition:n}),this.props.onPositionChange((l-s/2)/t)}},{key:"handleMouseMoveForHorizontal",value:function(e){var t=this.computeMultiplier();if(this.state.isDragging){e.preventDefault();var n=this.state.lastClientPosition-e.clientX;this.setState({lastClientPosition:e.clientX}),this.props.onMove(0,n/t)}}},{key:"handleMouseMoveForVertical",value:function(e){var t=this.computeMultiplier();if(this.state.isDragging){e.preventDefault();var n=this.state.lastClientPosition-e.clientY;this.setState({lastClientPosition:e.clientY}),this.props.onMove(n/t,0)}}},{key:"handleMouseDown",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.isVertical()?e.clientY:e.clientX;this.setState({isDragging:!0,lastClientPosition:t}),this.props.onFocus()}},{key:"handleMouseUp",value:function(e){this.state.isDragging&&(e.preventDefault(),this.setState({isDragging:!1}))}},{key:"createScrollStyles",value:function(){return"vertical"===this.props.type?{height:this.state.scrollSize,marginTop:this.state.position}:{width:this.state.scrollSize,marginLeft:this.state.position}}},{key:"computeMultiplier",value:function(){return this.props.containerSize/this.props.realSize}},{key:"isVertical",value:function(){return"vertical"===this.props.type}}]),t}(c.default.Component);y.propTypes={onMove:p.default.func,onPositionChange:p.default.func,onFocus:p.default.func,realSize:p.default.number,containerSize:p.default.number,position:p.default.number,containerStyle:p.default.object,scrollbarStyle:p.default.object,type:p.default.oneOf(["vertical","horizontal"]),ownerDocument:p.default.any,smoothScrolling:p.default.bool,minScrollSize:p.default.number},y.defaultProps={type:"vertical",smoothScrolling:!1},t.default=y},function(e,t){var n=function(e,t,n){return n=window.getComputedStyle,(n?n(e):e.currentStyle)[t.replace(/-(\w)/gi,function(e,t){return t.toUpperCase()})]};e.exports=n},function(e,t,n){t=e.exports=n(17)(),t.push([e.id,".scrollarea-content{margin:0;padding:0;overflow:hidden;position:relative}.scrollarea-content:focus{outline:0}.scrollarea{position:relative;overflow:hidden}.scrollarea .scrollbar-container{position:absolute;background:none;opacity:.1;z-index:9999;-webkit-transition:all .4s;transition:all .4s}.scrollarea .scrollbar-container.horizontal{width:100%;height:10px;left:0;bottom:0}.scrollarea .scrollbar-container.horizontal .scrollbar{width:20px;height:8px;background:#000;margin-top:1px}.scrollarea .scrollbar-container.vertical{width:10px;height:100%;right:0;top:0}.scrollarea .scrollbar-container.vertical .scrollbar{width:8px;height:20px;background:#000;margin-left:1px}.scrollarea .scrollbar-container.active,.scrollarea .scrollbar-container:hover{background:gray;opacity:.6!important}.scrollarea:hover .scrollbar-container{opacity:.3}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<t.length;r++){var a=t[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function o(e){var t=r(e,"line-height"),n=parseFloat(t,10);if(t===n+""){var o=e.style.lineHeight;e.style.lineHeight=t+"em",t=r(e,"line-height"),n=parseFloat(t,10),o?e.style.lineHeight=o:delete e.style.lineHeight}if(-1!==t.indexOf("pt")?(n*=4,n/=3):-1!==t.indexOf("mm")?(n*=96,n/=25.4):-1!==t.indexOf("cm")?(n*=96,n/=2.54):-1!==t.indexOf("in")?n*=96:-1!==t.indexOf("pc")&&(n*=16),n=Math.round(n),"normal"===t){var i=e.nodeName,a=document.createElement(i);a.innerHTML="&nbsp;";var l=r(e,"font-size");a.style.fontSize=l;var s=document.body;s.appendChild(a);n=a.offsetHeight,s.removeChild(a)}return n}var r=n(15);e.exports=o},function(e,t,n){"use strict";var o=n(21),r=n(22),i=n(20);e.exports=function(){function e(e,t,n,o,a,l){l!==i&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return n.checkPropTypes=o,n.PropTypes=n,n}},function(e,t){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t){"use strict";function n(e){return function(){return e}}var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},e.exports=o},function(e,t,n){"use strict";function o(e,t,n,o,i,a,l,s){if(r(t),!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,o,i,a,l,s],f=0;u=new Error(t.replace(/%s/g,function(){return c[f++]})),u.name="Invariant Violation"}throw u.framesToPop=1,u}}var r=function(e){};e.exports=o},function(e,t,n){(function(t){(function(){var n,o,r,i,a,l;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},o=t.hrtime,n=function(){var e;return e=o(),1e9*e[0]+e[1]},i=n(),l=1e9*t.uptime(),a=i-l):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(this)}).call(t,n(10))},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(6),u=o(s),c=n(3),f=o(c),p=n(8),d=o(p),h=n(4),y=o(h),v=n(5),m=o(v),b=n(7),S=o(b),g=n(1),w=o(g),P=n(2),T=o(P),k=1e3/60,O=function(e){function t(n){var o=this;r(this,t),e.call(this,n),this.wasAnimating=!1,this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyle=null,this.clearUnreadPropStyle=function(e){var t=!1,n=o.state,r=n.currentStyle,i=n.currentVelocity,l=n.lastIdealStyle,s=n.lastIdealVelocity;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var c=e[u];"number"==typeof c&&(t||(t=!0,r=a({},r),i=a({},i),l=a({},l),s=a({},s)),r[u]=c,i[u]=0,l[u]=c,s[u]=0)}t&&o.setState({currentStyle:r,currentVelocity:i,lastIdealStyle:l,lastIdealVelocity:s})},this.startAnimationIfNecessary=function(){o.animationID=m.default(function(e){var t=o.props.style;if(S.default(o.state.currentStyle,t,o.state.currentVelocity))return o.wasAnimating&&o.props.onRest&&o.props.onRest(),o.animationID=null,o.wasAnimating=!1,void(o.accumulatedTime=0);o.wasAnimating=!0;var n=e||y.default(),r=n-o.prevTime;if(o.prevTime=n,o.accumulatedTime=o.accumulatedTime+r,o.accumulatedTime>10*k&&(o.accumulatedTime=0),0===o.accumulatedTime)return o.animationID=null,void o.startAnimationIfNecessary();var i=(o.accumulatedTime-Math.floor(o.accumulatedTime/k)*k)/k,a=Math.floor(o.accumulatedTime/k),l={},s={},u={},c={};for(var f in t)if(Object.prototype.hasOwnProperty.call(t,f)){var p=t[f];if("number"==typeof p)u[f]=p,c[f]=0,l[f]=p,s[f]=0;else{for(var h=o.state.lastIdealStyle[f],v=o.state.lastIdealVelocity[f],m=0;m<a;m++){var b=d.default(k/1e3,h,v,p.val,p.stiffness,p.damping,p.precision);h=b[0],v=b[1]}var g=d.default(k/1e3,h,v,p.val,p.stiffness,p.damping,p.precision),w=g[0],P=g[1];u[f]=h+(w-h)*i,c[f]=v+(P-v)*i,l[f]=h,s[f]=v}}o.animationID=null,o.accumulatedTime-=a*k,o.setState({currentStyle:u,currentVelocity:c,lastIdealStyle:l,lastIdealVelocity:s}),o.unreadPropStyle=null,o.startAnimationIfNecessary()})},this.state=this.defaultState()}return i(t,e),l(t,null,[{key:"propTypes",value:{defaultStyle:T.default.objectOf(T.default.number),style:T.default.objectOf(T.default.oneOfType([T.default.number,T.default.object])).isRequired,children:T.default.func.isRequired,onRest:T.default.func},enumerable:!0}]),t.prototype.defaultState=function(){var e=this.props,t=e.defaultStyle,n=e.style,o=t||f.default(n),r=u.default(o);return{currentStyle:o,currentVelocity:r,lastIdealStyle:o,lastIdealVelocity:r}},t.prototype.componentDidMount=function(){this.prevTime=y.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function(e){null!=this.unreadPropStyle&&this.clearUnreadPropStyle(this.unreadPropStyle),this.unreadPropStyle=e.style,null==this.animationID&&(this.prevTime=y.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function(){null!=this.animationID&&(m.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function(){var e=this.props.children(this.state.currentStyle);return e&&w.default.Children.only(e)},t}(w.default.Component);t.default=O,e.exports=t.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){for(var o=0;o<e.length;o++)if(!g.default(e[o],t[o],n[o]))return!1;return!0}t.__esModule=!0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}
}(),u=n(6),c=o(u),f=n(3),p=o(f),d=n(8),h=o(d),y=n(4),v=o(y),m=n(5),b=o(m),S=n(7),g=o(S),w=n(1),P=o(w),T=n(2),k=o(T),O=1e3/60,M=function(e){function t(n){var o=this;r(this,t),e.call(this,n),this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyles=null,this.clearUnreadPropStyle=function(e){for(var t=o.state,n=t.currentStyles,r=t.currentVelocities,i=t.lastIdealStyles,a=t.lastIdealVelocities,s=!1,u=0;u<e.length;u++){var c=e[u],f=!1;for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var d=c[p];"number"==typeof d&&(f||(f=!0,s=!0,n[u]=l({},n[u]),r[u]=l({},r[u]),i[u]=l({},i[u]),a[u]=l({},a[u])),n[u][p]=d,r[u][p]=0,i[u][p]=d,a[u][p]=0)}}s&&o.setState({currentStyles:n,currentVelocities:r,lastIdealStyles:i,lastIdealVelocities:a})},this.startAnimationIfNecessary=function(){o.animationID=b.default(function(e){var t=o.props.styles(o.state.lastIdealStyles);if(a(o.state.currentStyles,t,o.state.currentVelocities))return o.animationID=null,void(o.accumulatedTime=0);var n=e||v.default(),r=n-o.prevTime;if(o.prevTime=n,o.accumulatedTime=o.accumulatedTime+r,o.accumulatedTime>10*O&&(o.accumulatedTime=0),0===o.accumulatedTime)return o.animationID=null,void o.startAnimationIfNecessary();for(var i=(o.accumulatedTime-Math.floor(o.accumulatedTime/O)*O)/O,l=Math.floor(o.accumulatedTime/O),s=[],u=[],c=[],f=[],p=0;p<t.length;p++){var d=t[p],y={},m={},b={},S={};for(var g in d)if(Object.prototype.hasOwnProperty.call(d,g)){var w=d[g];if("number"==typeof w)y[g]=w,m[g]=0,b[g]=w,S[g]=0;else{for(var P=o.state.lastIdealStyles[p][g],T=o.state.lastIdealVelocities[p][g],k=0;k<l;k++){var M=h.default(O/1e3,P,T,w.val,w.stiffness,w.damping,w.precision);P=M[0],T=M[1]}var x=h.default(O/1e3,P,T,w.val,w.stiffness,w.damping,w.precision),I=x[0],D=x[1];y[g]=P+(I-P)*i,m[g]=T+(D-T)*i,b[g]=P,S[g]=T}}c[p]=y,f[p]=m,s[p]=b,u[p]=S}o.animationID=null,o.accumulatedTime-=l*O,o.setState({currentStyles:c,currentVelocities:f,lastIdealStyles:s,lastIdealVelocities:u}),o.unreadPropStyles=null,o.startAnimationIfNecessary()})},this.state=this.defaultState()}return i(t,e),s(t,null,[{key:"propTypes",value:{defaultStyles:k.default.arrayOf(k.default.objectOf(k.default.number)),styles:k.default.func.isRequired,children:k.default.func.isRequired},enumerable:!0}]),t.prototype.defaultState=function(){var e=this.props,t=e.defaultStyles,n=e.styles,o=t||n().map(p.default),r=o.map(function(e){return c.default(e)});return{currentStyles:o,currentVelocities:r,lastIdealStyles:o,lastIdealVelocities:r}},t.prototype.componentDidMount=function(){this.prevTime=v.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function(e){null!=this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles),this.unreadPropStyles=e.styles(this.state.lastIdealStyles),null==this.animationID&&(this.prevTime=v.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function(){null!=this.animationID&&(b.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function(){var e=this.props.children(this.state.currentStyles);return e&&P.default.Children.only(e)},t}(P.default.Component);t.default=M,e.exports=t.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t,n){var o=t;return null==o?e.map(function(e,t){return{key:e.key,data:e.data,style:n[t]}}):e.map(function(e,t){for(var r=0;r<o.length;r++)if(o[r].key===e.key)return{key:o[r].key,data:o[r].data,style:n[t]};return{key:e.key,data:e.data,style:n[t]}})}function l(e,t,n,o){if(o.length!==t.length)return!1;for(var r=0;r<o.length;r++)if(o[r].key!==t[r].key)return!1;for(var r=0;r<o.length;r++)if(!k.default(e[r],t[r].style,n[r]))return!1;return!0}function s(e,t,n,o,r,i,a,l,s){for(var u=b.default(o,r,function(e,o){var r=t(o);return null==r?(n({key:o.key,data:o.data}),null):k.default(i[e],r,a[e])?(n({key:o.key,data:o.data}),null):{key:o.key,data:o.data,style:r}}),c=[],f=[],d=[],h=[],y=0;y<u.length;y++){for(var v=u[y],m=null,S=0;S<o.length;S++)if(o[S].key===v.key){m=S;break}if(null==m){var g=e(v);c[y]=g,d[y]=g;var w=p.default(v.style);f[y]=w,h[y]=w}else c[y]=i[m],d[y]=l[m],f[y]=a[m],h[y]=s[m]}return[u,c,f,d,h]}t.__esModule=!0;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),f=n(6),p=o(f),d=n(3),h=o(d),y=n(8),v=o(y),m=n(27),b=o(m),S=n(4),g=o(S),w=n(5),P=o(w),T=n(7),k=o(T),O=n(1),M=o(O),x=n(2),I=o(x),D=1e3/60,_=function(e){function t(n){var o=this;r(this,t),e.call(this,n),this.unmounting=!1,this.animationID=null,this.prevTime=0,this.accumulatedTime=0,this.unreadPropStyles=null,this.clearUnreadPropStyle=function(e){for(var t=s(o.props.willEnter,o.props.willLeave,o.props.didLeave,o.state.mergedPropsStyles,e,o.state.currentStyles,o.state.currentVelocities,o.state.lastIdealStyles,o.state.lastIdealVelocities),n=t[0],r=t[1],i=t[2],a=t[3],l=t[4],c=0;c<e.length;c++){var f=e[c].style,p=!1;for(var d in f)if(Object.prototype.hasOwnProperty.call(f,d)){var h=f[d];"number"==typeof h&&(p||(p=!0,r[c]=u({},r[c]),i[c]=u({},i[c]),a[c]=u({},a[c]),l[c]=u({},l[c]),n[c]={key:n[c].key,data:n[c].data,style:u({},n[c].style)}),r[c][d]=h,i[c][d]=0,a[c][d]=h,l[c][d]=0,n[c].style[d]=h)}}o.setState({currentStyles:r,currentVelocities:i,mergedPropsStyles:n,lastIdealStyles:a,lastIdealVelocities:l})},this.startAnimationIfNecessary=function(){o.unmounting||(o.animationID=P.default(function(e){if(!o.unmounting){var t=o.props.styles,n="function"==typeof t?t(a(o.state.mergedPropsStyles,o.unreadPropStyles,o.state.lastIdealStyles)):t;if(l(o.state.currentStyles,n,o.state.currentVelocities,o.state.mergedPropsStyles))return o.animationID=null,void(o.accumulatedTime=0);var r=e||g.default(),i=r-o.prevTime;if(o.prevTime=r,o.accumulatedTime=o.accumulatedTime+i,o.accumulatedTime>10*D&&(o.accumulatedTime=0),0===o.accumulatedTime)return o.animationID=null,void o.startAnimationIfNecessary();for(var u=(o.accumulatedTime-Math.floor(o.accumulatedTime/D)*D)/D,c=Math.floor(o.accumulatedTime/D),f=s(o.props.willEnter,o.props.willLeave,o.props.didLeave,o.state.mergedPropsStyles,n,o.state.currentStyles,o.state.currentVelocities,o.state.lastIdealStyles,o.state.lastIdealVelocities),p=f[0],d=f[1],h=f[2],y=f[3],m=f[4],b=0;b<p.length;b++){var S=p[b].style,w={},P={},T={},k={};for(var O in S)if(Object.prototype.hasOwnProperty.call(S,O)){var M=S[O];if("number"==typeof M)w[O]=M,P[O]=0,T[O]=M,k[O]=0;else{for(var x=y[b][O],I=m[b][O],_=0;_<c;_++){var j=v.default(D/1e3,x,I,M.val,M.stiffness,M.damping,M.precision);x=j[0],I=j[1]}var C=v.default(D/1e3,x,I,M.val,M.stiffness,M.damping,M.precision),z=C[0],E=C[1];w[O]=x+(z-x)*u,P[O]=I+(E-I)*u,T[O]=x,k[O]=I}}y[b]=T,m[b]=k,d[b]=w,h[b]=P}o.animationID=null,o.accumulatedTime-=c*D,o.setState({currentStyles:d,currentVelocities:h,lastIdealStyles:y,lastIdealVelocities:m,mergedPropsStyles:p}),o.unreadPropStyles=null,o.startAnimationIfNecessary()}}))},this.state=this.defaultState()}return i(t,e),c(t,null,[{key:"propTypes",value:{defaultStyles:I.default.arrayOf(I.default.shape({key:I.default.string.isRequired,data:I.default.any,style:I.default.objectOf(I.default.number).isRequired})),styles:I.default.oneOfType([I.default.func,I.default.arrayOf(I.default.shape({key:I.default.string.isRequired,data:I.default.any,style:I.default.objectOf(I.default.oneOfType([I.default.number,I.default.object])).isRequired}))]).isRequired,children:I.default.func.isRequired,willEnter:I.default.func,willLeave:I.default.func,didLeave:I.default.func},enumerable:!0},{key:"defaultProps",value:{willEnter:function(e){return h.default(e.style)},willLeave:function(){return null},didLeave:function(){}},enumerable:!0}]),t.prototype.defaultState=function(){var e=this.props,t=e.defaultStyles,n=e.styles,o=e.willEnter,r=e.willLeave,i=e.didLeave,a="function"==typeof n?n(t):n,l=void 0;l=null==t?a:t.map(function(e){for(var t=0;t<a.length;t++)if(a[t].key===e.key)return a[t];return e});var u=null==t?a.map(function(e){return h.default(e.style)}):t.map(function(e){return h.default(e.style)}),c=null==t?a.map(function(e){return p.default(e.style)}):t.map(function(e){return p.default(e.style)}),f=s(o,r,i,l,a,u,c,u,c),d=f[0];return{currentStyles:f[1],currentVelocities:f[2],lastIdealStyles:f[3],lastIdealVelocities:f[4],mergedPropsStyles:d}},t.prototype.componentDidMount=function(){this.prevTime=g.default(),this.startAnimationIfNecessary()},t.prototype.componentWillReceiveProps=function(e){this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles);var t=e.styles;this.unreadPropStyles="function"==typeof t?t(a(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.lastIdealStyles)):t,null==this.animationID&&(this.prevTime=g.default(),this.startAnimationIfNecessary())},t.prototype.componentWillUnmount=function(){this.unmounting=!0,null!=this.animationID&&(P.default.cancel(this.animationID),this.animationID=null)},t.prototype.render=function(){var e=a(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.currentStyles),t=this.props.children(e);return t&&M.default.Children.only(t)},t}(M.default.Component);t.default=_,e.exports=t.default},function(e,t){"use strict";function n(e,t,n){for(var o={},r=0;r<e.length;r++)o[e[r].key]=r;for(var i={},r=0;r<t.length;r++)i[t[r].key]=r;for(var a=[],r=0;r<t.length;r++)a[r]=t[r];for(var r=0;r<e.length;r++)if(!Object.prototype.hasOwnProperty.call(i,e[r].key)){var l=n(r,e[r]);null!=l&&a.push(l)}return a.sort(function(e,n){var r=i[e.key],a=i[n.key],l=o[e.key],s=o[n.key];if(null!=r&&null!=a)return i[e.key]-i[n.key];if(null!=l&&null!=s)return o[e.key]-o[n.key];if(null!=r){for(var u=0;u<t.length;u++){var c=t[u].key;if(Object.prototype.hasOwnProperty.call(o,c)){if(r<i[c]&&s>o[c])return-1;if(r>i[c]&&s<o[c])return 1}}return 1}for(var u=0;u<t.length;u++){var c=t[u].key;if(Object.prototype.hasOwnProperty.call(o,c)){if(a<i[c]&&l>o[c])return 1;if(a>i[c]&&l<o[c])return-1}}return-1})}t.__esModule=!0,t.default=n,e.exports=t.default},function(e,t,n){"use strict";function o(){}t.__esModule=!0,t.default=o,e.exports=t.default},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return i({},s,t,{val:e})}t.__esModule=!0;var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.default=r;var a=n(11),l=o(a),s=i({},l.default.noWobble,{precision:.01});e.exports=t.default},function(e,t,n){function o(e,t){for(var n=0;n<e.length;n++){var o=e[n],r=d[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(u(o.parts[i],t))}else{for(var a=[],i=0;i<o.parts.length;i++)a.push(u(o.parts[i],t));d[o.id]={id:o.id,refs:1,parts:a}}}}function r(e){for(var t=[],n={},o=0;o<e.length;o++){var r=e[o],i=r[0],a=r[1],l=r[2],s=r[3],u={css:a,media:l,sourceMap:s};n[i]?n[i].parts.push(u):t.push(n[i]={id:i,parts:[u]})}return t}function i(e,t){var n=v(),o=S[S.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),S.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=S.indexOf(e);t>=0&&S.splice(t,1)}function l(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function u(e,t){var n,o,r;if(t.singleton){var i=b++;n=m||(m=l(t)),o=c.bind(null,n,i,!1),r=c.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),o=p.bind(null,n),r=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=l(t),o=f.bind(null,n),r=function(){a(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}function c(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=g(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function f(e,t){var n=t.css,o=t.media;if(o&&e.setAttribute("media",o),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function p(e,t){var n=t.css,o=t.sourceMap;o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var d={},h=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}},y=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=h(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,b=0,S=[];e.exports=function(e,t){t=t||{},void 0===t.singleton&&(t.singleton=y()),void 0===t.insertAt&&(t.insertAt="bottom");var n=r(e);return o(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var l=n[a],s=d[l.id];s.refs--,i.push(s)}if(e){o(r(e),t)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete d[s.id]}}}};var g=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){var o=n(16);"string"==typeof o&&(o=[[e.id,o,""]]),n(30)(o,{}),o.locals&&(e.exports=o.locals)}])})},{react:"react"}],2:[function(require,module,exports){"use strict";var isWebSocket=function(constructor){return constructor&&2===constructor.CLOSING},isGlobalWebSocket=function(){return"undefined"!=typeof WebSocket&&isWebSocket(WebSocket)},getDefaultOptions=function(){return{constructor:isGlobalWebSocket()?WebSocket:null,maxReconnectionDelay:1e4,minReconnectionDelay:1500,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,debug:!1}},bypassProperty=function(src,dst,name){Object.defineProperty(dst,name,{get:function(){return src[name]},set:function(value){src[name]=value},enumerable:!0,configurable:!0})},initReconnectionDelay=function(config){return config.minReconnectionDelay+Math.random()*config.minReconnectionDelay},updateReconnectionDelay=function(config,previousDelay){var newDelay=previousDelay*config.reconnectionDelayGrowFactor;return newDelay>config.maxReconnectionDelay?config.maxReconnectionDelay:newDelay},LEVEL_0_EVENTS=["onopen","onclose","onmessage","onerror"],reassignEventListeners=function(ws,oldWs,listeners){Object.keys(listeners).forEach(function(type){listeners[type].forEach(function(_a){var listener=_a[0],options=_a[1];ws.addEventListener(type,listener,options)})}),oldWs&&LEVEL_0_EVENTS.forEach(function(name){ws[name]=oldWs[name]})},ReconnectingWebsocket=function(url,protocols,options){var _this=this;void 0===options&&(options={});var ws,connectingTimeout,reconnectDelay=0,retriesCount=0,shouldRetry=!0,savedOnClose=null,listeners={};if(!(this instanceof ReconnectingWebsocket))throw new TypeError("Failed to construct 'ReconnectingWebSocket': Please use the 'new' operator");var config=getDefaultOptions();if(Object.keys(config).filter(function(key){return options.hasOwnProperty(key)}).forEach(function(key){return config[key]=options[key]}),!isWebSocket(config.constructor))throw new TypeError("Invalid WebSocket constructor. Set `options.constructor`");var log=config.debug?function(){for(var params=[],_i=0;_i<arguments.length;_i++)params[_i]=arguments[_i];return console.log.apply(console,["RWS:"].concat(params))}:function(){},emitError=function(code,msg){return setTimeout(function(){var err=new Error(msg);err.code=code,Array.isArray(listeners.error)&&listeners.error.forEach(function(_a){return(0,_a[0])(err)}),ws.onerror&&ws.onerror(err)},0)},handleClose=function(){if(log("handleClose",{shouldRetry:shouldRetry}),retriesCount++,log("retries count:",retriesCount),retriesCount>config.maxRetries)return void emitError("EHOSTDOWN","Too many failed connection attempts");reconnectDelay=reconnectDelay?updateReconnectionDelay(config,reconnectDelay):initReconnectionDelay(config),log("handleClose - reconnectDelay:",reconnectDelay),shouldRetry&&setTimeout(connect,reconnectDelay)},connect=function(){if(shouldRetry){log("connect");var oldWs=ws,wsUrl="function"==typeof url?url():url;ws=new config.constructor(wsUrl,protocols),connectingTimeout=setTimeout(function(){log("timeout"),ws.close(),emitError("ETIMEDOUT","Connection timeout")},config.connectionTimeout),log("bypass properties");for(var key in ws)["addEventListener","removeEventListener","close","send"].indexOf(key)<0&&bypassProperty(ws,_this,key);ws.addEventListener("open",function(){clearTimeout(connectingTimeout),log("open"),reconnectDelay=initReconnectionDelay(config),log("reconnectDelay:",reconnectDelay),retriesCount=0}),ws.addEventListener("close",handleClose),reassignEventListeners(ws,oldWs,listeners),ws.onclose=ws.onclose||savedOnClose,savedOnClose=null}};log("init"),connect(),this.close=function(code,reason,_a){void 0===code&&(code=1e3),void 0===reason&&(reason="");var _b=void 0===_a?{}:_a,_c=_b.keepClosed,keepClosed=void 0!==_c&&_c,_d=_b.fastClose,fastClose=void 0===_d||_d,_e=_b.delay,delay=void 0===_e?0:_e;if(log("close - params:",{reason:reason,keepClosed:keepClosed,fastClose:fastClose,delay:delay,retriesCount:retriesCount,maxRetries:config.maxRetries}),shouldRetry=!keepClosed&&retriesCount<=config.maxRetries,delay&&(reconnectDelay=delay),ws.close(code,reason),fastClose){var fakeCloseEvent_1={code:code,reason:reason,wasClean:!0};handleClose(),ws.removeEventListener("close",handleClose),Array.isArray(listeners.close)&&listeners.close.forEach(function(_a){var listener=_a[0],options=_a[1];listener(fakeCloseEvent_1),ws.removeEventListener("close",listener,options)}),ws.onclose&&(savedOnClose=ws.onclose,ws.onclose(fakeCloseEvent_1),ws.onclose=null)}},this.send=function(data){ws.send(data)},this.addEventListener=function(type,listener,options){Array.isArray(listeners[type])?listeners[type].some(function(_a){return _a[0]===listener})||listeners[type].push([listener,options]):listeners[type]=[[listener,options]],ws.addEventListener(type,listener,options)},this.removeEventListener=function(type,listener,options){Array.isArray(listeners[type])&&(listeners[type]=listeners[type].filter(function(_a){return _a[0]!==listener})),ws.removeEventListener(type,listener,options)}};module.exports=ReconnectingWebsocket},{}],3:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_ChatClient=require("./ChatClient"),_ChatClient2=_interopRequireDefault(_ChatClient),_Message=require("./Message"),_Message2=_interopRequireDefault(_Message),_viewsEmptyStateView=require("../views/EmptyStateView"),_viewsEmptyStateView2=_interopRequireDefault(_viewsEmptyStateView),_materialUi=require("material-ui"),_ChatUsers=require("./ChatUsers"),_ChatUsers2=_interopRequireDefault(_ChatUsers),_Pydio$requireLib=_pydio2.default.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,moment=_Pydio$requireLib.moment,Chat=function(_React$Component){_inherits(Chat,_React$Component);function Chat(props){_classCallCheck(this,Chat),_React$Component.call(this,props),this.client=null,this.state={messages:[],room:null,value:""},this._newMessageListener=this.onNewMessage.bind(this)}return Chat.prototype.componentDidMount=function(){this.join(this.props.roomType,this.props.roomObjectId)},Chat.prototype.componentWillUnmount=function(){this.stop()},Chat.prototype.componentDidUpdate=function(prevProps,prevState){prevState.messages.length<=this.state.messages.length&&(this.refs.comments.scrollTop=1e5)},Chat.prototype.componentWillReceiveProps=function(nextProps){var roomType=(nextProps.pydio,nextProps.roomType),roomObjectId=nextProps.roomObjectId;roomType===this.props.roomType&&roomObjectId===this.props.roomObjectId||(this.client&&this.client.leaveRoom(this.props.roomType,this.props.roomObjectId,this._newMessageListener),this.setState({messages:[],room:null,value:""}),roomType&&roomObjectId&&this.join(roomType,roomObjectId))},Chat.prototype.onRoomMessage=function(msg){msg&&this.setState({room:msg.Room})},Chat.prototype.onNewMessage=function(msg){var deleteMsg=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];msg&&(deleteMsg?this.setState({messages:this.state.messages.filter(function(m){return m.Uuid!==msg.Uuid})}):this.setState({messages:[].concat(this.state.messages,[msg])}))},Chat.prototype.join=function(roomType,roomObjectId){if(roomObjectId){var pydio=this.props.pydio;this.client=_ChatClient2.default.getInstance(pydio);var room=this.client.joinRoom(roomType,roomObjectId,this._newMessageListener,this.onRoomMessage.bind(this));null!==room&&this.setState({room:room}),this.client.loadHistory(roomType,roomObjectId)}},Chat.prototype.stop=function(){var _props=this.props,roomType=_props.roomType,roomObjectId=_props.roomObjectId;this.client&&this.client.leaveRoom(roomType,roomObjectId,this._newMessageListener)},Chat.prototype.postMessage=function(){if(this.state.value){var room=this.state.room;if(!room||!room.Uuid)return void console.error("Cannot find cell info");var message={"@type":"POST",Message:{RoomUuid:room.Uuid,Message:this.state.value}};this.client.send(JSON.stringify(message)),this.setState({value:""})}},Chat.prototype.deleteMessage=function(msg){var room=this.state.room;if(!room||!room.Uuid)return void console.error("Cannot find cell info");var message={"@type":"DELETE_MSG",Message:msg};this.client.send(JSON.stringify(message))},Chat.prototype.keyDown=function(event){"Enter"===event.key&&(event.preventDefault(),this.postMessage())},Chat.prototype.render=function(){var _this=this,_props2=this.props,style=_props2.style,msgContainerStyle=_props2.msgContainerStyle,fieldHint=_props2.fieldHint,emptyStateProps=_props2.emptyStateProps,pydio=_props2.pydio,pushMessagesToBottom=_props2.pushMessagesToBottom,computePresenceFromACLs=_props2.computePresenceFromACLs,_state=this.state,messages=_state.messages,room=_state.room,data=[],previousMDate=void 0,previousAuthor=void 0;messages.forEach(function(m){if(m.Message){var mDate=moment(1e3*parseFloat(m.Timestamp)).fromNow(),hideDate=previousMDate&&previousMDate===mDate,sameAuthor=previousAuthor&&previousAuthor===m.Author&&hideDate;data.push(_react2.default.createElement(_Message2.default,{key:m.Uuid,message:m,hideDate:hideDate,sameAuthor:sameAuthor,onDeleteMessage:function(){_this.deleteMessage(m)}})),previousMDate=mDate,previousAuthor=m.Author}});var pushStyle=void 0,pusher=void 0;pushMessagesToBottom&&(pushStyle={display:"flex",flexDirection:"column"},data&&data.length&&(pusher=_react2.default.createElement("span",{style:{flex:1}})));var emptyState=void 0;return!emptyStateProps||data&&data.length||(emptyState=_react2.default.createElement(_viewsEmptyStateView2.default,_extends({pydio:pydio},emptyStateProps))),_react2.default.createElement("div",{style:_extends({padding:0},style)},void 0!==computePresenceFromACLs&&_react2.default.createElement(_ChatUsers2.default,{pydio:pydio,ACLs:computePresenceFromACLs,roomUsers:room?room.Users:[]}),_react2.default.createElement("div",{ref:"comments",className:"comments_feed",style:_extends({maxHeight:300,overflowY:"auto"},pushStyle,msgContainerStyle)},pusher,data,emptyState),_react2.default.createElement("div",{style:{backgroundColor:"white",paddingLeft:16,paddingRight:16,borderTop:"1px solid #e0e0e0"}},_react2.default.createElement(_materialUi.TextField,{hintText:fieldHint,hintStyle:{whiteSpace:"nowrap"},value:this.state.value,onChange:function(event,newValue){_this.setState({value:newValue})},multiLine:!0,ref:"new_comment",onKeyDown:this.keyDown.bind(this),fullWidth:!0,underlineShow:!1})))},Chat}(_react2.default.Component);Chat.PropTypes={roomType:_react2.default.PropTypes.string,roomObjectId:_react2.default.PropTypes.string},exports.default=Chat=PydioContextConsumer(Chat),exports.default=Chat,module.exports=exports.default},{"../views/EmptyStateView":60,"./ChatClient":4,"./ChatUsers":6,"./Message":7,"material-ui":"material-ui",pydio:"pydio",react:"react"}],4:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _pydioHttpWebsocket=require("pydio/http/websocket"),_pydioHttpWebsocket2=_interopRequireDefault(_pydioHttpWebsocket),_reconnectingWebsocket=require("reconnecting-websocket"),_reconnectingWebsocket2=_interopRequireDefault(_reconnectingWebsocket),ChatClient=function(_PydioWebSocket){_inherits(ChatClient,_PydioWebSocket),ChatClient.getInstance=function(pydioObject){return void 0!==ChatClient._instance?ChatClient._instance:(ChatClient._instance=new ChatClient(pydioObject),ChatClient._instance)};function ChatClient(pydioObject){_classCallCheck(this,ChatClient),_PydioWebSocket.call(this,pydioObject),this.currentRepo=pydioObject.repositoryId,this.subscriptions={},this.rooms={},this.roomInfos={},this.open()}return ChatClient.prototype.getIdentifier=function(roomType,objectId){return roomType+":"+objectId},ChatClient.prototype.getRoomInfoFromIdentifier=function(identifier){var _identifier$split=identifier.split(":");return{roomType:_identifier$split[0],objectId:_identifier$split[1]}},ChatClient.prototype.onRoomMessage=function(msg){if(msg){var room=msg.Room,identifier=this.getIdentifier(room.Type,room.RoomTypeObject);this.roomInfos[identifier]=room}},ChatClient.prototype.joinRoom=function(roomType,objectId,messageHandler,roomUpdateHandler){var _this=this,retry=arguments.length<=4||void 0===arguments[4]?0:arguments[4],identifier=this.getIdentifier(roomType,objectId);if(this.subscriptions[identifier]){var already=!1;return this.subscriptions[identifier].map(function(v){v.messageHandler===messageHandler&&(already=!0)}),already||this.subscriptions[identifier].push({messageHandler:messageHandler,roomUpdateHandler:roomUpdateHandler}),this.roomInfos[identifier]}if(this.connecting){if(retry<3)return setTimeout(function(){_this.joinRoom(roomType,objectId,messageHandler,roomUpdateHandler,retry+1)},1500),null}else if(!this.connOpen)return this.open(),setTimeout(function(){_this.joinRoom(roomType,objectId,messageHandler,roomUpdateHandler,retry+1)},1500),null;this.subscriptions[roomType+":"+objectId]=[{messageHandler:messageHandler,roomUpdateHandler:roomUpdateHandler}];var message={"@type":"JOIN",Room:{Type:roomType,RoomTypeObject:objectId}};return this.ws.send(JSON.stringify(message)),this.roomInfos[identifier]},ChatClient.prototype.loadHistory=function(roomType,objectId){var _this2=this,retry=arguments.length<=2||void 0===arguments[2]?0:arguments[2];if(this.connecting&&retry<3)return void setTimeout(function(){_this2.loadHistory(roomType,objectId,retry+1)},1500);var message={"@type":"HISTORY",Room:{Type:roomType,RoomTypeObject:objectId}};this.ws.send(JSON.stringify(message))},ChatClient.prototype.leaveRoom=function(roomType,objectId){var _this3=this,messageHandler=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2],keep=!1,identifier=this.getIdentifier(roomType,objectId);if(this.subscriptions[identifier]&&(messageHandler?(this.subscriptions[identifier]=this.subscriptions[identifier].filter(function(v){return v.messageHandler!==messageHandler}),this.subscriptions[identifier].length?keep=!0:delete this.subscriptions[identifier]):delete this.subscriptions[identifier]),!keep&&(Object.keys(this.rooms).map(function(k){_this3.rooms[k]===identifier&&delete _this3.rooms[k]}),this.connOpen)){var message={"@type":"LEAVE",Room:{Type:roomType,RoomTypeObject:objectId}};this.ws.send(JSON.stringify(message))}},ChatClient.prototype.handleMessageReceived=function(msg){var _this4=this,data=JSON.parse(msg.data);if("ROOM_UPDATE"===data["@type"]){var identifier=this.getIdentifier(data.Room.Type,data.Room.RoomTypeObject);this.subscriptions[identifier]&&(this.rooms[data.Room.Uuid]||(this.rooms[data.Room.Uuid]=identifier),this.onRoomMessage(data),this.subscriptions[identifier].map(function(v){if(v.roomUpdateHandler)try{v.roomUpdateHandler(data)}catch(e){}}))}else!function(){var deleteMsg=!1,wsMessage=void 0;if("DELETE_MSG"===data["@type"]?(deleteMsg=!0,wsMessage=data.Message):wsMessage=data,wsMessage.RoomUuid&&_this4.rooms[wsMessage.RoomUuid]){var subs=_this4.subscriptions[_this4.rooms[wsMessage.RoomUuid]],withRoomUpdateHandler=subs.filter(function(v){return v.roomUpdateHandler});withRoomUpdateHandler.length&&(subs=withRoomUpdateHandler),subs.map(function(v){try{v.messageHandler(wsMessage,deleteMsg)}catch(e){}})}}()},ChatClient.prototype.send=function(message){this.ws.send(message)},ChatClient.prototype.open=function(){var _this5=this;if(this.close(),this.currentRepo){var url=this.pydio.Parameters.get("ENDPOINT_WEBSOCKET").replace("/event","/chat");this.ws=new _reconnectingWebsocket2.default(url,[],{maxReconnectionDelay:6e4,reconnectionDelayGrowFactor:1.6,maxRetries:10}),this.connecting=!0,this.ws.addEventListener("open",function(){_pydioHttpWebsocket2.default.subscribeJWT(_this5.ws).then(function(){_this5.connecting=!1,_this5.connOpen=!0}).catch(function(){_this5.connecting=!1,_this5.connOpen=!1})}),this.ws.addEventListener("message",function(msg){_this5.handleMessageReceived(msg)}),this.ws.addEventListener("close",function(event){_this5.connOpen=!1,_this5.connecting=!1,_pydioHttpWebsocket2.default.logClose(event)}),this.ws.addEventListener("error",function(error){"EHOSTDOWN"===error.code&&console.error("WebSocket maxRetries reached, host is down!")})}},ChatClient.prototype.close=function(){var _this6=this;null!==this.ws&&(Object.keys(this.subscriptions).map(function(k){
var _getRoomInfoFromIdentifier=_this6.getRoomInfoFromIdentifier(k),roomType=_getRoomInfoFromIdentifier.roomType,objectId=_getRoomInfoFromIdentifier.objectId;_this6.leaveRoom(roomType,objectId)}),this.ws.close(1e3,"Closing",{keepClosed:!0}))},ChatClient}(_pydioHttpWebsocket2.default);exports.default=ChatClient,module.exports=exports.default},{"pydio/http/websocket":"pydio/http/websocket","reconnecting-websocket":2}],5:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_ChatClient=require("./ChatClient"),_ChatClient2=_interopRequireDefault(_ChatClient),ChatIcon=function(_React$Component){_inherits(ChatIcon,_React$Component);function ChatIcon(props){_classCallCheck(this,ChatIcon),_React$Component.call(this,props),this.state={newMessages:0},this._messageListener=this.onMessage.bind(this)}return ChatIcon.prototype.onMessage=function(msg){arguments.length<=1||void 0===arguments[1]||!arguments[1]?this.setState({newMessages:this.state.newMessages+1}):this.setState({newMessages:Math.max(0,this.state.newMessages-1)})},ChatIcon.prototype.listenToRoom=function(roomType,objectId){_ChatClient2.default.getInstance(this.props.pydio).joinRoom(roomType,objectId,this._messageListener,null)},ChatIcon.prototype.leaveRoom=function(roomType,objectId){_ChatClient2.default.getInstance(this.props.pydio).leaveRoom(roomType,objectId,this._messageListener)},ChatIcon.prototype.componentDidMount=function(){var _props=this.props,roomType=_props.roomType,objectId=_props.objectId;this.listenToRoom(roomType,objectId)},ChatIcon.prototype.componentWillUnmount=function(){var _props2=this.props,roomType=_props2.roomType,objectId=_props2.objectId;this.leaveRoom(roomType,objectId)},ChatIcon.prototype.componentWillReceiveProps=function(nextProps){var _this=this,_props3=this.props,roomType=_props3.roomType,objectId=_props3.objectId;nextProps.roomType===roomType&&nextProps.objectId===objectId||(this.leaveRoom(roomType,objectId),this.setState({newMessages:0},function(){_this.listenToRoom(nextProps.roomType,nextProps.objectId)}))},ChatIcon.prototype.onClick=function(){this.props.pydio.Controller.fireAction("toggle_chat_panel"),this.setState({newMessages:0})},ChatIcon.prototype.render=function(){var newMessages=this.state.newMessages;if(0===newMessages)return null;var green="#8BC34A",style={display:"inline-block",padding:"0 5px",fontSize:15,textAlign:"center",color:green,fontWeight:500,position:"relative"},innerStyle={fontSize:13,display:"inline-block",position:"absolute",top:-1,marginLeft:2};return _react2.default.createElement("span",{onClick:this.onClick.bind(this),className:"mdi mdi-comment",style:style},_react2.default.createElement("span",{style:innerStyle},newMessages))},ChatIcon}(_react2.default.Component);exports.default=ChatIcon,module.exports=exports.default},{"./ChatClient":4,react:"react"}],6:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydioModelIdmObjectHelper=require("pydio/model/idm-object-helper"),_pydioModelIdmObjectHelper2=_interopRequireDefault(_pydioModelIdmObjectHelper),ChatUsers=function(_React$Component){_inherits(ChatUsers,_React$Component);function ChatUsers(){_classCallCheck(this,ChatUsers),_React$Component.apply(this,arguments)}return ChatUsers.prototype.render=function(){var _props=this.props,ACLs=_props.ACLs,roomUsers=_props.roomUsers,pydio=_props.pydio,style={user:{marginRight:10},online:{color:"#4CAF50",marginLeft:5},offline:{marginLeft:5}},users=Object.keys(ACLs).map(function(roleId){var acl=ACLs[roleId],online=void 0,label=_pydioModelIdmObjectHelper2.default.extractLabel(pydio,acl);return acl.User&&(online=!!(roomUsers&&roomUsers.indexOf(acl.User.Login)>-1)),_react2.default.createElement("span",{style:style.user},label,void 0!==online&&_react2.default.createElement("span",{className:"mdi mdi-checkbox-blank-circle"+(online?"":"-outline"),style:online?style.online:style.offline}),void 0===online&&_react2.default.createElement("span",{className:"mdi mdi-account-multiple-outline",style:style.offline}))});return _react2.default.createElement("div",{style:{padding:16,fontWeight:500,color:"#757575"}},users)},ChatUsers}(_react2.default.Component);exports.default=ChatUsers,module.exports=exports.default},{"pydio/model/idm-object-helper":"pydio/model/idm-object-helper",react:"react"}],7:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_usersAvatarUserAvatar=require("../users/avatar/UserAvatar"),_usersAvatarUserAvatar2=_interopRequireDefault(_usersAvatarUserAvatar),_materialUi=require("material-ui"),_pydioUtilDom=require("pydio/util/dom"),_pydioUtilDom2=_interopRequireDefault(_pydioUtilDom),_Pydio$requireLib=_pydio2.default.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,moment=_Pydio$requireLib.moment,Message=function(_React$Component){_inherits(Message,_React$Component);function Message(props){_classCallCheck(this,Message),_React$Component.call(this,props),this.state={hover:!1}}return Message.prototype.render=function(){var _this=this,_props=this.props,message=_props.message,pydio=_props.pydio,hideDate=_props.hideDate,sameAuthor=_props.sameAuthor,onDeleteMessage=_props.onDeleteMessage,mDate=moment(1e3*parseFloat(message.Timestamp)),styles={date:{color:"rgba(0,0,0,.23)",textAlign:"center",display:"flex",margin:"5px 0"},dateLine:{flex:1,margin:"10px 20px",borderBottom:"1px solid #eee"},comment:{padding:8,display:"flex",alignItems:"flex-start"},commentContent:{flex:"1",marginLeft:8,position:"relative",padding:"8px 10px",backgroundColor:"#eee"},commentDeleteBox:{position:"absolute",top:5,right:5,cursor:"pointer",fontSize:20,color:"#424242",opacity:0,transition:_pydioUtilDom2.default.getBeziersTransition()}},authorIsLogged=!1;pydio.user.id===message.Author&&(authorIsLogged=!0);var avatar=_react2.default.createElement("div",{style:sameAuthor?{visibility:"hidden"}:{paddingTop:2}},_react2.default.createElement(_usersAvatarUserAvatar2.default,{avatarSize:30,pydio:pydio,userId:message.Author,displayLabel:!1,richOnHover:!0,avatarLetters:!0})),textStyle=_extends({},styles.commentContent);authorIsLogged&&(textStyle=_extends({},textStyle,{marginLeft:0,marginRight:8})),sameAuthor&&(textStyle=_extends({},textStyle,{borderRadius:0}));var deleteBox=void 0;if(authorIsLogged){var hover=this.state.hover,deleteStyle=styles.commentDeleteBox;hover&&(deleteStyle.opacity=1),deleteBox=_react2.default.createElement("span",{onClick:onDeleteMessage,className:"mdi mdi-close",style:styles.commentDeleteBox,title:pydio.MessageHash[7]})}var text=_react2.default.createElement(_materialUi.Paper,{zDepth:0,style:textStyle},deleteBox,message.Message);return _react2.default.createElement("div",{style:sameAuthor?{marginTop:-16}:{},onMouseOver:function(){_this.setState({hover:!0})},onMouseOut:function(){_this.setState({hover:!1})}},!hideDate&&_react2.default.createElement("div",{style:styles.date},_react2.default.createElement("span",{style:styles.dateLine}),_react2.default.createElement("span",null,mDate.fromNow()),_react2.default.createElement("span",{style:styles.dateLine})),authorIsLogged&&_react2.default.createElement("div",{style:styles.comment},text," ",avatar),!authorIsLogged&&_react2.default.createElement("div",{style:styles.comment},avatar," ",text))},Message}(_react2.default.Component);Message.PropTypes={message:_react2.default.PropTypes.object,hideDate:_react2.default.PropTypes.bool,sameAuthor:_react2.default.PropTypes.bool},exports.default=Message=PydioContextConsumer(Message),exports.default=Message,module.exports=exports.default},{"../users/avatar/UserAvatar":57,"material-ui":"material-ui",pydio:"pydio","pydio/util/dom":"pydio/util/dom",react:"react"}],8:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Store=require("./Store"),_Store2=_interopRequireDefault(_Store),_GridBuilder=require("./GridBuilder"),_GridBuilder2=_interopRequireDefault(_GridBuilder),React=require("react"),Pydio=require("pydio"),_require=require("react-grid-layout"),Responsive=_require.Responsive,WidthProvider=_require.WidthProvider,_Pydio$requireLib=Pydio.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,CardsGrid=React.createClass({displayName:"CardsGrid",saveFullLayouts:function(allLayouts){this.props.store.getUserPreference("Layout")&&this.previousLayout&&this.previousLayout==JSON.stringify(allLayouts)||(this.previousLayout=JSON.stringify(allLayouts),this.props.store.saveUserPreference("Layout",allLayouts))},onLayoutChange:function(currentLayout,allLayouts){this._blockLayoutSave||this.saveFullLayouts(allLayouts)},componentWillUnmount:function(){this.props.store.stopObserving("cards",this._storeObserver)},componentWillReceiveProps:function(nextProps){this.props&&nextProps.editMode!==this.props.editMode&&Object.keys(this.refs).forEach(function(k){this.refs[k].toggleEditMode(nextProps.editMode)}.bind(this))},shouldComponentUpdate:function(nextProps,nextState){return this._forceUpdate||!1},getInitialState:function(){return this._storeObserver=function(e){var _this=this;this._forceUpdate=!0,this.setState({cards:this.props.store.getCards()},function(){_this._forceUpdate=!1})}.bind(this),this.props.store.observe("cards",this._storeObserver),{cards:this.props.store.getCards()}},removeCard:function(itemKey){this.props.removeCard(itemKey)},buildCards:function(cards){var index=0,layouts={lg:[],md:[],sm:[],xs:[],xxs:[]},items=[],additionalNamespaces=[],savedLayouts=(Math.random(),this.props.store.getUserPreference("Layout")),buildLayout=function(classObject,itemKey,item,x,y){var layout=classObject.getGridLayout(x,y);return layout.handle="h4",item.gridHandle&&(layout.handle=item.gridHandle),layout.i=itemKey,layout};return cards.map(function(item){var classObject,parts=item.componentClass.split("."),classNS=parts[0],className=parts[1];if(!global[classNS]||!global[classNS][className])return void(global[classNS]||additionalNamespaces.push(classNS));classObject=global[classNS][className];var props=_extends({},item.props),itemKey=props.key=item.id||"item_"+index;props.ref=itemKey,props.pydio=this.props.pydio,props.onCloseAction=function(){this.removeCard(itemKey)}.bind(this),props.preferencesProvider=this.props.store;var defaultX=0,defaultY=0;item.defaultPosition&&(defaultX=item.defaultPosition.x,defaultY=item.defaultPosition.y);var defaultLayout=buildLayout(classObject,itemKey,item,defaultX,defaultY);for(var breakpoint in layouts)if(layouts.hasOwnProperty(breakpoint)){var existing,breakLayout=layouts[breakpoint];if(savedLayouts&&savedLayouts[breakpoint]&&savedLayouts[breakpoint].map(function(gridData){gridData.i==itemKey&&gridData.h==defaultLayout.h&&(existing=gridData)}),existing)breakLayout.push(existing);else if(item.defaultLayouts&&item.defaultLayouts[breakpoint]){var crtLayout=buildLayout(classObject,itemKey,item,item.defaultLayouts[breakpoint].x,item.defaultLayouts[breakpoint].y);breakLayout.push(crtLayout)}else breakLayout.push(defaultLayout)}index++,items.push(React.createElement(classObject,props))}.bind(this)),additionalNamespaces.length&&(this._blockLayoutSave=!0,ResourcesManager.loadClassesAndApply(additionalNamespaces,function(){this.setState({additionalNamespacesLoaded:additionalNamespaces},function(){this._blockLayoutSave=!1}.bind(this))}.bind(this))),{cards:items,layouts:layouts}},render:function(){var _buildCards=this.buildCards(this.state.cards),cards=_buildCards.cards,layouts=_buildCards.layouts,ResponsiveGridLayout=WidthProvider(Responsive);return React.createElement(ResponsiveGridLayout,{className:"dashboard-layout",cols:this.props.cols||{lg:10,md:8,sm:8,xs:4,xxs:2},layouts:layouts,rowHeight:5,onLayoutChange:this.onLayoutChange,isDraggable:!this.props.disableDrag,style:this.props.style,autoSize:!1},cards)}}),DynamicGrid=React.createClass({displayName:"DynamicGrid",propTypes:{storeNamespace:React.PropTypes.string.isRequired,builderNamespaces:React.PropTypes.array,defaultCards:React.PropTypes.array,pydio:React.PropTypes.instanceOf(Pydio),disableDrag:React.PropTypes.bool,disableEdit:React.PropTypes.bool},removeCard:function(cardId){this.state.store.removeCard(cardId)},addCard:function(cardDefinition){this.state.store.addCard(cardDefinition)},resetCardsAndLayout:function(){this.state.store.saveUserPreference("Layout",null),this.state.store.setCards(this.props.defaultCards)},getInitialState:function(){return{editMode:!1,store:new _Store2.default(this.props.storeNamespace,this.props.defaultCards,this.props.pydio)}},toggleEditMode:function(){this.setState({editMode:!this.state.editMode})},render:function(){var _this2=this,monitorWidgetEditing=function(status){this.setState({widgetEditing:status})}.bind(this),builder=void 0;this.props.builderNamespaces&&this.state.editMode&&(builder=React.createElement(_GridBuilder2.default,{className:"admin-helper-panel",namespaces:this.props.builderNamespaces,onCreateCard:this.addCard,onResetLayout:this.resetCardsAndLayout,onEditStatusChange:monitorWidgetEditing,getMessage:function(id){var ns=arguments.length<=1||void 0===arguments[1]?"ajxp_admin":arguments[1];return _this2.props.getMessage(id,ns)}}));var rglStyle=(this.props.style,this.props.rglStyle||{});return React.createElement("div",{style:_extends({},this.props.style,{width:"100%",flex:"1"}),className:this.state.editMode?"builder-open":""},!this.props.disableEdit&&React.createElement("div",{style:{position:"absolute",bottom:30,right:18,zIndex:11}},React.createElement(MaterialUI.FloatingActionButton,{tooltip:this.props.getMessage("home.49"),onClick:this.toggleEditMode,iconClassName:this.state.editMode?"icon-ok":"mdi mdi-pencil",mini:this.state.editMode,disabled:this.state.editMode&&this.state.widgetEditing})),builder,React.createElement("div",{className:"home-dashboard",style:{height:"100%"}},React.createElement(CardsGrid,{disableDrag:this.props.disableDrag,cols:this.props.cols,store:this.state.store,style:rglStyle,pydio:this.props.pydio,editMode:this.state.editMode,removeCard:this.removeCard})))}});exports.default=DynamicGrid=PydioContextConsumer(DynamicGrid),exports.default=DynamicGrid,module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./GridBuilder":9,"./Store":11,pydio:"pydio",react:"react","react-grid-layout":"react-grid-layout"}],9:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},React=require("react"),Pydio=require("pydio"),_Pydio$requireLib=Pydio.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,AsyncComponent=_Pydio$requireLib.AsyncComponent,GridBuilder=React.createClass({displayName:"GridBuilder",propTypes:{namespaces:React.PropTypes.array,onCreateCard:React.PropTypes.func,onEditStatusChange:React.PropTypes.func},getInitialState:function(){return{selectedIndex:0,availableWidgets:this.listAvailableWidgets()}},listAvailableWidgets:function(){var secondPass=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],widgets=[],additionalNamespaces=[];return this.props.namespaces.map(function(ns){if(!global[ns])return void additionalNamespaces.push(ns);for(var k in global[ns])if(global[ns].hasOwnProperty(k)){var widgetClass=global[ns][k];widgetClass.hasBuilderFields&&widgetClass.hasBuilderFields()&&widgets.push({reactClass:widgetClass,fullName:ns+"."+widgetClass.displayName})}}),additionalNamespaces.length&&!secondPass&&ResourcesManager.loadClassesAndApply(additionalNamespaces,function(){this.setState({availableWidgets:this.listAvailableWidgets(!0)})}.bind(this)),widgets},onDropDownChange:function(event,index,item){var defaultValues={};0!=index&&item.payload.reactClass.getBuilderFields().map(function(f){f.default&&(defaultValues[f.name]=f.default)}),this.props.onEditStatusChange&&this.props.onEditStatusChange(0!=index),this.setState({selectedIndex:index,selectedWidget:item.payload,currentFormValues:defaultValues})},cancel:function(){this.props.onEditStatusChange&&this.props.onEditStatusChange(!1),this.setState({selectedIndex:0})},onFormValueChange:function(newValues){this.setState({currentFormValues:newValues})},onFormSubmit:function(){var values=this.state.currentFormValues,selectedWidget=this.state.selectedWidget,title=values.title?values.title:values.legend;title||(title=this.state.selectedWidget.reactClass.builderDisplayName),this.props.onCreateCard({componentClass:selectedWidget.fullName,title:title,props:values}),this.cancel()},resetLayout:function(){window.confirm(this.props.getMessage("home.51"))&&this.props.onResetLayout()},render:function(){var form,add,getMessage=this.props.getMessage,selectorItems=[{payload:0,text:getMessage("home.50")}].concat(this.state.availableWidgets.map(function(w,index){return{payload:w,text:w.reactClass.builderDisplayName}})),selector=React.createElement(ReactMUI.DropDownMenu,{menuItems:selectorItems,onChange:this.onDropDownChange,selectedIndex:this.state.selectedIndex,autoWidth:!1,className:"widget-type-selector"});if(0!=this.state.selectedIndex){var fields=this.state.selectedWidget.reactClass.getBuilderFields(),defaultValues={};fields.map(function(f){f.default&&(defaultValues[f.name]=f.default)}),this.state.currentFormValues&&(defaultValues=LangUtils.mergeObjectsRecursive(defaultValues,this.state.currentFormValues)),form=React.createElement(AsyncComponent,{namespace:"PydioForm",componentName:"FormPanel",parameters:fields,depth:-1,values:defaultValues,onChange:this.onFormValueChange}),add=React.createElement("div",{style:{textAlign:"center",paddingBottom:100}},React.createElement(ReactMUI.RaisedButton,{label:getMessage("home.52"),onClick:this.onFormSubmit}),"",React.createElement(ReactMUI.RaisedButton,{label:getMessage("54",""),onClick:this.cancel}))}return React.createElement(ReactMUI.Paper,_extends({},this.props,{zDepth:3}),React.createElement("h3",null,getMessage("home.53")),React.createElement("div",{className:"legend"},getMessage("home.54"),React.createElement("br",null),getMessage("home.55")),selector,form,add,React.createElement("div",{style:{position:"absolute",bottom:30,left:10}},React.createElement(ReactMUI.FlatButton,{disabled:0!=this.state.selectedIndex,label:getMessage("home.56"),secondary:!0,onClick:this.resetLayout})))}});exports.default=GridBuilder=PydioContextConsumer(GridBuilder),exports.default=GridBuilder,module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{pydio:"pydio",react:"react"}],10:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};exports.default={propTypes:{showCloseAction:React.PropTypes.bool,onCloseAction:React.PropTypes.func},focusItem:function(){this.setState({focus:!0})},blurItem:function(){this.setState({focus:!1})},mergeStyleWithFocus:function(){return _extends({},this.props.style,{zIndex:this.state.focus?1:null})},getInitialSate:function(){return{focus:!1,showCloseAction:!1}},toggleEditMode:function(){var value=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];void 0===value?this.setState({showCloseAction:!(this.state&&this.state.showCloseAction)}):this.setState({showCloseAction:value})},getCloseButton:function(){if(this.state&&this.state.showCloseAction){var closeAction=this.props.onCloseAction||function(){},overlayStyle={position:"absolute",backgroundColor:"rgba(0,0,0,0.53)",zIndex:10,top:0,left:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"};return React.createElement("div",{style:overlayStyle},React.createElement(MaterialUI.FlatButton,{label:pydio.MessageHash["ajxp_admin.home.48"],className:"card-close-button",onTouchTap:closeAction,style:{color:"white"}}))}return null},statics:{getGridLayout:function(x,y){return{x:x||0,y:y||0,w:this.gridWidth||4,h:this.gridHeight||12,isResizable:!1}},hasBuilderFields:function(){return!!this.builderFields},getBuilderFields:function(){return this.builderFields}}},module.exports=exports.default},{}],11:[function(require,module,exports){"use strict";exports.__esModule=!0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var Store=function(_Observable){_inherits(Store,_Observable);function Store(prefNamespace,defaultCards,pydioObject){_classCallCheck(this,Store),_Observable.call(this),this._namespace=prefNamespace,this._pydio=pydioObject,this._cards=this.getUserPreference("Cards"),this._cards||(this._cards=defaultCards)}return Store.prototype.getUserPreference=function(prefName){var prefKey=this._namespace+prefName,guiPrefs=this._pydio.user.getPreference("gui_preferences",!0);return guiPrefs&&guiPrefs[prefKey]?guiPrefs[prefKey]:null},Store.prototype.saveUserPreference=function(prefName,prefValue){var prefKey=this._namespace+prefName,guiPrefs=this._pydio.user.getPreference("gui_preferences",!0);guiPrefs||(guiPrefs={}),guiPrefs[prefKey]=prefValue,this._pydio.user.setPreference("gui_preferences",guiPrefs,!0),this._pydio.user.savePreference("gui_preferences")},Store.prototype.saveCards=function(cards){this.saveUserPreference("Cards",cards)},Store.prototype.resetCards=function(){this.saveUserPreference("Cards",null)},Store.prototype.setCards=function(newCards){this._cards=newCards,this.notify("cards",this._cards),this.saveCards(newCards)},Store.prototype.getCards=function(){return this._cards},Store.prototype.removeCard=function(cardId){var index=-1,currentCards=this.getCards();if(currentCards.map(function(card,arrayIndex){card.id==cardId&&(index=arrayIndex)}),-1==index)return void console.warn("Card ID not found, this is strange.",cardId);var newCards;newCards=0==index?currentCards.slice(1):index==currentCards.length-1?currentCards.slice(0,-1):currentCards.slice(0,index).concat(currentCards.slice(index+1)),this.setCards(newCards)},Store.prototype.createCardId=function(cardDefinition){var randomize=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],id=LangUtils.computeStringSlug(cardDefinition.title);randomize&&(id+="-"+Math.round(100*Math.random()+10));var alreadyExists=!1;return this._cards.map(function(card){card.id==id&&(alreadyExists=!0)}.bind(this)),alreadyExists&&(id=this.createCardId(cardDefinition,!0)),id},Store.prototype.addCard=function(cardDefinition){cardDefinition.id=this.createCardId(cardDefinition),this.setCards(this._cards.concat([cardDefinition]))},Store}(Observable);exports.default=Store,module.exports=exports.default},{}],12:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _require=require("react"),Component=_require.Component,PropTypes=_require.PropTypes,_require2=require("material-ui"),FlatButton=_require2.FlatButton,_require3=require("material-ui/styles"),muiThemeable=_require3.muiThemeable;exports.default=function(PydioComponent,displayName){var gridDimension=arguments.length<=2||void 0===arguments[2]?{gridWidth:4,gridHeight:12}:arguments[2],builderFields=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],originalDisplayName=PydioComponent.displayName||PydioComponent.name;PydioComponent=muiThemeable()(PydioComponent);var GridItem=function(_Component){_inherits(GridItem,_Component);function GridItem(props,context){_classCallCheck(this,GridItem),_Component.call(this,props,context),this.state={focus:!1,showCloseAction:!1}}return GridItem.prototype.focusItem=function(){this.setState({focus:!0})},GridItem.prototype.blurItem=function(){this.setState({focus:!1})},GridItem.prototype.mergeStyleWithFocus=function(){return _extends({},this.props.style,{zIndex:this.state.focus?1:null})},GridItem.prototype.toggleEditMode=function(){var value=arguments.length<=0||void 0===arguments[0]?void 0:arguments[0];void 0===value?this.setState({showCloseAction:!(this.state&&this.state.showCloseAction)}):this.setState({showCloseAction:value})},GridItem.prototype.getCloseButton=function(){var closeAction=this.props.onCloseAction||function(){},overlayStyle={position:"absolute",backgroundColor:"rgba(0,0,0,0.53)",zIndex:10,top:0,left:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center"};return React.createElement("div",{style:overlayStyle},React.createElement(FlatButton,{label:this.props.pydio.MessageHash["ajxp_admin.home.48"],className:"card-close-button",onTouchTap:closeAction,style:{color:"white"}}))},GridItem.prototype.render=function(){var props=_extends({},this.props,{style:this.mergeStyleWithFocus(),closeButton:this.state.showCloseAction?this.getCloseButton():null,onFocusItem:this.focusItem.bind(this),onBlurItem:this.blurItem.bind(this)});return React.createElement(PydioComponent,props)},GridItem}(Component);return GridItem.propTypes={onCloseAction:PropTypes.func},GridItem.displayName=originalDisplayName,GridItem.builderDisplayName=displayName,GridItem.getGridLayout=function(x,y){return{x:x||0,y:y||0,w:gridDimension.gridWidth||4,h:gridDimension.gridHeight||12,isResizable:!1}},GridItem.hasBuilderFields=function(){return void 0!==builderFields},GridItem.getBuilderFields=function(){return builderFields},GridItem},module.exports=exports.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",react:"react"}],13:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_materialUi=require("material-ui"),PaperEditorLayout=_react2.default.createClass({displayName:"PaperEditorLayout",propTypes:{title:_react2.default.PropTypes.any,titleActionBar:_react2.default.PropTypes.any,leftNav:_react2.default.PropTypes.any,contentFill:_react2.default.PropTypes.bool,className:_react2.default.PropTypes.string},toggleMenu:function(){var crtLeftOpen=this.state&&this.state.forceLeftOpen;this.setState({forceLeftOpen:!crtLeftOpen})},render:function(){var styles={title:{backgroundColor:"#455A64",borderRadius:"2px 2px 0 0",display:"flex"},titleH2:{color:"white",flex:1,fontSize:26,padding:"14px 12px 10px",marginBottom:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},titleBar:{marginTop:15,marginRight:16}};return _react2.default.createElement("div",{className:"paper-editor-content layout-fill vertical-layout"+(this.props.className?" "+this.props.className:"")},_react2.default.createElement("div",{className:"paper-editor-title",style:styles.title},_react2.default.createElement("h2",{style:styles.titleH2},this.props.title," ",_react2.default.createElement("div",{className:"left-picker-toggle"},_react2.default.createElement(_materialUi.IconButton,{iconClassName:"icon-caret-down",onClick:this.toggleMenu}))),_react2.default.createElement("div",{style:styles.titleBar},this.props.titleActionBar)),_react2.default.createElement("div",{className:"layout-fill main-layout-nav-to-stack"},this.props.leftNav&&_react2.default.createElement("div",{className:"paper-editor-left"+(this.state&&this.state.forceLeftOpen?" picker-open":""),onClick:this.toggleMenu},this.props.leftNav),_react2.default.createElement("div",{className:"layout-fill paper-editor-right"+(this.props.contentFill?" vertical-layout":""),style:this.props.contentFill?{}:{overflowY:"auto"}},this.props.children)))}}),PaperEditorNavHeader=_react2.default.createClass({displayName:"PaperEditorNavHeader",propTypes:{label:_react2.default.PropTypes.string},render:function(){return _react2.default.createElement("div",{className:"mui-subheader",style:{fontSize:13,fontWeight:500,color:"rgba(0, 0, 0, 0.25)",lineHeight:"48px",paddingLeft:16}},this.props.children,this.props.label)}}),PaperEditorNavEntry=_react2.default.createClass({
displayName:"PaperEditorNavEntry",propTypes:{keyName:_react2.default.PropTypes.string.isRequired,onClick:_react2.default.PropTypes.func.isRequired,label:_react2.default.PropTypes.string,selectedKey:_react2.default.PropTypes.string,isLast:_react2.default.PropTypes.bool,dropDown:_react2.default.PropTypes.bool,dropDownData:_react2.default.PropTypes.object,dropDownChange:_react2.default.PropTypes.func,dropDownDefaultItems:_react2.default.PropTypes.array},onClick:function(){this.props.onClick(this.props.keyName)},captureDropDownClick:function(){if(this.preventClick)return void(this.preventClick=!1);this.props.onClick(this.props.keyName)},dropDownChange:function(event,index,item){this.preventClick=!0,this.props.dropDownChange(item)},render:function(){if(!this.props.dropDown||!this.props.dropDownData)return _react2.default.createElement("div",{className:"menu-entry"+(this.props.keyName==this.props.selectedKey?" menu-entry-selected":"")+(this.props.isLast?" last":""),onClick:this.onClick},this.props.children,this.props.label);var menuItemsTpl=[{text:this.props.label,payload:"-1"}];return this.props.dropDownDefaultItems&&(menuItemsTpl=menuItemsTpl.concat(this.props.dropDownDefaultItems)),this.props.dropDownData.forEach(function(v,k){menuItemsTpl.push({text:v.label,payload:v})}),_react2.default.createElement("div",{onClick:this.captureDropDownClick,className:"menu-entry-dropdown"+(this.props.keyName==this.props.selectedKey?" menu-entry-selected":"")+(this.props.isLast?" last":"")},_react2.default.createElement(_materialUi.DropDownMenu,{menuItems:menuItemsTpl,className:"dropdown-full-width",style:{width:256},autoWidth:!1,onChange:this.dropDownChange}))}});exports.PaperEditorLayout=PaperEditorLayout,exports.PaperEditorNavEntry=PaperEditorNavEntry,exports.PaperEditorNavHeader=PaperEditorNavHeader},{"material-ui":"material-ui",react:"react"}],14:[function(require,module,exports){"use strict";exports.__esModule=!0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var propTypes={node:React.PropTypes.instanceOf(AjxpNode).isRequired,registry:React.PropTypes.instanceOf(Registry).isRequired,editorData:React.PropTypes.object.isRequired,icon:React.PropTypes.bool},defaultProps={icon:!1},ReactEditorOpener=function(_React$Component){_inherits(ReactEditorOpener,_React$Component);function ReactEditorOpener(props){_classCallCheck(this,ReactEditorOpener),_React$Component.call(this,props);props.node,props.editorData;this.state={ready:!1}}return ReactEditorOpener.prototype.componentDidMount=function(){var _this=this,_props=this.props,editorData=_props.editorData;_props.registry.loadEditorResources(editorData.resourcesManager,function(){return _this.setState({ready:!0})})},ReactEditorOpener.prototype.render=function(){var editorData=this.props.editorData;if(!this.state.ready)return null;var EditorClass=null;return(EditorClass=FuncUtils.getFunctionByName(editorData.editorClass,window))?React.createElement(EditorClass.Editor,this.props):React.createElement("div",null,"Cannot find editor component ("+editorData.editorClass+")!")},ReactEditorOpener}(React.Component);ReactEditorOpener.propTypes=propTypes,ReactEditorOpener.defaultProps=defaultProps,exports.default=ReactEditorOpener,module.exports=exports.default},{}],15:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};exports.default=React.createClass({displayName:"ClipboardTextField",propTypes:{floatingLabelText:React.PropTypes.string,inputValue:React.PropTypes.string,inputClassName:React.PropTypes.string,getMessage:React.PropTypes.func,inputCopyMessage:React.PropTypes.string},getInitialState:function(){return{copyMessage:null}},componentDidMount:function(){this.attachClipboard()},componentDidUpdate:function(){this.attachClipboard()},attachClipboard:function(){this._clip&&this._clip.destroy(),this.refs["copy-button"]&&(this._clip=new Clipboard(this.refs["copy-button"],{text:function(trigger){return this.props.inputValue}.bind(this)}),this._clip.on("success",function(){this.setState({copyMessage:this.props.getMessage(this.props.inputCopyMessage||"192")},this.clearCopyMessage)}.bind(this)),this._clip.on("error",function(){var copyMessage;copyMessage=0===global.navigator.platform.indexOf("Mac")?this.props.getMessage("144"):this.props.getMessage("143"),this.refs.input.focus(),this.setState({copyMessage:copyMessage},this.clearCopyMessage)}.bind(this)))},clearCopyMessage:function(){global.setTimeout(function(){this.setState({copyMessage:""})}.bind(this),3e3)},render:function(){var select=function(e){e.currentTarget.select()},copyMessage=null;if(this.state.copyMessage){var setHtml=function(){return{__html:this.state.copyMessage}}.bind(this);copyMessage=React.createElement("div",{style:{color:"rgba(0,0,0,0.23)"},className:"copy-message",dangerouslySetInnerHTML:setHtml()})}var buttonStyle=_extends({position:"absolute",right:-8,bottom:13,fontSize:15,color:this.props.buttonColor||"rgba(0, 150, 136, 0.52)",height:26,width:26,lineHeight:"28px",textAlign:"center",cursor:"pointer",borderRadius:"50%"},this.props.buttonStyle);return React.createElement("div",null,React.createElement("div",{style:{position:"relative"}},React.createElement(MaterialUI.TextField,{fullWidth:!0,ref:"input",floatingLabelText:this.props.floatingLabelText,floatingLabelStyle:{whiteSpace:"nowrap"},underlineShow:this.props.underlineShow,defaultValue:this.props.inputValue,className:this.props.inputClassName,multiLine:this.props.multiLine,rows:this.props.rows,rowsMax:this.props.rowsMax,readOnly:!0,onClick:select,style:{marginTop:-10,width:"92%",fontSize:14}}),React.createElement("span",{ref:"copy-button",style:buttonStyle,title:this.props.getMessage("191"),className:"copy-button mdi mdi-content-copy"})),copyMessage)}}),module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=React.createClass({displayName:"LabelWithTip",propTypes:{label:React.PropTypes.string,labelElement:React.PropTypes.object,tooltip:React.PropTypes.string,tooltipClassName:React.PropTypes.string,className:React.PropTypes.string,style:React.PropTypes.object},getInitialState:function(){return{show:!1}},show:function(){this.setState({show:!0})},hide:function(){this.setState({show:!1})},render:function(){if(this.props.tooltip){var tooltipStyle={};this.props.label||this.props.labelElement?this.state.show&&(tooltipStyle={bottom:-10,top:"inherit"}):tooltipStyle={position:"relative"};var label=void 0;this.props.label?label=React.createElement("span",{className:"ellipsis-label"},this.props.label):this.props.labelElement&&(label=this.props.labelElement);var style=this.props.style||{position:"relative"};return React.createElement("span",{onMouseEnter:this.show,onMouseLeave:this.hide,style:style,className:this.props.className},label,this.props.children,React.createElement(ReactMUI.Tooltip,{label:this.props.tooltip,style:tooltipStyle,className:this.props.tooltipClassName,show:this.state.show}))}return this.props.label?React.createElement("span",null,this.props.label):this.props.labelElement?this.props.labelElement:React.createElement("span",null,this.props.children)}}),module.exports=exports.default},{}],17:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=React.createClass({displayName:"SimpleFigureBadge",propTypes:{colorIndicator:React.PropTypes.string,figure:React.PropTypes.number.isRequired,legend:React.PropTypes.string},getDefaultProps:function(){return{colorIndicator:""}},render:function(){return React.createElement(ReactMUI.Paper,{style:{display:"inline-block",marginLeft:16}},React.createElement("div",{className:"figure-badge",style:this.props.colorIndicator?{borderLeftColor:this.props.colorIndicator}:{}},React.createElement("div",{className:"figure"},this.props.figure),React.createElement("div",{className:"legend"},this.props.legend)))}}),module.exports=exports.default},{}],18:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _listSortableList=require("./list/SortableList"),_listSortableList2=_interopRequireDefault(_listSortableList),_listSimpleList=require("./list/SimpleList"),_listSimpleList2=_interopRequireDefault(_listSimpleList),_listNodeListCustomProvider=require("./list/NodeListCustomProvider"),_listNodeListCustomProvider2=_interopRequireDefault(_listNodeListCustomProvider),_listListEntry=require("./list/ListEntry"),_listListPaginator=require("./list/ListPaginator"),_listListPaginator2=_interopRequireDefault(_listListPaginator),_listMaterialTable=require("./list/MaterialTable"),_listMaterialTable2=_interopRequireDefault(_listMaterialTable),_viewsTreeView=require("./views/TreeView"),_elementsLabelWithTip=require("./elements/LabelWithTip"),_elementsLabelWithTip2=_interopRequireDefault(_elementsLabelWithTip),_elementsSimpleFigureBadge=require("./elements/SimpleFigureBadge"),_elementsSimpleFigureBadge2=_interopRequireDefault(_elementsSimpleFigureBadge),_elementsClipboardTextField=require("./elements/ClipboardTextField"),_elementsClipboardTextField2=_interopRequireDefault(_elementsClipboardTextField),_viewsEmptyStateView=require("./views/EmptyStateView"),_viewsEmptyStateView2=_interopRequireDefault(_viewsEmptyStateView),_viewsModalAppBar=require("./views/ModalAppBar"),_viewsModalAppBar2=_interopRequireDefault(_viewsModalAppBar),_editorReactEditorOpener=require("./editor/ReactEditorOpener"),_editorReactEditorOpener2=_interopRequireDefault(_editorReactEditorOpener),_editorPaperEditor=require("./editor/PaperEditor"),_dynamicGridDynamicGrid=require("./dynamic-grid/DynamicGrid"),_dynamicGridDynamicGrid2=_interopRequireDefault(_dynamicGridDynamicGrid),_dynamicGridStore=require("./dynamic-grid/Store"),_dynamicGridStore2=_interopRequireDefault(_dynamicGridStore),_dynamicGridGridItemMixin=require("./dynamic-grid/GridItemMixin"),_dynamicGridGridItemMixin2=_interopRequireDefault(_dynamicGridGridItemMixin),_dynamicGridAsGridItem=require("./dynamic-grid/asGridItem"),_dynamicGridAsGridItem2=_interopRequireDefault(_dynamicGridAsGridItem),_utilDND=require("./util/DND"),_usersAvatarUserAvatar=require("./users/avatar/UserAvatar"),_usersAvatarUserAvatar2=_interopRequireDefault(_usersAvatarUserAvatar),_usersUsersCompleter=require("./users/UsersCompleter"),_usersUsersCompleter2=_interopRequireDefault(_usersUsersCompleter),_usersTeamCreationForm=require("./users/TeamCreationForm"),_usersTeamCreationForm2=_interopRequireDefault(_usersTeamCreationForm),_menuButtonMenu=require("./menu/ButtonMenu"),_menuButtonMenu2=_interopRequireDefault(_menuButtonMenu),_menuContextMenu=require("./menu/ContextMenu"),_menuContextMenu2=_interopRequireDefault(_menuContextMenu),_menuIconButtonMenu=require("./menu/IconButtonMenu"),_menuIconButtonMenu2=_interopRequireDefault(_menuIconButtonMenu),_menuToolbar=require("./menu/Toolbar"),_menuToolbar2=_interopRequireDefault(_menuToolbar),_usersAddressbookAddressBook=require("./users/addressbook/AddressBook"),_usersAddressbookAddressBook2=_interopRequireDefault(_usersAddressbookAddressBook),_chatChatClient=require("./chat/ChatClient"),_chatChatClient2=_interopRequireDefault(_chatChatClient),_chatChat=require("./chat/Chat"),_chatChat2=_interopRequireDefault(_chatChat),_chatChatIcon=require("./chat/ChatIcon"),_chatChatIcon2=_interopRequireDefault(_chatChatIcon),_policiesResourcePoliciesPanel=require("./policies/ResourcePoliciesPanel"),_policiesResourcePoliciesPanel2=_interopRequireDefault(_policiesResourcePoliciesPanel),_usersAvatarCellActionsRenderer=require("./users/avatar/CellActionsRenderer"),_usersAvatarCellActionsRenderer2=_interopRequireDefault(_usersAvatarCellActionsRenderer),PydioComponents={SortableList:_listSortableList2.default,SimpleList:_listSimpleList2.default,NodeListCustomProvider:_listNodeListCustomProvider2.default,ListEntry:_listListEntry.ListEntry,ListPaginator:_listListPaginator2.default,MaterialTable:_listMaterialTable2.default,TreeView:_viewsTreeView.TreeView,DNDTreeView:_viewsTreeView.DNDTreeView,FoldersTree:_viewsTreeView.FoldersTree,ClipboardTextField:_elementsClipboardTextField2.default,LabelWithTip:_elementsLabelWithTip2.default,EmptyStateView:_viewsEmptyStateView2.default,SimpleFigureBadge:_elementsSimpleFigureBadge2.default,ModalAppBar:_viewsModalAppBar2.default,ReactEditorOpener:_editorReactEditorOpener2.default,PaperEditorLayout:_editorPaperEditor.PaperEditorLayout,PaperEditorNavEntry:_editorPaperEditor.PaperEditorNavEntry,PaperEditorNavHeader:_editorPaperEditor.PaperEditorNavHeader,DynamicGrid:_dynamicGridDynamicGrid2.default,DynamicGridItemMixin:_dynamicGridGridItemMixin2.default,asGridItem:_dynamicGridAsGridItem2.default,DynamicGridStore:_dynamicGridStore2.default,DND:{Types:_utilDND.Types,collect:_utilDND.collect,collectDrop:_utilDND.collectDrop,nodeDragSource:_utilDND.nodeDragSource,nodeDropTarget:_utilDND.nodeDropTarget,DNDActionParameter:_utilDND.DNDActionParameter},DNDActionParameter:_utilDND.DNDActionParameter,UserAvatar:_usersAvatarUserAvatar2.default,UsersCompleter:_usersUsersCompleter2.default,TeamCreationForm:_usersTeamCreationForm2.default,AddressBook:_usersAddressbookAddressBook2.default,ContextMenu:_menuContextMenu2.default,Toolbar:_menuToolbar2.default,ButtonMenu:_menuButtonMenu2.default,IconButtonMenu:_menuIconButtonMenu2.default,Chat:_chatChat2.default,ChatIcon:_chatChatIcon2.default,ChatClient:_chatChatClient2.default,ResourcePoliciesPanel:_policiesResourcePoliciesPanel2.default,CellActionsRenderer:_usersAvatarCellActionsRenderer2.default};exports.default=PydioComponents,module.exports=exports.default},{"./chat/Chat":3,"./chat/ChatClient":4,"./chat/ChatIcon":5,"./dynamic-grid/DynamicGrid":8,"./dynamic-grid/GridItemMixin":10,"./dynamic-grid/Store":11,"./dynamic-grid/asGridItem":12,"./editor/PaperEditor":13,"./editor/ReactEditorOpener":14,"./elements/ClipboardTextField":15,"./elements/LabelWithTip":16,"./elements/SimpleFigureBadge":17,"./list/ListEntry":21,"./list/ListPaginator":23,"./list/MaterialTable":24,"./list/NodeListCustomProvider":25,"./list/SimpleList":26,"./list/SortableList":28,"./menu/ButtonMenu":32,"./menu/ContextMenu":33,"./menu/IconButtonMenu":34,"./menu/Toolbar":38,"./policies/ResourcePoliciesPanel":40,"./users/TeamCreationForm":41,"./users/UsersCompleter":43,"./users/addressbook/AddressBook":44,"./users/avatar/CellActionsRenderer":55,"./users/avatar/UserAvatar":57,"./util/DND":58,"./views/EmptyStateView":60,"./views/ModalAppBar":61,"./views/TreeView":63}],19:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_ListEntryNodeListenerMixin=require("./ListEntryNodeListenerMixin"),_ListEntryNodeListenerMixin2=_interopRequireDefault(_ListEntryNodeListenerMixin),_InlineEditor=require("./InlineEditor"),_InlineEditor2=_interopRequireDefault(_InlineEditor),_ListEntry=require("./ListEntry"),_materialUi=require("material-ui");exports.default=_react2.default.createClass({displayName:"ConfigurableListEntry",mixins:[_ListEntryNodeListenerMixin2.default],propTypes:{node:_react2.default.PropTypes.instanceOf(AjxpNode),renderIcon:_react2.default.PropTypes.func,renderFirstLine:_react2.default.PropTypes.func,renderSecondLine:_react2.default.PropTypes.func,renderThirdLine:_react2.default.PropTypes.func,renderActions:_react2.default.PropTypes.func,style:_react2.default.PropTypes.object},render:function(){var _this=this,icon=void 0,firstLine=void 0,secondLine=void 0,thirdLine=void 0,style=this.props.style||{};if(this.props.renderIcon)icon=this.props.renderIcon(this.props.node,this.props);else{var node=this.props.node,iconClass=node.getMetadata().get("icon_class")?node.getMetadata().get("icon_class"):node.isLeaf()?"icon-file-alt":"icon-folder-close";icon=_react2.default.createElement(_materialUi.FontIcon,{className:iconClass})}firstLine=this.props.renderFirstLine?this.props.renderFirstLine(this.props.node):this.props.node.getLabel(),this.state&&this.state.inlineEdition&&(firstLine=_react2.default.createElement("span",null,_react2.default.createElement(_InlineEditor2.default,{node:this.props.node,onClose:function(){_this.setState({inlineEdition:!1})},callback:this.state.inlineEditionCallback}),firstLine),style.position="relative"),this.props.renderSecondLine&&(secondLine=this.props.renderSecondLine(this.props.node)),this.props.renderThirdLine&&(thirdLine=this.props.renderThirdLine(this.props.node));var actions=this.props.actions;return this.props.renderActions&&(actions=this.props.renderActions(this.props.node)),_react2.default.createElement(_ListEntry.DragDropListEntry,_extends({},this.props,{iconCell:icon,firstLine:firstLine,secondLine:secondLine,thirdLine:thirdLine,actions:actions,style:style}))}}),module.exports=exports.default},{"./InlineEditor":20,"./ListEntry":21,"./ListEntryNodeListenerMixin":22,"material-ui":"material-ui",react:"react"}],20:[function(require,module,exports){"use strict";exports.__esModule=!0;var React=require("react"),Pydio=require("pydio"),AjxpNode=require("pydio/model/node"),_Pydio$requireLib=Pydio.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,_require=require("material-ui"),Paper=_require.Paper,TextField=_require.TextField,FlatButton=_require.FlatButton,InlineEditor=React.createClass({displayName:"InlineEditor",propTypes:{node:React.PropTypes.instanceOf(AjxpNode),callback:React.PropTypes.func,onClose:React.PropTypes.func,detached:React.PropTypes.bool},submit:function(){this.state&&this.state.value&&this.state.value!==this.props.node.getLabel()?(this.props.callback(this.state.value),this.props.onClose()):(this.setState({errorString:"Please use a different value for renaming!"}),this.props.getPydio().displayMessage("ERROR","Please use a different value for renaming!"))},componentDidMount:function(){this.refs.text.focus()},catchClicks:function(e){e.stopPropagation()},onKeyDown:function(e){"Enter"===e.key&&this.submit(),this.setState({errorString:""}),e.stopPropagation()},render:function(){var _this=this;return React.createElement(Paper,{className:"inline-editor"+(this.props.detached?" detached":""),style:{padding:8},zDepth:2},React.createElement(TextField,{ref:"text",defaultValue:this.props.node.getLabel(),onChange:function(e,value){_this.setState({value:value})},onClick:this.catch,onDoubleClick:this.catchClicks,tabIndex:"0",onKeyDown:this.onKeyDown,errorText:this.state?this.state.errorString:null}),React.createElement("div",{style:{textAlign:"right",paddingTop:8}},React.createElement(FlatButton,{label:"Cancel",onClick:this.props.onClose}),React.createElement(FlatButton,{label:"Submit",onClick:this.submit})))}});exports.default=InlineEditor=PydioContextConsumer(InlineEditor),exports.default=InlineEditor,module.exports=exports.default},{"material-ui":"material-ui",pydio:"pydio","pydio/model/node":"pydio/model/node",react:"react"}],21:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_utilDND=require("../util/DND"),_reactDnd=require("react-dnd"),_materialUi=require("material-ui"),_materialUiStyles=require("material-ui/styles"),_color=require("color"),_color2=_interopRequireDefault(_color),ListEntry=function(_React$Component){_inherits(ListEntry,_React$Component);function ListEntry(){_classCallCheck(this,ListEntry),_React$Component.apply(this,arguments)}return ListEntry.prototype.onClick=function(event){if(this.props.showSelector){if(this.props.selectorDisabled)return;this.props.onSelect(this.props.node,event),event.stopPropagation(),event.preventDefault()}else this.props.onClick&&this.props.onClick(this.props.node,event)},ListEntry.prototype.onDoubleClick=function(event){this.props.onDoubleClick&&this.props.onDoubleClick(this.props.node,event)},ListEntry.prototype.render=function(){var _this=this,selector=void 0,icon=void 0,_props=this.props,node=_props.node,showSelector=_props.showSelector,selected=_props.selected,selectorDisabled=_props.selectorDisabled,firstLine=_props.firstLine,secondLine=_props.secondLine,thirdLine=_props.thirdLine,style=_props.style,actions=_props.actions,iconCell=_props.iconCell,mainIcon=_props.mainIcon,className=_props.className,canDrop=_props.canDrop,isOver=_props.isOver,connectDragSource=_props.connectDragSource,connectDropTarget=_props.connectDropTarget,mainClasses=["material-list-entry","material-list-entry-"+(thirdLine?3:secondLine?2:1)+"-lines"];if(className&&mainClasses.push(className),showSelector&&(selector=React.createElement("div",{className:"material-list-selector"},React.createElement(_materialUi.Checkbox,{checked:selected,ref:"selector",disabled:selectorDisabled}))),iconCell)icon=this.props.iconCell;else if(this.props.mainIcon){var _style={fontSize:18,color:"#FFF",display:"inline-block",margin:16,backgroundColor:"rgb(189, 189, 189)",padding:"7px 3px",width:33,height:33,textAlign:"center"};icon=React.createElement(_materialUi.FontIcon,{className:"mui-font-icon "+this.props.mainIcon,style:_style})}canDrop&&isOver&&mainClasses.push("droppable-active"),node&&(mainClasses.push("listentry"+node.getPath().replace(/\//g,"_")),mainClasses.push("ajxp_node_"+(node.isLeaf()?"leaf":"collection")),node.getAjxpMime()&&mainClasses.push("ajxp_mime_"+node.getAjxpMime()));var additionalStyle={};if(this.state&&this.state.hover&&!this.props.noHover&&(additionalStyle=_extends({},additionalStyle,{backgroundColor:"rgba(0,0,0,0.05)",borderBottom:"1px solid transparent"})),selected){var selectionColor=this.props.muiTheme.palette.accent2Color,selectionColorDark=_color2.default(selectionColor).dark();additionalStyle=_extends({},additionalStyle,{backgroundColor:selectionColor,color:selectionColorDark?"white":"rgba(0,0,0,.87)"}),mainClasses.push("selected"),mainClasses.push("selected-"+(selectionColorDark?"dark":"light"))}return React.createElement(ContextMenuWrapper,_extends({},this.props,{ref:function(instance){var node=_reactDom2.default.findDOMNode(instance);"function"==typeof connectDropTarget&&connectDropTarget(node),"function"==typeof connectDragSource&&connectDragSource(node)},onClick:this.onClick.bind(this),onDoubleClick:showSelector?null:this.onDoubleClick.bind(this),className:mainClasses.join(" "),onMouseOver:function(){_this.setState({hover:!0})},onMouseOut:function(){_this.setState({hover:!1})},style:_extends({},style,additionalStyle)}),selector,React.createElement("div",{className:"material-list-icon"+(mainIcon||iconCell?"":" material-list-icon-none")},icon),React.createElement("div",{className:"material-list-text"},React.createElement("div",{key:"line-1",className:"material-list-line-1"},firstLine),React.createElement("div",{key:"line-2",className:"material-list-line-2"},secondLine),React.createElement("div",{key:"line-3",className:"material-list-line-3"},thirdLine)),React.createElement("div",{className:"material-list-actions"},actions))},ListEntry}(React.Component),ContextMenuWrapper=function(props){return React.createElement("div",props)};ContextMenuWrapper=PydioHOCs.withContextMenu(ContextMenuWrapper),ListEntry.propTypes={showSelector:React.PropTypes.bool,selected:React.PropTypes.bool,selectorDisabled:React.PropTypes.bool,onSelect:React.PropTypes.func,onClick:React.PropTypes.func,iconCell:React.PropTypes.element,mainIcon:React.PropTypes.string,firstLine:React.PropTypes.node,secondLine:React.PropTypes.node,thirdLine:React.PropTypes.node,actions:React.PropTypes.element,activeDroppable:React.PropTypes.bool,className:React.PropTypes.string,style:React.PropTypes.object,noHover:React.PropTypes.bool},exports.ListEntry=ListEntry=_materialUiStyles.muiThemeable()(ListEntry);var DragDropListEntry=_reactDnd.flow(_reactDnd.DragSource(_utilDND.Types.NODE_PROVIDER,_utilDND.nodeDragSource,_utilDND.collect),_reactDnd.DropTarget(_utilDND.Types.NODE_PROVIDER,_utilDND.nodeDropTarget,_utilDND.collectDrop))(ListEntry);exports.DragDropListEntry=DragDropListEntry,exports.ListEntry=ListEntry},{"../util/DND":58,color:"color","material-ui":"material-ui","material-ui/styles":"material-ui/styles","react-dnd":"react-dnd","react-dom":"react-dom"}],22:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default={attach:function(node){this._nodeListener=function(){if(!this.isMounted())return void this.detach(node);this.forceUpdate()}.bind(this),this._actionListener=function(eventMemo){return this.isMounted()?(eventMemo&&"prompt-rename"===eventMemo.type&&eventMemo.callback&&this.setState({inlineEdition:!0,inlineEditionCallback:eventMemo.callback}),!0):void this.detach(node)}.bind(this),node.observe("node_replaced",this._nodeListener),node.observe("node_action",this._actionListener)},detach:function(node){this._nodeListener&&(node.stopObserving("node_replaced",this._nodeListener),node.stopObserving("node_action",this._actionListener))},componentDidMount:function(){this.attach(this.props.node)},componentWillUnmount:function(){this.detach(this.props.node)}},module.exports=exports.default},{}],23:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_materialUi=require("material-ui"),_utilMessagesConsumerMixin=require("../util/MessagesConsumerMixin"),_utilMessagesConsumerMixin2=_interopRequireDefault(_utilMessagesConsumerMixin);exports.default=_react2.default.createClass({displayName:"ListPaginator",mixins:[_utilMessagesConsumerMixin2.default],propTypes:{dataModel:_react2.default.PropTypes.instanceOf(PydioDataModel).isRequired,node:_react2.default.PropTypes.instanceOf(AjxpNode)},componentDidMount:function(){var _this=this;this.props.node||function(){var dm=_this.props.dataModel;_this._dmObserver=function(){this.setState({node:dm.getContextNode()})}.bind(_this),dm.observe("context_changed",_this._dmObserver),_this.setState({node:dm.getContextNode()})}()},componentWillUnmount:function(){this._dmObserver&&this.props.dataModel.stopObserving("context_changed",this._dmObserver)},getInitialState:function(){return{node:this.props.node}},changePage:function(event){this.state.node.getMetadata().get("paginationData").set("new_page",event.currentTarget.getAttribute("data-page")),this.props.dataModel.requireContextChange(this.state.node)},onMenuChange:function(event,index,value){this.state.node.getMetadata().get("paginationData").set("new_page",value),this.props.dataModel.requireContextChange(this.state.node)},render:function(){var _this2=this;if(!this.state.node||!this.state.node.getMetadata().get("paginationData"))return null;for(var pData=this.state.node.getMetadata().get("paginationData"),current=parseInt(pData.get("current")),total=parseInt(pData.get("total")),pages=[],next=void 0,previous=void 0,pageWord=this.context.getMessage?this.context.getMessage("331",""):this.props.getMessage("331",""),i=1;i<=total;i++)pages.push(_react2.default.createElement(_materialUi.MenuItem,{value:i,primaryText:pageWord+" "+i+(i===current?" / "+total:"")}));return pages.length<=1?null:(previous=_react2.default.createElement(_materialUi.IconButton,{onTouchTap:function(){_this2.onMenuChange(null,0,current-1)},iconClassName:"mdi mdi-chevron-left",disabled:1===current}),next=_react2.default.createElement(_materialUi.IconButton,{onTouchTap:function(){_this2.onMenuChange(null,0,current+1)},iconClassName:"mdi mdi-chevron-right",disabled:current===total,style:{marginLeft:-20}}),_react2.default.createElement("div",{id:this.props.id,style:_extends({display:"flex",alignItems:"center"},this.props.style)},previous,_react2.default.createElement(_materialUi.DropDownMenu,{style:{width:150,marginTop:-6},onChange:this.onMenuChange,value:current,underlineStyle:{display:"none"},labelStyle:{color:"white"}},pages),next))}}),module.exports=exports.default},{"../util/MessagesConsumerMixin":59,"material-ui":"material-ui",react:"react"}],24:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_materialUi=require("material-ui"),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_Pydio$requireLib=_pydio2.default.requireLib("boot"),moment=_Pydio$requireLib.moment,MaterialTable=function(_React$Component){_inherits(MaterialTable,_React$Component);function MaterialTable(){_classCallCheck(this,MaterialTable),_React$Component.apply(this,arguments)}return MaterialTable.prototype.onRowSelection=function(indexes){var _props=this.props,data=_props.data,onSelectRows=_props.onSelectRows;onSelectRows&&("none"===indexes?onSelectRows([]):"all"===indexes?onSelectRows(data):function(){var selection=[];indexes.map(function(i){selection.push(data[i])}),onSelectRows(selection)}())},MaterialTable.prototype.render=function(){var _props2=this.props,columns=_props2.columns,data=_props2.data,deselectOnClickAway=_props2.deselectOnClickAway,emptyStateString=_props2.emptyStateString,onSelectRows=_props2.onSelectRows,computeRowStyle=_props2.computeRowStyle,showCheckboxes=this.props.showCheckboxes,rows=data.map(function(model){var rowStyle=void 0
;return computeRowStyle&&(rowStyle=computeRowStyle(model)),_react2.default.createElement(_materialUi.TableRow,{selectable:void 0!==onSelectRows,style:rowStyle},columns.map(function(column){var value=model[column.name];return column.useMoment&&value?value=moment(new Date(1e3*parseInt(value))).fromNow():column.renderCell&&(value=column.renderCell(model)),_react2.default.createElement(_materialUi.TableRowColumn,{style:column.style||{},title:value},value)}))}),headers=columns.map(function(column){return _react2.default.createElement(_materialUi.TableHeaderColumn,{style:column.headerStyle||{}},column.label)});return emptyStateString&&!rows.length&&(showCheckboxes=!1,rows=[_react2.default.createElement(_materialUi.TableRow,null,_react2.default.createElement(_materialUi.TableRowColumn,{colspan:columns.length},emptyStateString))]),_react2.default.createElement(_materialUi.Table,{onRowSelection:this.onRowSelection.bind(this),multiSelectable:showCheckboxes},_react2.default.createElement(_materialUi.TableHeader,{displaySelectAll:showCheckboxes,adjustForCheckbox:showCheckboxes,enableSelectAll:showCheckboxes},_react2.default.createElement(_materialUi.TableRow,null,headers)),_react2.default.createElement(_materialUi.TableBody,{deselectOnClickaway:deselectOnClickAway,displayRowCheckbox:showCheckboxes},rows))},MaterialTable}(_react2.default.Component);MaterialTable.PropTypes={data:_react2.default.PropTypes.array,columns:_react2.default.PropTypes.array,onSelectRows:_react2.default.PropTypes.func,emptyStateString:_react2.default.PropTypes.string},exports.default=MaterialTable,module.exports=exports.default},{"material-ui":"material-ui",pydio:"pydio",react:"react"}],25:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _SimpleList=require("./SimpleList"),_SimpleList2=_interopRequireDefault(_SimpleList);exports.default=React.createClass({displayName:"NodeListCustomProvider",propTypes:{nodeProviderProperties:React.PropTypes.object,presetDataModel:React.PropTypes.instanceOf(PydioDataModel),autoRefresh:React.PropTypes.number,actionBarGroups:React.PropTypes.array,heightAutoWithMax:React.PropTypes.number,elementHeight:React.PropTypes.number.isRequired,nodeClicked:React.PropTypes.func,reloadOnServerMessage:React.PropTypes.string,entryRenderAsCard:React.PropTypes.func},reload:function(){this.refs.list&&this.isMounted()&&this.refs.list.reload()},componentWillUnmount:function(){this._smObs&&(this.props.pydio.stopObserving("server_message",this._smObs),this.props.pydio.stopObserving("server_message:"+this.props.reloadOnServerMessage,this.reload))},componentWillReceiveProps:function(nextProps){if(this.props.nodeProviderProperties&&this.props.nodeProviderProperties!==nextProps.nodeProviderProperties){var _state=this.state,dataModel=_state.dataModel,node=_state.node,provider=new RemoteNodeProvider(nextProps.nodeProviderProperties);dataModel.setAjxpNodeProvider(provider),node.updateProvider(provider),this.setState({dataModel:dataModel,node:node})}else this.props.presetDataModel!==nextProps.presetDataModel&&this.setState({dataModel:nextProps.presetDataModel,node:nextProps.presetDataModel.getRootNode()})},getInitialState:function(){var dataModel=void 0;dataModel=this.props.presetDataModel?this.props.presetDataModel:PydioDataModel.RemoteDataModelFactory(this.props.nodeProviderProperties);var rootNode=dataModel.getRootNode();return this.props.nodeClicked&&(this.openEditor=function(node){return this.props.nodeClicked(node),!1}.bind(this),dataModel.observe("selection_changed",function(event){var selectedNodes=event.memo.getSelectedNodes();selectedNodes.length&&(this.props.nodeClicked(selectedNodes[0]),event.memo.setSelectedNodes([]))}.bind(this))),this.props.reloadOnServerMessage&&this.props.pydio&&(this._smObs=function(event){XMLUtils.XPathSelectSingleNode(event,this.props.reloadOnServerMessage)&&this.reload()}.bind(this),this.props.pydio.observe("server_message",this._smObs),this.props.pydio.observe("server_message:"+this.props.reloadOnServerMessage,this.reload)),{node:rootNode,dataModel:dataModel}},render:function(){return this.props.legend&&React.createElement("div",{className:"subtitle"},this.props.legend),React.createElement("div",{className:this.props.heightAutoWithMax?"":"layout-fill vertical-layout"},React.createElement(_SimpleList2.default,_extends({},this.props,{openEditor:this.openEditor,ref:"list",style:Object.assign({height:"100%"},this.props.style||{}),node:this.state.node,dataModel:this.state.dataModel,actionBarGroups:this.props.actionBarGroups,skipParentNavigation:!0,observeNodeReload:!0,hideToolbar:!0})))}}),module.exports=exports.default},{"./SimpleList":26}],26:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _reactScrollbar=require("react-scrollbar"),_reactScrollbar2=_interopRequireDefault(_reactScrollbar),_materialUi=require("material-ui"),_utilMessagesConsumerMixin=require("../util/MessagesConsumerMixin"),_utilMessagesConsumerMixin2=_interopRequireDefault(_utilMessagesConsumerMixin),_ListEntry=require("./ListEntry"),_TableListEntry=require("./TableListEntry"),_TableListEntry2=_interopRequireDefault(_TableListEntry),_TableListHeader=require("./TableListHeader"),_TableListHeader2=_interopRequireDefault(_TableListHeader),_ConfigurableListEntry=require("./ConfigurableListEntry"),_ConfigurableListEntry2=_interopRequireDefault(_ConfigurableListEntry),_SortColumns=require("./SortColumns"),_SortColumns2=_interopRequireDefault(_SortColumns),_ListPaginator=require("./ListPaginator"),_ListPaginator2=_interopRequireDefault(_ListPaginator),_viewsSimpleReactActionBar=require("../views/SimpleReactActionBar"),_viewsSimpleReactActionBar2=_interopRequireDefault(_viewsSimpleReactActionBar),_InlineEditor=require("./InlineEditor"),_InlineEditor2=_interopRequireDefault(_InlineEditor),_viewsEmptyStateView=require("../views/EmptyStateView"),_viewsEmptyStateView2=_interopRequireDefault(_viewsEmptyStateView),React=require("react"),Infinite=require("react-infinite"),DOMUtils=require("pydio/util/dom"),LangUtils=require("pydio/util/lang"),PydioDataModel=require("pydio/model/data-model"),PeriodicalExecuter=require("pydio/util/periodical-executer"),SimpleList=React.createClass({displayName:"SimpleList",mixins:[_utilMessagesConsumerMixin2.default],propTypes:{infiniteSliceCount:React.PropTypes.number,filterNodes:React.PropTypes.func,customToolbar:React.PropTypes.object,tableKeys:React.PropTypes.object,autoRefresh:React.PropTypes.number,reloadAtCursor:React.PropTypes.bool,clearSelectionOnReload:React.PropTypes.bool,heightAutoWithMax:React.PropTypes.number,containerHeight:React.PropTypes.number,observeNodeReload:React.PropTypes.bool,defaultGroupBy:React.PropTypes.string,defaultGroupByLabel:React.PropTypes.string,skipParentNavigation:React.PropTypes.bool,skipInternalDataModel:React.PropTypes.bool,delayInitialLoad:React.PropTypes.number,entryEnableSelector:React.PropTypes.func,renderCustomEntry:React.PropTypes.func,entryRenderIcon:React.PropTypes.func,entryRenderActions:React.PropTypes.func,entryRenderFirstLine:React.PropTypes.func,entryRenderSecondLine:React.PropTypes.func,entryRenderThirdLine:React.PropTypes.func,entryHandleClicks:React.PropTypes.func,hideToolbar:React.PropTypes.bool,computeActionsForNode:React.PropTypes.bool,multipleActions:React.PropTypes.array,openEditor:React.PropTypes.func,openCollection:React.PropTypes.func,elementStyle:React.PropTypes.object,passScrollingStateToChildren:React.PropTypes.bool,elementHeight:React.PropTypes.oneOfType([React.PropTypes.number,React.PropTypes.object]).isRequired},statics:{HEIGHT_ONE_LINE:50,HEIGHT_TWO_LINES:73,CLICK_TYPE_SIMPLE:"simple",CLICK_TYPE_DOUBLE:"double",PARENT_FOLDER_ICON:"mdi mdi-chevron-left"},getDefaultProps:function(){return{infiniteSliceCount:30,clearSelectionOnReload:!0}},clickRow:function(gridRow,event){var node=void 0;if(node=gridRow.props?gridRow.props.data.node:gridRow,this.props.entryHandleClicks)return void this.props.entryHandleClicks(node,SimpleList.CLICK_TYPE_SIMPLE,event);if(node.isLeaf()&&this.props.openEditor){if(!1===this.props.openEditor(node))return;var uniqueSelection=new Map;uniqueSelection.set(node,!0),this.setState({selection:uniqueSelection},this.rebuildLoadedElements)}else node.isLeaf()||(this.props.openCollection?this.props.openCollection(node):this.props.dataModel.setSelectedNodes([node]))},doubleClickRow:function(gridRow,event){var node=void 0;node=gridRow.props?gridRow.props.data.node:gridRow,this.props.entryHandleClicks&&this.props.entryHandleClicks(node,SimpleList.CLICK_TYPE_DOUBLE,event)},onColumnSort:function(column){var stateSetCallback=arguments.length<=1||void 0===arguments[1]?null:arguments[1],pagination=this.props.node.getMetadata().get("paginationData");if(pagination&&pagination.get("total")>1&&pagination.get("remote_order")){var dir="asc";this.props.node.getMetadata().get("paginationData").get("currentOrderDir")&&(dir="asc"===this.props.node.getMetadata().get("paginationData").get("currentOrderDir")?"desc":"asc");var orderData=new Map;orderData.set("order_column",column.remoteSortAttribute?column.remoteSortAttribute:column.name),orderData.set("order_direction",dir),this.props.node.getMetadata().set("remote_order",orderData),this.props.dataModel.requireContextChange(this.props.node,!0)}else{var att=column.sortAttribute?column.sortAttribute:column.name,sortingInfo=void 0,_state$sortingInfo=this.state.sortingInfo,attribute=_state$sortingInfo.attribute,direction=_state$sortingInfo.direction;sortingInfo=attribute===att&&direction?"asc"===direction?{attribute:att,sortType:column.sortType,direction:"desc"}:this.props.defaultSortingInfo||{}:{attribute:att,sortType:column.sortType,direction:"asc"},this.setState({sortingInfo:sortingInfo},function(){this.rebuildLoadedElements(),stateSetCallback&&stateSetCallback()}.bind(this))}},computeSelectionFromCurrentPlusTargetNode:function(currentSelection,targetNode){var currentIndexStart=void 0,currentIndexEnd=void 0,nodeBefore=!1;if(!this.indexedElements)return[];for(var firstSelected=currentSelection[0],lastSelected=currentSelection[currentSelection.length-1],newSelection=[],i=0;i<this.indexedElements.length;i++){if(void 0!==currentIndexStart&&newSelection.push(this.indexedElements[i].node),this.indexedElements[i].node===targetNode){if(void 0!==currentIndexStart&&void 0===currentIndexEnd){currentIndexEnd=i;break}currentIndexStart=i,nodeBefore=!0,newSelection.push(this.indexedElements[i].node)}if(this.indexedElements[i].node===firstSelected&&void 0===currentIndexStart&&(currentIndexStart=i,newSelection.push(this.indexedElements[i].node)),this.indexedElements[i].node===lastSelected&&nodeBefore){currentIndexEnd=i;break}}return newSelection},onKeyDown:function(e){var currentIndexStart=void 0,currentIndexEnd=void 0,contextHolder=window.pydio.getContextHolder(),elementsPerLine=this.props.elementsPerLine||1,shiftKey=e.shiftKey,key=e.key;if(!contextHolder.isEmpty()&&this.indexedElements){var downKeys=["ArrowDown","ArrowRight","PageDown","End"],currentSelection=(shiftKey&&downKeys.indexOf(key),contextHolder.getSelectedNodes()),firstSelected=currentSelection[0],lastSelected=currentSelection[currentSelection.length-1];if("Enter"===key)return void this.doubleClickRow(firstSelected);if("Delete"!==key||!global.pydio.Controller.fireActionByKey("key_delete")){for(var i=0;i<this.indexedElements.length;i++)if(this.indexedElements[i].node===firstSelected&&(currentIndexStart=i),this.indexedElements[i].node===lastSelected){currentIndexEnd=i;break}var selectionIndex=void 0,maxIndex=this.indexedElements.length-1,increment="PageDown"===key||"PageUp"===key?10:1;if("ArrowDown"===key||"PageDown"===key?selectionIndex=Math.min(currentIndexEnd+elementsPerLine*increment,maxIndex):"ArrowUp"===key||"PageUp"===key?selectionIndex=Math.max(currentIndexStart-elementsPerLine*increment,0):"Home"===key?selectionIndex=0:"End"===key&&(selectionIndex=maxIndex),elementsPerLine>1&&("ArrowRight"===key?selectionIndex=currentIndexEnd+1:"ArrowLeft"===key&&(selectionIndex=currentIndexStart-1)),shiftKey&&void 0!==selectionIndex){var min=Math.min(currentIndexStart,currentIndexEnd,selectionIndex),max=Math.max(currentIndexStart,currentIndexEnd,selectionIndex);if(min!==max){for(var selection=[],i=min;i<max+1;i++)this.indexedElements[i]&&selection.push(this.indexedElements[i].node);contextHolder.setSelectedNodes(selection)}}else this.indexedElements[selectionIndex]&&this.indexedElements[selectionIndex].node&&contextHolder.setSelectedNodes([this.indexedElements[selectionIndex].node])}}},getInitialState:function(){this.actionsCache={multiple:new Map},this.props.skipInternalDataModel?this.dm=this.props.dataModel:(this.dm=new PydioDataModel,this.dm.setRootNode(this.props.dataModel.getContextNode()),this.dm.setContextNode(this.props.dataModel.getContextNode()));var state={loaded:this.props.node.isLoaded(),loading:!this.props.node.isLoaded(),showSelector:!1,elements:this.props.node.isLoaded()?this.buildElements(0,this.props.infiniteSliceCount):[],containerHeight:this.props.containerHeight?this.props.containerHeight:this.props.heightAutoWithMax?0:500,sortingInfo:this.props.defaultSortingInfo||null};return this.props.elementHeight instanceof Object&&(state.elementHeight=this.computeElementHeightResponsive()),state.infiniteLoadBeginBottomOffset=200,state},componentWillReceiveProps:function(nextProps){var _this=this;this.indexedElements=null;var currentLength=Math.max(this.state.elements.length,nextProps.infiniteSliceCount);this.setState({loaded:nextProps.node.isLoaded(),loading:!nextProps.node.isLoaded(),showSelector:!1,elements:nextProps.node.isLoaded()?this.buildElements(0,currentLength,nextProps.node):[],infiniteLoadBeginBottomOffset:200,sortingInfo:this.state.sortingInfo||nextProps.defaultSortingInfo||null},function(){nextProps.node.isLoaded()&&_this.updateInfiniteContainerHeight()}),!nextProps.autoRefresh&&this.refreshInterval?(window.clearInterval(this.refreshInterval),this.refreshInterval=null):nextProps.autoRefresh&&!this.refreshInterval&&(this.refreshInterval=window.setInterval(this.reload,nextProps.autoRefresh)),this.patchInfiniteGrid(nextProps.elementsPerLine),this.props.node&&nextProps.node!==this.props.node&&this.observeNodeChildren(this.props.node,!0),this._manualScrollPe&&(this._manualScrollPe.stop(),this._manualScrollPe=null)},observeNodeChildren:function(node){var stop=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];stop&&!this._childrenObserver||(this._childrenObserver||(this._childrenObserver=function(){this.indexedElements=null,this.rebuildLoadedElements()}.bind(this)),this._childrenActionsObserver||(this._childrenActionsObserver=function(eventMemo){"prompt-rename"===eventMemo.type&&this.setState({inlineEditionForNode:eventMemo.child,inlineEditionCallback:eventMemo.callback})}.bind(this)),stop?(node.stopObserving("child_added",this._childrenObserver),node.stopObserving("child_removed",this._childrenObserver),node.stopObserving("child_node_action",this._childrenActionsObserver)):(node.observe("child_added",this._childrenObserver),node.observe("child_removed",this._childrenObserver),node.observe("child_node_action",this._childrenActionsObserver)))},_loadNodeIfNotLoaded:function(){var node=this.props.node;node.isLoaded()?this.observeNodeChildren(node):(node.observeOnce("loaded",function(){this.isMounted()&&(this.props.node===node&&(this.observeNodeChildren(node),this.setState({loaded:!0,loading:!1,elements:this.buildElements(0,this.props.infiniteSliceCount)})),this.props.heightAutoWithMax&&this.updateInfiniteContainerHeight())}.bind(this)),node.load())},_loadingListener:function(){this.observeNodeChildren(this.props.node,!0),this.setState({loaded:!1,loading:!0}),this.indexedElements=null},_loadedListener:function(){var currentLength=Math.max(this.state.elements.length,this.props.infiniteSliceCount);this.setState({loading:!1,elements:this.buildElements(0,currentLength,this.props.node)}),this.props.heightAutoWithMax&&this.updateInfiniteContainerHeight(),this.observeNodeChildren(this.props.node)},reload:function(){if(this.props.reloadAtCursor&&this._currentCursor)return void this.loadStartingAtCursor();this.props.clearSelectionOnReload&&this.props.dataModel.setSelectedNodes([]),this._loadingListener(),this.props.node.observeOnce("loaded",this._loadedListener),this.props.node.reload()},loadStartingAtCursor:function(){this._loadingListener();var node=this.props.node,cachedChildren=node.getChildren(),newChildren=[];node.observeOnce("loaded",function(){var reorderedChildren=new Map;newChildren.map(function(c){reorderedChildren.set(c.getPath(),c)}),cachedChildren.forEach(function(c){reorderedChildren.set(c.getPath(),c)}),node._children=reorderedChildren,this._loadedListener()}.bind(this)),node.setLoaded(!1),node.observe("child_added",function(newChild){newChildren.push(node._children.get(newChild))}),this.props.node.load(null,{cursor:this._currentCursor})},wireReloadListeners:function(){this.wrappedLoading=this._loadingListener,this.wrappedLoaded=this._loadedListener,this.props.node.observe("loading",this.wrappedLoading),this.props.node.observe("loaded",this.wrappedLoaded)},stopReloadListeners:function(){this.props.node.stopObserving("loading",this.wrappedLoading),this.props.node.stopObserving("loaded",this.wrappedLoaded)},toggleSelector:function(){this.setState({showSelector:!this.state.showSelector,selection:new Map},this.rebuildLoadedElements)},toggleSelection:function(node){var selection=this.state.selection||new Map;selection.get(node)?selection.delete(node):selection.set(node,!0),this.refs.all_selector&&this.refs.all_selector.setChecked(!1),this.setState({selection:selection},this.rebuildLoadedElements)},selectAll:function(){var _this2=this;this.refs.all_selector&&!this.refs.all_selector.isChecked()?this.setState({selection:new Map},this.rebuildLoadedElements):function(){var selection=new Map;_this2.props.node.getChildren().forEach(function(child){this.props.filterNodes&&!this.props.filterNodes(child)||child.isLeaf()&&selection.set(child,!0)}.bind(_this2)),_this2.refs.all_selector&&_this2.refs.all_selector.setChecked(!0),_this2.setState({selection:selection},_this2.rebuildLoadedElements)}()},applyMultipleAction:function(ev){if(this.state.selection&&this.state.selection.size){var actionName=ev.currentTarget.getAttribute("data-action"),dm=this.dm||new PydioDataModel;dm.setContextNode(this.props.node);var selNodes=[];this.state.selection.forEach(function(v,node){selNodes.push(node)}),dm.setSelectedNodes(selNodes);var a=this.props.pydio.Controller.getActionByName(actionName);a.fireContextChange(dm,!0,this.props.pydio.user),a.apply([dm]),ev.stopPropagation(),ev.preventDefault()}},getActionsForNode:function(dm,node){if(!this.props.computeActionsForNode)return[];var cacheKey=node.isLeaf()?"file-"+node.getAjxpMime():"folder",selectionType=node.isLeaf()?"file":"dir",nodeActions=[];return this.actionsCache[cacheKey]?nodeActions=this.actionsCache[cacheKey]:(dm.setSelectedNodes([node]),window.pydio.Controller.actions.forEach(function(a){a.fireContextChange(dm,!0,window.pydio.user),!(a.context.selection&&a.context.actionBar&&a.selectionContext[selectionType]&&!a.deny&&a.options.icon_class)||this.props.actionBarGroups&&-1===this.props.actionBarGroups.indexOf(a.context.actionBarGroup)||a.selectionContext.allowedMimes.length&&-1===a.selectionContext.allowedMimes.indexOf(node.getAjxpMime())||(nodeActions.push(a),node.isLeaf()&&!1===a.selectionContext.unique&&this.actionsCache.multiple.set(a.options.name,a))}.bind(this)),this.actionsCache[cacheKey]=nodeActions),nodeActions},updateInfiniteContainerHeight:function(){var retries=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];if(this.props.containerHeight)return this.props.containerHeight;if(this.refs.infiniteParent){var containerHeight=this.refs.infiniteParent.clientHeight;if(this.props.heightAutoWithMax){var number=this.indexedElements?this.indexedElements.length:this.props.node.getChildren().size,elementHeight=this.state.elementHeight?this.state.elementHeight:this.props.elementHeight;containerHeight=Math.min(number*elementHeight,this.props.heightAutoWithMax)}containerHeight||retries||global.setTimeout(function(){this.updateInfiniteContainerHeight(!0)}.bind(this),50),this.setState({containerHeight:containerHeight})}},computeElementHeightResponsive:function(){var breaks=this.props.elementHeight;if(breaks instanceof Object||(breaks={"min-width:480px":this.props.elementHeight,"max-width:480px":24*Object.keys(this.props.tableKeys).length+33}),!window.matchMedia){DOMUtils.getViewportWidth();return breaks["max-width:480px"]}for(var k in breaks)if(breaks.hasOwnProperty(k)&&window.matchMedia("("+k+")").matches)return breaks[k];return 50},updateElementHeightResponsive:function(){var newH=this.computeElementHeightResponsive();this.state&&this.state.elementHeight&&this.state.elementHeight==newH||this.setState({elementHeight:newH},function(){this.props.heightAutoWithMax&&this.updateInfiniteContainerHeight()}.bind(this))},patchInfiniteGrid:function(els){this.refs.infinite&&els>1&&(this.refs.infinite.state.infiniteComputer.__proto__.getDisplayIndexStart=function(windowTop){return els*Math.floor(windowTop/this.heightData/els)},this.refs.infinite.state.infiniteComputer.__proto__.getDisplayIndexEnd=function(windowBottom){return els*Math.ceil(windowBottom/this.heightData/els)})},componentDidMount:function(){var _this3=this;this.props.delayInitialLoad?setTimeout(function(){_this3._loadNodeIfNotLoaded()},this.props.delayInitialLoad):this._loadNodeIfNotLoaded(),this.patchInfiniteGrid(this.props.elementsPerLine),this.refs.infiniteParent&&(this.updateInfiniteContainerHeight(),this.props.heightAutoWithMax||this.props.externalResize||(window.addEventListener?window.addEventListener("resize",this.updateInfiniteContainerHeight):window.attachEvent("onresize",this.updateInfiniteContainerHeight))),this.props.autoRefresh&&(this.refreshInterval=window.setInterval(this.reload,this.props.autoRefresh)),this.props.observeNodeReload&&this.wireReloadListeners(),(this.props.elementHeight instanceof Object||this.props.tableKeys)&&(window.addEventListener?window.addEventListener("resize",this.updateElementHeightResponsive):window.attachEvent("onresize",this.updateElementHeightResponsive),this.updateElementHeightResponsive()),this.props.dataModel.observe("root_node_changed",function(rootNode){console.log("root node changed",rootNode,_this3.props.node),_this3.rootNodeChangedFlag=!0}),this.props.dataModel.observe("selection_changed",function(){var _this4=this;if(this.isMounted()){var selection=new Map,selectedNodes=this.props.dataModel.getSelectedNodes();selectedNodes.map(function(n){selection.set(n,!0)}),this.setState({selection:selection},function(){_this4.rebuildLoadedElements(),1===selectedNodes.length&&_this4.scrollToView(selectedNodes[0])})}}.bind(this))},componentWillUnmount:function(){this.props.heightAutoWithMax||(window.removeEventListener?window.removeEventListener("resize",this.updateInfiniteContainerHeight):window.detachEvent("onresize",this.updateInfiniteContainerHeight)),(this.props.elementHeight instanceof Object||this.props.tableKeys)&&(window.removeEventListener?window.removeEventListener("resize",this.updateElementHeightResponsive):window.detachEvent("resize",this.updateElementHeightResponsive)),this.refreshInterval&&window.clearInterval(this.refreshInterval),this.props.observeNodeReload&&this.stopReloadListeners(),this.props.node&&this.observeNodeChildren(this.props.node,!0)},componentDidUpdate:function(prevProps,prevState){!this.rootNodeChangedFlag&&prevProps.node&&this.props.node&&prevProps.node.getPath()===this.props.node.getPath()||(this._loadNodeIfNotLoaded(),this.rootNodeChangedFlag=!1)},onScroll:function(scrollTop){if(this.props.passScrollingStateToChildren){this.state.scrollTimeout&&clearTimeout(this.state.scrollTimeout);var that=this,scrollTimeout=setTimeout(function(){that.setState({isScrolling:!1,scrollTimeout:void 0})},150);this.setState({isScrolling:!0,scrollTimeout:scrollTimeout})}},scrollToLast:function(){this.indexedElements&&this.indexedElements[this.indexedElements.length-1].node&&this.scrollToView(this.indexedElements[this.indexedElements.length-1].node)},scrollToView:function(node){var _this5=this;if(this.indexedElements&&this.refs.infinite&&this.refs.infinite.scrollable){var scrollable=this.refs.infinite.scrollable,visibleFrame={top:scrollable.scrollTop+this.props.elementHeight/2,bottom:scrollable.scrollTop+this.state.containerHeight-this.props.elementHeight/2},realMaxScrollTop=this.indexedElements.length*this.props.elementHeight-this.state.containerHeight,position=-1;if(this.indexedElements.forEach(function(e,k){e.node&&e.node===node&&(position=k)}),-1!==position){var elementHeight=this.props.elementHeight,scrollTarget=position*elementHeight;scrollTarget>visibleFrame.top&&scrollTarget<visibleFrame.bottom||(scrollTarget>=visibleFrame.bottom&&(scrollTarget-=this.state.containerHeight-2*elementHeight),scrollTarget=Math.min(scrollTarget,realMaxScrollTop),scrollable.scrollTop=scrollTarget,this._manualScrollPe&&this._manualScrollPe.stop(),scrollable.scrollHeight<scrollTarget&&(this._manualScrollPe=new PeriodicalExecuter(function(){scrollable.scrollTop=scrollTarget,scrollable.scrollHeight>=scrollTarget&&(_this5._manualScrollPe.stop(),_this5._manualScrollPe=null)},.25)))}}},buildElementsFromNodeEntries:function(nodeEntries,showSelector){var components=[],index=0,nodeEntriesLength=nodeEntries.length;return nodeEntries.forEach(function(entry){var data=void 0;if(entry.parent)data={node:entry.node,key:entry.node.getPath(),id:entry.node.getPath(),mainIcon:SimpleList.PARENT_FOLDER_ICON,firstLine:"..",className:"list-parent-node",secondLine:this.context.getMessage("react.1"),onClick:this.clickRow,onDoubleClick:this.doubleClickRow,showSelector:!1,selectorDisabled:!0,noHover:!1},this.props.entryRenderParentIcon&&!this.props.tableKeys?data.iconCell=this.props.entryRenderParentIcon(entry.node,entry):data.mainIcon=SimpleList.PARENT_FOLDER_ICON,this.props.elementStyle&&(data.style=this.props.elementStyle),this.props.passScrollingStateToChildren&&(data.parentIsScrolling=this.state.isScrolling),components.push(React.createElement(_ListEntry.ListEntry,data));else if(entry.groupHeader){var id=entry.groupHeader,firstLine=entry.groupHeaderLabel;this.props.entryRenderGroupHeader&&(firstLine=this.props.entryRenderGroupHeader(id,firstLine)),data={node:null,key:entry.groupHeader,id:id,mainIcon:null,firstLine:firstLine,className:"list-group-header",onClick:null,showSelector:!1,selectorDisabled:!0,noHover:!0},this.props.passScrollingStateToChildren&&(data.parentIsScrolling=this.state.isScrolling),components.push(React.createElement(_ListEntry.ListEntry,data))}else data={node:entry.node,onClick:this.clickRow,onDoubleClick:this.doubleClickRow,onSelect:this.toggleSelection,key:entry.node.getPath(),id:entry.node.getPath(),renderIcon:this.props.entryRenderIcon,renderFirstLine:this.props.entryRenderFirstLine,renderSecondLine:this.props.entryRenderSecondLine,renderThirdLine:this.props.entryRenderThirdLine,renderActions:this.props.entryRenderActions,showSelector:showSelector,selected:!(!this.state||!this.state.selection)&&this.state.selection.get(entry.node),actions:React.createElement(_viewsSimpleReactActionBar2.default,{node:entry.node,actions:entry.actions,dataModel:this.dm}),selectorDisabled:!(this.props.entryEnableSelector?this.props.entryEnableSelector(entry.node):entry.node.isLeaf())},data.isFirst=0===index,data.isLast=index===nodeEntriesLength-1,index++,this.props.elementStyle&&(data.style=this.props.elementStyle),this.props.passScrollingStateToChildren&&(data.parentIsScrolling=this.state.isScrolling),this.props.renderCustomEntry?components.push(this.props.renderCustomEntry(data)):this.props.tableKeys?(this.props.defaultGroupBy?(data.tableKeys=LangUtils.deepCopy(this.props.tableKeys),delete data.tableKeys[this.props.defaultGroupBy]):data.tableKeys=this.props.tableKeys,components.push(React.createElement(_TableListEntry2.default,data))):components.push(React.createElement(_ConfigurableListEntry2.default,data))}.bind(this)),components},buildElements:function(start,end,node,showSelector){var _this6=this,theNode=this.props.node;node&&(theNode=node);this.state&&this.state.showSelector;return void 0!==showSelector&&showSelector,this.indexedElements&&this.indexedElements.length===theNode.getChildren().size||function(){_this6.indexedElements=[];var groupBy=void 0,groupByLabel=void 0,groups=void 0,groupKeys=void 0,groupLabels=void 0;_this6.props.defaultGroupBy&&(groupBy=_this6.props.defaultGroupBy,groupByLabel=_this6.props.groupByLabel||!1,groups={},groupKeys=[],groupLabels={}),_this6.props.skipParentNavigation||!theNode.getParent()||_this6.props.dataModel.getContextNode()===theNode&&!_this6.props.skipInternalDataModel||_this6.indexedElements.push({node:theNode.getParent(),parent:!0,actions:null}),theNode.getChildren().forEach(function(child){if(child.getMetadata().has("cursor")){var childCursor=parseInt(child.getMetadata().get("cursor"));this._currentCursor=Math.max(this._currentCursor?this._currentCursor:0,childCursor)}if(!this.props.filterNodes||this.props.filterNodes(child)){var nodeActions=this.getActionsForNode(this.dm,child);if(groupBy){var groupValue=child.getMetadata().get(groupBy)||"N/A";groups[groupValue]||(groups[groupValue]=[],groupKeys.push(groupValue)),groupByLabel&&child.getMetadata().has(groupByLabel)&&!groupLabels[groupValue]&&(groupLabels[groupValue]=child.getMetadata().get(groupByLabel)),groups[groupValue].push({node:child,parent:!1,actions:nodeActions})}else this.indexedElements.push({node:child,parent:!1,actions:nodeActions})}}.bind(_this6)),groupBy&&(groupKeys=groupKeys.sort(),groupKeys.map(function(k){var label=k;groupLabels[k]?label=groupLabels[k]:this.props.renderGroupLabels&&(label=this.props.renderGroupLabels(groupBy,k)),this.indexedElements.push({node:null,groupHeader:k,groupHeaderLabel:label,parent:!1,actions:null}),this.indexedElements=this.indexedElements.concat(groups[k])}.bind(_this6)))}(),this.state&&this.state.sortingInfo&&!this.remoteSortingInfo()&&function(){var _state$sortingInfo2=_this6.state.sortingInfo,attribute=_state$sortingInfo2.attribute,direction=_state$sortingInfo2.direction,sortType=_state$sortingInfo2.sortType,sortFunction=void 0;sortFunction="file-natural"===sortType?function(a,b){if(a.parent)return-1;if(b.parent)return 1;var nodeA=a.node,nodeB=b.node;if(nodeA.isRecycle())return 1;if(nodeB.isRecycle())return-1;var aLeaf=nodeA.isLeaf(),bLeaf=nodeB.isLeaf(),res=aLeaf&&!bLeaf?1:!aLeaf&&bLeaf?-1:0;return 0!==res?res:res=nodeA.getLabel().localeCompare(nodeB.getLabel())}:function(a,b){if(a.parent)return-1;var aMeta=a.node.getMetadata().get(attribute)||"",bMeta=b.node.getMetadata().get(attribute)||"",res=void 0;if("number"===sortType?(aMeta=parseFloat(aMeta),bMeta=parseFloat(bMeta),res="asc"===direction?aMeta-bMeta:bMeta-aMeta):"string"===sortType&&(res="asc"===direction?aMeta.localeCompare(bMeta):bMeta.localeCompare(aMeta)),0===res){var labComp=a.node.getLabel().localeCompare(b.node.getLabel());res="asc"===direction?labComp:-labComp}return res},_this6.indexedElements.sort(sortFunction)}(),this.props.elementPerLine>1&&(end*=this.props.elementPerLine,start*=this.props.elementPerLine),this.indexedElements.slice(start,end)},rebuildLoadedElements:function(){
var newElements=this.buildElements(0,Math.max(this.state.elements.length,this.props.infiniteSliceCount)),infiniteLoadBeginBottomOffset=newElements.length?200:0;this.setState({elements:newElements,infiniteLoadBeginBottomOffset:infiniteLoadBeginBottomOffset}),this.updateInfiniteContainerHeight()},handleInfiniteLoad:function(){var elemLength=this.state.elements.length,newElements=this.buildElements(elemLength,elemLength+this.props.infiniteSliceCount),infiniteLoadBeginBottomOffset=newElements.length?200:0;this.setState({isInfiniteLoading:!1,elements:this.state.elements.concat(newElements),infiniteLoadBeginBottomOffset:infiniteLoadBeginBottomOffset})},remoteSortingInfo:function(){var meta=this.props.node.getMetadata().get("paginationData");if(meta&&meta.get("total")>1&&meta.has("remote_order")){var col=meta.get("currentOrderCol"),dir=meta.get("currentOrderDir");if(col&&dir)return{remote:!0,attribute:col,direction:dir}}return null},renderToolbar:function(){var _this7=this,rightButtons=[React.createElement(_materialUi.FontIcon,{key:1,tooltip:"Reload",className:"mdi mdi-reload"+(this.state.loading?" rotating":""),onClick:this.reload})],i=2;if(this.props.sortKeys){var sortingInfo=void 0,remoteSortingInfo=this.remoteSortingInfo();sortingInfo=remoteSortingInfo||(this.state?this.state.sortingInfo:null),rightButtons.push(React.createElement(_SortColumns2.default,{key:i,displayMode:"menu",tableKeys:this.props.sortKeys,columnClicked:this.onColumnSort,sortingInfo:sortingInfo})),i++}this.props.additionalActions&&rightButtons.push(this.props.additionalActions);var leftToolbar=void 0,paginator=void 0;if(this.props.node.getMetadata().get("paginationData")&&this.props.node.getMetadata().get("paginationData").get("total")>1&&(paginator=React.createElement(_ListPaginator2.default,{dataModel:this.dm,node:this.props.node})),this.props.listTitle&&(leftToolbar=React.createElement(_materialUi.ToolbarGroup,{key:0,float:"left"},React.createElement("div",{className:"list-title"},this.props.listTitle))),this.props.searchResultData)leftToolbar=React.createElement(_materialUi.ToolbarGroup,{key:0,float:"left"},React.createElement("div",{style:{fontSize:15,fontWeight:500,color:"#9e9e9e"}},this.context.getMessage("react.3").replace("%s",this.props.searchResultData.term))),rightButtons=React.createElement(_materialUi.RaisedButton,{key:1,label:this.context.getMessage("react.4"),primary:!0,onTouchTap:this.props.searchResultData.toggleState,style:{marginRight:-10}});else if(this.actionsCache.multiple.size||this.props.multipleActions){var bulkLabel=this.context.getMessage("react.2"),hiddenStyle={transform:"translateX(-80px)"},cbStyle=_extends({width:24},hiddenStyle),buttonStyle=_extends({},hiddenStyle);this.state.showSelector&&(cbStyle={width:24,transform:"translateX(-12px)"},buttonStyle={transform:"translateX(-40px)"}),this.state.selection&&this.state.showSelector&&(bulkLabel+=" ("+this.state.selection.size+")"),leftToolbar=React.createElement(_materialUi.ToolbarGroup,{key:0,float:"left",className:"hide-on-vertical-layout"},React.createElement(_materialUi.Checkbox,{ref:"all_selector",onClick:this.selectAll,style:cbStyle}),React.createElement(_materialUi.FlatButton,{label:bulkLabel,onClick:this.toggleSelector,style:buttonStyle})),this.state.showSelector&&function(){rightButtons=[],(_this7.props.multipleActions||_this7.actionsCache.multiple).forEach(function(a){rightButtons.push(React.createElement(_materialUi.RaisedButton,{key:0,label:a.options.text,"data-action":a.options.name,onClick:this.applyMultipleAction,primary:!0}))}.bind(_this7)),rightButtons=React.createElement("span",null,rightButtons)}()}return React.createElement(_materialUi.Toolbar,{style:this.props.toolbarStyle},leftToolbar,React.createElement(_materialUi.ToolbarGroup,{key:1,float:"right"},paginator,rightButtons))},render:function(){var _this8=this,containerClasses="material-list vertical-layout layout-fill";this.props.className&&(containerClasses+=" "+this.props.className),this.state.showSelector&&(containerClasses+=" list-show-selectors"),this.props.tableKeys&&(containerClasses+=" table-mode");var toolbar=void 0;if(this.props.tableKeys){var tableKeys=void 0;this.props.defaultGroupBy?(tableKeys=LangUtils.deepCopy(this.props.tableKeys),delete tableKeys[this.props.defaultGroupBy]):tableKeys=this.props.tableKeys;var sortingInfo=void 0,remoteSortingInfo=this.remoteSortingInfo();sortingInfo=remoteSortingInfo||(this.state?this.state.sortingInfo:null),toolbar=React.createElement(_TableListHeader2.default,{tableKeys:tableKeys,loading:this.state.loading,reload:this.reload,ref:"loading_indicator",dm:this.props.dataModel,node:this.props.node,additionalActions:this.props.additionalActions,onHeaderClick:this.onColumnSort,sortingInfo:sortingInfo})}else toolbar=this.props.customToolbar?this.props.customToolbar:this.props.hideToolbar?null:this.renderToolbar();var inlineEditor=void 0;this.state.inlineEditionForNode&&(inlineEditor=React.createElement(_InlineEditor2.default,{detached:!0,node:this.state.inlineEditionForNode,callback:this.state.inlineEditionCallback,onClose:function(){_this8.setState({inlineEditionForNode:null})}}));var emptyState=void 0,_props=this.props,emptyStateProps=_props.emptyStateProps;_props.node;if(emptyStateProps&&this.props.node.isLoaded()&&!this.props.node.isLoading()&&(!this.state.elements.length||1===this.state.elements.length&&this.state.elements[0].parent)){var actionProps={};1===this.state.elements.length&&this.state.elements[0].parent&&function(){var parentNode=_this8.state.elements[0].node;actionProps={actionLabelId:"react.1",actionIconClassName:SimpleList.PARENT_FOLDER_ICON,actionCallback:function(e){_this8.props.entryHandleClicks&&_this8.props.entryHandleClicks(parentNode,SimpleList.CLICK_TYPE_DOUBLE,e)}}}(),emptyState=React.createElement(_viewsEmptyStateView2.default,_extends({},emptyStateProps,actionProps))}else emptyStateProps&&emptyStateProps.checkEmptyState&&emptyStateProps.checkEmptyState(this.props.node)&&(emptyState=React.createElement(_viewsEmptyStateView2.default,emptyStateProps));var elements=this.buildElementsFromNodeEntries(this.state.elements,this.state.showSelector);return React.createElement("div",{className:containerClasses,onContextMenu:this.contextMenuResponder,tabIndex:"0",onKeyDown:this.onKeyDown,style:this.props.style},toolbar,inlineEditor,React.createElement("div",{className:this.props.heightAutoWithMax?"infinite-parent-smooth-height":emptyState?"layout-fill vertical_layout":"layout-fill",ref:"infiniteParent"},!emptyState&&!this.props.verticalScroller&&React.createElement(Infinite,{elementHeight:this.state.elementHeight?this.state.elementHeight:this.props.elementHeight,containerHeight:this.state.containerHeight?this.state.containerHeight:1,infiniteLoadBeginEdgeOffset:this.state.infiniteLoadBeginBottomOffset,onInfiniteLoad:this.handleInfiniteLoad,handleScroll:this.onScroll,ref:"infinite"},elements),!emptyState&&this.props.verticalScroller&&React.createElement(_reactScrollbar2.default,{speed:.8,horizontalScroll:!1,style:{height:this.state.containerHeight},verticalScrollbarStyle:{borderRadius:10,width:6},verticalContainerStyle:{width:8}},React.createElement("div",null,elements)),emptyState))}});exports.default=SimpleList,module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../util/MessagesConsumerMixin":59,"../views/EmptyStateView":60,"../views/SimpleReactActionBar":62,"./ConfigurableListEntry":19,"./InlineEditor":20,"./ListEntry":21,"./ListPaginator":23,"./SortColumns":27,"./TableListEntry":29,"./TableListHeader":30,"material-ui":"material-ui","pydio/model/data-model":"pydio/model/data-model","pydio/util/dom":"pydio/util/dom","pydio/util/lang":"pydio/util/lang","pydio/util/periodical-executer":"pydio/util/periodical-executer",react:"react","react-infinite":"react-infinite","react-scrollbar":1}],27:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _menuIconButtonMenu=require("../menu/IconButtonMenu"),_menuIconButtonMenu2=_interopRequireDefault(_menuIconButtonMenu),React=require("react"),Pydio=require("pydio"),_Pydio$requireLib=Pydio.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,_require=require("material-ui-legacy"),ToolbarGroup=_require.ToolbarGroup,SortColumns=React.createClass({displayName:"SortColumns",propTypes:{tableKeys:React.PropTypes.object.isRequired,columnClicked:React.PropTypes.func,sortingInfo:React.PropTypes.object,displayMode:React.PropTypes.string},onMenuClicked:function(object){this.props.columnClicked(object.payload)},onHeaderClick:function(key,callback){var data=this.props.tableKeys[key];data&&data.sortType&&this.props.columnClicked&&(data.name=key,this.props.columnClicked(data,callback))},getColumnsItems:function(displayMode){var _this=this,controller=arguments.length<=1||void 0===arguments[1]?null:arguments[1],items=[],_callback=function(){controller&&controller.notify("actions_refreshed")},_loop=function(key){if(!_this.props.tableKeys.hasOwnProperty(key))return"continue";var data=_this.props.tableKeys[key],style=data.width?{width:data.width}:null,icon=void 0,className="cell header_cell cell-"+key;data.sortType&&(className+=" sortable",!_this.props.sortingInfo||_this.props.sortingInfo.attribute!==key&&_this.props.sortingInfo.attribute!==data.sortAttribute&&_this.props.sortingInfo.attribute!==data.remoteSortAttribute||(icon="asc"===_this.props.sortingInfo.direction?"mdi mdi-arrow-up":"mdi mdi-arrow-down",className+=" active-sort-"+_this.props.sortingInfo.direction)),"menu"===displayMode?(data.name=key,items.push({payload:data,text:data.label,iconClassName:icon})):"menu_data"===displayMode?items.push({name:data.label,callback:function(){_this.onHeaderClick(key,_callback)},icon_class:icon||"__INSET__"}):items.push(React.createElement("span",{key:key,className:className,style:style,onClick:function(){_this.onHeaderClick(key,_callback)}},data.label))};for(var key in this.props.tableKeys){_loop(key)}return items},buildSortingMenuItems:function(controller){return this.getColumnsItems("menu_data",controller)},componentDidMount:function(){var sortAction=new Action({name:"sort_action",icon_class:"mdi mdi-sort-descending",text_id:450,title_id:450,text:this.props.getMessage(450),title:this.props.getMessage(450),hasAccessKey:!1,subMenu:!0,subMenuUpdateImage:!0},{selection:!1,dir:!0,actionBar:!0,actionBarGroup:"display_toolbar",contextMenu:!1,infoPanel:!1},{},{},{dynamicBuilder:this.buildSortingMenuItems}),buttons=new Map;buttons.set("sort_action",sortAction),this.props.pydio.getController().updateGuiActions(buttons)},componentWillUnmount:function(){this.props.pydio.getController().deleteFromGuiActions("sort_action")},render:function(){return"menu"===this.props.displayMode?React.createElement(_menuIconButtonMenu2.default,{buttonTitle:"Sort by...",buttonClassName:"mdi mdi-sort-descending",menuItems:this.getColumnsItems("menu",this.props.pydio.getController()),onMenuClicked:this.onMenuClicked}):React.createElement(ToolbarGroup,{float:"left"},this.getColumnsItems("header",this.props.pydio.getController()))}});exports.default=SortColumns=PydioContextConsumer(SortColumns),exports.default=SortColumns,module.exports=exports.default},{"../menu/IconButtonMenu":34,"material-ui-legacy":"material-ui-legacy",pydio:"pydio",react:"react"}],28:[function(require,module,exports){"use strict";exports.__esModule=!0;var DraggableListItem,_utilDND=require("../util/DND"),sortableItemSource={beginDrag:function(props){return{id:props.id}},endDrag:function(props){props.endSwitching()}},sortableItemTarget={hover:function(props,monitor){var draggedId=monitor.getItem().id;draggedId!==props.id&&props.switchItems(draggedId,props.id)}},sortableItem=React.createClass({displayName:"sortableItem",propTypes:{connectDragSource:React.PropTypes.func.isRequired,connectDropTarget:React.PropTypes.func.isRequired,isDragging:React.PropTypes.bool.isRequired,id:React.PropTypes.any.isRequired,label:React.PropTypes.string.isRequired,switchItems:React.PropTypes.func.isRequired,removable:React.PropTypes.bool,onRemove:React.PropTypes.func},removeClicked:function(){this.props.onRemove(this.props.id)},render:function(){var remove,isDragging=(this.props.id,this.props.isDragging),connectDragSource=this.props.connectDragSource,connectDropTarget=this.props.connectDropTarget;return this.props.removable&&(remove=React.createElement("span",{className:"button mdi mdi-close",onClick:this.removeClicked})),React.createElement(ReactMUI.Paper,{ref:function(instance){connectDropTarget(ReactDOM.findDOMNode(instance)),connectDragSource(ReactDOM.findDOMNode(instance))},zDepth:1,style:{opacity:isDragging?0:1}},React.createElement("div",{className:this.props.className},this.props.label,remove))}}),NonDraggableListItem=React.createClass({displayName:"NonDraggableListItem",render:function(){var remove;return this.props.removable&&(remove=React.createElement("span",{className:"button mdi mdi-close",onClick:this.removeClicked})),React.createElement(ReactMUI.Paper,{zDepth:1},React.createElement("div",{className:this.props.className},this.props.label,remove))}});DraggableListItem=window.ReactDND?ReactDND.flow(ReactDND.DragSource(_utilDND.Types.SORTABLE_LIST_ITEM,sortableItemSource,_utilDND.collect),ReactDND.DropTarget(_utilDND.Types.SORTABLE_LIST_ITEM,sortableItemTarget,_utilDND.collectDrop))(sortableItem):NonDraggableListItem;var SortableList=React.createClass({displayName:"SortableList",propTypes:{values:React.PropTypes.array.isRequired,onOrderUpdated:React.PropTypes.func,removable:React.PropTypes.bool,onRemove:React.PropTypes.func,className:React.PropTypes.string,itemClassName:React.PropTypes.string},getInitialState:function(){return{values:this.props.values}},componentWillReceiveProps:function(props){this.setState({values:props.values,switchData:null})},findItemIndex:function(itemId,data){for(var i=0;i<data.length;i++)if(data[i].payload==itemId)return i},switchItems:function(oldId,newId){var oldIndex=this.findItemIndex(oldId,this.state.values),oldItem=this.state.values[oldIndex],newIndex=this.findItemIndex(newId,this.state.values),newItem=this.state.values[newIndex],currentValues=this.state.values.slice();currentValues[oldIndex]=newItem,currentValues[newIndex]=oldItem;var oldPrevious=this.findItemIndex(oldId,this.props.values),newPrevious=this.findItemIndex(newId,this.props.values);oldPrevious==newIndex&&newPrevious==oldIndex?this.setState({values:currentValues,switchData:null}):this.setState({values:currentValues,switchData:{oldId:oldId,newId:newId}})},endSwitching:function(){this.state.switchData&&this.props.onOrderUpdated&&this.props.onOrderUpdated(this.state.switchData.oldId,this.state.switchData.newId,this.state.values),this.setState({switchData:null})},render:function(){var switchItems=this.switchItems;return React.createElement("div",{className:this.props.className},this.state.values.map(function(item){return React.createElement(DraggableListItem,{id:item.payload,key:item.payload,label:item.text,switchItems:switchItems,endSwitching:this.endSwitching,removable:this.props.removable,onRemove:this.props.onRemove,className:this.props.itemClassName})}.bind(this)))}});exports.default=SortableList,module.exports=exports.default},{"../util/DND":58}],29:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _ListEntryNodeListenerMixin=require("./ListEntryNodeListenerMixin"),_ListEntryNodeListenerMixin2=_interopRequireDefault(_ListEntryNodeListenerMixin),_ListEntry=require("./ListEntry"),_InlineEditor=require("./InlineEditor"),_InlineEditor2=_interopRequireDefault(_InlineEditor),_pydioUtilPath=require("pydio/util/path"),_pydioUtilPath2=_interopRequireDefault(_pydioUtilPath),_require$requireLib=require("pydio").requireLib("boot"),moment=_require$requireLib.moment;exports.default=React.createClass({displayName:"TableListEntry",mixins:[_ListEntryNodeListenerMixin2.default],propTypes:{node:React.PropTypes.instanceOf(AjxpNode),tableKeys:React.PropTypes.object.isRequired,renderActions:React.PropTypes.func},render:function(){var _this=this,actions=this.props.actions;this.props.renderActions&&(actions=this.props.renderActions(this.props.node));var cells=[],firstKey=!0,meta=this.props.node.getMetadata();for(var key in this.props.tableKeys)if(this.props.tableKeys.hasOwnProperty(key)){var data=this.props.tableKeys[key],style=data.width?{width:data.width}:null,value=void 0,rawValue=void 0;if(data.renderCell)data.name=key,value=data.renderCell(this.props.node,data);else if("ajxp_modiftime"===key){var mDate=moment(1e3*parseFloat(meta.get("ajxp_modiftime"))),dateString=mDate.calendar();dateString.indexOf("/")>-1&&(dateString=mDate.fromNow()),value=dateString}else value="bytesize"===key?_pydioUtilPath2.default.roundFileSize(parseInt(meta.get(key))):meta.get(key);rawValue=meta.get(key);var inlineEditor=void 0;if(this.state&&this.state.inlineEdition&&firstKey){inlineEditor=React.createElement(_InlineEditor2.default,{node:this.props.node,onClose:function(){_this.setState({inlineEdition:!1})},callback:this.state.inlineEditionCallback});var _style=this.props.style||{};_style.position="relative",this.props.style=_style}cells.push(React.createElement("span",{key:key,className:"cell cell-"+key,title:rawValue,style:style,"data-label":data.label},inlineEditor,value)),firstKey=!1}return React.createElement(_ListEntry.DragDropListEntry,_extends({},this.props,{iconCell:null,firstLine:cells,actions:actions}))}}),module.exports=exports.default},{"./InlineEditor":20,"./ListEntry":21,"./ListEntryNodeListenerMixin":22,pydio:"pydio","pydio/util/path":"pydio/util/path"}],30:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _utilMessagesConsumerMixin=require("../util/MessagesConsumerMixin"),_utilMessagesConsumerMixin2=_interopRequireDefault(_utilMessagesConsumerMixin),_SortColumns=require("./SortColumns"),_SortColumns2=_interopRequireDefault(_SortColumns),_ListPaginator=require("./ListPaginator"),_ListPaginator2=_interopRequireDefault(_ListPaginator);exports.default=React.createClass({displayName:"TableListHeader",mixins:[_utilMessagesConsumerMixin2.default],propTypes:{tableKeys:React.PropTypes.object.isRequired,loading:React.PropTypes.bool,reload:React.PropTypes.func,dm:React.PropTypes.instanceOf(PydioDataModel),node:React.PropTypes.instanceOf(AjxpNode),onHeaderClick:React.PropTypes.func,sortingInfo:React.PropTypes.object},render:function(){var paginator=void 0;return this.props.node.getMetadata().get("paginationData")&&this.props.node.getMetadata().get("paginationData").get("total")>1&&(paginator=React.createElement(_ListPaginator2.default,{dataModel:this.props.dm,node:this.props.node})),React.createElement(ReactMUI.Toolbar,{className:"toolbarTableHeader"},React.createElement(_SortColumns2.default,_extends({displayMode:"tableHeader"},this.props,{columnClicked:this.props.onHeaderClick})),React.createElement(ReactMUI.ToolbarGroup,{float:"right"},paginator,React.createElement(ReactMUI.FontIcon,{key:1,tooltip:this.context.getMessage("149",""),className:"icon-refresh"+(this.props.loading?" rotating":""),onClick:this.props.reload}),this.props.additionalActions))}}),module.exports=exports.default},{"../util/MessagesConsumerMixin":59,"./ListPaginator":23,"./SortColumns":27}],31:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),_MenuItemsConsumer=require("./MenuItemsConsumer"),_MenuItemsConsumer2=_interopRequireDefault(_MenuItemsConsumer),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_materialUi=require("material-ui"),ButtonComposed=_react2.default.createClass({displayName:"ButtonComposed",propTypes:{buttonTitle:_react2.default.PropTypes.oneOfType([_react2.default.PropTypes.string,_react2.default.PropTypes.object]).isRequired,masterAction:_react2.default.PropTypes.func.isRequired,menuItems:_react2.default.PropTypes.array.isRequired,className:_react2.default.PropTypes.string,raised:_react2.default.PropTypes.bool,direction:_react2.default.PropTypes.oneOf(["left","right"])},componentDidMount:function(){var _this=this;this.props.openOnEvent&&this.props.pydio.observe(this.props.openOnEvent,function(){_this.showMenu()})},getInitialState:function(){return{showMenu:!1}},showMenu:function(event){var anchor=void 0;anchor=event?event.currentTarget:this._buttonDOM,this.setState({showMenu:!0,anchor:anchor})},menuClicked:function(event,index,object){this.setState({showMenu:!1})},render:function(){var _this2=this,masterButton=void 0,arrowButton=void 0,_props=this.props,id=_props.id,masterAction=_props.masterAction,buttonTitle=_props.buttonTitle,primary=_props.primary,secondary=_props.secondary,disabled=_props.disabled,raised=_props.raised,menuItems=_props.menuItems,buttonStyle=_props.buttonStyle,buttonLabelStyle=_props.buttonLabelStyle,className=_props.className,direction=_props.direction,masterProps={primary:primary,secondary:secondary,disabled:disabled,label:buttonTitle,style:buttonStyle,labelStyle:_extends({},buttonLabelStyle,{paddingRight:8}),onTouchTap:masterAction,onClick:function(e){return e.stopPropagation()}},arrowProps={primary:primary,secondary:secondary,disabled:disabled,label:_react2.default.createElement("span",{className:"mdi mdi-menu-down"}),onTouchTap:this.showMenu,style:_extends({},buttonStyle,{minWidth:16}),labelStyle:_extends({},buttonLabelStyle,{paddingLeft:8,paddingRight:8}),onClick:function(e){return e.stopPropagation()}},_state=this.state,showMenu=_state.showMenu,anchor=_state.anchor,over=_state.over;return menuItems.length&&(raised?(arrowButton=_react2.default.createElement(_materialUi.RaisedButton,_extends({},arrowProps,{ref:function(b){_this2._buttonDOM=_reactDom2.default.findDOMNode(b)}})),masterButton=_react2.default.createElement(_materialUi.RaisedButton,masterProps)):(arrowButton=_react2.default.createElement(_materialUi.FlatButton,_extends({},arrowProps,{ref:function(b){_this2._buttonDOM=_reactDom2.default.findDOMNode(b)}})),masterButton=_react2.default.createElement(_materialUi.FlatButton,masterProps))),_react2.default.createElement("span",{id:id,className:className,onMouseOver:function(){_this2.setState({over:!0})},onMouseOut:function(){_this2.setState({over:!1})},style:over||showMenu?{backgroundColor:"rgba(153, 153, 153, 0.2)",whiteSpace:"nowrap"}:{whiteSpace:"nowrap"}},masterButton,arrowButton,_react2.default.createElement(_materialUi.Popover,{className:"menuPopover",open:showMenu,anchorEl:anchor,anchorOrigin:{horizontal:direction||"left",vertical:"bottom"},targetOrigin:{horizontal:direction||"left",vertical:"top"},onRequestClose:function(){_this2.setState({showMenu:!1})},style:{marginTop:1},useLayerForClickAway:!1},_Utils2.default.itemsToMenu(menuItems,this.menuClicked)))}});exports.default=_MenuItemsConsumer2.default(ButtonComposed),module.exports=exports.default},{"./MenuItemsConsumer":36,"./Utils":39,"material-ui":"material-ui",react:"react","react-dom":"react-dom"}],32:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),_MenuItemsConsumer=require("./MenuItemsConsumer"),_MenuItemsConsumer2=_interopRequireDefault(_MenuItemsConsumer),_react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_materialUi=require("material-ui"),ButtonMenu=_react2.default.createClass({displayName:"ButtonMenu",propTypes:{buttonTitle:_react2.default.PropTypes.oneOfType([_react2.default.PropTypes.string,_react2.default.PropTypes.object]).isRequired,menuItems:_react2.default.PropTypes.array.isRequired,className:_react2.default.PropTypes.string,raised:_react2.default.PropTypes.bool,direction:_react2.default.PropTypes.oneOf(["left","right"])},componentDidMount:function(){var _this=this;this.props.openOnEvent&&this.props.pydio.observe(this.props.openOnEvent,function(){_this.showMenu()})},getInitialState:function(){return{showMenu:!1}},showMenu:function(event){var anchor=void 0;anchor=event?event.currentTarget:this._buttonDOM,this.setState({showMenu:!0,anchor:anchor})},menuClicked:function(event,index,object){this.setState({showMenu:!1})},render:function(){var _this2=this,_state=this.state,showMenu=_state.showMenu,anchor=_state.anchor,label=_react2.default.createElement("span",{style:{whiteSpace:"nowrap"}},this.props.buttonTitle," ",_react2.default.createElement("span",{className:"mdi mdi-menu-down"})),button=void 0,props={primary:this.props.primary,secondary:this.props.secondary,disabled:this.props.disabeld,label:label,onTouchTap:this.showMenu,labelStyle:_extends({},this.props.buttonLabelStyle,{paddingRight:10}),style:_extends({},this.props.buttonStyle,{backgroundColor:showMenu?"rgba(153,153,153,.2)":""}),onClick:function(e){return e.stopPropagation()}},menuItems=this.props.menuItems;return menuItems.length&&(button=this.props.raised?_react2.default.createElement(_materialUi.RaisedButton,_extends({},props,{ref:function(b){_this2._buttonDOM=_reactDom2.default.findDOMNode(b)}})):_react2.default.createElement(_materialUi.FlatButton,_extends({},props,{ref:function(b){_this2._buttonDOM=_reactDom2.default.findDOMNode(b)}}))),_react2.default.createElement("span",{id:this.props.id,className:this.props.className},button,_react2.default.createElement(_materialUi.Popover,{className:"menuPopover",open:showMenu,anchorEl:anchor,anchorOrigin:{horizontal:this.props.direction||"left",vertical:"bottom"},targetOrigin:{horizontal:this.props.direction||"left",vertical:"top"},onRequestClose:function(){_this2.setState({showMenu:!1})},style:{marginTop:1},useLayerForClickAway:!1},_Utils2.default.itemsToMenu(menuItems,this.menuClicked)))}});exports.default=_MenuItemsConsumer2.default(ButtonMenu),module.exports=exports.default},{"./MenuItemsConsumer":36,"./Utils":39,"material-ui":"material-ui",react:"react","react-dom":"react-dom"}],33:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _pydioModelContextMenu=require("pydio/model/context-menu"),_pydioModelContextMenu2=_interopRequireDefault(_pydioModelContextMenu),_Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),_PopupMenu=require("./PopupMenu"),_PopupMenu2=_interopRequireDefault(_PopupMenu),_require=require("react"),Component=_require.Component,dims={MENU_ITEM_HEIGHT:32,MENU_SEP_HEIGHT:16,MENU_VERTICAL_PADDING:8,MENU_WIDTH:250,OFFSET_VERTICAL:8,OFFSET_HORIZONTAL:8},ContextMenu=function(_Component){_inherits(ContextMenu,_Component);function ContextMenu(){_classCallCheck(this,ContextMenu),_Component.apply(this,arguments)}return ContextMenu.prototype.modelOpen=function(node){var position=_pydioModelContextMenu2.default.getInstance().getPosition();if(node){var dm=pydio.getContextHolder();-1!==dm.getSelectedNodes().indexOf(node)?this.openMenu("selectionContext",position):(pydio.observeOnce("actions_refreshed",function(dataModel){this.openMenu("selectionContext",position)}.bind(this)),dm.setSelectedNodes([node]))}else this.openMenu("genericContext",position)},ContextMenu.prototype.openMenu=function(context,position){var items=this.computeMenuItems(context);this._items=items,this.props.pydio.UI.MOBILE_EXTENSIONS?this.refs.menu.showMenu({bottom:0,left:0,right:0,height:200,zIndex:1e4,overflowY:"auto"},items):(position=this.computeVisiblePosition(position,items),this.refs.menu.showMenu({top:position.y,left:position.x},items))},ContextMenu.prototype.computeMenuItems=function(context){var actions=this.props.pydio.Controller.getContextActions(context,["inline","info_panel","info_panel_share"]);return _Utils2.default.pydioActionsToItems(actions)},ContextMenu.prototype.computeVisiblePosition=function(position,items){var menuHeight=2*dims.MENU_VERTICAL_PADDING;items.map(function(it){it.separator?menuHeight+=dims.MENU_SEP_HEIGHT:menuHeight+=dims.MENU_ITEM_HEIGHT});var menuWidth=dims.MENU_WIDTH,windowW=Math.max(document.documentElement.clientWidth,window.innerWidth||0),windowH=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return position.x+menuWidth>windowW?position.x=Math.max(position.x-menuWidth,10)-dims.OFFSET_HORIZONTAL:position.x+=dims.OFFSET_HORIZONTAL,position.y+menuHeight>windowH?position.y=Math.max(position.y-menuHeight,10)-dims.OFFSET_VERTICAL:position.y+=dims.OFFSET_VERTICAL,position},ContextMenu.prototype.componentDidMount=function(){this._modelOpen=this.modelOpen.bind(this),_pydioModelContextMenu2.default.getInstance().observe("open",this._modelOpen)},ContextMenu.prototype.componentWillUnmount=function(){_pydioModelContextMenu2.default.getInstance().stopObserving("open",this._modelOpen)},ContextMenu.prototype.render=function(){var mobile=this.props.pydio.UI.MOBILE_EXTENSIONS;return React.createElement(_PopupMenu2.default,{ref:"menu",menuItems:this._items||[],onMenuClosed:this.props.onMenuClosed,menuProps:mobile?{width:600,autoWidth:!1,desktop:!1}:{},zDepth:mobile?2:1})},ContextMenu}(Component);exports.default=ContextMenu,module.exports=exports.default},{"./PopupMenu":37,"./Utils":39,"pydio/model/context-menu":"pydio/model/context-menu",react:"react"}],34:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}
var _Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),_MenuItemsConsumer=require("./MenuItemsConsumer"),_MenuItemsConsumer2=_interopRequireDefault(_MenuItemsConsumer),React=require("react"),_require=require("material-ui"),IconButton=_require.IconButton,Popover=_require.Popover,IconButtonMenu=function(_React$Component){_inherits(IconButtonMenu,_React$Component);function IconButtonMenu(props,context){_classCallCheck(this,IconButtonMenu),_React$Component.call(this,props,context),this.state={showMenu:!1}}return IconButtonMenu.prototype.showMenu=function(event){this.setState({showMenu:!0,anchor:event.currentTarget})},IconButtonMenu.prototype.closeMenu=function(event,index,menuItem){this.setState({showMenu:!1})},IconButtonMenu.prototype.render=function(){var _this=this,_props=this.props,menuItems=_props.menuItems,className=_props.className,buttonTitle=_props.buttonTitle,buttonClassName=_props.buttonClassName,buttonStyle=_props.buttonStyle,popoverDirection=_props.popoverDirection,popoverTargetPosition=_props.popoverTargetPosition,menuProps=_props.menuProps;return menuItems.length?React.createElement("span",{className:"toolbars-button-menu "+(className||"")},React.createElement(IconButton,{ref:"menuButton",tooltip:buttonTitle,iconClassName:buttonClassName,onTouchTap:this.showMenu.bind(this),iconStyle:buttonStyle}),React.createElement(Popover,{open:this.state.showMenu,anchorEl:this.state.anchor,anchorOrigin:{horizontal:popoverDirection||"right",vertical:popoverTargetPosition||"bottom"},targetOrigin:{horizontal:popoverDirection||"right",vertical:"top"},onRequestClose:function(){_this.setState({showMenu:!1})},useLayerForClickAway:!1},_Utils2.default.itemsToMenu(menuItems,this.closeMenu.bind(this),!1,menuProps||void 0))):null},IconButtonMenu}(React.Component);IconButtonMenu.propTypes={buttonTitle:React.PropTypes.string.isRequired,buttonClassName:React.PropTypes.string.isRequired,className:React.PropTypes.string,popoverDirection:React.PropTypes.oneOf(["right","left"]),popoverPosition:React.PropTypes.oneOf(["top","bottom"]),menuProps:React.PropTypes.object,menuItems:React.PropTypes.array.isRequired},exports.default=_MenuItemsConsumer2.default(IconButtonMenu),module.exports=exports.default},{"./MenuItemsConsumer":36,"./Utils":39,"material-ui":"material-ui",react:"react"}],35:[function(require,module,exports){"use strict";exports.__esModule=!0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var React=require("react"),_require=require("material-ui"),IconButton=_require.IconButton,Popover=_require.Popover,IconButtonPopover=function(_React$Component){_inherits(IconButtonPopover,_React$Component);function IconButtonPopover(props,context){_classCallCheck(this,IconButtonPopover),_React$Component.call(this,props,context),this.state={showPopover:!1}}return IconButtonPopover.prototype.showPopover=function(event){this.setState({showPopover:!0,anchor:event.currentTarget})},IconButtonPopover.prototype.render=function(){var _this=this;return React.createElement("span",{className:"toolbars-button-menu "+(this.props.className?this.props.className:"")},React.createElement(IconButton,{ref:"menuButton",tooltip:this.props.buttonTitle,iconClassName:this.props.buttonClassName,onTouchTap:this.showPopover.bind(this),iconStyle:this.props.buttonStyle}),React.createElement(Popover,{open:this.state.showPopover,anchorEl:this.state.anchor,anchorOrigin:{horizontal:this.props.direction||"right",vertical:"bottom"},targetOrigin:{horizontal:this.props.direction||"right",vertical:"top"},onRequestClose:function(){_this.setState({showPopover:!1})},useLayerForClickAway:!1},this.props.popoverContent))},IconButtonPopover}(React.Component);IconButtonPopover.propTypes={buttonTitle:React.PropTypes.string.isRequired,buttonClassName:React.PropTypes.string.isRequired,className:React.PropTypes.string,direction:React.PropTypes.oneOf(["right","left"]),popoverContent:React.PropTypes.object.isRequired},exports.default=IconButtonPopover,module.exports=exports.default},{"material-ui":"material-ui",react:"react"}],36:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),React=require("react"),Controller=require("pydio/model/controller");exports.default=function(Component){var Wrapped=function(_React$Component){_inherits(Wrapped,_React$Component);function Wrapped(props,context){_classCallCheck(this,Wrapped),_React$Component.call(this,props,context),this.state={menuItems:this.props.menuItems||[]}}return Wrapped.prototype.componentDidMount=function(){var _this=this;this.props.controller&&!this.props.menuItems&&(this._observer=function(){var actions=_this.props.controller.getContextActions("genericContext",null,_this.props.toolbars),menuItems=_Utils2.default.pydioActionsToItems(actions);_this.setState({menuItems:menuItems})},this.props.controller===this.props.pydio.Controller?this.props.pydio.observe("actions_refreshed",this._observer):this.props.controller.observe("actions_refreshed",this._observer),this._observer())},Wrapped.prototype.componentWillUnmount=function(){this._observer&&(this.props.controller===this.props.pydio.Controller?this.props.pydio.stopObserving("actions_refreshed",this._observer):this.props.controller.stopObserving("actions_refreshed",this._observer))},Wrapped.prototype.componentWillReceiveProps=function(nextProps){nextProps.menuItems&&nextProps.menuItems!==this.props.menuItems&&this.setState({menuItems:nextProps.menuItems})},Wrapped.prototype.render=function(){return React.createElement(Component,_extends({},this.props,{menuItems:this.state.menuItems}))},Wrapped}(React.Component);return Wrapped.propTypes={menuItems:React.PropTypes.array,toolbars:React.PropTypes.array,controller:React.PropTypes.instanceOf(Controller),pydio:React.PropTypes.instanceOf(Pydio)},Wrapped},module.exports=exports.default},{"./Utils":39,"pydio/model/controller":"pydio/model/controller",react:"react"}],37:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),React=require("react"),ReactDOM=require("react-dom"),_require=require("material-ui"),Paper=(_require.Menu,_require.Paper);exports.default=React.createClass({displayName:"PopupMenu",propTypes:{menuItems:React.PropTypes.array.isRequired,onExternalClickCheckElements:React.PropTypes.func,className:React.PropTypes.string,style:React.PropTypes.object,onMenuClosed:React.PropTypes.func},getInitialState:function(){return{showMenu:!1,menuItems:this.props.menuItems}},showMenu:function(){var style=arguments.length<=0||void 0===arguments[0]?null:arguments[0],menuItems=arguments.length<=1||void 0===arguments[1]?null:arguments[1];this.setState({showMenu:!0,style:style,menuItems:menuItems||this.state.menuItems})},hideMenu:function(event){if(!event)return this.setState({showMenu:!1}),void(this.props.onMenuClosed&&this.props.onMenuClosed());if(void 0===event||2!==event.button||"contextmenu"===event.type){var node=ReactDOM.findDOMNode(this.refs.menuContainer);node.contains(event.target)||node===event.target||(this.setState({showMenu:!1}),this.props.onMenuClosed&&this.props.onMenuClosed())}},componentDidMount:function(){this._observer=this.hideMenu},componentWillUnmount:function(){document.removeEventListener("click",this._observer,!1)},componentWillReceiveProps:function(nextProps){nextProps.menuItems&&this.setState({menuItems:nextProps.menuItems})},componentDidUpdate:function(prevProps,nextProps){this.state.showMenu?document.addEventListener("click",this._observer,!1):document.removeEventListener("click",this._observer,!1)},menuClicked:function(event,index,menuItem){this.hideMenu()},render:function(){var style=this.state.style||{};style=_extends({},style,{zIndex:1e3});var menu=_Utils2.default.itemsToMenu(this.state.menuItems,this.menuClicked,!1,_extends({desktop:!0,display:"right",width:250},this.props.menuProps));return this.state.showMenu?React.createElement(Paper,{zDepth:this.props.zDepth||1,ref:"menuContainer",className:"menu-positioner",style:style},menu):null}}),module.exports=exports.default},{"./Utils":39,"material-ui":"material-ui",react:"react","react-dom":"react-dom"}],38:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_Utils=require("./Utils"),_Utils2=_interopRequireDefault(_Utils),_IconButtonMenu=require("./IconButtonMenu"),_IconButtonMenu2=_interopRequireDefault(_IconButtonMenu),_ButtonMenu=require("./ButtonMenu"),_ButtonMenu2=_interopRequireDefault(_ButtonMenu),_ButtonComposed=require("./ButtonComposed"),_ButtonComposed2=_interopRequireDefault(_ButtonComposed),_IconButtonPopover=require("./IconButtonPopover"),_IconButtonPopover2=_interopRequireDefault(_IconButtonPopover),_materialUi=require("material-ui");exports.default=_react2.default.createClass({displayName:"Toolbar",propTypes:{toolbars:_react2.default.PropTypes.array,groupOtherList:_react2.default.PropTypes.array,renderingType:_react2.default.PropTypes.string,controller:_react2.default.PropTypes.instanceOf(Controller),toolbarStyle:_react2.default.PropTypes.object,buttonStyle:_react2.default.PropTypes.object,fabAction:_react2.default.PropTypes.string,buttonMenuNoLabel:_react2.default.PropTypes.bool},componentDidMount:function(){this._observer=function(){this.isMounted()&&this.setState({groups:this.props.controller.getToolbarsActions(this.props.toolbars,this.props.groupOtherList)})}.bind(this),this.props.controller===pydio.Controller?pydio.observe("actions_refreshed",this._observer):this.props.controller.observe("actions_refreshed",this._observer)},componentWillUnmount:function(){this.props.controller===pydio.Controller?pydio.stopObserving("actions_refreshed",this._observer):this.props.controller.stopObserving("actions_refreshed",this._observer)},componentWillReceiveProps:function(nextProps){nextProps.toolbars!==this.props.toolbars&&this.setState({groups:this.props.controller.getToolbarsActions(nextProps.toolbars,nextProps.groupOtherList)})},getInitialState:function(){return{groups:this.props.controller.getToolbarsActions(this.props.toolbars,this.props.groupOtherList)}},getDefaultProps:function(){return{controller:global.pydio.Controller,renderingType:"button",groupOtherList:[]}},render:function(){var groups=this.state.groups,actions=[],_props=this.props,toolbars=_props.toolbars,renderingType=_props.renderingType,groupOtherList=_props.groupOtherList,buttonStyle=_props.buttonStyle,tooltipPosition=_props.tooltipPosition,controller=_props.controller,fabAction=_props.fabAction,toolbarStyle=_props.toolbarStyle,buttonMenuNoLabel=_props.buttonMenuNoLabel,buttonMenuPopoverDirection=_props.buttonMenuPopoverDirection,flatButtonStyle=_props.flatButtonStyle,allToolbars=[].concat(toolbars);groupOtherList.length&&(allToolbars=allToolbars.concat(["MORE_ACTION"])),allToolbars.map(function(barName){groups.has(barName)&&groups.get(barName).map(function(action){if(!action.deny){var menuItems=void 0,popoverContent=void 0,menuTitle=void 0,menuIcon=void 0,menuItemsUseMasterAction=void 0,actionName=action.options.name;menuTitle=pydio.MessageHash[action.options.text_id]||action.options.text,menuIcon=action.options.icon_class,"MORE_ACTION"===barName?function(){var subItems=action.subMenuItems.dynamicItems,items=[];subItems.map(function(obj){obj.separator?items.push(obj):obj.actionId&&!obj.actionId.deny&&items.push(obj.actionId.getMenuData())}),menuItems=_Utils2.default.pydioActionsToItems(items),menuIcon="mdi mdi-dots-vertical"}():action.subMenuItems.staticItems?menuItems=_Utils2.default.pydioActionsToItems(action.subMenuItems.staticItems):action.subMenuItems.dynamicBuilder?menuItems=_Utils2.default.pydioActionsToItems(action.subMenuItems.dynamicBuilder(controller)):action.subMenuItems.popoverContent&&(popoverContent=action.subMenuItems.popoverContent),menuItems&&action.subMenuItems.masterAction&&function(){var masterAction=controller.getActionByName(action.subMenuItems.masterAction);masterAction&&!masterAction.deny&&(menuItemsUseMasterAction=function(){masterAction.apply()})}();var id="action-"+action.options.name;if("button-icon"===renderingType&&(menuTitle=_react2.default.createElement("span",{className:"button-icon"},_react2.default.createElement("span",{className:"button-icon-icon "+menuIcon}),_react2.default.createElement("span",{className:"button-icon-label"},menuTitle))),menuItems)"button"===renderingType||"button-icon"===renderingType?menuItemsUseMasterAction?actions.push(_react2.default.createElement(_ButtonComposed2.default,{key:actionName,className:id,buttonTitle:menuTitle,menuItems:menuItems,masterAction:menuItemsUseMasterAction,buttonLabelStyle:buttonStyle,direction:buttonMenuPopoverDirection})):actions.push(_react2.default.createElement(_ButtonMenu2.default,{key:actionName,className:id,buttonTitle:buttonMenuNoLabel?"":menuTitle,menuItems:menuItems,buttonLabelStyle:buttonStyle,direction:buttonMenuPopoverDirection})):actions.push(_react2.default.createElement(_IconButtonMenu2.default,{key:actionName,className:id,onMenuClicked:function(object){object.payload()},buttonClassName:menuIcon,buttonTitle:menuTitle,menuItems:menuItems,buttonStyle:buttonStyle,popoverDirection:buttonMenuPopoverDirection}));else if(popoverContent)actions.push(_react2.default.createElement(_IconButtonPopover2.default,{key:actionName,className:id,buttonClassName:menuIcon,buttonTitle:menuTitle,buttonStyle:buttonStyle,popoverContent:popoverContent}));else{var click=function(){action.apply()};fabAction&&fabAction===actionName?actions.push(_react2.default.createElement(_materialUi.FloatingActionButton,{key:actionName,onTouchTap:click,iconClassName:menuIcon,mini:!0,backgroundColor:toolbarStyle.backgroundColor,style:{position:"absolute",top:-20,left:10}})):"button-icon"===renderingType?actions.push(_react2.default.createElement(ReactMUI.FlatButton,{key:actionName,className:id,onTouchTap:click,label:menuTitle,labelStyle:buttonStyle})):"button"===renderingType?actions.push(_react2.default.createElement(_materialUi.FlatButton,{key:actionName,className:id,onTouchTap:click,label:menuTitle,labelStyle:buttonStyle,style:flatButtonStyle})):actions.push(_react2.default.createElement(_materialUi.IconButton,{key:actionName,iconClassName:menuIcon+" "+id,iconStyle:buttonStyle,onTouchTap:click,tooltip:menuTitle,tooltipPosition:tooltipPosition}))}}})});var cName=this.props.className?this.props.className:"";cName+=" toolbar",actions.length||(cName+=" empty-toolbar");var style=_extends({},toolbarStyle);return _react2.default.createElement("div",{className:cName,style:style,id:this.props.id},actions)}}),module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ButtonComposed":31,"./ButtonMenu":32,"./IconButtonMenu":34,"./IconButtonPopover":35,"./Utils":39,"material-ui":"material-ui",react:"react"}],39:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_require=require("material-ui"),Divider=_require.Divider,Menu=_require.Menu,MenuItem=_require.MenuItem,FontIcon=_require.FontIcon;function pydioActionsToItems(){var actions=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],items=[],lastIsSeparator=!1;return actions.map(function(action,index){if(action.separator){if(lastIsSeparator)return;return items.push(action),void(lastIsSeparator=!0)}lastIsSeparator=!1;var label=action.raw_name?action.raw_name:action.name,iconClass=action.icon_class;if(action.subMenu){var subItems=action.subMenuBeforeShow?pydioActionsToItems(action.subMenuBeforeShow()):action.subMenu;items.push({text:label,iconClassName:iconClass,subItems:subItems})}else items.push({text:label,iconClassName:iconClass,payload:action.callback})}.bind(this)),lastIsSeparator&&(items=items.slice(0,items.length-1)),items.length&&items[0]&&items[0].separator&&items.shift(),items}function itemsToMenu(items,closeMenuCallback){var subItemsOnly=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],menuProps=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];menuProps=_extends({display:"normal",width:216,desktop:!0,autoWidth:!1},menuProps);var menuItems=items.map(function(item,index){if(item.separator)return React.createElement(Divider,{key:"divider"+index});var subItems=void 0,payload=void 0;item.subItems?subItems=itemsToMenu(item.subItems,closeMenuCallback,!0):item.payload&&(payload=function(){item.payload(),closeMenuCallback()});var leftIcon=void 0,rightIcon=void 0,iconClassName=item.iconClassName,inset=!1;return"__INSET__"===iconClassName&&(iconClassName="",inset=!0),"normal"===menuProps.display?leftIcon=iconClassName?React.createElement(FontIcon,{className:item.iconClassName+" menu-icons",style:{fontSize:16,padding:5}}):null:"right"===menuProps.display&&(rightIcon=iconClassName?React.createElement(FontIcon,{className:item.iconClassName+" menu-icons",style:{fontSize:16,padding:5}}):null),rightIcon=subItems&&subItems.length?React.createElement(FontIcon,{className:"mdi mdi-menu-right menu-icons"}):rightIcon,React.createElement(MenuItem,{key:item.text,primaryText:item.text,insetChildren:inset,leftIcon:leftIcon,rightIcon:rightIcon,onTouchTap:payload,menuItems:subItems})});return subItemsOnly?menuItems:React.createElement(Menu,menuProps,menuItems)}exports.default={pydioActionsToItems:pydioActionsToItems,itemsToMenu:itemsToMenu},module.exports=exports.default},{"material-ui":"material-ui"}],40:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_materialUi=require("material-ui"),_materialUiStyles=require("material-ui/styles"),_pydioHttpPolicies=require("pydio/http/policies"),_pydioHttpPolicies2=_interopRequireDefault(_pydioHttpPolicies),_pydioHttpRestApi=(require("pydio/http/users-api"),require("pydio/http/rest-api")),_pydio2=require("pydio"),_pydio3=_interopRequireDefault(_pydio2),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_usersUsersCompleter=require("../users/UsersCompleter"),_usersUsersCompleter2=_interopRequireDefault(_usersUsersCompleter),ResourcePoliciesPanel=function(_React$Component){_inherits(ResourcePoliciesPanel,_React$Component);function ResourcePoliciesPanel(props){_classCallCheck(this,ResourcePoliciesPanel),props.subjectsDisabled||(props.subjectsDisabled={READ:{},WRITE:{}}),props.cellAcls&&Object.keys(props.cellAcls).map(function(k){props.cellAcls[k].RoleId&&(props.subjectsDisabled.READ["role:"+props.cellAcls[k].RoleId]=!0)}),_React$Component.call(this,props),this.state={loading:!0,policies:[],diffPolicies:{add:{},remove:{}}}}return ResourcePoliciesPanel.prototype.componentDidMount=function(){this.setState({loading:!0}),this.reload()},ResourcePoliciesPanel.prototype.reload=function(){var _this=this,_props=this.props,resourceType=_props.resourceType,resourceId=_props.resourceId,_pydio=pydio,user=_pydio.user,proms=[_pydioHttpPolicies2.default.loadPolicies(resourceType,resourceId),user.getIdmUser()];"team"!==resourceType&&proms.push(_pydioHttpApi2.default.getRestClient().getIdmApi().listTeams()),Promise.all(proms).then(function(result){var policies=result[0],resourceUuid=policies[0].Resource,idmUser=result[1],teams=[];"team"!==resourceType&&result[2]&&(teams=result[2].Teams),_this.setState({policies:policies,idmUser:idmUser,userTeams:teams,loading:!1,resourceUuid:resourceUuid})}).catch(function(error){_this.setState({error:error.message,loading:!1})})},ResourcePoliciesPanel.prototype.revert=function(){this.setState({dirtyPolicies:null,diffPolicies:{add:{},remove:{}}})},ResourcePoliciesPanel.prototype.save=function(){var _this2=this,_state=this.state,dirtyPolicies=_state.dirtyPolicies,diffPolicies=_state.diffPolicies,_props2=this.props,resourceType=_props2.resourceType,resourceId=_props2.resourceId,onSavePolicies=_props2.onSavePolicies;_pydioHttpPolicies2.default.savePolicies(resourceType,resourceId,dirtyPolicies).then(function(result){_this2.setState({policies:result,dirtyPolicies:null,diffPolicies:{add:{},remove:{}}}),onSavePolicies&&onSavePolicies(diffPolicies)}).catch(function(reason){_this2.setState({error:reason.message})})},ResourcePoliciesPanel.prototype.removePolicy=function(action,subject){var _state2=this.state,policies=_state2.policies,dirtyPolicies=_state2.dirtyPolicies,diffPolicies=_state2.diffPolicies;dirtyPolicies&&(policies=dirtyPolicies);var newPolicies=[];policies.map(function(p){p.Action===action&&p.Subject===subject||newPolicies.push(p)}),diffPolicies.remove[action+"///"+subject]=!0,diffPolicies.add[action+"///"+subject]&&delete diffPolicies.add[action+"///"+subject],this.setState({dirtyPolicies:newPolicies,diffPolicies:diffPolicies})},ResourcePoliciesPanel.prototype.addPolicy=function(action,subject){var isPickedUser=!(arguments.length<=2||void 0===arguments[2])&&arguments[2],_state3=this.state,policies=_state3.policies,dirtyPolicies=_state3.dirtyPolicies,resourceUuid=_state3.resourceUuid,diffPolicies=_state3.diffPolicies,newPolicies=[].concat(dirtyPolicies?dirtyPolicies:policies),newPol=new _pydioHttpRestApi.ServiceResourcePolicy;newPol.Resource=resourceUuid,newPol.Effect="allow",newPol.Subject=subject,newPol.Action=action,newPolicies.push(newPol),diffPolicies.add[action+"///"+subject]=!0,diffPolicies.remove[action+"///"+subject]&&delete diffPolicies.remove[action+"///"+subject],isPickedUser?this.setState({dirtyPolicies:newPolicies,diffPolicies:diffPolicies,pickedUser:null,pickedLabel:null}):this.setState({dirtyPolicies:newPolicies,diffPolicies:diffPolicies})},ResourcePoliciesPanel.prototype.hasOneWrite=function(userSubjects,policies){for(var i=0;i<userSubjects.length;i++)for(var j=0;j<policies.length;j++)if(policies[j].Subject===userSubjects[i]&&"WRITE"===policies[j].Action)return!0;return!1},ResourcePoliciesPanel.prototype.listUserRoles=function(idmUser,policies){var crtUserSubject="user:"+idmUser.Login,values={};idmUser.Roles.map(function(role){role.GroupRole&&(values["role:"+role.Uuid]=role.Label)}),values[crtUserSubject]="You";var hasWrite=this.hasOneWrite(Object.keys(values),policies);values=_extends({},this.listOtherUsersSubjects(policies,crtUserSubject),values);for(var keys=Object.keys(values),groupBlocks=[],i=keys.length-1;i>=0;i--){var newKey=keys[i],newVal=values[newKey];groupBlocks.push(this.renderLine(newKey,newVal,policies,!hasWrite||newKey===crtUserSubject))}return{groupBlocks:groupBlocks,hasWrite:hasWrite}},ResourcePoliciesPanel.prototype.listUserTeams=function(userTeams,policies,disabled){var _this3=this;return userTeams.map(function(role){return _this3.renderLine("role:"+role.Uuid,role.Label,policies,disabled)})},ResourcePoliciesPanel.prototype.listOtherUsersSubjects=function(policies,currentUserSubject){var _props3=this.props,resourceId=_props3.resourceId,cellAcls=_props3.cellAcls,subs={};return policies.map(function(p){if(0===p.Subject.indexOf("user:")&&p.Subject!==currentUserSubject&&p.Subject!=="user:"+resourceId&&(subs[p.Subject]=p.Subject.substr("user:".length)),cellAcls&&0===p.Subject.indexOf("role:")&&cellAcls[p.Subject.substr("role:".length)]){var roleId=p.Subject.substr("role:".length);if(cellAcls[roleId].User){var usr=cellAcls[roleId].User;currentUserSubject!=="user:"+usr.Login&&(subs[p.Subject]=usr.Attributes&&usr.Attributes.displayName?usr.Attributes.displayName:usr.Login)}else if(cellAcls[roleId].Group){var grp=cellAcls[roleId].Group;subs[p.Subject]=grp.Attributes&&grp.Attributes.displayName?grp.Attributes.displayName:grp.GroupLabel}}}),subs},ResourcePoliciesPanel.prototype.pickUser=function(userOrRole){var subject=void 0,label=void 0;if(userOrRole.IdmUser){var IdmUser=userOrRole.IdmUser,attributes=IdmUser.Attributes||{};IdmUser.IsGroup?(subject="role:"+IdmUser.Uuid,label=attributes.displayName||IdmUser.GroupLabel):(subject="user:"+IdmUser.Login,label=attributes.displayName||IdmUser.Login)}else{var IdmRole=userOrRole.IdmRole;subject="role:"+IdmRole.Uuid,label=IdmRole.Label}this.setState({pickedUser:subject,pickedLabel:label})},ResourcePoliciesPanel.prototype.renderLine=function(subject,label,policies,disabled){var _this4=this,isPickedUser=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],_props4=this.props,subjectsDisabled=_props4.subjectsDisabled,subjectsHidden=_props4.subjectsHidden,readonly=_props4.readonly;if(subjectsHidden&&subjectsHidden[subject])return null;var read=!1,write=!1,readChange=function(){_this4.addPolicy("READ",subject,isPickedUser)},writeChange=function(){_this4.addPolicy("WRITE",subject,isPickedUser)};policies.map(function(p){p.Subject===subject&&("WRITE"===p.Action?(write="WRITE"===p.Action,writeChange=function(){_this4.removePolicy("WRITE",subject)}):"READ"===p.Action&&(read="READ"===p.Action,readChange=function(){_this4.removePolicy("READ",subject)}))});var disableWrite=disabled,disableRead=disabled;return readonly?(disableRead=!0,disableWrite=!0):(subjectsDisabled&&subjectsDisabled.READ&&subjectsDisabled.READ[subject]&&(disableRead=!0),subjectsDisabled&&subjectsDisabled.WRITE&&subjectsDisabled.WRITE[subject]&&(disableWrite=!0)),_react2.default.createElement("div",{style:{display:"flex",margin:10,marginRight:0}},_react2.default.createElement("div",{style:{flex:1}},label),_react2.default.createElement(_materialUi.Checkbox,{checked:read,disabled:disableRead,style:{width:40},onCheck:readChange}),_react2.default.createElement(_materialUi.Checkbox,{checked:write,disabled:disableWrite,style:{width:40},onCheck:writeChange}))},ResourcePoliciesPanel.prototype.render=function(){var _this5=this,appBar=this.props.muiTheme.appBar,styles={title:{paddingLeft:10,backgroundColor:appBar.color,display:"flex",alignItems:"center",fontSize:16,color:appBar.textColor},subheader:{margin:10,fontWeight:500,color:"#9E9E9E",display:"flex"},subject:{margin:10},head:{display:"inline-block",width:40,textAlign:"center",fontSize:10}},_state4=this.state,policies=_state4.policies,dirtyPolicies=_state4.dirtyPolicies,error=_state4.error,idmUser=_state4.idmUser,userTeams=_state4.userTeams,loading=_state4.loading,pickedUser=_state4.pickedUser,pickedLabel=_state4.pickedLabel,_props5=this.props,onDismiss=_props5.onDismiss,style=_props5.style,skipTitle=_props5.skipTitle,resourceId=_props5.resourceId,pydio=_props5.pydio,userListExcludes=_props5.userListExcludes,readonly=_props5.readonly,blocks=[];if(!loading&&!error){var _listUserRoles=this.listUserRoles(idmUser,dirtyPolicies||policies),groupBlocks=_listUserRoles.groupBlocks,hasWrite=_listUserRoles.hasWrite,teamBlocks=this.listUserTeams(userTeams,dirtyPolicies||policies,!hasWrite),heads=_react2.default.createElement("div",null,_react2.default.createElement("span",{style:styles.head},"View"),_react2.default.createElement("span",{style:styles.head},"Edit"));groupBlocks.length&&(blocks.push(_react2.default.createElement("div",{style:styles.subheader},_react2.default.createElement("span",{style:{flex:1}},"Users"),heads)),blocks.push(groupBlocks),blocks.push(_react2.default.createElement(_materialUi.Divider,null))),teamBlocks.length&&(blocks.push(_react2.default.createElement("div",{style:styles.subheader},_react2.default.createElement("span",{style:{flex:1}},"Your Teams"),heads)),blocks.push(teamBlocks),blocks.push(_react2.default.createElement(_materialUi.Divider,null))),pickedUser?(blocks.push(_react2.default.createElement("div",{style:styles.subheader},"Set visible to...")),blocks.push(this.renderLine(pickedUser,pickedLabel,policies,!1,!0)),blocks.push(_react2.default.createElement("div",{style:{textAlign:"right"}},_react2.default.createElement(_materialUi.FlatButton,{label:"Cancel",onTouchTap:function(){_this5.setState({pickedUser:null,pickedLabel:null})}}))),blocks.push(_react2.default.createElement(_materialUi.Divider,null))):readonly||function(){var crtUserSubject="user:"+idmUser.Login,userSubjects=_this5.listOtherUsersSubjects(dirtyPolicies||policies,crtUserSubject),exludes=[];Object.keys(userSubjects).map(function(k){exludes.push(userSubjects[k])}),blocks.push(_react2.default.createElement("div",{style:styles.subheader},"Set visible to ...")),blocks.push(_react2.default.createElement("div",{style:{margin:"-30px 10px 0"}},_react2.default.createElement(_usersUsersCompleter2.default,{className:"share-form-users",fieldLabel:"Select user",renderSuggestion:function(userObject){return _react2.default.createElement("div",{style:{fontSize:13}},userObject.getExtendedLabel())},onValueSelected:_this5.pickUser.bind(_this5),usersOnly:!0,existingOnly:!0,excludes:[resourceId].concat(userListExcludes,exludes),pydio:pydio,showAddressBook:!1,usersFrom:"local"}))),blocks.push(_react2.default.createElement(_materialUi.Divider,null))}(),blocks.pop()}return _react2.default.createElement("div",{style:style},_react2.default.createElement("div",{style:styles.title},_react2.default.createElement("span",{style:{flex:1}
},skipTitle?"":"Visibility"),dirtyPolicies&&_react2.default.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-undo-variant",tooltip:"Revert changes",onTouchTap:this.revert.bind(this),iconStyle:{color:appBar.textColor}}),dirtyPolicies&&_react2.default.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-content-save",tooltip:"Save changes",onTouchTap:this.save.bind(this),iconStyle:{color:appBar.textColor}}),!dirtyPolicies&&onDismiss&&_react2.default.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-close",onTouchTap:onDismiss,iconStyle:{color:appBar.textColor}})),error&&_react2.default.createElement("div",null,"Error: ",error),_react2.default.createElement("div",null,blocks))},ResourcePoliciesPanel}(_react2.default.Component);ResourcePoliciesPanel.PropTypes={pydio:_react2.default.PropTypes.instanceOf(_pydio3.default),resourceType:_react2.default.PropTypes.string.isRequired,resourceId:_react2.default.PropTypes.string.isRequired,onSavePolicies:_react2.default.PropTypes.func,userListExcludes:_react2.default.PropTypes.array,subjectsDisabled:_react2.default.PropTypes.array,subjectsHidden:_react2.default.PropTypes.object,readonly:_react2.default.PropTypes.bool,cellAcls:_react2.default.PropTypes.object,onDismiss:_react2.default.PropTypes.func,style:_react2.default.PropTypes.object,skipTitle:_react2.default.PropTypes.bool},exports.default=ResourcePoliciesPanel=_materialUiStyles.muiThemeable()(ResourcePoliciesPanel),exports.default=ResourcePoliciesPanel,module.exports=exports.default},{"../users/UsersCompleter":43,"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/http/policies":"pydio/http/policies","pydio/http/rest-api":"pydio/http/rest-api","pydio/http/users-api":"pydio/http/users-api",react:"react"}],41:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_require=require("react"),Component=_require.Component,PropTypes=_require.PropTypes,_require2=require("material-ui"),TextField=_require2.TextField,FlatButton=_require2.FlatButton,_require$requireLib=require("pydio").requireLib("boot"),PydioContextConsumer=_require$requireLib.PydioContextConsumer,TeamCreationForm=function(_Component){_inherits(TeamCreationForm,_Component);function TeamCreationForm(props,context){_classCallCheck(this,TeamCreationForm),_Component.call(this,props,context),this.state={value:""}}return TeamCreationForm.prototype.onChange=function(e,value){this.setState({value:value})},TeamCreationForm.prototype.submitCreationForm=function(){var value=this.state.value;_pydioHttpApi2.default.getRestClient().getIdmApi().saveSelectionAsTeam(value,[],this.props.onTeamCreated)},TeamCreationForm.prototype.render=function(){var getMessage=this.props.getMessage;return React.createElement("div",null,React.createElement("div",{style:{padding:20}},React.createElement("div",null,getMessage(591)),React.createElement(TextField,{floatingLabelText:getMessage(578),value:this.state.value,onChange:this.onChange.bind(this),fullWidth:!0})),React.createElement("div",null,React.createElement("div",{style:{textAlign:"right",padding:8}},React.createElement(FlatButton,{label:getMessage(49),onTouchTap:this.props.onCancel.bind(this)}),React.createElement(FlatButton,{label:getMessage(579),primary:!0,onTouchTap:this.submitCreationForm.bind(this)}))))},TeamCreationForm}(Component);TeamCreationForm.propTypes={onTeamCreated:PropTypes.func.isRequired,onCancel:PropTypes.func.isRequired},exports.default=TeamCreationForm=PydioContextConsumer(TeamCreationForm),exports.default=TeamCreationForm,module.exports=exports.default},{"material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],42:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_materialUi=require("material-ui"),_pydioHttpUsersApi=require("pydio/http/users-api"),_Pydio$requireLib=_pydio2.default.requireLib("form"),Manager=_Pydio$requireLib.Manager,FormPanel=_Pydio$requireLib.FormPanel,UserCreationForm=function(_React$Component){_inherits(UserCreationForm,_React$Component),UserCreationForm.prototype.getCreateUserParameters=function(){var editMode=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],basicParameters=[],pydio=this.props.pydio,MessageHash=pydio.MessageHash,prefix=pydio.getPluginConfigs("action.share").get("SHARED_USERS_TMP_PREFIX");basicParameters.push({IdmUserField:"Login",description:MessageHash[533],readonly:editMode,expose:"true",label:MessageHash[522],name:editMode?"existing_user_id":"new_user_id",scope:"user",type:"string",mandatory:!0,default:prefix||""},{IdmUserField:"Password",description:MessageHash[534],editable:"true",expose:"true",label:MessageHash[523],name:"new_password",scope:"user",type:"valid-password",mandatory:!0});for(var params=global.pydio.getPluginConfigs("auth").get("NEWUSERS_EDIT_PARAMETERS").split(","),i=0;i<params.length;i++)params[i]="user/preferences/pref[@exposed]|//param[@name='"+params[i]+"']";var xPath=params.join("|");return Manager.parseParameters(this.props.pydio.getXmlRegistry(),xPath).map(function(el){basicParameters.push(el)}),editMode||basicParameters.push({description:MessageHash[536],editable:"true",expose:"true",label:MessageHash[535],name:"send_email",scope:"user",type:"boolean",mandatory:!0}),basicParameters},UserCreationForm.prototype.getDefaultProps=function(){return{editMode:!1}},UserCreationForm.prototype.getParameters=function(){return this._parsedParameters||(this._parsedParameters=this.getCreateUserParameters(this.props.editMode)),this._parsedParameters},UserCreationForm.prototype.getValuesForPost=function(prefix){return Manager.getValuesForPOST(this.getParameters(),this.state.values,prefix)};function UserCreationForm(props,context){var _this=this;_classCallCheck(this,UserCreationForm),_React$Component.call(this,props,context);var _props=this.props,pydio=_props.pydio,newUserName=_props.newUserName,editMode=_props.editMode,userData=_props.userData,userPrefix=pydio.getPluginConfigs("action.share").get("SHARED_USERS_TMP_PREFIX");userPrefix&&!newUserName.startsWith(userPrefix)||(userPrefix="");var values={new_password:"",send_email:!0};editMode&&userData&&userData.IdmUser?function(){var IdmUser=userData.IdmUser;_this.getParameters().forEach(function(param){var name=param.name,IdmUserField=param.IdmUserField,scope=param.scope,pluginId=param.pluginId,value=void 0;IdmUserField?value=IdmUser[IdmUserField]:"user"===scope&&IdmUser.Attributes?value=IdmUser.Attributes[name]:pluginId&&IdmUser.Attributes["parameter:"+pluginId+":"+name]&&(value=JSON.parse(IdmUser.Attributes["parameter:"+pluginId+":"+name])),void 0!==value&&(values[name]=value)})}():(values.new_user_id=userPrefix+newUserName,values.lang=pydio.currentLanguage),this.state={values:values}}return UserCreationForm.prototype.onValuesChange=function(newValues){this.setState({values:newValues})},UserCreationForm.prototype.changeValidStatus=function(status){this.setState({valid:status})},UserCreationForm.prototype.submitCreationForm=function(){var _this2=this,existingUser=void 0,_props2=this.props,editMode=_props2.editMode,userData=_props2.userData;editMode&&(existingUser=userData.IdmUser),_pydioHttpApi2.default.getRestClient().getIdmApi().putExternalUser(this.state.values,this.getParameters(),existingUser).then(function(idmUser){_this2.props.onUserCreated(_pydioHttpUsersApi.User.fromIdmUser(idmUser))})},UserCreationForm.prototype.cancelCreationForm=function(){this.props.onCancel()},UserCreationForm.prototype.render=function(){var _props3=this.props,pydio=_props3.pydio,editMode=_props3.editMode,status=(_props3.newUserName,this.state.valid);return status||!editMode||this.state.values.new_password||(status=!0),_react2.default.createElement(_materialUi.Paper,{zDepth:void 0!==this.props.zDepth?this.props.zDepth:2,style:_extends({minHeight:250,display:"flex",flexDirection:"column"},this.props.style)},_react2.default.createElement(FormPanel,{className:"reset-pydio-forms",depth:-1,parameters:this.getParameters(),values:this.state.values,onChange:this.onValuesChange.bind(this),onValidStatusChange:this.changeValidStatus.bind(this),style:{overflowY:"auto",flex:1}}),_react2.default.createElement(_materialUi.Divider,{style:{flexShrink:0}}),_react2.default.createElement("div",{style:{padding:8,textAlign:"right"}},_react2.default.createElement(_materialUi.FlatButton,{label:pydio.MessageHash[49],onTouchTap:this.cancelCreationForm.bind(this)}),_react2.default.createElement(_materialUi.FlatButton,{label:this.props.editMode?pydio.MessageHash[519]:pydio.MessageHash[484],primary:!0,onTouchTap:this.submitCreationForm.bind(this),disabled:!status})))},UserCreationForm}(_react2.default.Component);UserCreationForm.propTypes={newUserName:_react2.default.PropTypes.string,onUserCreated:_react2.default.PropTypes.func.isRequired,onCancel:_react2.default.PropTypes.func.isRequired,editMode:_react2.default.PropTypes.bool,userData:_react2.default.PropTypes.object},exports.default=UserCreationForm,module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/http/users-api":"pydio/http/users-api",react:"react"}],43:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_addressbookAddressBook=require("./addressbook/AddressBook"),_addressbookAddressBook2=_interopRequireDefault(_addressbookAddressBook),_materialUi=require("material-ui"),_pydioUtilFunc=require("pydio/util/func"),_pydioUtilFunc2=_interopRequireDefault(_pydioUtilFunc),_UserCreationForm=require("./UserCreationForm"),_UserCreationForm2=_interopRequireDefault(_UserCreationForm),UsersLoader=_react2.default.createClass({displayName:"UsersLoader",propTypes:{renderSuggestion:_react2.default.PropTypes.func.isRequired,onValueSelected:_react2.default.PropTypes.func.isRequired,fieldLabel:_react2.default.PropTypes.string.isRequired,excludes:_react2.default.PropTypes.array.isRequired,usersOnly:_react2.default.PropTypes.bool,usersFrom:_react2.default.PropTypes.oneOf(["local","remote","any"]),existingOnly:_react2.default.PropTypes.bool,freeValueAllowed:_react2.default.PropTypes.bool,className:_react2.default.PropTypes.string},getInitialState:function(){return{dataSource:[],loading:!1,searchText:"",minChars:parseInt(global.pydio.getPluginConfigs("core.auth").get("USERS_LIST_COMPLETE_MIN_CHARS"))}},suggestionLoader:function(input,callback){var _this=this,excludes=this.props.excludes;this.setState({loading:this.state.loading+1});var api=_pydioHttpApi2.default.getRestClient().getIdmApi(),uPromise=api.listUsers("/",input,!0,0,20),gPromise=api.listGroups("/",input,!0,0,20),tPromise=api.listTeams(input,0,20);Promise.all([uPromise,gPromise,tPromise]).then(function(results){_this.setState({loading:_this.state.loading-1});var users=results[0],groups=results[1],teams=results[2];users=users.Users,groups=groups.Groups,teams=teams.Teams,excludes&&excludes.length&&(users=users.filter(function(user){return-1===excludes.indexOf(user.Login)}),groups=groups.filter(function(group){return-1===excludes.indexOf(group.GroupLabel)}),teams=teams.filter(function(team){return excludes.indexOf(-1===team.Label)})),callback([].concat(groups.map(function(u){return{IdmUser:u}}),teams.map(function(u){return{IdmRole:u}}),users.map(function(u){return{IdmUser:u}})))})},textFieldUpdate:function(value){this.setState({searchText:value}),this.state.minChars&&value&&value.length<this.state.minChars||this.loadBuffered(value,350)},getPendingSearchText:function(){return this.state.searchText||!1},loadBuffered:function(value,timeout){if(!value&&this._emptyValueList)return void this.setState({dataSource:this._emptyValueList});var _props=this.props,existingOnly=_props.existingOnly,freeValueAllowed=_props.freeValueAllowed;_pydioUtilFunc2.default.bufferCallback("remote_users_search",timeout,function(){this.setState({loading:!0}),this.suggestionLoader(value,function(users){var valueExists=!1,values=users.map(function(userObject){var identifier=void 0,label=void 0;return userObject.IdmUser&&userObject.IdmUser.IsGroup?(identifier=userObject.IdmUser.GroupLabel,label=userObject.IdmUser.Attributes&&userObject.IdmUser.Attributes.displayName?userObject.IdmUser.Attributes.displayName:identifier,"mdi mdi-folder"):userObject.IdmUser?(identifier=userObject.IdmUser.Login,label=userObject.IdmUser.Attributes&&userObject.IdmUser.Attributes.displayName?userObject.IdmUser.Attributes.displayName:identifier,"mdi mdi-account"):(identifier=userObject.IdmRole.Uuid,label=userObject.IdmRole.Label,"mdi mdi-folder"),valueExists|=label===value,{userObject:userObject,text:identifier,value:_react2.default.createElement(_materialUi.MenuItem,{primaryText:label})}}.bind(this));value||(this._emptyValueList=values),!value||valueExists||existingOnly&&!freeValueAllowed||(values=[{text:value,value:_react2.default.createElement(_materialUi.MenuItem,{primaryText:value+(freeValueAllowed?"":" (create user)")})}].concat(values)),this.setState({dataSource:values,loading:!1})}.bind(this))}.bind(this))},onCompleterRequest:function(value,index){var freeValueAllowed=this.props.freeValueAllowed;if(-1===index&&(this.state.dataSource.map(function(entry){entry.text===value&&(value=entry)}),value&&!value.userObject&&this.props.freeValueAllowed))return this.props.onValueSelected({FreeValue:value.text}),void this.setState({searchText:"",dataSource:[]});value&&(value.userObject?this.props.onValueSelected(value.userObject):freeValueAllowed?this.props.onValueSelected({FreeValue:value.text}):this.setState({createUser:value.text}),this.setState({searchText:"",dataSource:[]}))},onUserCreated:function(newUser){this.props.onValueSelected(newUser),this.setState({createUser:null})},onCreationCancelled:function(){this.setState({createUser:null})},openAddressBook:function(event){this.setState({addressBookOpen:!0,addressBookAnchor:event.currentTarget})},closeAddressBook:function(){this.setState({addressBookOpen:!1})},onAddressBookItemSelected:function(item){this.props.onValueSelected(item)},render:function(){var _this2=this,_state=this.state,dataSource=_state.dataSource,createUser=_state.createUser,containerStyle={position:"relative",overflow:"visible"};return _react2.default.createElement("div",{style:containerStyle,ref:function(el){_this2._popoverAnchor=el}},!createUser&&_react2.default.createElement(_materialUi.AutoComplete,{filter:_materialUi.AutoComplete.noFilter,dataSource:dataSource,searchText:this.state.searchText,onUpdateInput:this.textFieldUpdate,className:this.props.className,openOnFocus:!0,floatingLabelText:this.props.fieldLabel,underlineShow:!this.props.underlineHide,fullWidth:!0,onNewRequest:this.onCompleterRequest,listStyle:{maxHeight:350,overflowY:"auto"},onFocus:function(){_this2.loadBuffered(_this2.state.searchText,100)}}),createUser&&_react2.default.createElement(_materialUi.TextField,{floatingLabelText:this.props.fieldLabel,value:global.pydio.MessageHash[485]+" ("+this.state.createUser+")",disabled:!0,fullWidth:!0,underlineShow:!this.props.underlineHide}),!createUser&&_react2.default.createElement("div",{style:{position:"absolute",right:4,bottom:14,height:20,width:20}},_react2.default.createElement(_materialUi.RefreshIndicator,{size:20,left:0,top:0,status:this.state.loading?"loading":"hide"})),this.props.showAddressBook&&!createUser&&_react2.default.createElement(_addressbookAddressBook2.default,{mode:"popover",pydio:this.props.pydio,loaderStyle:{width:320,height:420},onItemSelected:this.onAddressBookItemSelected,usersFrom:this.props.usersFrom,disableSearch:!0}),_react2.default.createElement(_materialUi.Popover,{open:createUser,anchorEl:this._popoverAnchor,anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.onCreationCancelled,canAutoPosition:!1},createUser&&_react2.default.createElement(_UserCreationForm2.default,{onUserCreated:this.onUserCreated.bind(this),onCancel:this.onCreationCancelled.bind(this),style:{width:350,height:320},newUserName:this.state.createUser,pydio:this.props.pydio})))}});exports.default=UsersLoader,module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./UserCreationForm":42,"./addressbook/AddressBook":44,"material-ui":"material-ui","pydio/http/api":"pydio/http/api","pydio/util/func":"pydio/util/func",react:"react"}],44:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _NestedListItem=require("./NestedListItem"),_NestedListItem2=_interopRequireDefault(_NestedListItem),_UsersList=require("./UsersList"),_UsersList2=_interopRequireDefault(_UsersList),_RightPanelCard=require("./RightPanelCard"),_RightPanelCard2=_interopRequireDefault(_RightPanelCard),_SearchPanel=require("./SearchPanel"),_SearchPanel2=_interopRequireDefault(_SearchPanel),_Loaders=require("./Loaders"),_Loaders2=_interopRequireDefault(_Loaders),_TeamCreationForm=require("../TeamCreationForm"),_TeamCreationForm2=_interopRequireDefault(_TeamCreationForm),_react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_materialUi=require("material-ui"),_materialUiStyles=require("material-ui/styles"),_avatarActionsPanel=require("../avatar/ActionsPanel"),_avatarActionsPanel2=_interopRequireDefault(_avatarActionsPanel),_UserCreationForm=require("../UserCreationForm"),_UserCreationForm2=_interopRequireDefault(_UserCreationForm),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_Pydio$requireLib=_pydio2.default.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,AddressBook=_react2.default.createClass({displayName:"AddressBook",propTypes:{pydio:_react2.default.PropTypes.instanceOf(_pydio2.default),mode:_react2.default.PropTypes.oneOf(["book","selector","popover"]).isRequired,bookColumn:_react2.default.PropTypes.bool,onItemSelected:_react2.default.PropTypes.func,usersOnly:_react2.default.PropTypes.bool,usersFrom:_react2.default.PropTypes.oneOf(["local","remote","any"]),disableSearch:_react2.default.PropTypes.bool,muiTheme:_react2.default.PropTypes.object,popoverStyle:_react2.default.PropTypes.object,popoverButton:_react2.default.PropTypes.object,popoverContainerStyle:_react2.default.PropTypes.object,popoverIconButtonStyle:_react2.default.PropTypes.object},getDefaultProps:function(){return{mode:"book",usersOnly:!1,usersFrom:"any",teamsOnly:!1,disableSearch:!1}},getInitialState:function(){var _this=this,_props=this.props,pydio=_props.pydio,mode=_props.mode,usersOnly=_props.usersOnly,usersFrom=_props.usersFrom,teamsOnly=_props.teamsOnly,getMessage=(_props.disableSearch,function(id){return _this.props.getMessage(id,"")}),authConfigs=pydio.getPluginConfigs("core.auth"),root=void 0;if(teamsOnly)return root={id:"teams",label:getMessage(568),childrenLoader:_Loaders2.default.loadTeams,_parent:null,_notSelectable:!0,actions:{type:"teams",create:"+ "+getMessage(569),remove:getMessage(570),multiple:!0}},{root:root,selectedItem:root,loading:!1,rightPaneItem:null};root={id:"root",label:getMessage(592),type:"root",collections:[]},"remote"!==usersFrom&&(authConfigs.get("USER_CREATE_USERS")&&root.collections.push({id:"ext",label:getMessage(593),icon:"mdi mdi-account-network",itemsLoader:_Loaders2.default.loadExternalUsers,_parent:root,_notSelectable:!0,actions:{type:"users",create:"+ "+getMessage(484),remove:getMessage(582),multiple:!0}}),usersOnly||root.collections.push({id:"teams",label:getMessage(568),icon:"mdi mdi-account-multiple",childrenLoader:_Loaders2.default.loadTeams,_parent:root,_notSelectable:!0,actions:{type:"teams",create:"+ "+getMessage(569),remove:getMessage(570),multiple:!0}}),root.collections.push({id:"PYDIO_GRP_/",label:getMessage(584),icon:"mdi mdi-account-box",childrenLoader:_Loaders2.default.loadGroups,itemsLoader:_Loaders2.default.loadGroupUsers,_parent:root,_notSelectable:!0}));var ocsRemotes=pydio.getPluginConfigs("core.ocs").get("TRUSTED_SERVERS");if(ocsRemotes&&!usersOnly&&"local"!==usersFrom){var remotes=JSON.parse(ocsRemotes),remotesNodes={id:"remotes",label:getMessage(594),collections:[],_parent:root,_notSelectable:!0};for(var k in remotes)remotes.hasOwnProperty(k)&&remotesNodes.collections.push({id:k,label:remotes[k],icon:"mdi mdi-server-network",type:"remote",_parent:remotesNodes,_notSelectable:!0});remotesNodes.collections.length&&root.collections.push(remotesNodes)}return{root:root,selectedItem:"selector"===mode?root:root.collections[0],loading:!1,rightPaneItem:null}},componentDidMount:function(){this.state.selectedItem&&this.onFolderClicked(this.state.selectedItem)},onFolderClicked:function(item){var _this2=this,callback=arguments.length<=1||void 0===arguments[1]?void 0:arguments[1];if("selector"===this.props.mode&&item.IdmRole&&item.IdmRole.IsTeam)return void this.onUserListItemClicked(item);this.setState({loading:!0}),_Loaders2.default.childrenAsPromise(item,!1).then(function(children){_Loaders2.default.childrenAsPromise(item,!0).then(function(children){_this2.setState({selectedItem:item,loading:!1},callback)})})},onUserListItemClicked:function(item){if(this.props.onItemSelected){var uObject=new PydioUsers.User(item.id,item.label,item.type,item.group,item.avatar,item.temporary,item.external);item.trusted_server_id&&(uObject.trustedServerId=item.trusted_server_id,uObject.trustedServerLabel=item.trusted_server_label),uObject._uuid=item.uuid,item.IdmUser&&(uObject.IdmUser=item.IdmUser),item.IdmRole&&(uObject.IdmRole=item.IdmRole),this.props.onItemSelected(uObject)}else this.setState({rightPaneItem:item})},onCreateAction:function(item){this.setState({createDialogItem:item})},closeCreateDialogAndReload:function(){this.setState({createDialogItem:null}),this.reloadCurrentNode()},onCardUpdateAction:function(item){item._parent&&item._parent===this.state.selectedItem&&this.reloadCurrentNode()},onDeleteAction:function(parentItem,selection){var _this3=this;if(!(arguments.length<=2||void 0===arguments[2])&&arguments[2]||confirm(this.props.getMessage(278)))switch(parentItem.actions.type){case"users":Promise.all(selection.map(function(user){return _this3.state.rightPaneItem===user&&_this3.setState({rightPaneItem:null}),_pydioHttpApi2.default.getRestClient().getIdmApi().deleteIdmUser(user.IdmUser)})).then(function(){_this3.reloadCurrentNode()});break;case"teams":Promise.all(selection.map(function(team){return _this3.state.rightPaneItem===team&&_this3.setState({rightPaneItem:null}),_pydioHttpApi2.default.getRestClient().getIdmApi().deleteRole(team.IdmRole.Uuid)})).then(function(){_this3.reloadCurrentNode()});break;case"team":Promise.all(selection.map(function(user){return _pydioHttpApi2.default.getRestClient().getIdmApi().removeUserFromTeam(parentItem.IdmRole.Uuid,user.IdmUser.Login)})).then(function(){_this3.reloadCurrentNode()})}},openPopover:function(event){this.setState({popoverOpen:!0,popoverAnchor:event.currentTarget})},closePopover:function(){this.setState({popoverOpen:!1})},reloadCurrentNode:function(){var _this4=this;this.state.selectedItem.leafLoaded=!1,this.state.selectedItem.collectionsLoaded=!1,this.onFolderClicked(this.state.selectedItem,function(){_this4.state.rightPaneItem&&function(){var rPaneId=_this4.state.rightPaneItem.id,foundItem=null;[].concat(_this4.state.selectedItem.leafs||[],_this4.state.selectedItem.collections||[]).forEach(function(leaf){leaf.id===rPaneId&&(foundItem=leaf)}),_this4.setState({rightPaneItem:foundItem})}()})},reloadCurrentAtPage:function(letterOrRange){this.state.selectedItem.leafLoaded=!1,this.state.selectedItem.collectionsLoaded=!1,-1===letterOrRange?this.state.selectedItem.currentParams=null:-1!==letterOrRange.indexOf("-")?this.state.selectedItem.range=letterOrRange:(this.state.selectedItem.range=null,this.state.selectedItem.currentParams={alpha_pages:"true",value:letterOrRange}),this.onFolderClicked(this.state.selectedItem)},reloadCurrentWithSearch:function(value){if(!value)return void this.reloadCurrentAtPage(-1);this.state.selectedItem.leafLoaded=!1,this.state.selectedItem.collectionsLoaded=!1,this.state.selectedItem.currentParams={has_search:!0,value:value,existing_only:!0},this.onFolderClicked(this.state.selectedItem)},render:function(){var _this5=this,_props2=this.props,mode=_props2.mode,getMessage=_props2.getMessage,bookColumn=_props2.bookColumn;if("popover"===mode){var popoverStyle=this.props.popoverStyle||{},popoverContainerStyle=this.props.popoverContainerStyle||{},iconButtonStyle=this.props.popoverIconButtonStyle||{},iconButton=_react2.default.createElement(_materialUi.IconButton,{style:_extends({position:"absolute",padding:15,zIndex:100,right:0,top:25,display:this.state.loading?"none":"initial"},iconButtonStyle),iconStyle:{fontSize:19,color:"rgba(0,0,0,0.6)"},iconClassName:"mdi mdi-book-open-variant",onTouchTap:this.openPopover});return this.props.popoverButton&&(iconButton=_react2.default.createElement(this.props.popoverButton.type,_extends({},this.props.popoverButton.props,{onTouchTap:this.openPopover}))),_react2.default.createElement("span",null,iconButton,_react2.default.createElement(_materialUi.Popover,{open:this.state.popoverOpen,anchorEl:this.state.popoverAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"left",vertical:"top"},onRequestClose:this.closePopover,style:_extends({marginLeft:20},popoverStyle),zDepth:2},_react2.default.createElement("div",{style:_extends({width:320,height:420},popoverContainerStyle)},_react2.default.createElement(AddressBook,_extends({},this.props,{mode:"selector"})))))}var _state=this.state,selectedItem=_state.selectedItem,root=_state.root,rightPaneItem=_state.rightPaneItem,createDialogItem=_state.createDialogItem,leftColumnStyle={backgroundColor:_materialUiStyles.colors.grey100,width:256,overflowY:"auto",overflowX:"hidden"},centerComponent=void 0,rightPanel=void 0,leftPanel=void 0,topActionsPanel=void 0,onEditLabel=void 0;if("search"===selectedItem.id)centerComponent=_react2.default.createElement(_SearchPanel2.default,{item:selectedItem,title:getMessage(583,""),searchLabel:getMessage(595,""),onItemClicked:this.onUserListItemClicked,onFolderClicked:this.onFolderClicked,mode:mode});else if("remote"===selectedItem.type)centerComponent=_react2.default.createElement(_SearchPanel2.default,{item:selectedItem,params:{trusted_server_id:selectedItem.id},searchLabel:getMessage(595,""),title:getMessage(596,"").replace("%s",selectedItem.label),onItemClicked:this.onUserListItemClicked,onFolderClicked:this.onFolderClicked,mode:mode});else{var emptyStatePrimary=void 0,emptyStateSecondary=void 0,otherProps={};"teams"===selectedItem.id?(emptyStatePrimary=getMessage(571,""),emptyStateSecondary=getMessage(572,"")):"ext"===selectedItem.id?(emptyStatePrimary=getMessage(585,""),emptyStateSecondary=getMessage(586,"")):(selectedItem.IdmUser&&selectedItem.IdmUser.IsGroup||"PYDIO_GRP_/"===selectedItem.id)&&(otherProps={showSubheaders:!0,paginatorType:!(selectedItem.currentParams&&selectedItem.currentParams.has_search)&&"alpha",paginatorCallback:this.reloadCurrentAtPage.bind(this),enableSearch:!this.props.disableSearch,searchLabel:getMessage(595,""),onSearch:this.reloadCurrentWithSearch.bind(this)}),("book"===mode||bookColumn)&&selectedItem.IdmRole&&selectedItem.IdmRole.IsTeam&&(topActionsPanel=_react2.default.createElement(_avatarActionsPanel2.default,_extends({},this.props,{team:selectedItem,userEditable:!0,reloadAction:function(){_this5.reloadCurrentNode()},onDeleteAction:function(){confirm(_this5.props.getMessage(278))&&function(){var parent=selectedItem._parent;_this5.setState({selectedItem:parent},function(){_this5.onDeleteAction(parent,[selectedItem],!0)})}()},style:{backgroundColor:"transparent",borderTop:0,borderBottom:0}})),onEditLabel=function(item,newLabel){_pydioHttpApi2.default.getRestClient().getIdmApi().updateTeamLabel(item.IdmRole.Uuid,newLabel,function(){var parent=selectedItem._parent;_this5.setState({selectedItem:parent},function(){_this5.reloadCurrentNode()})})}),centerComponent=_react2.default.createElement(_UsersList2.default,_extends({item:selectedItem,onItemClicked:this.onUserListItemClicked,onFolderClicked:this.onFolderClicked,onCreateAction:this.onCreateAction,onDeleteAction:this.onDeleteAction,reloadAction:this.reloadCurrentNode.bind(this),onEditLabel:onEditLabel,loading:this.state.loading,mode:mode,bookColumn:bookColumn,emptyStatePrimaryText:emptyStatePrimary,emptyStateSecondaryText:emptyStateSecondary,onTouchTap:this.state.rightPaneItem?function(){_this5.setState({rightPaneItem:null})}:null,actionsPanel:topActionsPanel,actionsForCell:this.props.actionsForCell},otherProps))}var rightPanelStyle=_extends({},leftColumnStyle,{position:"absolute",transformOrigin:"right",backgroundColor:"white",right:8,bottom:8,top:120,zIndex:2});rightPaneItem||(rightPanelStyle=_extends({},rightPanelStyle,{transform:"scale(0)"})),rightPanel=_react2.default.createElement(_RightPanelCard2.default,{pydio:this.props.pydio,onRequestClose:function(){_this5.setState({rightPaneItem:null})},style:rightPanelStyle,onCreateAction:this.onCreateAction,onDeleteAction:this.onDeleteAction,onUpdateAction:this.onCardUpdateAction,item:rightPaneItem}),"book"===mode&&function(){var nestedRoots=[];root.collections.map(function(e){nestedRoots.push(_react2.default.createElement(_NestedListItem2.default,{key:e.id,selected:selectedItem.id,nestedLevel:0,entry:e,onTouchTap:this.onFolderClicked})),nestedRoots.push(_react2.default.createElement(_materialUi.Divider,{
key:e.id+"-divider"}))}.bind(_this5)),nestedRoots.pop(),leftPanel=_react2.default.createElement(MaterialUI.Paper,{zDepth:1,style:_extends({},leftColumnStyle,{zIndex:2})},_react2.default.createElement(MaterialUI.List,null,nestedRoots))}();var dialogTitle=void 0,dialogContent=void 0;if(createDialogItem)if("users"===createDialogItem.actions.type)dialogTitle=getMessage(484,""),dialogContent=_react2.default.createElement("div",{style:{height:500}},_react2.default.createElement(_UserCreationForm2.default,{zDepth:0,style:{height:500},newUserName:"",onUserCreated:this.closeCreateDialogAndReload.bind(this),onCancel:function(){_this5.setState({createDialogItem:null})},pydio:this.props.pydio}));else if("teams"===createDialogItem.actions.type)dialogTitle=getMessage(569,""),dialogContent=_react2.default.createElement(_TeamCreationForm2.default,{onTeamCreated:this.closeCreateDialogAndReload,onCancel:function(){_this5.setState({createDialogItem:null})}});else if("team"===createDialogItem.actions.type){var selectUser=function(item){_pydioHttpApi2.default.getRestClient().getIdmApi().addUserToTeam(createDialogItem.IdmRole.Uuid,item.IdmUser.Login).then(function(){_this5.reloadCurrentNode()})};dialogTitle=null,dialogContent=_react2.default.createElement(AddressBook,{pydio:this.props.pydio,mode:"selector",usersOnly:!0,disableSearch:!0,onItemSelected:selectUser})}var style=this.props.style||{};return _react2.default.createElement("div",{style:_extends({display:"flex",height:"selector"===mode?420:450},style)},leftPanel,centerComponent,rightPanel,_react2.default.createElement(MaterialUI.Dialog,{contentStyle:{width:380,minWidth:380,maxWidth:380,padding:0},bodyStyle:{padding:0},title:_react2.default.createElement("div",{style:{padding:20}},dialogTitle),actions:null,modal:!1,open:!!createDialogItem,onRequestClose:function(){_this5.setState({createDialogItem:null})}},dialogContent))}});exports.default=AddressBook=PydioContextConsumer(AddressBook),exports.default=AddressBook=_materialUiStyles.muiThemeable()(AddressBook),exports.default=AddressBook,module.exports=exports.default},{"../TeamCreationForm":41,"../UserCreationForm":42,"../avatar/ActionsPanel":54,"./Loaders":46,"./NestedListItem":47,"./RightPanelCard":48,"./SearchPanel":50,"./UsersList":53,"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],45:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_materialUiStyles=require("material-ui/styles"),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_materialUi=require("material-ui"),_Pydio$requireLib=_pydio2.default.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,AlphaPaginator=function(_Component){_inherits(AlphaPaginator,_Component);function AlphaPaginator(){_classCallCheck(this,AlphaPaginator),_Component.apply(this,arguments)}return AlphaPaginator.prototype.render=function(){var letters="abcdefghijklmnopqrstuvwxyz0123456789".split("");letters=[-1].concat(letters);var _props=this.props,item=_props.item,paginatorCallback=_props.paginatorCallback,style=_props.style,getMessage=_props.getMessage,paginator=void 0;item.pagination&&function(){for(var _item$pagination=item.pagination,start=_item$pagination.start,max=(_item$pagination.end,_item$pagination.max),interval=_item$pagination.interval,total_pages=Math.ceil(max/interval),current=Math.ceil(start/interval),pages=[],i=0;i<total_pages;i++)pages.push(i);paginator=React.createElement(_materialUi.SelectField,{floatingLabelText:getMessage(331),style:{width:60},fullWidth:!0,value:current,onChange:function(e,i,v){paginatorCallback(v*interval+"-"+(v+1)*interval)}},pages.map(function(p){return React.createElement(_materialUi.MenuItem,{value:p,key:p,primaryText:p+1})}))}();var currentPage=item.currentParams&&item.currentParams.alpha_pages&&item.currentParams.value||-1;return React.createElement("div",{style:_extends({},style,{display:"flex",paddingRight:8,alignItems:"center"})},React.createElement("div",{style:{flex:1}},getMessage(249,"")),paginator,React.createElement(_materialUi.SelectField,{floatingLabelText:getMessage(625),style:{width:60,marginLeft:20},fullWidth:!0,value:currentPage,onChange:function(e,i,v){paginatorCallback(v)}},letters.map(function(l){return React.createElement(_materialUi.MenuItem,{value:l,key:l,primaryText:-1===l?getMessage(597,""):l})})))},AlphaPaginator}(_react.Component);AlphaPaginator.propTypes={item:_react.PropTypes.object,paginatorCallback:_react.PropTypes.func.isRequired,pydio:_react.PropTypes.instanceOf(_pydio2.default),mode:_react.PropTypes.oneOf(["book","selector","popover"]).isRequired},exports.default=AlphaPaginator=PydioContextConsumer(AlphaPaginator),exports.default=AlphaPaginator=_materialUiStyles.muiThemeable()(AlphaPaginator),exports.default=AlphaPaginator,module.exports=exports.default},{"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],46:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_pydioUtilLang=require("pydio/util/lang"),_pydioUtilLang2=_interopRequireDefault(_pydioUtilLang),IdmApi=_pydioHttpApi2.default.getRestClient().getIdmApi(),Loaders=function(){function Loaders(){_classCallCheck(this,Loaders)}return Loaders.childrenAsPromise=function(item){var leaf=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],childrenLoader=item.childrenLoader,itemsLoader=item.itemsLoader,leafLoaded=item.leafLoaded,collectionsLoaded=item.collectionsLoaded,leafs=item.leafs,collections=item.collections,loader=leaf?itemsLoader:childrenLoader,loaded=leaf?leafLoaded:collectionsLoaded;return new Promise(function(resolve,reject){if(!loaded&&loader)loader(item,function(newChildren){leaf?(item.leafs=newChildren,item.leafLoaded=!0):(item.collections=newChildren,item.collectionsLoaded=!0),resolve(newChildren)});else{resolve((leaf?leafs:collections)||[])}})},Loaders.computePagination=function(result){var count=void 0;return result.Users?count=result.Users.length:result.Groups?count=result.Groups.length:result.Teams&&(count=result.Teams.length),result.Total>count?{start:result.Offset,end:result.Offset+result.Limit,max:result.Total,interval:result.Limit}:null},Loaders.loadTeams=function(entry,callback){var offset=0,limit=50;if(entry.range){var _entry$range$split=entry.range.split("-"),start=_entry$range$split[0],end=_entry$range$split[1];offset=parseInt(start),end=parseInt(end),limit=end-offset}IdmApi.listTeams("",offset,limit).then(function(collection){entry.pagination=Loaders.computePagination(collection);var items=collection.Teams.map(function(team){return{_parent:entry,id:team.Uuid,label:team.Label,type:"team",icon:"mdi mdi-account-multiple-outline",itemsLoader:Loaders.loadTeamUsers,actions:{type:"team",remove:"574",multiple:!0},_notSelectable:!0,IdmRole:team}});callback(items)})},Loaders.loadGroups=function(entry,callback){var path="/",filter="";entry.IdmUser&&(path=_pydioUtilLang2.default.trimRight(entry.IdmUser.GroupPath,"/")+"/"+entry.IdmUser.GroupLabel),entry.currentParams&&entry.currentParams.has_search&&(filter=entry.currentParams.value),IdmApi.listGroups(path,filter,!1,0,1e3).then(function(groups){var items=groups.Groups.map(function(idmUser){return{_parent:entry,id:idmUser.Uuid,label:idmUser.GroupLabel,type:"group",icon:"mdi mdi-account-multiple",childrenLoader:entry.childrenLoader?Loaders.loadGroups:null,itemsLoader:entry.itemsLoader?Loaders.loadGroupUsers:null,currentParams:entry.currentParams&&entry.currentParams.alpha_pages?_extends({},entry.currentParams):{},IdmUser:idmUser}});callback(items)})},Loaders.loadExternalUsers=function(entry,callback){var filter="",offset=0,limit=50;if(entry.currentParams&&entry.currentParams.alpha_pages&&(filter=entry.currentParams.value),entry.range){var _entry$range$split2=entry.range.split("-"),start=_entry$range$split2[0],end=_entry$range$split2[1];offset=parseInt(start),end=parseInt(end),limit=end-offset}var pydio=_pydioHttpApi2.default.getClient().getPydioObject();IdmApi.listUsers("/",filter,!0,offset,limit,"shared").then(function(users){entry.pagination=Loaders.computePagination(users);var items=users.Users.filter(function(idmUser){return idmUser.Login!==pydio.user.id}).map(function(idmUser){return{_parent:entry,id:idmUser.Login,label:idmUser.Attributes&&idmUser.Attributes.displayName?idmUser.Attributes.displayName:idmUser.Login,avatar:idmUser.Attributes&&idmUser.Attributes.avatar?idmUser.Attributes.avatar:void 0,type:"user",external:!0,IdmUser:idmUser}});callback(items)})},Loaders.loadGroupUsers=function(entry,callback){var path="/",filter="",offset=0,limit=50;if(entry.IdmUser&&(path=_pydioUtilLang2.default.trimRight(entry.IdmUser.GroupPath,"/")+"/"+entry.IdmUser.GroupLabel),entry.currentParams&&(entry.currentParams.alpha_pages||entry.currentParams.has_search)&&(filter=entry.currentParams.value),entry.range){var _entry$range$split3=entry.range.split("-"),start=_entry$range$split3[0],end=_entry$range$split3[1];offset=parseInt(start),end=parseInt(end),limit=end-offset}var pydio=_pydioHttpApi2.default.getClient().getPydioObject();IdmApi.listUsers(path,filter,!1,offset,limit,"!shared").then(function(users){entry.pagination=Loaders.computePagination(users);var items=users.Users.filter(function(idmUser){return idmUser.Login!==pydio.user.id}).map(function(idmUser){return{_parent:entry,id:idmUser.Login,label:idmUser.Attributes&&idmUser.Attributes.displayName?idmUser.Attributes.displayName:idmUser.Login,avatar:idmUser.Attributes&&idmUser.Attributes.avatar?idmUser.Attributes.avatar:void 0,type:"user",IdmUser:idmUser}});callback(items)})},Loaders.loadTeamUsers=function(entry,callback){var offset=0,limit=50;if(entry.range){var _entry$range$split4=entry.range.split("-"),start=_entry$range$split4[0],end=_entry$range$split4[1];offset=parseInt(start),end=parseInt(end),limit=end-offset}IdmApi.listUsersWithRole(entry.IdmRole.Uuid,offset,limit).then(function(users){entry.pagination=Loaders.computePagination(users);var items=users.Users.map(function(idmUser){return{_parent:entry,id:idmUser.Login,label:idmUser.Attributes&&idmUser.Attributes.displayName?idmUser.Attributes.displayName:idmUser.Login,type:"user",IdmUser:idmUser}});callback(items)})},Loaders}();exports.default=Loaders,module.exports=exports.default},{"pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang"}],47:[function(require,module,exports){"use strict";exports.__esModule=!0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_materialUi=require("material-ui"),NestedListItem=function(_Component){_inherits(NestedListItem,_Component);function NestedListItem(){_classCallCheck(this,NestedListItem),_Component.apply(this,arguments)}return NestedListItem.prototype.onTouchTap=function(){this.props.onTouchTap(this.props.entry)},NestedListItem.prototype.buildNestedItems=function(data){return data.map(function(entry){return React.createElement(NestedListItem,{nestedLevel:this.props.nestedLevel+1,entry:entry,onTouchTap:this.props.onTouchTap,selected:this.props.selected,showIcons:!0})}.bind(this))},NestedListItem.prototype.render=function(){var _props=this.props,showIcons=_props.showIcons,entry=_props.entry,selected=_props.selected,id=entry.id,label=entry.label,icon=entry.icon,children=entry.collections||[],nested=this.buildNestedItems(children),fontIcon=void 0;return icon&&showIcons&&(fontIcon=React.createElement(_materialUi.FontIcon,{className:icon})),React.createElement(_materialUi.ListItem,{nestedLevel:this.props.nestedLevel,key:id,primaryText:label,onTouchTap:this.onTouchTap.bind(this),nestedItems:nested,initiallyOpen:!0,leftIcon:fontIcon,innerDivStyle:{fontWeight:selected===entry.id?500:400},style:selected===entry.id?{backgroundColor:"#efefef"}:{}})},NestedListItem}(_react.Component);NestedListItem.propTypes={nestedLevel:_react.PropTypes.number,selected:_react.PropTypes.string,onTouchTap:_react.PropTypes.func},exports.default=NestedListItem,module.exports=exports.default},{"material-ui":"material-ui",react:"react"}],48:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _TeamCard=require("./TeamCard"),_TeamCard2=_interopRequireDefault(_TeamCard),_UserCard=require("./UserCard"),_UserCard2=_interopRequireDefault(_UserCard),React=require("react"),_require=require("material-ui"),Paper=_require.Paper,IconButton=_require.IconButton,RightPanelCard=function(_React$Component){_inherits(RightPanelCard,_React$Component);function RightPanelCard(){_classCallCheck(this,RightPanelCard),_React$Component.apply(this,arguments)}return RightPanelCard.prototype.render=function(){var content=void 0,item=this.props.item||{};return"user"===item.type?content=React.createElement(_UserCard2.default,this.props):item.IdmRole&&item.IdmRole.IsTeam&&(content=React.createElement(_TeamCard2.default,this.props)),React.createElement(Paper,{zDepth:2,style:_extends({position:"relative"},this.props.style)},React.createElement(IconButton,{iconClassName:"mdi mdi-close",style:{position:"absolute",top:0,right:0},iconStyle:{color:"#e0e0e0"},onTouchTap:this.props.onRequestClose}),content)},RightPanelCard}(React.Component);RightPanelCard.propTypes={pydio:React.PropTypes.instanceOf(Pydio),item:React.PropTypes.object,style:React.PropTypes.object,onRequestClose:React.PropTypes.func,onDeleteAction:React.PropTypes.func,onUpdateAction:React.PropTypes.func},exports.default=RightPanelCard,module.exports=exports.default},{"./TeamCard":51,"./UserCard":52,"material-ui":"material-ui",react:"react"}],49:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_materialUi=require("material-ui"),_lodashDebounce=require("lodash.debounce"),_lodashDebounce2=_interopRequireDefault(_lodashDebounce),SearchForm=function(_Component){_inherits(SearchForm,_Component);function SearchForm(props,context){_classCallCheck(this,SearchForm),_Component.call(this,props,context),this.state={value:""},this.search=_lodashDebounce2.default(this.search.bind(this),300)}return SearchForm.prototype.search=function(){this.props.onSearch(this.state.value)},SearchForm.prototype.onChange=function(event,value){this.setState({value:value}),this.search()},SearchForm.prototype.render=function(){var _props=this.props,underlineShow=_props.underlineShow,searchLabel=_props.searchLabel,style=_props.style,value=this.state.value;return React.createElement("div",{style:_extends({minWidth:320},style)},React.createElement(_materialUi.TextField,{fullWidth:!0,value:value,onChange:this.onChange.bind(this),hintText:searchLabel,underlineShow:void 0===underlineShow||underlineShow}))},SearchForm}(_react.Component);SearchForm.propTypes={searchLabel:_react.PropTypes.string.isRequired,onSearch:_react.PropTypes.func.isRequired,style:_react.PropTypes.object,underlineShow:_react.PropTypes.bool},exports.default=SearchForm,module.exports=exports.default},{"lodash.debounce":"lodash.debounce","material-ui":"material-ui",react:"react"}],50:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _SearchForm=require("./SearchForm"),_SearchForm2=_interopRequireDefault(_SearchForm),_UsersList=require("./UsersList"),_UsersList2=_interopRequireDefault(_UsersList),_Loaders=require("./Loaders"),_Loaders2=_interopRequireDefault(_Loaders),_require=require("react"),Component=_require.Component,PropTypes=_require.PropTypes,_require$requireLib=require("pydio").requireLib("boot"),PydioContextConsumer=_require$requireLib.PydioContextConsumer,SearchPanel=function(_Component){_inherits(SearchPanel,_Component);function SearchPanel(props,context){_classCallCheck(this,SearchPanel),_Component.call(this,props.context),this.state={items:[]}}return SearchPanel.prototype.onSearch=function(value){var _this=this;if(!value)return void this.setState({items:[]});var params={value:value,existing_only:"true"};this.props.params&&(params=_extends({},params,this.props.params)),_Loaders2.default.listUsers(params,function(children){_this.setState({items:children})})},SearchPanel.prototype.render=function(){var _this2=this,_props=this.props,mode=_props.mode,item=_props.item,getMessage=_props.getMessage;return React.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column"}},React.createElement("div",{style:{padding:10,height:56,backgroundColor:this.state.select?activeTbarColor:"#fafafa",display:"flex",alignItems:"center",transition:DOMUtils.getBeziersTransition()}},"selector"===mode&&item._parent&&React.createElement(MaterialUI.IconButton,{iconClassName:"mdi mdi-chevron-left",onTouchTap:function(){_this2.props.onFolderClicked(item._parent)}}),"book"===mode&&React.createElement("div",{style:{fontSize:20,color:"rgba(0,0,0,0.87)",flex:1}},this.props.title),React.createElement(_SearchForm2.default,{style:"book"===mode?{minWidth:320}:{flex:1},searchLabel:this.props.searchLabel,onSearch:this.onSearch.bind(this)})),React.createElement(_UsersList2.default,{mode:this.props.mode,onItemClicked:this.props.onItemClicked,item:{leafs:this.state.items},noToolbar:!0,emptyStatePrimaryText:getMessage(587,""),emptyStateSecondaryText:getMessage(588,"")}))},SearchPanel}(Component);SearchPanel.propTypes={params:PropTypes.object,searchLabel:PropTypes.string,onItemClicked:PropTypes.func,item:PropTypes.object,onFolderClicked:PropTypes.func},exports.default=SearchPanel=PydioContextConsumer(SearchPanel),exports.default=SearchPanel,module.exports=exports.default},{"./Loaders":46,"./SearchForm":49,"./UsersList":53,pydio:"pydio",react:"react"}],51:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _UsersList=require("./UsersList"),_UsersList2=_interopRequireDefault(_UsersList),_Loaders=require("./Loaders"),_Loaders2=_interopRequireDefault(_Loaders),_avatarActionsPanel=require("../avatar/ActionsPanel"),_avatarActionsPanel2=_interopRequireDefault(_avatarActionsPanel),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),React=require("react"),_require=require("material-ui"),TextField=_require.TextField,FlatButton=_require.FlatButton,CardTitle=_require.CardTitle,Divider=_require.Divider,_require$requireLib=require("pydio").requireLib("boot"),PydioContextConsumer=_require$requireLib.PydioContextConsumer,TeamCard=function(_React$Component){_inherits(TeamCard,_React$Component);function TeamCard(props,context){_classCallCheck(this,TeamCard),_React$Component.call(this,props,context),this.state={label:this.props.item.label}}return TeamCard.prototype.loadMembers=function(item){var _this=this;this.setState({loading:!0}),_Loaders2.default.childrenAsPromise(item,!1).then(function(children){_Loaders2.default.childrenAsPromise(item,!0).then(function(children){_this.setState({members:item.leafs,loading:!1})})})},TeamCard.prototype.componentWillMount=function(){this.loadMembers(this.props.item)},TeamCard.prototype.componentWillReceiveProps=function(nextProps){this.loadMembers(nextProps.item),this.setState({label:nextProps.item.label})},TeamCard.prototype.onLabelChange=function(e,value){this.setState({label:value})},TeamCard.prototype.updateLabel=function(){var _this2=this;this.state.label!==this.props.item.label&&_pydioHttpApi2.default.getRestClient().getIdmApi().updateTeamLabel(this.props.item.IdmRole.Uuid,this.state.label,function(){_this2.props.onUpdateAction(_this2.props.item)}),this.setState({editMode:!1})},TeamCard.prototype.render=function(){var _this3=this,_props=this.props,item=_props.item,onDeleteAction=_props.onDeleteAction,getMessage=(_props.onCreateAction,_props.getMessage),editProps={team:item,userEditable:this.props.item.IdmRole.PoliciesContextEditable,onDeleteAction:function(){_this3.props.onDeleteAction(item._parent,[item])},onEditAction:function(){_this3.setState({editMode:!_this3.state.editMode})},reloadAction:function(){_this3.props.onUpdateAction(item)}},title=void 0;title=this.state.editMode?React.createElement("div",{style:{display:"flex",alignItems:"center",margin:16}},React.createElement(TextField,{style:{flex:1,fontSize:24},fullWidth:!0,disabled:!1,underlineShow:!1,value:this.state.label,onChange:this.onLabelChange.bind(this)}),React.createElement(FlatButton,{secondary:!0,label:getMessage(48),onTouchTap:function(){_this3.updateLabel()}})):React.createElement(CardTitle,{title:this.state.label,subtitle:item.leafs&&item.leafs.length?getMessage(576).replace("%s",item.leafs.length):getMessage(577)});var _props2=this.props,otherProps=(_props2.style,_objectWithoutProperties(_props2,["style"]));return React.createElement("div",null,title,React.createElement(_avatarActionsPanel2.default,_extends({},otherProps,editProps)),React.createElement(Divider,null),React.createElement(_UsersList2.default,{subHeader:getMessage(575),onItemClicked:function(){},item:item,mode:"inner",onDeleteAction:onDeleteAction}))},TeamCard}(React.Component);TeamCard.propTypes={pydio:React.PropTypes.instanceOf(Pydio),item:React.PropTypes.object,style:React.PropTypes.object,onRequestClose:React.PropTypes.func,onDeleteAction:React.PropTypes.func,onUpdateAction:React.PropTypes.func},exports.default=TeamCard=PydioContextConsumer(TeamCard),exports.default=TeamCard,module.exports=exports.default},{"../avatar/ActionsPanel":54,"./Loaders":46,"./UsersList":53,"material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],52:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_react2=_interopRequireDefault(_react),_avatarUserAvatar=require("../avatar/UserAvatar"),_avatarUserAvatar2=_interopRequireDefault(_avatarUserAvatar),_UserCreationForm=require("../UserCreationForm"),_UserCreationForm2=_interopRequireDefault(_UserCreationForm),UserCard=function(_React$Component){_inherits(UserCard,_React$Component);function UserCard(props,context){_classCallCheck(this,UserCard),_React$Component.call(this,props,context),this.state={editForm:!1}}return UserCard.prototype.componentWillReceiveProps=function(nextProps){nextProps.item!==this.props.item&&this.setState({editForm:!1})},UserCard.prototype.render=function(){var _this=this,item=this.props.item,editableProps={},editForm=void 0;return item._parent&&"ext"===item._parent.id&&(editableProps={userEditable:item.IdmUser.PoliciesContextEditable,onDeleteAction:function(){_this.props.onDeleteAction(item._parent,[item])},onEditAction:function(){_this.setState({editForm:!0})},reloadAction:function(){_this.props.onUpdateAction(item)}}),this.state.editForm&&(editForm=_react2.default.createElement(_UserCreationForm2.default,{pydio:this.props.pydio,zDepth:0,style:{flex:1},newUserName:item.id,editMode:!0,userData:item,onUserCreated:function(){_this.props.onUpdateAction(item),_this.setState({editForm:!1})},onCancel:function(){_this.setState({editForm:!1})}}),editableProps=_extends({},editableProps,{displayLabel:!0,displayAvatar:!0,useDefaultAvatar:!0,style:{textAlign:"center",borderBottom:"1px solid #e0e0e0",padding:10,backgroundColor:"#fafafa"},avatarStyle:{marginBottom:16}})),_react2.default.createElement("div",{style:editForm?{height:"100%",display:"flex",flexDirection:"column"}:{}},_react2.default.createElement(_avatarUserAvatar2.default,_extends({userId:this.props.item.id,richCard:!editForm,pydio:this.props.pydio,cardSize:this.props.style.width},editableProps)),editForm)},UserCard}(_react2.default.Component);UserCard.propTypes={pydio:_react2.default.PropTypes.instanceOf(Pydio),item:_react2.default.PropTypes.object,style:_react2.default.PropTypes.object,onRequestClose:_react2.default.PropTypes.func,onDeleteAction:_react2.default.PropTypes.func,onUpdateAction:_react2.default.PropTypes.func},exports.default=UserCard,module.exports=exports.default},{"../UserCreationForm":42,"../avatar/UserAvatar":57,react:"react"}],53:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}
var _react=require("react"),_react2=_interopRequireDefault(_react),_avatarUserAvatar=require("../avatar/UserAvatar"),_avatarUserAvatar2=_interopRequireDefault(_avatarUserAvatar),_materialUi=require("material-ui"),_materialUiStyles=require("material-ui/styles"),_viewsEmptyStateView=require("../../views/EmptyStateView"),_viewsEmptyStateView2=_interopRequireDefault(_viewsEmptyStateView),_AlphaPaginator=require("./AlphaPaginator"),_AlphaPaginator2=_interopRequireDefault(_AlphaPaginator),_SearchForm=require("./SearchForm"),_SearchForm2=_interopRequireDefault(_SearchForm),_pydioUtilDom=require("pydio/util/dom"),_pydioUtilDom2=_interopRequireDefault(_pydioUtilDom),_avatarCellActionsRenderer=require("../avatar/CellActionsRenderer"),_avatarCellActionsRenderer2=_interopRequireDefault(_avatarCellActionsRenderer),_require$requireLib=require("pydio").requireLib("boot"),Loader=_require$requireLib.Loader,PydioContextConsumer=_require$requireLib.PydioContextConsumer,UsersList=function(_React$Component){_inherits(UsersList,_React$Component);function UsersList(props,context){_classCallCheck(this,UsersList),_React$Component.call(this,props,context),this.state={select:!1,selection:[],editLabel:!1}}return UsersList.prototype.onLabelKeyEnter=function(e){"Enter"===e.key&&this.updateLabel()},UsersList.prototype.onLabelChange=function(e,value){this.setState({label:value})},UsersList.prototype.updateLabel=function(){this.state.label!==this.props.item.label&&this.props.onEditLabel(this.props.item,this.state.label),this.setState({editLabel:!1})},UsersList.prototype.render=function(){var _this=this,_props=this.props,item=_props.item,mode=_props.mode,paginatorType=_props.paginatorType,loading=_props.loading,enableSearch=_props.enableSearch,showSubheaders=_props.showSubheaders,getMessage=_props.getMessage,actionsPanel=_props.actionsPanel,muiTheme=_props.muiTheme,bookColumn=_props.bookColumn,pydio=_props.pydio,reloadAction=_props.reloadAction,folders=item.collections||[],leafs=item.leafs||[],foldersSubHeader=folders.length&&(leafs.length||showSubheaders)?[{subheader:getMessage("532")}]:[],usersSubHeader=[];(showSubheaders||paginatorType)&&(usersSubHeader=[{subheader:paginatorType?_react2.default.createElement(_AlphaPaginator2.default,_extends({},this.props,{style:{lineHeight:"20px",padding:"14px 0"}})):getMessage("249")}]);var items=[].concat(foldersSubHeader,folders,usersSubHeader,leafs),total=items.length,elements=[],toggleSelect=function(){_this.setState({select:!_this.state.select,selection:[]})},createAction=function(){_this.props.onCreateAction(item)},deleteAction=function(){_this.props.onDeleteAction(item,_this.state.selection),_this.setState({select:!1,selection:[]})},accentColor=muiTheme.palette.accent2Color,appBar=muiTheme.appBar,stylesProps={toolbarHeight:"book"===mode?56:48,toolbarBgColor:"book"===mode?this.state.select?accentColor:"#fafafa":appBar.color,titleFontsize:"book"===mode?20:16,titleFontWeight:400,titleColor:"book"===mode?this.state.select?"white":"rgba(0,0,0,0.87)":appBar.textColor,titlePadding:10,button:{border:"1px solid "+accentColor,borderRadius:"50%",margin:"0 4px",width:36,height:36,padding:6},icon:{fontSize:22,color:accentColor}};bookColumn&&(stylesProps.toolbarBgColor="transparent",stylesProps.titleColor="rgba(0,0,0,0.54)",stylesProps.titleFontsize=14,stylesProps.titleFontWeight=500,stylesProps.titlePadding="10px 16px",stylesProps.button.border="0",stylesProps.icon.color=muiTheme.palette.primary1Color);var label=item.label;this.props.onEditLabel&&!this.state.select&&(label=this.state.editLabel?_react2.default.createElement("div",{style:{display:"flex",alignItems:"center",flex:1}},_react2.default.createElement(_materialUi.TextField,{style:{fontSize:20},value:this.state.label,onChange:this.onLabelChange.bind(this),onKeyDown:this.onLabelKeyEnter.bind(this)}),_react2.default.createElement(_materialUi.IconButton,{iconStyle:{color:"#e0e0e0"},secondary:!0,iconClassName:"mdi mdi-content-save",tooltip:getMessage(48),onTouchTap:function(){_this.updateLabel()}})):_react2.default.createElement("div",{style:{display:"flex",alignItems:"center",flex:1}},label,_react2.default.createElement(_materialUi.IconButton,{iconStyle:{color:"#e0e0e0"},iconClassName:"mdi mdi-pencil",tooltip:getMessage(48),onTouchTap:function(){_this.setState({editLabel:!0,label:item.label})}})));var createIcon="mdi mdi-account-plus";item.actions&&"teams"===item.actions.type&&(createIcon="mdi mdi-account-multiple-plus");var toolbar=_react2.default.createElement("div",{style:{padding:stylesProps.titlePadding,height:stylesProps.toolbarHeight,backgroundColor:stylesProps.toolbarBgColor,borderRadius:"2px 2px 0 0",display:"flex",alignItems:"center",transition:_pydioUtilDom2.default.getBeziersTransition()}},"selector"===mode&&item._parent&&_react2.default.createElement(_materialUi.IconButton,{style:{marginLeft:-10},iconClassName:"mdi mdi-chevron-left",onTouchTap:function(){_this.props.onFolderClicked(item._parent)}}),"book"===mode&&total>0&&item.actions&&item.actions.multiple&&_react2.default.createElement(_materialUi.Checkbox,{style:{width:"initial",marginLeft:this.state.select?7:14},checked:this.state.select,onCheck:toggleSelect}),_react2.default.createElement("div",{style:{flex:2,fontSize:stylesProps.titleFontsize,color:stylesProps.titleColor,fontWeight:stylesProps.titleFontWeight}},label),("book"===mode||"selector"===mode&&bookColumn)&&item.actions&&item.actions.create&&!this.state.select&&_react2.default.createElement(_materialUi.IconButton,{style:stylesProps.button,iconStyle:stylesProps.icon,iconClassName:createIcon,tooltipPosition:"bottom-left",tooltip:getMessage(item.actions.create),onTouchTap:createAction}),bookColumn&&!item._parent&&_react2.default.createElement(_materialUi.IconButton,{style:stylesProps.button,iconStyle:stylesProps.icon,iconClassName:"mdi mdi-window-restore",tooltipPosition:"bottom-left",tooltip:pydio.MessageHash[411],onTouchTap:function(){pydio.Controller.fireAction("open_address_book")}}),"book"===mode&&item.actions&&item.actions.remove&&this.state.select&&_react2.default.createElement(_materialUi.RaisedButton,{secondary:!0,label:getMessage(item.actions.remove),disabled:!this.state.selection.length,onTouchTap:deleteAction}),!this.state.select&&actionsPanel,enableSearch&&!bookColumn&&_react2.default.createElement(_SearchForm2.default,{searchLabel:this.props.searchLabel,onSearch:this.props.onSearch,style:{flex:1,minWidth:200}}),reloadAction&&("book"===mode||"selector"===mode&&bookColumn)&&_react2.default.createElement(_materialUi.IconButton,{style:stylesProps.button,iconStyle:stylesProps.icon,iconClassName:"mdi mdi-refresh",tooltipPosition:"bottom-left",tooltip:pydio.MessageHash[149],onTouchTap:reloadAction,disabled:loading}));item._parent&&"book"===mode&&item._parent._parent&&"teams"!==item._parent.id&&(elements.push(_react2.default.createElement(_materialUi.ListItem,{key:"__parent__",primaryText:"..",onTouchTap:function(e){e.stopPropagation(),_this.props.onFolderClicked(item._parent)},leftAvatar:_react2.default.createElement(_materialUi.Avatar,{icon:_react2.default.createElement(_materialUi.FontIcon,{className:"mdi mdi-arrow-up"}),size:36})})),total&&elements.push(_react2.default.createElement(_materialUi.Divider,{inset:!0,key:"parent-divider"}))),items.forEach(function(item,index){var _this2=this;if(item.subheader)return void elements.push(_react2.default.createElement(_materialUi.Subheader,{key:item.subheader},item.subheader));var fontIcon=_react2.default.createElement(_avatarUserAvatar2.default,{avatarSize:36,pydio:this.props.pydio||pydio,userId:item.id,userLabel:item.label,avatar:item.avatar,icon:item.icon,idmUser:item.IdmUser,userType:item.type||"group",avatarOnly:!0,useDefaultAvatar:!0}),rightIconButton=void 0,touchTap=function(e){e.stopPropagation(),_this2.props.onItemClicked(item)};if(folders.indexOf(item)>-1&&this.props.onFolderClicked?(touchTap=function(e){e.stopPropagation(),_this2.props.onFolderClicked(item)},"selector"!==mode||item._notSelectable||(rightIconButton=_react2.default.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-account-multiple-plus",tooltip:"Select this group",tooltipPosition:"bottom-left",onTouchTap:function(){_this2.props.onItemClicked(item)}}))):"inner"===mode&&this.props.onDeleteAction&&(rightIconButton=_react2.default.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-delete",tooltip:getMessage(257),tooltipPosition:"bottom-left",iconStyle:{color:"rgba(0,0,0,0.13)",hoverColor:"rgba(0,0,0,0.53)"},onTouchTap:function(){_this2.props.onDeleteAction(_this2.props.item,[item])}})),bookColumn&&this.props.actionsForCell&&item.type){var menuItems=new _avatarCellActionsRenderer2.default(pydio,this.props.actionsForCell,null,item).renderItems();menuItems.length&&(rightIconButton=_react2.default.createElement(_materialUi.IconMenu,{iconButtonElement:_react2.default.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-dots-vertical",iconStyle:{color:"rgba(0,0,0,.33)"}}),targetOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"top"}},menuItems))}var select=function(e,checked){if(checked)_this2.setState({selection:[].concat(_this2.state.selection,[item])});else{var stateSel=_this2.state.selection,selection=[].concat(stateSel.slice(0,stateSel.indexOf(item)),stateSel.slice(stateSel.indexOf(item)+1));_this2.setState({selection:selection})}};elements.push(_react2.default.createElement(_materialUi.ListItem,{key:item.id,primaryText:item.label,onTouchTap:touchTap,disabled:"inner"===mode,leftAvatar:!this.state.select&&fontIcon,rightIconButton:rightIconButton,leftCheckbox:this.state.select&&_react2.default.createElement(_materialUi.Checkbox,{checked:this.state.selection.indexOf(item)>-1,onCheck:select})})),"inner"!==mode&&index<total-1&&elements.push(_react2.default.createElement(_materialUi.Divider,{inset:!0,key:item.id+"-divider"}))}.bind(this));var emptyState=void 0;if(!elements.length){var emptyStateProps={style:{backgroundColor:"transparent",minHeight:300},iconClassName:"mdi mdi-account-off",primaryTextId:this.props.emptyStatePrimaryText||getMessage(629),secondaryTextId:"book"===mode?this.props.emptyStateSecondaryText||null:null};"book"===mode&&item.actions&&item.actions.create&&(emptyStateProps=_extends({},emptyStateProps,{actionLabelId:getMessage(item.actions.create),actionCallback:createAction})),emptyState=_react2.default.createElement(_viewsEmptyStateView2.default,emptyStateProps)}return _react2.default.createElement("div",{style:{flex:1,flexDirection:"column",display:"flex"},onTouchTap:this.props.onTouchTap},"inner"!==mode&&!this.props.noToolbar&&toolbar,!emptyState&&!loading&&_react2.default.createElement(_materialUi.List,{style:{flex:1,overflowY:"inner"!==mode?"auto":"initial"}},this.props.subHeader&&_react2.default.createElement(_materialUi.Subheader,null,this.props.subHeader),elements),loading&&_react2.default.createElement(Loader,{style:{flex:1}}),!loading&&emptyState,"selector"===mode&&enableSearch&&bookColumn&&_react2.default.createElement(_SearchForm2.default,{searchLabel:this.props.searchLabel,onSearch:this.props.onSearch,style:{padding:"0 20px",minWidth:null,borderTop:"1px solid #e0e0e0"},underlineShow:!1}))},UsersList}(_react2.default.Component);UsersList.propTypes={item:_react2.default.PropTypes.object,onCreateAction:_react2.default.PropTypes.func,onDeleteAction:_react2.default.PropTypes.func,onItemClicked:_react2.default.PropTypes.func,onFolderClicked:_react2.default.PropTypes.func,onEditLabel:_react2.default.PropTypes.func,mode:_react2.default.PropTypes.oneOf(["book","selector","inner"]),bookColumn:_react2.default.PropTypes.bool},exports.default=UsersList=PydioContextConsumer(UsersList),exports.default=UsersList=_materialUiStyles.muiThemeable()(UsersList),exports.default=UsersList,module.exports=exports.default},{"../../views/EmptyStateView":60,"../avatar/CellActionsRenderer":55,"../avatar/UserAvatar":57,"./AlphaPaginator":45,"./SearchForm":49,"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/util/dom":"pydio/util/dom",react:"react"}],54:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _addressbookAddressBook=require("../addressbook/AddressBook"),_addressbookAddressBook2=_interopRequireDefault(_addressbookAddressBook),_policiesResourcePoliciesPanel=require("../../policies/ResourcePoliciesPanel"),_policiesResourcePoliciesPanel2=_interopRequireDefault(_policiesResourcePoliciesPanel),React=require("react"),PydioApi=require("pydio/http/api"),ResourcesManager=require("pydio/http/resources-manager"),_require=require("material-ui"),IconButton=_require.IconButton,Popover=_require.Popover,_require2=require("material-ui/styles"),muiThemeable=_require2.muiThemeable,_require$requireLib=require("pydio").requireLib("boot"),PydioContextConsumer=_require$requireLib.PydioContextConsumer,AsyncComponent=_require$requireLib.AsyncComponent,ActionsPanel=function(_React$Component){_inherits(ActionsPanel,_React$Component);function ActionsPanel(props,context){_classCallCheck(this,ActionsPanel),_React$Component.call(this,props,context),this.state={showPicker:!1,pickerAnchor:null,showMailer:!1,mailerAnchor:null,showPolicies:!1,policiesAnchor:null}}return ActionsPanel.prototype.onTeamSelected=function(item){this.setState({showPicker:!1}),item.IdmRole&&item.IdmRole.IsTeam&&PydioApi.getRestClient().getIdmApi().addUserToTeam(item.IdmRole.Uuid,this.props.userId,this.props.reloadAction)},ActionsPanel.prototype.onUserSelected=function(item){this.setState({showPicker:!1}),PydioApi.getRestClient().getIdmApi().addUserToTeam(this.props.team.id,item.IdmUser.Login,this.props.reloadAction)},ActionsPanel.prototype.openPicker=function(event){this.setState({showPicker:!0,pickerAnchor:event.currentTarget})},ActionsPanel.prototype.openPolicies=function(event){this.setState({showPolicies:!0,policiesAnchor:event.currentTarget})},ActionsPanel.prototype.openMailer=function(event){var _this=this,target=event.currentTarget;ResourcesManager.loadClassesAndApply(["PydioMailer"],function(){_this.setState({mailerLibLoaded:!0},function(){_this.setState({showMailer:!0,mailerAnchor:target})})})},ActionsPanel.prototype.componentDidUpdate=function(prevProps,prevState){this.props.lockOnSubPopoverOpen&&(!this.state.showPicker&&!this.state.showMailer||prevState.showPicker||prevState.showMailer?this.state.showPicker||this.state.showMailer||!prevState.showPicker&&!prevState.showMailer||this.props.lockOnSubPopoverOpen(!1):this.props.lockOnSubPopoverOpen(!0))},ActionsPanel.prototype.render=function(){var _this2=this,_props=this.props,getMessage=_props.getMessage,muiTheme=_props.muiTheme,team=_props.team,user=_props.user,userEditable=_props.userEditable,userId=_props.userId,style=_props.style,styles=(_props.zDepth,{button:{border:"1px solid "+muiTheme.palette.accent2Color,borderRadius:"50%",margin:"0 4px",width:36,height:36,padding:6},icon:{fontSize:22,color:muiTheme.palette.accent2Color}}),usermails={},actions=[],resourceType=void 0,resourceId=void 0;return user&&user.hasEmail&&(actions.push({key:"message",label:getMessage(598),icon:"email",callback:this.openMailer.bind(this)}),usermails[user.id]=PydioUsers.User.fromObject(user)),team?(resourceType="team",resourceId=team.id,actions.push({key:"users",label:getMessage(599),icon:"account-multiple-plus",callback:this.openPicker.bind(this)})):(resourceType="user",resourceId=userId,actions.push({key:"teams",label:getMessage(573),icon:"account-multiple-plus",callback:this.openPicker.bind(this)})),userEditable&&(this.props.onEditAction&&actions.push({key:"edit",label:getMessage(this.props.team?580:600),icon:"pencil",callback:this.props.onEditAction}),actions.push({key:"policies",label:"Visibility",icon:"security",callback:this.openPolicies.bind(this)}),this.props.onDeleteAction&&actions.push({key:"delete",label:getMessage(this.props.team?570:582),icon:"delete",callback:this.props.onDeleteAction})),React.createElement("div",{style:_extends({textAlign:"center",paddingTop:10,paddingBottom:10,borderTop:"1px solid #e0e0e0",borderBottom:"1px solid #e0e0e0"},style)},actions.map(function(a){return React.createElement(IconButton,{key:a.key,style:styles.button,iconStyle:styles.icon,tooltip:a.label,iconClassName:"mdi mdi-"+a.icon,onTouchTap:a.callback})}),React.createElement(Popover,{open:this.state.showPicker,anchorEl:this.state.pickerAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},onRequestClose:function(){_this2.setState({showPicker:!1})},useLayerForClickAway:!1,style:{zIndex:2200}},React.createElement("div",{style:{width:256,height:320}},React.createElement(_addressbookAddressBook2.default,{mode:"selector",pydio:this.props.pydio,loaderStyle:{width:320,height:420},onItemSelected:this.props.team?this.onUserSelected.bind(this):this.onTeamSelected.bind(this),teamsOnly:!this.props.team,usersOnly:!!this.props.team}))),React.createElement(Popover,{open:this.state.showMailer,anchorEl:this.state.mailerAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},useLayerForClickAway:!1,style:{zIndex:2200}},React.createElement("div",{style:{width:256,height:320}},this.state.mailerLibLoaded&&React.createElement(AsyncComponent,{namespace:"PydioMailer",componentName:"Pane",zDepth:0,panelTitle:getMessage(598),uniqueUserStyle:!0,users:usermails,onDismiss:function(){_this2.setState({showMailer:!1})},onFieldFocus:this.props.otherPopoverMouseOver}))),React.createElement(Popover,{open:this.state.showPolicies,anchorEl:this.state.policiesAnchor,anchorOrigin:{horizontal:"right",vertical:"top"},targetOrigin:{horizontal:"right",vertical:"top"},useLayerForClickAway:!1,style:{zIndex:2e3}},React.createElement("div",{style:{width:256,height:320}},React.createElement(_policiesResourcePoliciesPanel2.default,{pydio:this.props.pydio,resourceType:resourceType,resourceId:resourceId,onDismiss:function(){_this2.setState({showPolicies:!1})}}))))},ActionsPanel}(React.Component);ActionsPanel.propTypes={user:React.PropTypes.object,team:React.PropTypes.object,userEditable:React.PropTypes.object},exports.default=ActionsPanel=PydioContextConsumer(ActionsPanel),exports.default=ActionsPanel=muiThemeable()(ActionsPanel),exports.default=ActionsPanel,module.exports=exports.default},{"../../policies/ResourcePoliciesPanel":40,"../addressbook/AddressBook":44,"material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/http/resources-manager":"pydio/http/resources-manager",react:"react"}],55:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _materialUi=require("material-ui"),_pydioModelIdmObjectHelper=require("pydio/model/idm-object-helper"),_pydioModelIdmObjectHelper2=_interopRequireDefault(_pydioModelIdmObjectHelper),_pydioModelCell=require("pydio/model/cell"),_pydioModelCell2=_interopRequireDefault(_pydioModelCell),CellActionsRenderer=function(){function CellActionsRenderer(pydio,cellModel,acl){var addressBookItem=arguments.length<=3||void 0===arguments[3]?null:arguments[3];_classCallCheck(this,CellActionsRenderer),this.props={pydio:pydio,cellModel:cellModel,acl:acl,addressBookItem:addressBookItem}}return CellActionsRenderer.prototype.createCell=function(){var _props=this.props,addressBookItem=_props.addressBookItem,pydio=_props.pydio,m=pydio.MessageHash,idmObject=void 0;addressBookItem.IdmUser?idmObject=addressBookItem.IdmUser:addressBookItem.IdmRole&&(idmObject=addressBookItem.IdmRole),idmObject&&pydio.user.getIdmUser().then(function(loggedUser){var loggedLabel=_pydioModelIdmObjectHelper2.default.extractLabelFromIdmObject(loggedUser),targetLabel=_pydioModelIdmObjectHelper2.default.extractLabelFromIdmObject(addressBookItem.IdmUser||addressBookItem.IdmRole),model=new _pydioModelCell2.default;model.setLabel(loggedLabel+", "+targetLabel),model.setDescription("Created by "+loggedLabel),model.addUser(idmObject),model.save().then(function(res){pydio.UI.displayMessage("SUCCESS",m[643].replace("%s",targetLabel))}).catch(function(reason){pydio.UI.displayMessage("ERROR",m[644].replace("%s",reason.message))})})},CellActionsRenderer.prototype.addToCell=function(){var idmObject=void 0,_props2=this.props,addressBookItem=_props2.addressBookItem,cellModel=_props2.cellModel;addressBookItem.IdmUser?idmObject=addressBookItem.IdmUser:addressBookItem.IdmRole&&(idmObject=addressBookItem.IdmRole),idmObject&&(cellModel.addUser(idmObject),cellModel.save())},CellActionsRenderer.prototype.removeFromCell=function(){var _props3=this.props,acl=_props3.acl,cellModel=_props3.cellModel;cellModel.removeUser(acl.RoleId),cellModel.save()},CellActionsRenderer.prototype.renderItems=function(){var _props4=this.props,pydio=_props4.pydio,cellModel=_props4.cellModel,acl=_props4.acl,addressBookItem=_props4.addressBookItem,m=pydio.MessageHash,isLogged=void 0;isLogged=acl?acl.User&&acl.User.Login===pydio.user.id:"user"===userType&&pydio.user.id===userId;var items=[];if(isLogged)return items;var userId=void 0,userType=void 0;addressBookItem&&(userId=addressBookItem.id,"group"===(userType=addressBookItem.type)&&addressBookItem.IdmRole&&(userId=addressBookItem.IdmRole.Uuid,userType="team"));var label=void 0;if(label=acl?_pydioModelIdmObjectHelper2.default.extractLabel(pydio,acl):addressBookItem.label,!0===cellModel)return[React.createElement(_materialUi.MenuItem,{primaryText:m[640].replace("%s",label),onTouchTap:this.createCell.bind(this)})];var canWrite=cellModel.isEditable(),acls=cellModel.getAcls(),isInCurrent=void 0;return Object.keys(acls).map(function(k){var cellAcl=acls[k],crt=void 0;(crt=acl?acl.RoleId===cellAcl.RoleId:"user"===userType&&cellAcl.User&&cellAcl.User.Login===userId||"group"===userType&&cellAcl.Group&&cellAcl.Group.Uuid===userId||"team"===userType&&cellAcl.Role&&cellAcl.Role.Uuid===userId)&&(isInCurrent=!0)}),isInCurrent?items.push(React.createElement(_materialUi.MenuItem,{primaryText:m[641],disabled:!canWrite,onTouchTap:this.removeFromCell.bind(this)})):items.push(React.createElement(_materialUi.MenuItem,{primaryText:m[642],disabled:!canWrite,onTouchTap:this.addToCell.bind(this)})),items.push(React.createElement(_materialUi.Divider,null),React.createElement(_materialUi.MenuItem,{primaryText:m[640].replace("%s",label),onTouchTap:this.createCell.bind(this)})),items},CellActionsRenderer}();exports.default=CellActionsRenderer,module.exports=exports.default},{"material-ui":"material-ui","pydio/model/cell":"pydio/model/cell","pydio/model/idm-object-helper":"pydio/model/idm-object-helper"}],56:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _addressbookUsersList=require("../addressbook/UsersList"),_addressbookUsersList2=_interopRequireDefault(_addressbookUsersList),_require=require("react"),Component=_require.Component,_require2=require("material-ui"),Divider=_require2.Divider,PydioApi=require("pydio/http/api"),_require$requireLib=require("pydio").requireLib("boot"),PydioContextConsumer=_require$requireLib.PydioContextConsumer,GraphPanel=function(_Component){_inherits(GraphPanel,_Component);function GraphPanel(){_classCallCheck(this,GraphPanel),_Component.apply(this,arguments)}return GraphPanel.prototype.render=function(){var _props=this.props,graph=_props.graph,userLabel=_props.userLabel,pydio=_props.pydio,getMessage=_props.getMessage,elements=[];if(graph.teams&&graph.teams.length){var onDeleteAction=function(parentItem,team){var _this=this;PydioApi.getRestClient().getIdmApi().removeUserFromTeam(team[0].id,this.props.userId,function(response){response.message&&pydio.UI.displayMessage("SUCCESS",response.message),_this.props.reloadAction()})}.bind(this);elements.push(React.createElement("div",{key:"teams"},React.createElement(_addressbookUsersList2.default,{subHeader:getMessage(581).replace("%s",graph.teams.length),onItemClicked:function(){},item:{leafs:graph.teams},mode:"inner",onDeleteAction:onDeleteAction})))}if(graph.cells&&Object.keys(graph.cells).length){var sentence=void 0;if(1===Object.keys(graph.cells).length){var cellLabel=Object.values(graph.cells).pop();sentence=getMessage(601).replace("%1",userLabel).replace("%2",cellLabel)}else{var cellLabels="("+Object.values(graph.cells).join(", ")+")";sentence=getMessage(602).replace("%1",userLabel).replace("%2",Object.keys(graph.cells).length)+" "+cellLabels}elements.push(React.createElement("div",{key:"source"},elements.length?React.createElement(Divider,null):null,React.createElement("div",{style:{padding:16}},sentence)))}return React.createElement("div",null,elements)},GraphPanel}(Component);exports.default=GraphPanel=PydioContextConsumer(GraphPanel),exports.default=GraphPanel,module.exports=exports.default},{"../addressbook/UsersList":53,"material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],57:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _GraphPanel=require("./GraphPanel"),_GraphPanel2=_interopRequireDefault(_GraphPanel),_ActionsPanel=require("./ActionsPanel"),_ActionsPanel2=_interopRequireDefault(_ActionsPanel),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),debounce=require("lodash.debounce"),React=require("react"),Color=require("color"),_require=require("material-ui"),FontIcon=_require.FontIcon,Popover=_require.Popover,Paper=_require.Paper,Avatar=_require.Avatar,CardTitle=_require.CardTitle,_require2=(_require.Divider,require("material-ui/styles")),muiThemeable=_require2.muiThemeable,MetaCacheService=require("pydio/http/meta-cache-service"),_require3=require("pydio/http/users-api"),UsersApi=_require3.UsersApi,UserAvatar=function(_React$Component){_inherits(UserAvatar,_React$Component);function UserAvatar(props,context){_classCallCheck(this,UserAvatar),_React$Component.call(this,props,context),this.state={user:null,avatar:null,graph:null,local:!1}}return UserAvatar.prototype.componentDidMount=function(){this.loadPublicData(this.props.userId,this.props.idmUser)},UserAvatar.prototype.componentWillReceiveProps=function(nextProps){this.props.userId&&this.props.userId===nextProps.userId||(this.setState({label:nextProps.userId}),this.loadPublicData(nextProps.userId,nextProps.idmUser))},UserAvatar.prototype.componentWillUnmount=function(){this._userLoggedObs&&this.props.pydio.stopObserving("user_logged",this._userLoggedObs)},UserAvatar.prototype.loadPublicData=function(userId,idmUser){var _this=this,_props=this.props,userType=_props.userType,richCard=_props.richCard,pydio=_props.pydio;"group"!==userType&&"team"!==userType&&UsersApi.getUserPromise(userId,idmUser).then(function(userObject){userObject.isLocal()&&(_this._userLoggedObs=function(eventUser){_this._userLoggedObs=null,null!==eventUser&&_this.loadPublicData(userId)},pydio.observeOnce("user_logged",_this._userLoggedObs)),_this.setState({user:userObject,avatar:userObject.getAvatar(),local:userObject.isLocal()}),richCard&&!userObject.isNotFound()&&_pydioHttpApi2.default.getRestClient().getIdmApi().loadUserGraph(userId).then(function(response){var graph={cells:{},teams:[]};response.SharedCells&&response.SharedCells.forEach(function(workspace){graph.cells[workspace.Uuid]=workspace.Label}),response.BelongsToTeams&&response.BelongsToTeams.forEach(function(role){graph.teams.push({id:role.Uuid,label:role.Label,type:"team",IdmRole:role})}),_this.setState({graph:graph})})}).catch(function(e){_this.setState({loadError:!0})})},UserAvatar.prototype.render=function(){var _this2=this,_state=this.state,user=_state.user,avatar=_state.avatar,graph=_state.graph,local=_state.local,loadError=_state.loadError,_props2=this.props,pydio=_props2.pydio,userId=_props2.userId,userType=_props2.userType,icon=_props2.icon,style=_props2.style,labelStyle=_props2.labelStyle,avatarLetters=_props2.avatarLetters,avatarStyle=_props2.avatarStyle,avatarSize=_props2.avatarSize,className=_props2.className,labelClassName=_props2.labelClassName,displayLabel=_props2.displayLabel,displayLocalLabel=_props2.displayLocalLabel,displayAvatar=_props2.displayAvatar,useDefaultAvatar=_props2.useDefaultAvatar,richCard=_props2.richCard,muiTheme=(_props2.cardSize,_props2.muiTheme),noActionsPanel=_props2.noActionsPanel,label=this.state.label,userTypeLabel=void 0,userNotFound=loadError,userIsPublic=!1;user?(label=user.getLabel(),userNotFound=user.isNotFound(),userIsPublic=user.isPublic()):label||(label=this.props.userLabel||this.props.userId),local&&displayLocalLabel&&(label=pydio.MessageHash[634]);var avatarContent=void 0,avatarColor=void 0,avatarIcon=void 0;if(richCard&&(displayAvatar=!0,useDefaultAvatar=!0,displayLabel=!0),displayAvatar&&!avatar&&label&&(!displayLabel||useDefaultAvatar)){var avatarsColor=muiTheme.palette.avatarsColor;"group"!==userType&&"team"!==userType&&0!==userId.indexOf("PYDIO_GRP_/")&&0!==userId.indexOf("/USER_TEAM/")||(avatarsColor=Color(avatarsColor).darken(.2).toString());var iconClassName=void 0;switch(userType){case"group":iconClassName="mdi mdi-account-multiple",userTypeLabel="289";break;case"team":iconClassName="mdi mdi-account-multiple-outline",userTypeLabel="603";break;case"remote":iconClassName="mdi mdi-account-network",userTypeLabel="604";break;default:iconClassName="mdi mdi-account",
user?user.getExternal()?(userTypeLabel="589",user.isPublic()&&(userTypeLabel="589",label=pydio.MessageHash.public_link_user,iconClassName="mdi mdi-link")):userTypeLabel="590":userTypeLabel="288"}icon&&(iconClassName=icon),userTypeLabel&&(userTypeLabel=pydio.MessageHash[userTypeLabel]),richCard?(avatarIcon=React.createElement(FontIcon,{className:iconClassName,style:{color:avatarsColor}}),avatarColor="#f5f5f5"):(avatarColor=avatarsColor,iconClassName&&!avatarLetters?avatarIcon=React.createElement(FontIcon,{className:iconClassName}):(avatarContent=label.split(" ").map(function(word){return word[0]}).join("").substring(0,2),avatarContent.length<2&&(avatarContent=label.substring(0,2))))}var reloadAction=void 0,onEditAction=void 0,onMouseOver=void 0,onMouseOut=void 0,onClick=void 0,popover=void 0;richCard?function(){displayAvatar=!0,style=_extends({},style,{flexDirection:"column"}),avatarSize=100,avatarStyle={marginTop:20};var localReload=function(){MetaCacheService.getInstance().deleteKey("user_public_data-graph",_this2.props.userId),_this2.loadPublicData(_this2.props.userId,_this2.props.idmUser)};reloadAction=function(){localReload(),_this2.props.reloadAction&&_this2.props.reloadAction()},onEditAction=function(){localReload(),_this2.props.onEditAction&&_this2.props.onEditAction()}}():local||userNotFound||userIsPublic||!this.props.richOnHover?local||userNotFound||userIsPublic||!this.props.richOnClick||function(){onMouseOut=function(){_this2.lockedBySubPopover||_this2.setState({showPopover:!1})},onMouseOut=debounce(onMouseOut,350),onClick=function(e){_this2.setState({showPopover:!0,popoverAnchor:e.currentTarget}),onMouseOut.cancel()};var onMouseOverInner=function(e){_this2.setState({showPopover:!0}),onMouseOut.cancel()},lockOnSubPopoverOpen=function(status){_this2.lockedBySubPopover=status,onMouseOverInner()},_props4=_this2.props,popoverProps=(_props4.style,_objectWithoutProperties(_props4,["style"]));popover=React.createElement(Popover,{open:_this2.state.showPopover,anchorEl:_this2.state.popoverAnchor,onRequestClose:function(reason){"clickAway"===reason&&_this2.lockedBySubPopover||_this2.setState({showPopover:!1})},anchorOrigin:{horizontal:"left",vertical:"bottom"},targetOrigin:{horizontal:"left",vertical:"top"},useLayerForClickAway:!1},React.createElement(Paper,{zDepth:2,style:{width:220,height:320,overflowY:"auto"},onMouseOver:onMouseOverInner,onMouseOut:onMouseOut},React.createElement(UserAvatar,_extends({},popoverProps,{richCard:!0,richOnHover:!1,cardSize:220,lockOnSubPopoverOpen:lockOnSubPopoverOpen}))))}():function(){onMouseOut=function(){_this2.lockedBySubPopover||_this2.setState({showPopover:!1})},onMouseOut=debounce(onMouseOut,350),onMouseOver=function(e){_this2.setState({showPopover:!0,popoverAnchor:e.currentTarget}),onMouseOut.cancel()};var onMouseOverInner=function(e){_this2.setState({showPopover:!0}),onMouseOut.cancel()},lockOnSubPopoverOpen=function(status){_this2.lockedBySubPopover=status,onMouseOverInner()},_props3=_this2.props,popoverProps=(_props3.style,_objectWithoutProperties(_props3,["style"]));popover=React.createElement(Popover,{open:_this2.state.showPopover,anchorEl:_this2.state.popoverAnchor,onRequestClose:function(reason){"clickAway"===reason&&_this2.lockedBySubPopover||_this2.setState({showPopover:!1})},anchorOrigin:{horizontal:"left",vertical:"center"},targetOrigin:{horizontal:"right",vertical:"center"},useLayerForClickAway:!1},React.createElement(Paper,{zDepth:2,style:{width:220,height:320,overflowY:"auto"},onMouseOver:onMouseOverInner,onMouseOut:onMouseOut},React.createElement(UserAvatar,_extends({},popoverProps,{richCard:!0,richOnHover:!1,cardSize:220,lockOnSubPopoverOpen:lockOnSubPopoverOpen}))))}(),avatar&&(avatarIcon=React.createElement(FontIcon,{style:{backgroundImage:"url("+avatar+"?dim="+avatarSize+")",backgroundSize:"cover",margin:0,width:"100%",height:"100%",borderRadius:"50%",backgroundPosition:"center"}}));var avatarComponent=React.createElement(Avatar,{icon:avatarIcon,size:avatarSize,style:this.props.avatarOnly?this.props.style:avatarStyle,backgroundColor:avatarColor},avatarContent);return this.props.avatarOnly?avatarComponent:(richCard?avatarComponent=React.createElement("div",{style:{textAlign:"center"}},avatarComponent):userNotFound&&(labelStyle=_extends({},labelStyle,{textDecoration:"line-through"})),React.createElement("div",{className:className,style:style,onMouseOver:onMouseOver,onMouseOut:onMouseOut,onClick:onClick},displayAvatar&&(avatar||avatarContent||avatarIcon)&&avatarComponent,displayLabel&&!richCard&&React.createElement("div",{className:labelClassName,style:labelStyle},label),displayLabel&&richCard&&React.createElement(CardTitle,{style:{textAlign:"center"},title:label,subtitle:userTypeLabel}),richCard&&user&&!noActionsPanel&&React.createElement(_ActionsPanel2.default,_extends({},this.state,this.props,{reloadAction:reloadAction,onEditAction:onEditAction})),richCard&&graph&&!noActionsPanel&&React.createElement(_GraphPanel2.default,_extends({graph:graph},this.props,{userLabel:label,reloadAction:reloadAction,onEditAction:onEditAction})),this.props.children,popover))},UserAvatar}(React.Component);UserAvatar.propTypes={userId:React.PropTypes.string.isRequired,pydio:React.PropTypes.instanceOf(Pydio),userLabel:React.PropTypes.string,userType:React.PropTypes.oneOf(["user","group","remote","team"]),icon:React.PropTypes.string,richCard:React.PropTypes.bool,richOnHover:React.PropTypes.bool,richOnClick:React.PropTypes.bool,userEditable:React.PropTypes.bool,onEditAction:React.PropTypes.func,onDeleteAction:React.PropTypes.func,reloadAction:React.PropTypes.func,displayLabel:React.PropTypes.bool,displayLocalLabel:React.PropTypes.bool,displayAvatar:React.PropTypes.bool,avatarOnly:React.PropTypes.bool,useDefaultAvatar:React.PropTypes.bool,avatarSize:React.PropTypes.number,avatarLetters:React.PropTypes.bool,noActionsPanel:React.PropTypes.bool,className:React.PropTypes.string,labelClassName:React.PropTypes.string,avatarClassName:React.PropTypes.string,style:React.PropTypes.object,labelStyle:React.PropTypes.object,avatarStyle:React.PropTypes.object},UserAvatar.defaultProps={displayLabel:!0,displayAvatar:!0,avatarSize:40,userType:"user",className:"user-avatar-widget",avatarClassName:"user-avatar",labelClassName:"user-label"},exports.default=UserAvatar=muiThemeable()(UserAvatar),exports.default=UserAvatar,module.exports=exports.default},{"./ActionsPanel":54,"./GraphPanel":56,color:"color","lodash.debounce":"lodash.debounce","material-ui":"material-ui","material-ui/styles":"material-ui/styles","pydio/http/api":"pydio/http/api","pydio/http/meta-cache-service":"pydio/http/meta-cache-service","pydio/http/users-api":"pydio/http/users-api",react:"react"}],58:[function(require,module,exports){"use strict";exports.__esModule=!0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var FuncUtils=require("pydio/util/func"),ResourcesManager=require("pydio/http/resources-manager"),Types={NODE_PROVIDER:"node",SORTABLE_LIST_ITEM:"sortable-list-item"};function collect(connect,monitor){return{connectDragSource:connect.dragSource(),isDragging:monitor.isDragging()}}function collectDrop(connect,monitor){return{connectDropTarget:connect.dropTarget(),canDrop:monitor.canDrop(),isOver:monitor.isOver(),isOverCurrent:monitor.isOver({shallow:!0})}}var DNDActionParameter=function(){function DNDActionParameter(source,target,step){_classCallCheck(this,DNDActionParameter),this._source=source,this._target=target,this._step=step}return DNDActionParameter.prototype.getSource=function(){return this._source},DNDActionParameter.prototype.getTarget=function(){return this._target},DNDActionParameter.prototype.getStep=function(){return this._step},DNDActionParameter}();DNDActionParameter.STEP_BEGIN_DRAG="beginDrag",DNDActionParameter.STEP_END_DRAG="endDrag",DNDActionParameter.STEP_CAN_DROP="canDrop",DNDActionParameter.STEP_HOVER_DROP="hover";var applyDNDAction=function(source,target,step){var Controller=window.pydio.Controller,dnd=Controller.defaultActions.get("dragndrop");if(!dnd)throw new Error("No DND Actions available");var dndAction=Controller.getActionByName(dnd);dndAction.enable();var params=new DNDActionParameter(source,target,step),checkModule=dndAction.options.dragndropCheckModule;if(step===DNDActionParameter.STEP_CAN_DROP&&checkModule){if(!FuncUtils.getFunctionByName(checkModule,window))throw ResourcesManager.detectModuleToLoadAndApply(checkModule,function(){}),new Error("Cannot find test module, trying to load it");FuncUtils.executeFunctionByName(dndAction.options.dragndropCheckModule,window,Controller,params)}else dndAction.apply(params)},nodeDragSource={beginDrag:function(props){return{node:props.node}},endDrag:function(props,monitor,component){if(monitor.didDrop()){var item=monitor.getItem(),dropResult=monitor.getDropResult();try{applyDNDAction(item.node,dropResult.node,DNDActionParameter.STEP_END_DRAG)}catch(e){}}}},nodeDropTarget={hover:function(props,monitor){},canDrop:function(props,monitor){var source=monitor.getItem().node,target=props.node;try{applyDNDAction(source,target,DNDActionParameter.STEP_CAN_DROP)}catch(e){return!1}return!0},drop:function(props,monitor){if(!monitor.didDrop())return{node:props.node}}};exports.Types=Types,exports.collect=collect,exports.collectDrop=collectDrop,exports.nodeDragSource=nodeDragSource,exports.nodeDropTarget=nodeDropTarget,exports.DNDActionParameter=DNDActionParameter},{"pydio/http/resources-manager":"pydio/http/resources-manager","pydio/util/func":"pydio/util/func"}],59:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default={contextTypes:{messages:React.PropTypes.object,getMessage:React.PropTypes.func}},module.exports=exports.default},{}],60:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _require=require("react"),Component=_require.Component,PropTypes=_require.PropTypes,_require2=require("material-ui"),FlatButton=_require2.FlatButton,FontIcon=_require2.FontIcon,_require3=require("material-ui/styles"),muiThemeable=_require3.muiThemeable,Color=require("color"),Pydio=require("pydio"),_Pydio$requireLib=Pydio.requireLib("boot"),PydioContextConsumer=_Pydio$requireLib.PydioContextConsumer,EmptyStateView=function(_Component){_inherits(EmptyStateView,_Component);function EmptyStateView(props,context){_classCallCheck(this,EmptyStateView),_Component.call(this,props,context)}return EmptyStateView.prototype.render=function(){var _props=this.props,style=_props.style,iconClassName=_props.iconClassName,primaryTextId=_props.primaryTextId,secondaryTextId=_props.secondaryTextId,actionLabelId=_props.actionLabelId,actionCallback=_props.actionCallback,actionStyle=_props.actionStyle,actionIconClassName=_props.actionIconClassName,getMessage=_props.getMessage,iconStyle=_props.iconStyle,legendStyle=_props.legendStyle,mainColor=Color(this.props.muiTheme.palette.primary1Color),styles={container:_extends({display:"flex",alignItems:"center",justifyContent:"center",height:"100%",width:"100%",flex:1,backgroundColor:mainColor.lightness(97).rgb().toString()},style),centered:{maxWidth:280,textAlign:"center",color:mainColor.fade(.6).toString()},icon:_extends({fontSize:100},iconStyle),primaryText:_extends({fontSize:16,fontWeight:500},legendStyle),secondaryText:{marginTop:20,fontSize:13},buttonContainer:{marginTop:100,textAlign:"center"},buttonStyle:{color:this.props.muiTheme.palette.accent2Color}},buttonIcon=actionIconClassName?React.createElement(FontIcon,{className:actionIconClassName}):null;return React.createElement("div",{style:styles.container},React.createElement("div",{style:styles.centered},React.createElement("div",{className:iconClassName,style:styles.icon}),React.createElement("div",{style:styles.primaryText},getMessage(primaryTextId)),secondaryTextId&&React.createElement("div",{style:styles.secondaryText},getMessage(secondaryTextId)),actionLabelId&&actionCallback&&React.createElement("div",{style:_extends({},styles.buttonContainer,actionStyle)},React.createElement(FlatButton,{style:styles.buttonStyle,label:getMessage(actionLabelId),onTouchTap:actionCallback,icon:buttonIcon}))))},EmptyStateView}(Component);EmptyStateView.propTypes={pydio:PropTypes.instanceOf(Pydio).isRequired,iconClassName:PropTypes.string.isRequired,primaryTextId:PropTypes.string.isRequired,secondaryTextId:PropTypes.string,actionLabelId:PropTypes.string,actionCallback:PropTypes.func,actionStyle:PropTypes.object,style:PropTypes.object,iconStyle:PropTypes.object,legendStyle:PropTypes.object,getMessage:PropTypes.func},exports.default=EmptyStateView=PydioContextConsumer(EmptyStateView),exports.default=EmptyStateView=muiThemeable()(EmptyStateView),exports.default=EmptyStateView,module.exports=exports.default},{color:"color","material-ui":"material-ui","material-ui/styles":"material-ui/styles",pydio:"pydio",react:"react"}],61:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj)keys.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(obj,i)&&(target[i]=obj[i]);return target}var _react=require("react"),_react2=_interopRequireDefault(_react),_materialUi=require("material-ui"),ModalAppBar=function(props){var style=props.style,titleStyle=props.titleStyle,iconStyleRight=props.iconStyleRight,iconStyleLeft=props.iconStyleLeft,otherProps=_objectWithoutProperties(props,["style","titleStyle","iconStyleRight","iconStyleLeft"]),styles={style:_extends({flexShrink:0},style),titleStyle:_extends({lineHeight:"56px",height:56,marginLeft:-8},titleStyle),iconStyleRight:_extends({marginTop:4},iconStyleRight),iconStyleLeft:_extends({marginTop:4},iconStyleLeft)};return _react2.default.createElement(_materialUi.AppBar,_extends({},otherProps,styles))};exports.default=ModalAppBar,module.exports=exports.default},{"material-ui":"material-ui",react:"react"}],62:[function(require,module,exports){"use strict";exports.__esModule=!0,exports.default=React.createClass({displayName:"SimpleReactActionBar",propTypes:{dataModel:React.PropTypes.instanceOf(PydioDataModel).isRequired,node:React.PropTypes.instanceOf(AjxpNode).isRequired,actions:React.PropTypes.array},clickAction:function(event){var actionName=event.currentTarget.getAttribute("data-action");this.props.dataModel.setSelectedNodes([this.props.node]);var a=window.pydio.Controller.getActionByName(actionName);a.fireContextChange(this.props.dataModel,!0,window.pydio.user),a.apply([this.props.dataModel]),event.stopPropagation(),event.preventDefault()},render:function(){var actions=this.props.actions.map(function(a){return React.createElement("div",{key:a.options.name,className:a.options.icon_class+" material-list-action-inline"||"",title:a.options.title,"data-action":a.options.name,onClick:this.clickAction})}.bind(this));return React.createElement("span",null,actions)}}),module.exports=exports.default},{}],63:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _utilDND=require("../util/DND"),_react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),withContextMenu=_Pydio$requireLib.withContextMenu,ContextMenuWrapper=function(props){return _react2.default.createElement("div",props)};ContextMenuWrapper=withContextMenu(ContextMenuWrapper);var DragDropTreeNode,SimpleTreeNode=_react2.default.createClass({displayName:"SimpleTreeNode",propTypes:{collapse:_react2.default.PropTypes.bool,forceExpand:_react2.default.PropTypes.bool,childrenOnly:_react2.default.PropTypes.bool,depth:_react2.default.PropTypes.number,onNodeSelect:_react2.default.PropTypes.func,node:_react2.default.PropTypes.instanceOf(AjxpNode),dataModel:_react2.default.PropTypes.instanceOf(PydioDataModel),forceLabel:_react2.default.PropTypes.string,nodeIsSelected:_react2.default.PropTypes.func,checkboxes:_react2.default.PropTypes.array,checkboxesValues:_react2.default.PropTypes.object,checkboxesComputeStatus:_react2.default.PropTypes.func,onCheckboxCheck:_react2.default.PropTypes.func,paddingOffset:_react2.default.PropTypes.number},getDefaultProps:function(){return{collapse:!1,childrenOnly:!1,depth:0,paddingOffset:0,onNodeSelect:function(node){}}},listenToNode:function(node){this._childrenListener=function(){this.isMounted()&&this.setState({children:this._nodeToChildren(node)})}.bind(this),this._nodeListener=function(){this.isMounted()&&this.forceUpdate()}.bind(this),node.observe("child_added",this._childrenListener),node.observe("child_removed",this._childrenListener),node.observe("node_replaced",this._nodeListener)},stopListening:function(node){node.stopObserving("child_added",this._childrenListener),node.stopObserving("child_removed",this._childrenListener),node.stopObserving("node_replaced",this._nodeListener)},componentDidMount:function(){this.listenToNode(this.props.node)},componentWillUnmount:function(){this.stopListening(this.props.node)},componentWillReceiveProps:function(nextProps){var oldNode=this.props.node,newNode=nextProps.node;if(newNode==oldNode&&newNode.getMetadata().get("paginationData")){var remapedChildren=this.state.children.map(function(c){return c.setParent(newNode),c}),remapedPathes=this.state.children.map(function(c){return c.getPath()});this._nodeToChildren(newNode).forEach(function(nc){-1===remapedPathes.indexOf(nc.getPath())&&remapedChildren.push(nc)}),this.setState({children:remapedChildren})}else this.setState({children:this._nodeToChildren(newNode)});newNode!==oldNode&&(this.stopListening(oldNode),this.listenToNode(newNode))},getInitialState:function(){return{showChildren:!this.props.collapse||this.props.forceExpand,children:this._nodeToChildren(this.props.node)}},_nodeToChildren:function(){var children=[];return this.props.node.getChildren().forEach(function(c){c.isLeaf()&&"ajxp_browsable_archive"!==c.getAjxpMime()||children.push(c)}),children},onNodeSelect:function(ev){this.props.onNodeSelect&&this.props.onNodeSelect(this.props.node),ev.preventDefault(),ev.stopPropagation()},onChildDisplayToggle:function(ev){this.props.node.getChildren().size&&this.setState({showChildren:!this.state.showChildren}),ev.preventDefault(),ev.stopPropagation()},nodeIsSelected:function(n){return this.props.nodeIsSelected?this.props.nodeIsSelected(n):-1!==this.props.dataModel.getSelectedNodes().indexOf(n)},render:function(){var hasChildren,_this=this,_props=this.props,node=_props.node,childrenOnly=_props.childrenOnly,canDrop=_props.canDrop,isOverCurrent=_props.isOverCurrent,checkboxes=_props.checkboxes,checkboxesComputeStatus=_props.checkboxesComputeStatus,checkboxesValues=_props.checkboxesValues,onCheckboxCheck=_props.onCheckboxCheck,depth=_props.depth,paddingOffset=_props.paddingOffset,forceExpand=_props.forceExpand,selectedItemStyle=_props.selectedItemStyle,getItemStyle=_props.getItemStyle,forceLabel=_props.forceLabel,hasFolderChildrens=!!this.state.children.length;if(hasFolderChildrens)hasChildren=_react2.default.createElement("span",{onClick:this.onChildDisplayToggle},this.state.showChildren||forceExpand?_react2.default.createElement("span",{className:"tree-icon icon-angle-down"}):_react2.default.createElement("span",{className:"tree-icon icon-angle-right"}));else{var cname="tree-icon icon-angle-right";node.isLoaded()&&(cname+=" no-folder-children"),hasChildren=_react2.default.createElement("span",{className:cname})}var selfLabel,isSelected=this.nodeIsSelected(node)?"mui-menu-item mui-is-selected":"mui-menu-item";if(!childrenOnly){canDrop&&isOverCurrent&&(isSelected+=" droppable-active");var boxes;if(checkboxes){var values={},inherited=!1,disabled={},additionalClassName="";if(checkboxesComputeStatus){var status=checkboxesComputeStatus(node);values=status.VALUES,inherited=status.INHERITED,disabled=status.DISABLED,status.CLASSNAME&&(additionalClassName=" "+status.CLASSNAME)}else checkboxesValues&&checkboxesValues[node.getPath()]&&(values=checkboxesValues[node.getPath()]);var valueClasses=[];boxes=checkboxes.map(function(c){var selected=void 0!==values[c]&&values[c],click=function(event,value){onCheckboxCheck(node,c,value)}.bind(this);return selected&&valueClasses.push(c),_react2.default.createElement(ReactMUI.Checkbox,{name:c,key:c+"-"+(selected?"true":"false"),checked:selected,onCheck:click,disabled:disabled[c],className:"cbox-"+c})}.bind(this)),isSelected+=inherited?" inherited ":"",isSelected+=valueClasses.length?" checkbox-values-"+valueClasses.join("-"):" checkbox-values-empty",boxes=_react2.default.createElement("div",{className:"tree-checkboxes"+additionalClassName},boxes)}var itemStyle={paddingLeft:paddingOffset+20*depth};this.nodeIsSelected(node)&&selectedItemStyle&&(itemStyle=_extends({},itemStyle,selectedItemStyle)),getItemStyle&&(itemStyle=_extends({},itemStyle,getItemStyle(node)));var icon="mdi mdi-folder",ajxpMime=node.getAjxpMime();"ajxp_browsable_archive"===ajxpMime?icon="mdi mdi-archive":"ajxp_recycle"===ajxpMime&&(icon="mdi mdi-delete"),selfLabel=_react2.default.createElement(ContextMenuWrapper,{node:node,className:"tree-item "+isSelected+(boxes?" has-checkboxes":""),style:itemStyle},_react2.default.createElement("div",{className:"tree-item-label",onClick:this.onNodeSelect,title:node.getLabel(),"data-id":node.getPath()},hasChildren,_react2.default.createElement("span",{className:"tree-icon "+icon}),forceLabel||node.getLabel()),boxes)}var children=[],connector=function(instance){return instance},draggable=!1;return window.ReactDND&&this.props.connectDropTarget&&this.props.connectDragSource&&function(){var connectDragSource=_this.props.connectDragSource,connectDropTarget=_this.props.connectDropTarget;connector=function(instance){connectDragSource(ReactDOM.findDOMNode(instance)),connectDropTarget(ReactDOM.findDOMNode(instance))},draggable=!0}(),(this.state.showChildren||forceExpand)&&(children=this.state.children.map(function(child){var props=_extends({},this.props,{forceLabel:null,childrenOnly:!1,key:child.getPath(),node:child,depth:depth+1});return _react2.default.createElement(draggable?DragDropTreeNode:SimpleTreeNode,props)}.bind(this))),_react2.default.createElement("li",{ref:connector,className:"treenode"+node.getPath().replace(/\//g,"_")},selfLabel,_react2.default.createElement("ul",null,children))}});DragDropTreeNode=window.ReactDND?ReactDND.flow(ReactDND.DragSource(_utilDND.Types.NODE_PROVIDER,_utilDND.nodeDragSource,_utilDND.collect),ReactDND.DropTarget(_utilDND.Types.NODE_PROVIDER,_utilDND.nodeDropTarget,_utilDND.collectDrop))(SimpleTreeNode):SimpleTreeNode;var DNDTreeView=_react2.default.createClass({displayName:"DNDTreeView",propTypes:{showRoot:_react2.default.PropTypes.bool,rootLabel:_react2.default.PropTypes.string,onNodeSelect:_react2.default.PropTypes.func,node:_react2.default.PropTypes.instanceOf(AjxpNode).isRequired,dataModel:_react2.default.PropTypes.instanceOf(PydioDataModel).isRequired,selectable:_react2.default.PropTypes.bool,selectableMultiple:_react2.default.PropTypes.bool,initialSelectionModel:_react2.default.PropTypes.array,onSelectionChange:_react2.default.PropTypes.func,forceExpand:_react2.default.PropTypes.bool,nodeIsSelected:_react2.default.PropTypes.func,checkboxes:_react2.default.PropTypes.array,checkboxesValues:_react2.default.PropTypes.object,checkboxesComputeStatus:_react2.default.PropTypes.func,onCheckboxCheck:_react2.default.PropTypes.func,paddingOffset:_react2.default.PropTypes.number},getDefaultProps:function(){return{showRoot:!0,onNodeSelect:this.onNodeSelect}},onNodeSelect:function(node){this.props.onNodeSelect?this.props.onNodeSelect(node):this.props.dataModel.setSelectedNodes([node])},render:function(){return _react2.default.createElement("ul",{className:this.props.className},_react2.default.createElement(DragDropTreeNode,{childrenOnly:!this.props.showRoot,forceExpand:this.props.forceExpand,node:this.props.node?this.props.node:this.props.dataModel.getRootNode(),dataModel:this.props.dataModel,onNodeSelect:this.onNodeSelect,nodeIsSelected:this.props.nodeIsSelected,forceLabel:this.props.rootLabel,checkboxes:this.props.checkboxes,checkboxesValues:this.props.checkboxesValues,checkboxesComputeStatus:this.props.checkboxesComputeStatus,onCheckboxCheck:this.props.onCheckboxCheck,selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,paddingOffset:this.props.paddingOffset}))}}),TreeView=_react2.default.createClass({displayName:"TreeView",propTypes:{showRoot:_react2.default.PropTypes.bool,rootLabel:_react2.default.PropTypes.string,onNodeSelect:_react2.default.PropTypes.func,node:_react2.default.PropTypes.instanceOf(AjxpNode).isRequired,dataModel:_react2.default.PropTypes.instanceOf(PydioDataModel).isRequired,selectable:_react2.default.PropTypes.bool,selectableMultiple:_react2.default.PropTypes.bool,initialSelectionModel:_react2.default.PropTypes.array,onSelectionChange:_react2.default.PropTypes.func,forceExpand:_react2.default.PropTypes.bool,nodeIsSelected:_react2.default.PropTypes.func,checkboxes:_react2.default.PropTypes.array,checkboxesValues:_react2.default.PropTypes.object,checkboxesComputeStatus:_react2.default.PropTypes.func,onCheckboxCheck:_react2.default.PropTypes.func,paddingOffset:_react2.default.PropTypes.number},getDefaultProps:function(){return{showRoot:!0,onNodeSelect:this.onNodeSelect}},onNodeSelect:function(node){this.props.onNodeSelect?this.props.onNodeSelect(node):this.props.dataModel.setSelectedNodes([node])},render:function(){return _react2.default.createElement("ul",{className:this.props.className},_react2.default.createElement(SimpleTreeNode,{childrenOnly:!this.props.showRoot,forceExpand:this.props.forceExpand,node:this.props.node?this.props.node:this.props.dataModel.getRootNode(),dataModel:this.props.dataModel,onNodeSelect:this.onNodeSelect,nodeIsSelected:this.props.nodeIsSelected,forceLabel:this.props.rootLabel,checkboxes:this.props.checkboxes,checkboxesValues:this.props.checkboxesValues,checkboxesComputeStatus:this.props.checkboxesComputeStatus,onCheckboxCheck:this.props.onCheckboxCheck,selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,paddingOffset:this.props.paddingOffset}))}}),FoldersTree=_react2.default.createClass({displayName:"FoldersTree",propTypes:{pydio:_react2.default.PropTypes.instanceOf(_pydio2.default).isRequired,dataModel:_react2.default.PropTypes.instanceOf(PydioDataModel).isRequired,className:_react2.default.PropTypes.string,onNodeSelected:_react2.default.PropTypes.func,draggable:_react2.default.PropTypes.bool},nodeObserver:function(){var r=this.props.dataModel.getRootNode();r.isLoaded()?this.forceUpdate():r.observeOnce("loaded",function(){this.forceUpdate()}.bind(this))},componentDidMount:function(){var dm=this.props.dataModel;this._dmObs=this.nodeObserver,dm.observe("context_changed",this._dmObs),dm.observe("root_node_changed",this._dmObs),this.nodeObserver()},componentWillUnmount:function(){if(this._dmObs){var dm=this.props.dataModel;dm.stopObserving("context_changed",this._dmObs),dm.stopObserving("root_node_changed",this._dmObs)}},treeNodeSelected:function(n){this.props.onNodeSelected?this.props.onNodeSelected(n):this.props.dataModel.requireContextChange(n)},nodeIsSelected:function(n){return n===this.props.dataModel.getContextNode()},render:function(){return this.props.draggable?_react2.default.createElement(PydioComponents.DNDTreeView,{onNodeSelect:this.treeNodeSelected,nodeIsSelected:this.nodeIsSelected,dataModel:this.props.dataModel,node:this.props.dataModel.getRootNode(),showRoot:!!this.props.showRoot,selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,className:"folders-tree"+(this.props.className?" "+this.props.className:"")}):_react2.default.createElement(PydioComponents.TreeView,{onNodeSelect:this.treeNodeSelected,nodeIsSelected:this.nodeIsSelected,dataModel:this.props.dataModel,node:this.props.dataModel.getRootNode(),selectedItemStyle:this.props.selectedItemStyle,getItemStyle:this.props.getItemStyle,showRoot:!!this.props.showRoot,className:"folders-tree"+(this.props.className?" "+this.props.className:"")})}});exports.TreeView=TreeView,exports.DNDTreeView=DNDTreeView,exports.FoldersTree=FoldersTree},{"../util/DND":58,pydio:"pydio",react:"react"}]},{},[18])(18)});