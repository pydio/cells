!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.PydioForm=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_mixinsFieldWithChoices=require("../mixins/FieldWithChoices"),_mixinsFieldWithChoices2=_interopRequireDefault(_mixinsFieldWithChoices),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),React=require("react"),_require=require("material-ui"),AutoComplete=_require.AutoComplete,MenuItem=_require.MenuItem,RefreshIndicator=_require.RefreshIndicator,_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernStyles=_Pydio$requireLib.ModernStyles,AutocompleteBox=React.createClass({displayName:"AutocompleteBox",mixins:[_mixinsFormMixin2.default],handleUpdateInput:function(searchText){},handleNewRequest:function(chosenValue){void 0===chosenValue.key?this.onChange(null,chosenValue):this.onChange(null,chosenValue.key)},render:function(){var choices=this.props.choices,dataSource=[],labels={};choices.forEach(function(choice,key){dataSource.push({key:key,text:choice,value:React.createElement(MenuItem,null,choice)}),labels[key]=choice});var displayText=this.state.value;if(labels&&labels[displayText]&&(displayText=labels[displayText]),this.isDisplayGrid()&&!this.state.editMode||this.props.disabled){var value=this.state.value;return choices.get(value)&&(value=choices.get(value)),React.createElement("div",{onClick:this.props.disabled?function(){}:this.toggleEditMode,className:value?"":"paramValue-empty"},value||"Empty","   ",React.createElement("span",{className:"icon-caret-down"}))}return React.createElement("div",{className:"pydioform_autocomplete",style:{position:"relative"}},!dataSource.length&&React.createElement(RefreshIndicator,{size:30,right:10,top:0,status:"loading"}),dataSource.length&&React.createElement(AutoComplete,_extends({fullWidth:!0,searchText:displayText,onUpdateInput:this.handleUpdateInput,onNewRequest:this.handleNewRequest,dataSource:dataSource,hintText:this.props.attributes.label,filter:function(searchText,key){return!(!key||!searchText)&&0===key.toLowerCase().indexOf(searchText.toLowerCase())},openOnFocus:!0,menuProps:{maxHeight:200}},ModernStyles.textField)))}});exports.default=AutocompleteBox=_mixinsFieldWithChoices2.default(AutocompleteBox),exports.default=AutocompleteBox,module.exports=exports.default},{"../mixins/FieldWithChoices":16,"../mixins/FormMixin":17,"material-ui":"material-ui",pydio:"pydio",react:"react"}],2:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),React=require("react"),debounce=require("lodash.debounce"),_require=require("material-ui"),AutoComplete=_require.AutoComplete,MenuItem=_require.MenuItem,RefreshIndicator=_require.RefreshIndicator,FontIcon=_require.FontIcon,AutocompleteTree=React.createClass({displayName:"AutocompleteTree",mixins:[_mixinsFormMixin2.default],handleUpdateInput:function(searchText){this.debounced(),this.setState({searchText:searchText})},handleNewRequest:function(chosenValue){var key=void 0;key=void 0!==chosenValue.key?chosenValue.key:chosenValue,this.onChange(null,key),this.loadValues(key)},componentWillMount:function(){this.debounced=debounce(this.loadValues.bind(this),300),this.lastSearch=null;var value="";this.props.value&&(value=this.props.value),this.loadValues(value)},loadValues:function(){var value=arguments.length<=0||void 0===arguments[0]?"":arguments[0],basePath=value;if(!value&&this.state.searchText){var last=this.state.searchText.lastIndexOf("/");basePath=this.state.searchText.substr(0,last)}null!==this.lastSearch&&this.lastSearch===basePath||(this.lastSearch=basePath)},render:function(){var dataSource=[];this.state&&this.state.nodes&&this.state.nodes.forEach(function(node){var icon="mdi mdi-folder";node.uuid.startsWith("DATASOURCE:")&&(icon="mdi mdi-database"),dataSource.push({key:node.path,text:node.path,value:React.createElement(MenuItem,null,React.createElement(FontIcon,{className:icon,color:"#616161",style:{float:"left",marginRight:8}})," ",node.path)})});var displayText=this.state.value;return React.createElement("div",{className:"pydioform_autocomplete",style:{position:"relative"}},!dataSource.length&&React.createElement(RefreshIndicator,{size:30,right:10,top:0,status:"loading"}),React.createElement(AutoComplete,{fullWidth:!0,searchText:displayText,onUpdateInput:this.handleUpdateInput,onNewRequest:this.handleNewRequest,dataSource:dataSource,floatingLabelText:this.props.attributes.label,filter:function(searchText,key){return 0===key.toLowerCase().indexOf(searchText.toLowerCase())},openOnFocus:!0,menuProps:{maxHeight:200}}))}});exports.default=AutocompleteTree,module.exports=exports.default},{"../mixins/FormMixin":17,"lodash.debounce":"lodash.debounce","material-ui":"material-ui",react:"react"}],3:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},React=require("react");exports.default=React.createClass({displayName:"FileDropzone",getDefaultProps:function(){return{supportClick:!0,multiple:!0,onDrop:function(){}}},getInitialState:function(){return{isDragActive:!1}},propTypes:{onDrop:React.PropTypes.func.isRequired,ignoreNativeDrop:React.PropTypes.bool,size:React.PropTypes.number,style:React.PropTypes.object,dragActiveStyle:React.PropTypes.object,supportClick:React.PropTypes.bool,accept:React.PropTypes.string,multiple:React.PropTypes.bool},onDragLeave:function(e){this.setState({isDragActive:!1})},onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",this.setState({isDragActive:!0})},onFilePicked:function(e){if(e.target&&e.target.files){var files=e.target.files,maxFiles=this.props.multiple?files.length:1;files=Array.prototype.slice.call(files,0,maxFiles),this.props.onDrop&&this.props.onDrop(files,e,this)}},onFolderPicked:function(e){this.props.onFolderPicked&&this.props.onFolderPicked(e.target.files)},onDrop:function(e){if(this.setState({isDragActive:!1}),e.preventDefault(),!this.props.ignoreNativeDrop){var files=void 0;e.dataTransfer?files=e.dataTransfer.files:e.target&&(files=e.target.files);for(var maxFiles=this.props.multiple?files.length:1,i=0;i<maxFiles;i++)files[i].preview=URL.createObjectURL(files[i]);this.props.onDrop&&(files=Array.prototype.slice.call(files,0,maxFiles),this.props.onDrop(files,e,this))}},onClick:function(){!0===this.props.supportClick&&this.open()},open:function(){this.refs.fileInput.click()},openFolderPicker:function(){this.refs.folderInput.setAttribute("webkitdirectory","true"),this.refs.folderInput.click()},render:function(){var className=this.props.className||"file-dropzone";this.state.isDragActive&&(className+=" active");var style={width:this.props.size||100,height:this.props.size||100};this.props.style&&(style=_extends({},style,this.props.style)),this.state.isDragActive&&this.props.dragActiveStyle&&(style=_extends({},style,this.props.dragActiveStyle));var folderInput=void 0;return this.props.enableFolders&&(folderInput=React.createElement("input",{style:{display:"none"},name:"userfolder",type:"file",ref:"folderInput",onChange:this.onFolderPicked})),React.createElement("div",{className:className,style:style,onClick:this.onClick,onDragLeave:this.onDragLeave,onDragOver:this.onDragOver,onDrop:this.onDrop},React.createElement("input",{style:{display:"none"},name:"userfile",type:"file",multiple:this.props.multiple,ref:"fileInput",value:"",onChange:this.onFilePicked,accept:this.props.accept}),folderInput,this.props.children)}}),module.exports=exports.default},{react:"react"}],4:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_react=require("react"),_react2=_interopRequireDefault(_react),_mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_materialUi=require("material-ui"),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernStyles=_Pydio$requireLib.ModernStyles;exports.default=_react2.default.createClass({displayName:"InputBoolean",mixins:[_mixinsFormMixin2.default],getDefaultProps:function(){return{skipBufferChanges:!0}},onCheck:function(event,newValue){this.props.onChange(newValue,this.state.value),this.setState({dirty:!0,value:newValue})},getBooleanState:function(){var boolVal=this.state.value;return"string"==typeof boolVal&&(boolVal="true"===boolVal),boolVal},render:function(){var boolVal=this.getBooleanState();return _react2.default.createElement("span",null,_react2.default.createElement(_materialUi.Toggle,_extends({toggled:boolVal,onToggle:this.onCheck,disabled:this.props.disabled,label:this.isDisplayForm()?this.props.attributes.label:null,labelPosition:this.isDisplayForm()?"left":"right"},ModernStyles.toggleField)))}}),module.exports=exports.default},{"../mixins/FormMixin":17,"material-ui":"material-ui",pydio:"pydio",react:"react"}],5:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _mixinsActionRunnerMixin=require("../mixins/ActionRunnerMixin"),_mixinsActionRunnerMixin2=_interopRequireDefault(_mixinsActionRunnerMixin),React=require("react"),_require=require("material-ui"),RaisedButton=_require.RaisedButton;exports.default=React.createClass({displayName:"InputButton",mixins:[_mixinsActionRunnerMixin2.default],applyButton:function(){var callback=this.props.actionCallback;callback||(callback=function(transport){transport.responseText.startsWith("SUCCESS:")?global.pydio.displayMessage("SUCCESS",transport.responseText.replace("SUCCESS:","")):global.pydio.displayMessage("ERROR",transport.responseText.replace("ERROR:",""))}),this.applyAction(callback)},render:function(){return React.createElement(RaisedButton,{label:this.props.attributes.label,onTouchTap:this.applyButton,disabled:this.props.disabled})}}),module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/ActionRunnerMixin":15,"material-ui":"material-ui",react:"react"}],6:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_pydioHttpApi=require("pydio/http/api"),_pydioHttpApi2=_interopRequireDefault(_pydioHttpApi),_mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_FileDropzone=require("./FileDropzone"),_FileDropzone2=_interopRequireDefault(_FileDropzone),_pydioUtilLang=require("pydio/util/lang"),_pydioUtilLang2=_interopRequireDefault(_pydioUtilLang),_materialUi=require("material-ui"),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),NativeFileDropProvider=_Pydio$requireLib.NativeFileDropProvider,BinaryDropZone=NativeFileDropProvider(_FileDropzone2.default,function(items,files,props){});exports.default=_react2.default.createClass({displayName:"InputImage",mixins:[_mixinsFormMixin2.default],propTypes:{attributes:_react2.default.PropTypes.object,binary_context:_react2.default.PropTypes.string},componentWillReceiveProps:function(newProps){var imgSrc=void 0;(newProps.value||newProps.binary_context&&newProps.binary_context!==this.props.binary_context)&&!this.state.reset?imgSrc=this.getBinaryUrl(newProps,this.state.temporaryBinary&&this.state.temporaryBinary===newProps.value):newProps.attributes.defaultImage&&(imgSrc=newProps.attributes.defaultImage),imgSrc&&this.setState({imageSrc:imgSrc,reset:!1})},getInitialState:function(){var imgSrc=void 0,originalBinary=void 0;return this.props.value?(imgSrc=this.getBinaryUrl(this.props),originalBinary=this.props.value):this.props.attributes.defaultImage&&(imgSrc=this.props.attributes.defaultImage),{imageSrc:imgSrc,originalBinary:originalBinary}},getBinaryUrl:function(props){var pydio=_pydioHttpApi2.default.getClient().getPydioObject(),url=pydio.Parameters.get("ENDPOINT_REST_API")+props.attributes.loadAction,bId=props.value;return props.binary_context&&0===props.binary_context.indexOf("user_id=")&&(bId=props.binary_context.replace("user_id=","")),url=url.replace("{BINARY}",bId)},getUploadUrl:function(){var pydio=_pydioHttpApi2.default.getClient().getPydioObject(),url=pydio.Parameters.get("ENDPOINT_REST_API")+this.props.attributes.uploadAction,bId="";return bId=this.props.binary_context&&0===this.props.binary_context.indexOf("user_id=")?this.props.binary_context.replace("user_id=",""):this.props.value?this.props.value:_pydioUtilLang2.default.computeStringSlug(this.props.attributes.name+".png"),url=url.replace("{BINARY}",bId)},uploadComplete:function(newBinaryName){var prevValue=this.state.value;if(this.setState({temporaryBinary:newBinaryName,value:null}),this.props.onChange){var additionalFormData={type:"binary"};this.state.originalBinary&&(additionalFormData.original_binary=this.state.originalBinary),this.props.onChange(newBinaryName,prevValue,additionalFormData)}},htmlUpload:function(){window.formManagerHiddenIFrameSubmission=function(result){this.uploadComplete(result.trim()),window.formManagerHiddenIFrameSubmission=null}.bind(this),this.refs.uploadForm.submit()},onDrop:function(files,event,dropzone){var _this=this;if(0!==files.length){var messages=_pydio2.default.getMessages();if("avatar"===this.props.name&&files[0].size>5242880)return void this.setState({error:messages["form.input-image.avatarMax"]});if(-1===["image/jpeg","image/png","image/bmp","image/tiff","image/webp"].indexOf(files[0].type))return void this.setState({error:messages["form.input-image.fileTypes"]});this.setState({error:null}),_pydioHttpApi2.default.supportsUpload()?(this.setState({loading:!0}),_pydioHttpApi2.default.getRestClient().getOrUpdateJwt().then(function(jwt){var xhrSettings={customHeaders:{Authorization:"Bearer "+jwt}};_pydioHttpApi2.default.getClient().uploadFile(files[0],"userfile","",function(transport){var result=JSON.parse(transport.responseText);result&&result.binary&&_this.uploadComplete(result.binary),_this.setState({loading:!1})},function(error){_this.setState({loading:!1,error:error})},function(computableEvent){},_this.getUploadUrl(),xhrSettings)})):this.htmlUpload()}},clearImage:function(){var _this2=this;global.confirm(_pydio2.default.getMessages()["form.input-image.clearConfirm"])&&function(){var prevValue=_this2.state.value;_this2.setState({value:null,error:null,reset:!0},function(){this.props.onChange("",prevValue,{type:"binary"})}.bind(_this2))}()},render:function(){var _this3=this,_state=this.state,loading=_state.loading,error=_state.error,coverImageStyle={backgroundImage:"url("+this.state.imageSrc+")",backgroundPosition:"50% 50%",backgroundSize:"cover",position:"relative"},overlay=void 0,overlayBg={};if(error)overlayBg={backgroundColor:"rgba(255, 255, 255, 0.77)",borderRadius:"50%"},overlay=_react2.default.createElement("div",{style:{color:"#F44336",textAlign:"center",fontSize:11,cursor:"pointer"},onClick:function(){_this3.setState({error:null})}},_react2.default.createElement("span",{className:"mdi mdi-alert",style:{fontSize:40}}),_react2.default.createElement("br",null),error);else if(loading)overlay=_react2.default.createElement(_materialUi.CircularProgress,{mode:"indeterminate"});else{var isDefault=this.props.attributes.defaultImage&&this.props.attributes.defaultImage===this.state.imageSrc;overlay=_react2.default.createElement("span",{className:"mdi mdi-camera",style:{fontSize:40,opacity:.5,color:isDefault?null:"white"}})}return _react2.default.createElement("div",null,_react2.default.createElement("div",{className:"image-label"},this.props.attributes.label),_react2.default.createElement("form",{ref:"uploadForm",encType:"multipart/form-data",target:"uploader_hidden_iframe",method:"post",action:this.getUploadUrl()},_react2.default.createElement(BinaryDropZone,{onDrop:this.onDrop,accept:"image/*",style:coverImageStyle},_react2.default.createElement("div",{style:_extends({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},overlayBg)},overlay))),_react2.default.createElement("div",{className:"binary-remove-button",onClick:this.clearImage},_react2.default.createElement("span",{key:"remove",className:"mdi mdi-close"})," ",_pydio2.default.getMessages()["form.input-image.clearButton"]),_react2.default.createElement("iframe",{style:{display:"none"},id:"uploader_hidden_iframe",name:"uploader_hidden_iframe"}))}}),module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/FormMixin":17,"./FileDropzone":3,"material-ui":"material-ui",pydio:"pydio","pydio/http/api":"pydio/http/api","pydio/util/lang":"pydio/util/lang",react:"react"}],7:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernTextField=_Pydio$requireLib.ModernTextField;exports.default=_react2.default.createClass({displayName:"InputInteger",mixins:[_mixinsFormMixin2.default],keyDown:function(event){var inc=0,multiple=1;if("Enter"==event.key)return void this.toggleEditMode();"ArrowUp"==event.key?inc=1:"ArrowDown"==event.key&&(inc=-1),event.shiftKey&&(multiple=10);var parsed=parseInt(this.state.value);isNaN(parsed)&&(parsed=0);var value=parsed+inc*multiple;this.onChange(null,value)},render:function(){if(this.isDisplayGrid()&&!this.state.editMode){var value=this.state.value;return _react2.default.createElement("div",{onClick:this.props.disabled?function(){}:this.toggleEditMode,className:value?"":"paramValue-empty"},value||"Empty")}var intval=void 0;return this.state.value?(intval=parseInt(this.state.value)+"",isNaN(intval)&&(intval=this.state.value+"")):intval="0",_react2.default.createElement("span",{className:"integer-input"},_react2.default.createElement(ModernTextField,{value:intval,onChange:this.onChange,onKeyDown:this.keyDown,disabled:this.props.disabled,fullWidth:!0,hintText:this.isDisplayForm()?this.props.attributes.label:null}))}}),module.exports=exports.default},{"../mixins/FormMixin":17,pydio:"pydio",react:"react"}],8:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_mixinsFieldWithChoices=require("../mixins/FieldWithChoices"),_mixinsFieldWithChoices2=_interopRequireDefault(_mixinsFieldWithChoices),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),React=require("react"),_require=require("material-ui"),MenuItem=(_require.SelectField,_require.MenuItem),Chip=_require.Chip,LangUtils=require("pydio/util/lang"),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernSelectField=_Pydio$requireLib.ModernSelectField,InputSelectBox=React.createClass({displayName:"InputSelectBox",mixins:[_mixinsFormMixin2.default],getDefaultProps:function(){return{skipBufferChanges:!0}},onDropDownChange:function(event,index,value){this.onChange(event,value),this.toggleEditMode()},onMultipleSelect:function(event,index,newValue){if(-1!=newValue){var currentValue=this.state.value,currentValues="string"==typeof currentValue?currentValue.split(","):currentValue;-1!==!currentValues.indexOf(newValue)&&(currentValues.push(newValue),this.onChange(event,currentValues.join(","))),this.toggleEditMode()}},onMultipleRemove:function(value){var currentValue=this.state.value,currentValues="string"==typeof currentValue?currentValue.split(","):currentValue;-1!==currentValues.indexOf(value)&&(currentValues=LangUtils.arrayWithout(currentValues,currentValues.indexOf(value)),this.onChange(null,currentValues.join(",")))},render:function(){var _this=this,currentValue=this.state.value,menuItems=[],multipleOptions=[];this.props.attributes.mandatory&&"true"==this.props.attributes.mandatory||(!1,menuItems.push(React.createElement(MenuItem,{value:-1,primaryText:this.props.attributes.label+"..."})));var choices=this.props.choices;if(choices.forEach(function(value,key){menuItems.push(React.createElement(MenuItem,{value:key,primaryText:value})),multipleOptions.push({value:key,label:value})}),this.isDisplayGrid()&&!this.state.editMode||this.props.disabled){var value=this.state.value;return choices.get(value)&&(value=choices.get(value)),React.createElement("div",{onClick:this.props.disabled?function(){}:this.toggleEditMode,className:value?"":"paramValue-empty"},value||"Empty","   ",React.createElement("span",{className:"icon-caret-down"}))}if(this.props.multiple&&1==this.props.multiple){var currentValues=currentValue;return"string"==typeof currentValue&&(currentValues=currentValue.split(",")),!!currentValues.length,React.createElement("span",{className:"multiple has-value"},React.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},currentValues.map(function(v){return React.createElement(Chip,{onRequestDelete:function(){_this.onMultipleRemove(v)}},v)})),React.createElement(ModernSelectField,{value:-1,onChange:this.onMultipleSelect,fullWidth:!0,className:this.props.className},menuItems))}return React.createElement("span",null,React.createElement(ModernSelectField,{hintText:this.props.attributes.label,value:currentValue,onChange:this.onDropDownChange,fullWidth:!0,className:this.props.className},menuItems))}});exports.default=InputSelectBox=_mixinsFieldWithChoices2.default(InputSelectBox),exports.default=InputSelectBox,module.exports=exports.default},{"../mixins/FieldWithChoices":16,"../mixins/FormMixin":17,"material-ui":"material-ui",pydio:"pydio","pydio/util/lang":"pydio/util/lang",react:"react"}],9:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _mixinsActionRunnerMixin=require("../mixins/ActionRunnerMixin"),_mixinsActionRunnerMixin2=_interopRequireDefault(_mixinsActionRunnerMixin),React=require("react");exports.default=React.createClass({displayName:"MonitoringLabel",mixins:[_mixinsActionRunnerMixin2.default],getInitialState:function(){var loadingMessage="Loading";return this.context&&this.context.getMessage?loadingMessage=this.context.getMessage(466,""):global.pydio&&global.pydio.MessageHash&&(loadingMessage=global.pydio.MessageHash[466]),{status:loadingMessage}},componentDidMount:function(){var callback=function(transport){this.setState({status:transport.responseText})}.bind(this);this._poller=function(){this.applyAction(callback)}.bind(this),this._poller(),this._pe=global.setInterval(this._poller,1e4)},componentWillUnmount:function(){this._pe&&global.clearInterval(this._pe)},render:function(){return React.createElement("div",null,this.state.status)}}),module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/ActionRunnerMixin":15,react:"react"}],10:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_pydio=(require("material-ui"),require("pydio")),_pydio2=_interopRequireDefault(_pydio),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernTextField=_Pydio$requireLib.ModernTextField;exports.default=_react2.default.createClass({displayName:"TextField",mixins:[_mixinsFormMixin2.default],render:function(){if(this.isDisplayGrid()&&!this.state.editMode){var value=this.state.value;return value="password"===this.props.attributes.type&&value?"***********":this.state.value,_react2.default.createElement("div",{onClick:this.props.disabled?function(){}:this.toggleEditMode,className:value?"":"paramValue-empty"},value||"Empty")}var field=_react2.default.createElement(ModernTextField,{hintText:this.isDisplayForm()?this.props.attributes.label:null,value:this.state.value||"",onChange:this.onChange,onKeyDown:this.enterToToggle,type:"password"===this.props.attributes.type?"password":null,multiLine:"textarea"===this.props.attributes.type,disabled:this.props.disabled,errorText:this.props.errorText,autoComplete:"off",fullWidth:!0});return"password"===this.props.attributes.type?_react2.default.createElement("form",{autoComplete:"off",onSubmit:function(e){e.stopPropagation(),e.preventDefault()},style:{display:"inline"}},field):_react2.default.createElement("span",null,field)}}),module.exports=exports.default},{"../mixins/FormMixin":17,"material-ui":"material-ui",pydio:"pydio",react:"react"}],11:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_pydioUtilPass=require("pydio/util/pass"),_pydioUtilPass2=_interopRequireDefault(_pydioUtilPass),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernTextField=_Pydio$requireLib.ModernTextField;exports.default=_react2.default.createClass({displayName:"ValidLogin",mixins:[_mixinsFormMixin2.default],textValueChanged:function(event,value){var err=_pydioUtilPass2.default.isValidLogin(value),prevStateValid=this.state.valid,valid=!err;prevStateValid!==valid&&this.props.onValidStatusChange&&this.props.onValidStatusChange(valid),this.setState({valid:valid,err:err}),this.onChange(event,value)},render:function(){var _this=this;if(this.isDisplayGrid()&&!this.state.editMode){var value=this.state.value;return value="password"===this.props.attributes.type&&value?"***********":this.state.value,_react2.default.createElement("div",{onClick:this.props.disabled?function(){}:this.toggleEditMode,className:value?"":"paramValue-empty"},value||"Empty")}var err=this.state.err,field=_react2.default.createElement(ModernTextField,{floatingLabelText:this.isDisplayForm()?this.props.attributes.label:null,value:this.state.value||"",onChange:function(e,v){return _this.textValueChanged(e,v)},onKeyDown:this.enterToToggle,type:"password"===this.props.attributes.type?"password":null,multiLine:"textarea"===this.props.attributes.type,disabled:this.props.disabled,errorText:this.props.errorText||err,autoComplete:"off",fullWidth:!0});return"password"===this.props.attributes.type?_react2.default.createElement("form",{autoComplete:"off",onSubmit:function(e){e.stopPropagation(),e.preventDefault()},style:{display:"inline"}},field):_react2.default.createElement("span",null,field)}}),module.exports=exports.default},{"../mixins/FormMixin":17,pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],12:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_pydio=require("pydio"),_pydio2=_interopRequireDefault(_pydio),_pydioUtilPass=require("pydio/util/pass"),_pydioUtilPass2=_interopRequireDefault(_pydioUtilPass),_mixinsFormMixin=require("../mixins/FormMixin"),_mixinsFormMixin2=_interopRequireDefault(_mixinsFormMixin),_materialUi=require("material-ui"),_Pydio$requireLib=_pydio2.default.requireLib("hoc"),ModernTextField=_Pydio$requireLib.ModernTextField;exports.default=_react2.default.createClass({displayName:"ValidPassword",mixins:[_mixinsFormMixin2.default],isValid:function(){return this.state.valid},checkMinLength:function(value){var minLength=parseInt(global.pydio.getPluginConfigs("core.auth").get("PASSWORD_MINLENGTH"));return!(value&&value.length<minLength)},getMessage:function(messageId){return this.context&&this.context.getMessage?this.context.getMessage(messageId,""):global.pydio&&global.pydio.MessageHash?global.pydio.MessageHash[messageId]:void 0},updatePassState:function(){var prevStateValid=this.state.valid,newState=_pydioUtilPass2.default.getState(this.refs.pass.getValue(),this.refs.confirm?this.refs.confirm.getValue():"");this.setState(newState),prevStateValid!==newState.valid&&this.props.onValidStatusChange&&this.props.onValidStatusChange(newState.valid)},onPasswordChange:function(event){this.updatePassState(),this.onChange(event,event.target.value)},onConfirmChange:function(event){this.setState({confirmValue:event.target.value}),this.updatePassState(),this.onChange(event,this.state.value)},render:function(){var _props=this.props,disabled=_props.disabled,className=_props.className,attributes=_props.attributes,dialogField=_props.dialogField;if(this.isDisplayGrid()&&!this.state.editMode){var value=this.state.value;return _react2.default.createElement("div",{onClick:disabled?function(){}:this.toggleEditMode,className:value?"":"paramValue-empty"},value||"Empty")}var overflow={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",width:"100%"},cName=this.state.valid?"":"mui-error-as-hint";className&&(cName=className+" "+cName);var _confirm=void 0,TextComponent=dialogField?_materialUi.TextField:ModernTextField;return this.state.value&&!disabled&&(_confirm=[_react2.default.createElement("div",{key:"sep",style:{width:8}}),_react2.default.createElement(TextComponent,{key:"confirm",ref:"confirm",floatingLabelText:this.getMessage(199),floatingLabelShrinkStyle:_extends({},overflow,{width:"130%"}),
floatingLabelStyle:overflow,className:cName,value:this.state.confirmValue,onChange:this.onConfirmChange,type:"password",multiLine:!1,disabled:disabled,fullWidth:!0,style:{flex:1},errorText:this.state.confirmErrorText,errorStyle:dialogField?{bottom:-5}:null})]),_react2.default.createElement("form",{autoComplete:"off",onSubmit:function(e){e.stopPropagation(),e.preventDefault()}},_react2.default.createElement("div",{style:{display:"flex"}},_react2.default.createElement(TextComponent,{ref:"pass",floatingLabelText:this.isDisplayForm()?attributes.label:null,floatingLabelShrinkStyle:_extends({},overflow,{width:"130%"}),floatingLabelStyle:overflow,className:cName,value:this.state.value,onChange:this.onPasswordChange,onKeyDown:this.enterToToggle,type:"password",multiLine:!1,disabled:disabled,errorText:this.state.passErrorText,fullWidth:!0,style:{flex:1},errorStyle:dialogField?{bottom:-5}:null}),_confirm))}}),module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../mixins/FormMixin":17,"material-ui":"material-ui",pydio:"pydio","pydio/util/pass":"pydio/util/pass",react:"react"}],13:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _mixinsHelperMixin=require("./mixins/HelperMixin"),_mixinsHelperMixin2=_interopRequireDefault(_mixinsHelperMixin),_managerManager=require("./manager/Manager"),_managerManager2=_interopRequireDefault(_managerManager),_fieldsTextField=require("./fields/TextField"),_fieldsTextField2=_interopRequireDefault(_fieldsTextField),_fieldsValidPassword=require("./fields/ValidPassword"),_fieldsValidPassword2=_interopRequireDefault(_fieldsValidPassword),_fieldsInputInteger=require("./fields/InputInteger"),_fieldsInputInteger2=_interopRequireDefault(_fieldsInputInteger),_fieldsInputBoolean=require("./fields/InputBoolean"),_fieldsInputBoolean2=_interopRequireDefault(_fieldsInputBoolean),_fieldsInputButton=require("./fields/InputButton"),_fieldsInputButton2=_interopRequireDefault(_fieldsInputButton),_fieldsMonitoringLabel=require("./fields/MonitoringLabel"),_fieldsMonitoringLabel2=_interopRequireDefault(_fieldsMonitoringLabel),_fieldsInputSelectBox=require("./fields/InputSelectBox"),_fieldsInputSelectBox2=_interopRequireDefault(_fieldsInputSelectBox),_fieldsAutocompleteBox=require("./fields/AutocompleteBox"),_fieldsAutocompleteBox2=_interopRequireDefault(_fieldsAutocompleteBox),_fieldsInputImage=require("./fields/InputImage"),_fieldsInputImage2=_interopRequireDefault(_fieldsInputImage),_panelFormPanel=require("./panel/FormPanel"),_panelFormPanel2=_interopRequireDefault(_panelFormPanel),_panelFormHelper=require("./panel/FormHelper"),_panelFormHelper2=_interopRequireDefault(_panelFormHelper),_fieldsFileDropzone=require("./fields/FileDropzone"),_fieldsFileDropzone2=_interopRequireDefault(_fieldsFileDropzone),_fieldsAutocompleteTree=require("./fields/AutocompleteTree"),_fieldsAutocompleteTree2=_interopRequireDefault(_fieldsAutocompleteTree),PydioForm={HelperMixin:_mixinsHelperMixin2.default,Manager:_managerManager2.default,InputText:_fieldsTextField2.default,ValidPassword:_fieldsValidPassword2.default,InputBoolean:_fieldsInputBoolean2.default,InputInteger:_fieldsInputInteger2.default,InputButton:_fieldsInputButton2.default,MonitoringLabel:_fieldsMonitoringLabel2.default,InputSelectBox:_fieldsInputSelectBox2.default,AutocompleteBox:_fieldsAutocompleteBox2.default,AutocompleteTree:_fieldsAutocompleteTree2.default,InputImage:_fieldsInputImage2.default,FormPanel:_panelFormPanel2.default,PydioHelper:_panelFormHelper2.default,FileDropZone:_fieldsFileDropzone2.default,createFormElement:_managerManager2.default.createFormElement};exports.default=PydioForm,module.exports=exports.default},{"./fields/AutocompleteBox":1,"./fields/AutocompleteTree":2,"./fields/FileDropzone":3,"./fields/InputBoolean":4,"./fields/InputButton":5,"./fields/InputImage":6,"./fields/InputInteger":7,"./fields/InputSelectBox":8,"./fields/MonitoringLabel":9,"./fields/TextField":10,"./fields/ValidPassword":12,"./manager/Manager":14,"./mixins/HelperMixin":18,"./panel/FormHelper":19,"./panel/FormPanel":20}],14:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _fieldsValidLogin=require("../fields/ValidLogin"),_fieldsValidLogin2=_interopRequireDefault(_fieldsValidLogin),XMLUtils=require("pydio/util/xml"),InputBoolean=require("./../fields/InputBoolean"),InputText=require("./../fields/TextField"),ValidPassword=require("./../fields/ValidPassword"),InputInteger=require("./../fields/InputInteger"),InputButton=require("./../fields/InputButton"),MonitoringLabel=require("./../fields/MonitoringLabel"),InputImage=require("./../fields/InputImage"),SelectBox=require("./../fields/InputSelectBox"),AutocompleteBox=require("./../fields/AutocompleteBox"),AutocompleteTree=require("./../fields/AutocompleteTree"),Manager=function(){function Manager(){_classCallCheck(this,Manager)}return Manager.hasHelper=function(pluginId,paramName){var helpers=Manager.getHelpersCache();return helpers[pluginId]&&helpers[pluginId].parameters[paramName]},Manager.getHelpersCache=function(){if(!Manager.HELPERS_CACHE){for(var helperCache={},helpers=XMLUtils.XPathSelectNodes(window.pydio.Registry.getXML(),'plugins/*/client_settings/resources/js[@type="helper"]'),i=0;i<helpers.length;i++){var helperNode=helpers[i],plugin=helperNode.getAttribute("plugin");helperCache[plugin]={namespace:helperNode.getAttribute("className"),parameters:{}};for(var paramNodes=XMLUtils.XPathSelectNodes(helperNode,"parameter"),k=0;k<paramNodes.length;k++){var paramNode=paramNodes[k];helperCache[plugin].parameters[paramNode.getAttribute("name")]=!0}}Manager.HELPERS_CACHE=helperCache}return Manager.HELPERS_CACHE},Manager.parseParameters=function(xmlDocument,query){return XMLUtils.XPathSelectNodes(xmlDocument,query).map(function(node){return Manager.parameterNodeToHash(node)}.bind(this))},Manager.parameterNodeToHash=function(paramNode){var paramsAtts=paramNode.attributes,paramsObject={};paramNode.parentNode&&paramNode.parentNode.parentNode&&paramNode.parentNode.parentNode.getAttribute&&(paramsObject.pluginId=paramNode.parentNode.parentNode.getAttribute("id"));for(var collectCdata=!1,MessageHash=global.pydio.MessageHash,i=0;i<paramsAtts.length;i++){var attName=paramsAtts.item(i).nodeName,value=paramsAtts.item(i).value;"label"!==attName&&"description"!==attName&&"group"!==attName&&0!==attName.indexOf("group_switch_")||!MessageHash[value]||(value=MessageHash[value]),"cdatavalue"!==attName?paramsObject[attName]=value:collectCdata=!0}return collectCdata&&(paramsObject.value=paramNode.firstChild.value),"boolean"===paramsObject.type?(void 0!==paramsObject.value&&(paramsObject.value="true"===paramsObject.value),void 0!==paramsObject.default&&(paramsObject.default="true"===paramsObject.default)):"integer"===paramsObject.type&&(void 0!==paramsObject.value&&(paramsObject.value=parseInt(paramsObject.value)),void 0!==paramsObject.default&&(paramsObject.default=parseInt(paramsObject.default))),paramsObject},Manager.createFormElement=function(props){var value=void 0;switch(props.attributes.type){case"boolean":value=React.createElement(InputBoolean,props);break;case"string":case"textarea":case"password":value=React.createElement(InputText,props);break;case"valid-password":value=React.createElement(ValidPassword,props);break;case"valid-login":value=React.createElement(_fieldsValidLogin2.default,props);break;case"integer":value=React.createElement(InputInteger,props);break;case"button":value=React.createElement(InputButton,props);break;case"monitor":value=React.createElement(MonitoringLabel,props);break;case"image":value=React.createElement(InputImage,props);break;case"select":value=React.createElement(SelectBox,props);break;case"autocomplete":value=React.createElement(AutocompleteBox,props);break;case"autocomplete-tree":value=React.createElement(AutocompleteTree,props);break;case"legend":case"hidden":value=null;break;default:value=props.value?props.value:React.createElement("span",{className:"paramValue-empty"},"Empty")}return value},Manager.SlashesToJson=function(values){if(void 0===values||"object"!=typeof values)return values;var newValues={},recurseOnKeys={};return Object.keys(values).forEach(function(k){var data=values[k];if(k.indexOf("/")>0){var parts=k.split("/"),firstPart=parts.shift(),lastPart=parts.join("/");newValues[firstPart]?"string"==typeof newValues[firstPart]&&(newValues[firstPart]={"@value":newValues[firstPart]}):newValues[firstPart]={},newValues[firstPart][lastPart]=data,recurseOnKeys[firstPart]=firstPart}else newValues[k]&&"object"==typeof newValues[k]?newValues[k]["@value"]=data:newValues[k]=data}),Object.keys(recurseOnKeys).map(function(key){newValues[key]=Manager.SlashesToJson(newValues[key])}),newValues},Manager.JsonToSlashes=function(values){var prefix=arguments.length<=1||void 0===arguments[1]?"":arguments[1],newValues={};return Object.keys(values).forEach(function(k){if("object"==typeof values[k]){var subValues=Manager.JsonToSlashes(values[k],prefix+k+"/");newValues=_extends({},newValues,subValues),values[k]["@value"]&&(newValues[prefix+k]=values[k]["@value"])}else newValues[prefix+k]=values[k]}),newValues},Manager.getValuesForPOST=function(definitions,values){var prefix=arguments.length<=2||void 0===arguments[2]?"DRIVER_OPTION_":arguments[2],additionalMetadata=arguments.length<=3||void 0===arguments[3]?null:arguments[3],clientParams={};for(var key in values)if(values.hasOwnProperty(key)){clientParams[prefix+key]=values[key];for(var defType=null,d=0;d<definitions.length;d++)if(definitions[d].name==key){defType=definitions[d].type;break}if(!defType){var last,prev,parts=key.split("/");parts.length>1&&(last=parts.pop(),prev=parts.pop());for(var k=0;k<definitions.length;k++)if(void 0!==last){if(definitions[k].name==last&&definitions[k].group_switch_name&&definitions[k].group_switch_name==prev){defType=definitions[k].type;break}}else if(definitions[k].name==key){defType=definitions[k].type;break}}if(defType&&("image"==defType&&(defType="binary"),clientParams[prefix+key+"_ajxptype"]=defType),additionalMetadata&&additionalMetadata[key])for(var meta in additionalMetadata[key])additionalMetadata[key].hasOwnProperty(meta)&&(clientParams[prefix+key+"_"+meta]=additionalMetadata[key][meta])}var allKeys=Object.keys(clientParams);allKeys.sort(),allKeys.reverse();var treeKeys={};allKeys.map(function(key){if(-1!==key.indexOf("/")&&!key.endsWith("_ajxptype")){for(var parentKey,typeKey=key+"_ajxptype",parts=key.split("/"),parentName=parts.shift();parts.length>0;)parentKey||(parentKey=treeKeys),parentKey[parentName]||(parentKey[parentName]={}),parentKey=parentKey[parentName],parentName=parts.shift();var type=clientParams[typeKey];if(delete clientParams[typeKey],parentKey&&!parentKey[parentName])if("boolean"==type){var v=clientParams[key];parentKey[parentName]="true"==v||1==v||!0===v}else"integer"==type?parentKey[parentName]=parseInt(clientParams[key]):type&&type.startsWith("group_switch:")&&"string"==typeof clientParams[key]?parentKey[parentName]={group_switch_value:clientParams[key]}:parentKey[parentName]=clientParams[key];else parentKey&&type&&type.startsWith("group_switch:")&&(parentKey[parentName].group_switch_value=clientParams[key]);delete clientParams[key]}});for(key in treeKeys)if(treeKeys.hasOwnProperty(key)){var treeValue=treeKeys[key];clientParams[key+"_ajxptype"]&&0===clientParams[key+"_ajxptype"].indexOf("group_switch:")&&!treeValue.group_switch_value&&(treeValue.group_switch_value=clientParams[key]),clientParams[key]=JSON.stringify(treeValue),clientParams[key+"_ajxptype"]="text/json"}for(var theKey in clientParams)clientParams.hasOwnProperty(theKey)&&(-1==theKey.indexOf("/")&&clientParams[theKey]&&clientParams[theKey+"_ajxptype"]&&clientParams[theKey+"_ajxptype"].startsWith("group_switch:")&&"string"==typeof clientParams[theKey]&&(clientParams[theKey]=JSON.stringify({group_switch_value:clientParams[theKey]}),clientParams[theKey+"_ajxptype"]="text/json"),clientParams.hasOwnProperty(theKey)&&theKey.endsWith("_group_switch")&&delete clientParams[theKey]);return clientParams},Manager}();exports.default=Manager,module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../fields/ValidLogin":11,"./../fields/AutocompleteBox":1,"./../fields/AutocompleteTree":2,"./../fields/InputBoolean":4,"./../fields/InputButton":5,"./../fields/InputImage":6,"./../fields/InputInteger":7,"./../fields/InputSelectBox":8,"./../fields/MonitoringLabel":9,"./../fields/TextField":10,"./../fields/ValidPassword":12,"pydio/util/xml":"pydio/util/xml"}],15:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var React=require("react"),PathUtils=require("pydio/util/path");exports.default={propTypes:{attributes:React.PropTypes.object.isRequired,applyButtonAction:React.PropTypes.func,actionCallback:React.PropTypes.func},applyAction:function(callback){var choicesValue=this.props.attributes.choices.split(":"),firstPart=choicesValue.shift();if("run_client_action"===firstPart&&global.pydio)return void global.pydio.getController().fireAction(choicesValue.shift());if(this.props.applyButtonAction){var parameters={action:firstPart};choicesValue.length>1&&(parameters.action_plugin_id=choicesValue.shift(),parameters.action_plugin_method=choicesValue.shift()),-1!==this.props.attributes.name.indexOf("/")&&(parameters.button_key=PathUtils.getDirname(this.props.attributes.name)),this.props.applyButtonAction(parameters,callback)}}},module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pydio/util/path":"pydio/util/path",react:"react"}],16:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _require=require("react"),Component=_require.Component,_require$requireLib=require("pydio").requireLib("boot"),PydioContextConsumer=_require$requireLib.PydioContextConsumer;exports.default=function(PydioComponent){var FieldWithChoices=function(_Component){_inherits(FieldWithChoices,_Component),FieldWithChoices.prototype.loadExternalValues=function(choices){var _this=this,pydio=this.props.pydio,parsed=!0,list_action=void 0;if(choices instanceof Map)return this.onChoicesLoaded&&this.onChoicesLoaded(choices),{choices:choices,parsed:parsed};var output=new Map;return 0===choices.indexOf("json_file:")?(parsed=!1,list_action=choices.replace("json_file:",""),output.set("0",pydio.MessageHash["ajxp_admin.home.6"]),PydioApi.getClient().loadFile(list_action,function(transport){var newOutput=new Map;if(transport.responseJSON)transport.responseJSON.forEach(function(entry){newOutput.set(entry.key,entry.label)});else if(transport.responseText)try{JSON.parse(transport.responseText).forEach(function(entry){newOutput.set(entry.key,entry.label)})}catch(e){console.log("Error while parsing list "+choices,e)}_this.setState({choices:newOutput},function(){_this.onChoicesLoaded&&_this.onChoicesLoaded(newOutput)})})):"PYDIO_AVAILABLE_LANGUAGES"===choices?(pydio.listLanguagesWithCallback(function(key,label){output.set(key,label)}),this.onChoicesLoaded&&this.onChoicesLoaded(output)):"PYDIO_AVAILABLE_REPOSITORIES"===choices?(pydio.user&&function(){var sorter=[];pydio.user.repositories.forEach(function(repository){"cell"!==repository.getRepositoryType()&&sorter.push({id:repository.getId(),label:repository.getLabel()})}),sorter.sort(function(a,b){return a.label>b.label?1:-1}),sorter.forEach(function(d){return output.set(d.id,d.label)})}(),this.onChoicesLoaded&&this.onChoicesLoaded(output)):choices.split(",").map(function(choice){var label=void 0,value=void 0,l=choice.split("|");l.length>1?(value=l[0],label=l[1]):value=label=choice,global.pydio.MessageHash[label]&&(label=global.pydio.MessageHash[label]),output.set(value,label)}),{choices:output,parsed:parsed}};function FieldWithChoices(props,context){_classCallCheck(this,FieldWithChoices),_Component.call(this,props,context);var choices=new Map;choices.set("0",this.props.pydio?this.props.pydio.MessageHash["ajxp_admin.home.6"]:" ... "),this.state={choices:choices,choicesParsed:!1}}return FieldWithChoices.prototype.componentDidMount=function(){if(this.props.attributes.choices){var _loadExternalValues=this.loadExternalValues(this.props.attributes.choices),choices=_loadExternalValues.choices,parsed=_loadExternalValues.parsed;this.setState({choices:choices,choicesParsed:parsed})}},FieldWithChoices.prototype.componentWillReceiveProps=function(newProps){if(newProps.attributes.choices&&newProps.attributes.choices!==this.props.attributes.choices){var _loadExternalValues2=this.loadExternalValues(newProps.attributes.choices),choices=_loadExternalValues2.choices,parsed=_loadExternalValues2.parsed;this.setState({choices:choices,choicesParsed:parsed})}},FieldWithChoices.prototype.render=function(){return React.createElement(PydioComponent,_extends({},this.props,this.state))},FieldWithChoices}(Component);return FieldWithChoices=PydioContextConsumer(FieldWithChoices)},module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{pydio:"pydio",react:"react"}],17:[function(require,module,exports){(function(global){"use strict";exports.__esModule=!0;var React=require("react");require("pydio/http/api");exports.default={propTypes:{attributes:React.PropTypes.object.isRequired,name:React.PropTypes.string.isRequired,displayContext:React.PropTypes.oneOf(["form","grid"]),disabled:React.PropTypes.bool,multiple:React.PropTypes.bool,value:React.PropTypes.any,onChange:React.PropTypes.func,onChangeEditMode:React.PropTypes.func,binary_context:React.PropTypes.string,errorText:React.PropTypes.string},getDefaultProps:function(){return{displayContext:"form",disabled:!1}},isDisplayGrid:function(){return"grid"==this.props.displayContext},isDisplayForm:function(){return"form"==this.props.displayContext},toggleEditMode:function(){if(!this.isDisplayForm()){var newState=!this.state.editMode;this.setState({editMode:newState}),this.props.onChangeEditMode&&this.props.onChangeEditMode(newState)}},enterToToggle:function(event){"Enter"==event.key&&this.toggleEditMode()},bufferChanges:function(newValue,oldValue){this.triggerPropsOnChange(newValue,oldValue)},onChange:function(event,value){void 0===value&&(value=event.currentTarget.getValue?event.currentTarget.getValue():event.currentTarget.value),this.changeTimeout&&global.clearTimeout(this.changeTimeout);var newValue=value,oldValue=this.state.value;if(this.props.skipBufferChanges&&this.triggerPropsOnChange(newValue,oldValue),this.setState({dirty:!0,value:newValue}),!this.props.skipBufferChanges){var timerLength=250;"password"===this.props.attributes.type&&(timerLength=1200),this.changeTimeout=global.setTimeout(function(){this.bufferChanges(newValue,oldValue)}.bind(this),timerLength)}},triggerPropsOnChange:function(newValue,oldValue){"password"===this.props.attributes.type?(this.toggleEditMode(),this.props.onChange(newValue,oldValue,{type:this.props.attributes.type})):this.props.onChange(newValue,oldValue)},componentWillReceiveProps:function(newProps){this.setState({value:newProps.value,dirty:!1})},getInitialState:function(){return{editMode:!1,dirty:!1,value:this.props.value}}},module.exports=exports.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pydio/http/api":"pydio/http/api",react:"react"}],18:[function(require,module,exports){"use strict";exports.__esModule=!0;var React=require("react");exports.default={propTypes:{paramName:React.PropTypes.string,paramAttributes:React.PropTypes.object,values:React.PropTypes.object,updateCallback:React.PropTypes.func}},module.exports=exports.default},{react:"react"}],19:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _managerManager=require("../manager/Manager"),_managerManager2=_interopRequireDefault(_managerManager),React=require("react"),_require$requireLib=require("pydio").requireLib("boot"),AsyncComponent=_require$requireLib.AsyncComponent;exports.default=React.createClass({displayName:"FormHelper",propTypes:{helperData:React.PropTypes.object,close:React.PropTypes.func.isRequired},closeHelper:function(){this.props.close()},render:function(){var helper=void 0;if(this.props.helperData){var helpersCache=_managerManager2.default.getHelpersCache(),pluginHelperNamespace=helpersCache[this.props.helperData.pluginId].namespace;helper=React.createElement("div",null,React.createElement("div",{className:"helper-title"},React.createElement("span",{className:"helper-close mdi mdi-close",onClick:this.closeHelper}),"Pydio Companion"),React.createElement("div",{className:"helper-content"},React.createElement(AsyncComponent,_extends({},this.props.helperData,{namespace:pluginHelperNamespace,componentName:"Helper",paramName:this.props.helperData.paramAttributes.name}))))}return React.createElement("div",{className:"pydio-form-helper"+(helper?" helper-visible":" helper-empty"),style:{zIndex:1}},helper)}}),module.exports=exports.default},{"../manager/Manager":14,pydio:"pydio",react:"react"}],20:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _react=require("react"),_react2=_interopRequireDefault(_react),_GroupSwitchPanel=require("./GroupSwitchPanel"),_GroupSwitchPanel2=_interopRequireDefault(_GroupSwitchPanel),_ReplicationPanel=require("./ReplicationPanel"),_ReplicationPanel2=_interopRequireDefault(_ReplicationPanel),_managerManager=require("../manager/Manager"),_managerManager2=_interopRequireDefault(_managerManager),_pydioUtilLang=require("pydio/util/lang"),_pydioUtilLang2=_interopRequireDefault(_pydioUtilLang),_materialUi=require("material-ui");exports.default=_react2.default.createClass({displayName:"FormPanel",_hiddenValues:{},_internalValid:null,_parametersMetadata:null,propTypes:{parameters:_react2.default.PropTypes.array.isRequired,values:_react2.default.PropTypes.object,onParameterChange:_react2.default.PropTypes.func,onChange:_react2.default.PropTypes.func,onValidStatusChange:_react2.default.PropTypes.func,disabled:_react2.default.PropTypes.bool,binary_context:_react2.default.PropTypes.string,depth:_react2.default.PropTypes.number,header:_react2.default.PropTypes.object,footer:_react2.default.PropTypes.object,additionalPanes:_react2.default.PropTypes.shape({top:_react2.default.PropTypes.array,bottom:_react2.default.PropTypes.array}),tabs:_react2.default.PropTypes.array,onTabChange:_react2.default.PropTypes.func,accordionizeIfGroupsMoreThan:_react2.default.PropTypes.number,onScrollCallback:_react2.default.PropTypes.func,limitToGroups:_react2.default.PropTypes.array,skipFieldsTypes:_react2.default.PropTypes.array,setHelperData:_react2.default.PropTypes.func,checkHasHelper:_react2.default.PropTypes.func,helperTestFor:_react2.default.PropTypes.string},externallySelectTab:function(index){this.setState({tabSelectedIndex:index})},getInitialState:function(){return this.props.onTabChange?{tabSelectedIndex:0}:{}},getDefaultProps:function(){return{depth:0,values:{}}},componentWillReceiveProps:function(newProps){JSON.stringify(newProps.parameters)!==JSON.stringify(this.props.parameters)&&(this._internalValid=null,this._hiddenValues={},this._parametersMetadata={}),newProps.values&&newProps.values!==this.props.values&&this.checkValidStatus(newProps.values)},getValues:function(){return this.props.values},onParameterChange:function(paramName,newValue,oldValue){var additionalFormData=arguments.length<=3||void 0===arguments[3]?null:arguments[3],newValues=_pydioUtilLang2.default.deepCopy(this.getValues());this.props.onParameterChange&&this.props.onParameterChange(paramName,newValue,oldValue,additionalFormData),additionalFormData&&(this._parametersMetadata||(this._parametersMetadata={}),this._parametersMetadata[paramName]=additionalFormData),newValues[paramName]=newValue,this.onChange(newValues,!0)},onChange:function(newValues,dirty,removeValues){if(this.props.onChange){for(var key in this._hiddenValues)!this._hiddenValues.hasOwnProperty(key)||void 0!==newValues[key]||removeValues&&void 0!==removeValues[key]||(newValues[key]=this._hiddenValues[key]);this.props.onChange(newValues,dirty,removeValues)}this.checkValidStatus(newValues)},onSubformChange:function(newValues,dirty,removeValues){var values=_pydioUtilLang2.default.mergeObjectsRecursive(this.getValues(),newValues);if(removeValues)for(var k in removeValues)removeValues.hasOwnProperty(k)&&void 0!==values[k]&&(delete values[k],void 0!==this._hiddenValues[k]&&delete this._hiddenValues[k]);this.onChange(values,dirty,removeValues)},onSubformValidStatusChange:function(newValidValue,failedMandatories){(newValidValue!==this._internalValid||this.props.forceValidStatusCheck)&&this.props.onValidStatusChange&&this.props.onValidStatusChange(newValidValue,failedMandatories),this._internalValid=newValidValue},applyButtonAction:function(parameters,callback){this.props.applyButtonAction&&this.props.applyButtonAction(parameters,callback)},getValuesForPOST:function(values){var prefix=arguments.length<=1||void 0===arguments[1]?"DRIVER_OPTION_":arguments[1];return _managerManager2.default.getValuesForPOST(this.props.parameters,values,prefix,this._parametersMetadata)},checkValidStatus:function(values){var failedMandatories=[];this.props.parameters.map(function(p){["string","textarea","password","integer"].indexOf(p.type)>-1&&("true"===p.mandatory||!0===p.mandatory)&&(values&&values.hasOwnProperty(p.name)&&void 0!==values[p.name]&&""!==values[p.name]||failedMandatories.push(p)),"valid-password"===p.type&&this.refs["form-element-"+p.name]&&(this.refs["form-element-"+p.name].isValid()||failedMandatories.push(p))}.bind(this));var newValue=void 0;this._internalValid,newValue=!failedMandatories.length,(newValue!==this._internalValid||this.props.forceValidStatusCheck)&&this.props.onValidStatusChange&&this.props.onValidStatusChange(newValue,failedMandatories),this._internalValid=newValue},componentDidMount:function(){this.checkValidStatus(this.props.values)},renderGroupHeader:function(groupLabel,accordionize,index,active){var properties={key:"group-"+groupLabel};if(accordionize){var current=this.state&&this.state.currentActiveGroup?this.state.currentActiveGroup:null;properties.className="group-label-"+(active?"active":"inactive"),properties.onClick=function(){this.setState({currentActiveGroup:current!==index?index:null})}.bind(this),groupLabel=[_react2.default.createElement("span",{key:"toggler",className:"group-active-toggler icon-angle-"+(current===index?"down":"right")}),groupLabel]}return _react2.default.createElement("h"+(3+this.props.depth),properties,groupLabel)},render:function(){var _this2=this,allGroups=[],values=this.getValues(),groupsOrdered=["__DEFAULT__"];allGroups.__DEFAULT__={FIELDS:[]};var replicationGroups={};this.props.parameters.map(function(attributes){var _this=this,type=attributes.type;if(!(this.props.skipFieldsTypes&&this.props.skipFieldsTypes.indexOf(type)>-1)){var field,paramName=attributes.name;if(!attributes.group_switch_name){var group=attributes.group||"__DEFAULT__";allGroups[group]||(groupsOrdered.push(group),allGroups[group]={FIELDS:[],LABEL:group});var repGroup=attributes.replicationGroup;if(repGroup){replicationGroups[repGroup]||(replicationGroups[repGroup]={PARAMS:[],GROUP:group,POSITION:allGroups[group].FIELDS.length},allGroups[group].FIELDS.push("REPLICATION:"+repGroup));var repAttr=_pydioUtilLang2.default.deepCopy(attributes);delete repAttr.replicationGroup,delete repAttr.group,replicationGroups[repGroup].PARAMS.push(repAttr)}else{if(0===type.indexOf("group_switch:"))field=_react2.default.createElement(_GroupSwitchPanel2.default,_extends({},this.props,{onChange:this.onSubformChange,paramAttributes:attributes,parameters:this.props.parameters,values:this.props.values,key:paramName,onScrollCallback:null,limitToGroups:null,onValidStatusChange:this.onSubformValidStatusChange}));else if("hidden"!==attributes.type){var helperMark;if(this.props.setHelperData&&this.props.checkHasHelper&&this.props.checkHasHelper(attributes.name,this.props.helperTestFor)){var showHelper=function(){this.props.setHelperData({paramAttributes:attributes,values:values,postValues:this.getValuesForPOST(values),applyButtonAction:this.applyButtonAction},this.props.helperTestFor)}.bind(this);helperMark=_react2.default.createElement("span",{className:"icon-question-sign",onClick:showHelper})}var mandatoryMissing=!1,classLegend="form-legend";attributes.errorText?classLegend="form-legend mandatory-missing":attributes.warningText?classLegend="form-legend warning-message":!attributes.mandatory||"true"!==attributes.mandatory&&!0!==attributes.mandatory||-1===["string","textarea","image","integer"].indexOf(attributes.type)||values[paramName]||(mandatoryMissing=!0,classLegend="form-legend mandatory-missing");var props={ref:"form-element-"+paramName,attributes:attributes,name:paramName,value:values[paramName],onChange:function(newValue,oldValue,additionalFormData){_this.onParameterChange(paramName,newValue,oldValue,additionalFormData)},disabled:this.props.disabled||attributes.readonly,multiple:attributes.multiple,binary_context:this.props.binary_context,displayContext:"form",applyButtonAction:this.applyButtonAction,errorText:mandatoryMissing?pydio.MessageHash[621]:attributes.errorText?attributes.errorText:null};field=_react2.default.createElement("div",{key:paramName,className:"form-entry-"+attributes.type},_managerManager2.default.createFormElement(props),_react2.default.createElement("div",{className:classLegend},attributes.warningText?attributes.warningText:attributes.description," ",helperMark))}else this._hiddenValues[paramName]=void 0===values[paramName]?attributes.default:values[paramName];field&&allGroups[group].FIELDS.push(field)}}}}.bind(this));for(var rGroup in replicationGroups)if(replicationGroups.hasOwnProperty(rGroup)){var rGroupData=replicationGroups[rGroup]
;allGroups[rGroupData.GROUP].FIELDS[rGroupData.POSITION]=_react2.default.createElement(_ReplicationPanel2.default,_extends({},this.props,{key:"replication-group-"+rGroupData.PARAMS[0].name,onChange:this.onSubformChange,onParameterChange:null,values:this.getValues(),depth:this.props.depth+1,parameters:rGroupData.PARAMS,applyButtonAction:this.applyButtonAction,onScrollCallback:null}))}var groupPanes=[],accordionize=this.props.accordionizeIfGroupsMoreThan&&groupsOrdered.length>this.props.accordionizeIfGroupsMoreThan,currentActiveGroup=this.state&&this.state.currentActiveGroup?this.state.currentActiveGroup:0;if(groupsOrdered.map(function(g,gIndex){if(!this.props.limitToGroups||-1!==this.props.limitToGroups.indexOf(g)){var header,gData=allGroups[g],className="pydio-form-group",active=!1;accordionize&&(active=currentActiveGroup===gIndex,className+=gIndex===currentActiveGroup?" form-group-active":" form-group-inactive"),gData.FIELDS.length&&(!gData.LABEL||this.props.skipFieldsTypes&&this.props.skipFieldsTypes.indexOf("GroupHeader")>-1||(header=this.renderGroupHeader(gData.LABEL,accordionize,gIndex,active)),0===this.props.depth?(className+=" z-depth-1",groupPanes.push(_react2.default.createElement(_materialUi.Paper,{className:className,key:"pane-"+g},0===gIndex&&this.props.header?this.props.header:null,header,_react2.default.createElement("div",null,gData.FIELDS),gIndex===groupsOrdered.length-1&&this.props.footer?this.props.footer:null))):groupPanes.push(_react2.default.createElement("div",{className:className,key:"pane-"+g},0===gIndex&&this.props.header?this.props.header:null,header,_react2.default.createElement("div",null,gData.FIELDS),gIndex===groupsOrdered.length-1&&this.props.footer?this.props.footer:null)))}}.bind(this)),this.props.additionalPanes&&function(){var otherPanes={top:[],bottom:[]},depth=_this2.props.depth,index=0,_loop=function(k){if(!otherPanes.hasOwnProperty(k))return"continue";_this2.props.additionalPanes[k]&&_this2.props.additionalPanes[k].map(function(p){0===depth?otherPanes[k].push(_react2.default.createElement(_materialUi.Paper,{className:"pydio-form-group additional",key:"other-pane-"+index},p)):otherPanes[k].push(_react2.default.createElement("div",{className:"pydio-form-group additional",key:"other-pane-"+index},p)),index++})};for(var k in otherPanes){_loop(k)}groupPanes=otherPanes.top.concat(groupPanes).concat(otherPanes.bottom)}(),!this.props.tabs)return _react2.default.createElement("div",{className:(this.props.className?this.props.className+" ":" ")+"pydio-form-panel"+(groupPanes.length%2?" form-panel-odd":""),onScroll:this.props.onScrollCallback},groupPanes);var _ret3=function(){var className=_this2.props.className,initialSelectedIndex=0,i=0,tabs=_this2.props.tabs.map(function(tDef){var label=tDef.label,groups=tDef.groups;tDef.selected&&(initialSelectedIndex=i);var panes=groups.map(function(gId){return groupPanes[gId]?groupPanes[gId]:null});return i++,_react2.default.createElement(_materialUi.Tab,{label:label,key:label,value:this.props.onTabChange?i-1:void 0},_react2.default.createElement("div",{className:(className?className+" ":" ")+"pydio-form-panel"+(panes.length%2?" form-panel-odd":"")},panes))}.bind(_this2));return void 0!==_this2.state.tabSelectedIndex&&(initialSelectedIndex=_this2.state.tabSelectedIndex),{v:_react2.default.createElement("div",{className:"layout-fill vertical-layout tab-vertical-layout"},_react2.default.createElement(_materialUi.Tabs,{ref:"tabs",initialSelectedIndex:initialSelectedIndex,value:_this2.props.onTabChange?initialSelectedIndex:void 0,onChange:_this2.props.onTabChange?function(i){_this2.setState({tabSelectedIndex:i}),_this2.props.onTabChange(i)}:void 0,style:{flex:1,display:"flex",flexDirection:"column"},contentContainerStyle:{flex:1,overflowY:"auto"}},tabs))}}();return"object"==typeof _ret3?_ret3.v:void 0}}),module.exports=exports.default},{"../manager/Manager":14,"./GroupSwitchPanel":21,"./ReplicationPanel":23,"material-ui":"material-ui","pydio/util/lang":"pydio/util/lang",react:"react"}],21:[function(require,module,exports){"use strict";exports.__esModule=!0;function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _FormPanel=require("./FormPanel"),_FormPanel2=_interopRequireDefault(_FormPanel),_fieldsInputSelectBox=require("../fields/InputSelectBox"),_fieldsInputSelectBox2=_interopRequireDefault(_fieldsInputSelectBox),React=require("react"),LangUtils=require("pydio/util/lang");exports.default=React.createClass({displayName:"GroupSwitchPanel",propTypes:{paramAttributes:React.PropTypes.object.isRequired,parameters:React.PropTypes.array.isRequired,values:React.PropTypes.object.isRequired,onChange:React.PropTypes.func.isRequired},computeSubPanelParameters:function(){var switchName=this.props.paramAttributes.type.split(":").pop(),parentName=this.props.paramAttributes.name,switchValues={},potentialSubSwitches=[];this.props.parameters.map(function(p){if(p.group_switch_name){if(p.group_switch_name!=switchName)return void potentialSubSwitches.push(p);var crtSwitch=p.group_switch_value;switchValues[crtSwitch]||(switchValues[crtSwitch]={label:p.group_switch_label,fields:[],values:{},fieldsKeys:{}}),p=LangUtils.deepCopy(p),delete p.group_switch_name,p.name=parentName+"/"+p.name;var vKey=p.name,paramName=vKey;switchValues[crtSwitch].fieldsKeys[paramName]||(switchValues[crtSwitch].fields.push(p),switchValues[crtSwitch].fieldsKeys[paramName]=paramName,this.props.values&&this.props.values[vKey]&&(switchValues[crtSwitch].values[paramName]=this.props.values[vKey]))}}.bind(this));for(var k in switchValues)if(switchValues.hasOwnProperty(k)){var sv=switchValues[k];sv.fields=sv.fields.concat(potentialSubSwitches)}return switchValues},clearSubParametersValues:function(parentName,newValue,newFields){var vals=LangUtils.deepCopy(this.props.values),toRemove={};for(var key in vals)vals.hasOwnProperty(key)&&0===key.indexOf(parentName+"/")&&(toRemove[key]="");vals[parentName]=newValue,newFields.map(function(p){"hidden"==p.type&&p.default&&!p.group_switch_name||p.group_switch_name==parentName?(vals[p.name]=p.default,void 0!==toRemove[p.name]&&delete toRemove[p.name]):0===p.name.indexOf(parentName+"/")&&p.default&&(p.type&&p.type.startsWith("group_switch:"),vals[p.name]=p.default)}),this.props.onChange(vals,!0,toRemove)},onChange:function(newValues,dirty,removeValues){this.props.onChange(newValues,!0,removeValues)},render:function(){var attributes=this.props.paramAttributes,values=this.props.values,paramName=attributes.name,switchValues=this.computeSubPanelParameters(attributes),selectorValues=new Map;Object.keys(switchValues).map(function(k){selectorValues.set(k,switchValues[k].label)});var selectorChanger=function(newValue){this.clearSubParametersValues(paramName,newValue,switchValues[newValue]?switchValues[newValue].fields:[])}.bind(this),subForm=void 0,selectorLegend=void 0,selector=React.createElement(_fieldsInputSelectBox2.default,{key:paramName,name:paramName,className:"group-switch-selector",attributes:{name:paramName,choices:selectorValues,label:attributes.label,mandatory:attributes.mandatory},value:values[paramName],onChange:selectorChanger,displayContext:"form",disabled:this.props.disabled,ref:"subFormSelector"}),helperMark=void 0;if(this.props.setHelperData&&this.props.checkHasHelper&&this.props.checkHasHelper(attributes.name,this.props.helperTestFor)){var showHelper=function(){this.props.setHelperData({paramAttributes:attributes,values:values})}.bind(this);helperMark=React.createElement("span",{className:"icon-question-sign",onClick:showHelper})}return selectorLegend=React.createElement("div",{className:"form-legend"},attributes.description," ",helperMark),values[paramName]&&switchValues[values[paramName]]&&(React.createElement("h4",null,values[paramName]),subForm=React.createElement(_FormPanel2.default,{onParameterChange:this.props.onParameterChange,applyButtonAction:this.props.applyButtonAction,disabled:this.props.disabled,ref:paramName+"-SUB",key:paramName+"-SUB",className:"sub-form",parameters:switchValues[values[paramName]].fields,values:values,depth:this.props.depth+1,onChange:this.onChange,checkHasHelper:this.props.checkHasHelper,setHelperData:this.props.setHelperData,helperTestFor:values[paramName],accordionizeIfGroupsMoreThan:5})),React.createElement("div",{className:"sub-form-group"},selector,selectorLegend,subForm)}}),module.exports=exports.default},{"../fields/InputSelectBox":8,"./FormPanel":20,"pydio/util/lang":"pydio/util/lang",react:"react"}],22:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}var _react=require("react"),_materialUi=require("material-ui"),_FormPanel=require("./FormPanel"),_FormPanel2=_interopRequireDefault(_FormPanel),UP_ARROW="mdi mdi-chevron-up",DOWN_ARROW="mdi mdi-chevron-down",REMOVE="mdi mdi-close",ADD_VALUE="mdi mdi-plus",ReplicatedGroup=function(_Component){_inherits(ReplicatedGroup,_Component);function ReplicatedGroup(props,context){_classCallCheck(this,ReplicatedGroup),_Component.call(this,props,context);var subValues=props.subValues,parameters=props.parameters,firstParam=parameters[0],instanceValue=subValues[firstParam.name]||"";this.state={toggled:!instanceValue}}return ReplicatedGroup.prototype.render=function(){var _this=this,_props=this.props,depth=_props.depth,onSwapUp=_props.onSwapUp,onSwapDown=_props.onSwapDown,onRemove=_props.onRemove,parameters=_props.parameters,subValues=_props.subValues,disabled=_props.disabled,onAddValue=_props.onAddValue,toggled=this.state.toggled,unique=1===parameters.length,firstParam=parameters[0],instanceValue=subValues[firstParam.name]||React.createElement("span",{style:{color:"rgba(0,0,0,0.33)"}},"Empty Value"),ibStyles={width:36,height:36,padding:6};if(unique){var disStyle={opacity:.3},remStyle=!onRemove||disabled?disStyle:{},upStyle=!onSwapUp||disabled?disStyle:{},downStyle=!onSwapDown||disabled?disStyle:{};return React.createElement("div",{style:{display:"flex",width:"100%"}},React.createElement("div",{style:{flex:1}},React.createElement(_FormPanel2.default,_extends({},this.props,{tabs:null,values:subValues,onChange:null,className:"replicable-unique",depth:-1,style:{paddingBottom:0}}))),React.createElement("div",{style:{display:"flex",fontSize:24,paddingLeft:4,paddingTop:2}},onAddValue&&React.createElement("div",null,React.createElement("div",{className:ADD_VALUE,style:{padding:"8px 4px",cursor:"pointer"},onClick:onAddValue})),React.createElement("div",null,React.createElement("div",{className:REMOVE,style:_extends({padding:"8px 4px",cursor:"pointer"},remStyle),onClick:onRemove})),React.createElement("div",{style:{display:"flex",flexDirection:"column",padding:"0 4px"}},React.createElement("div",{className:UP_ARROW,style:_extends({height:16,cursor:"pointer"},upStyle),onClick:onSwapUp}),React.createElement("div",{className:DOWN_ARROW,style:_extends({height:16,cursor:"pointer"},downStyle),onClick:onSwapDown}))))}return React.createElement(_materialUi.Paper,{zDepth:0,style:{border:"2px solid whitesmoke",marginBottom:8}},React.createElement("div",{style:{display:"flex",alignItems:"center"}},React.createElement("div",null,React.createElement(_materialUi.IconButton,{iconClassName:"mdi mdi-menu-"+(this.state.toggled?"down":"right"),iconStyle:{color:"rgba(0,0,0,.15)"},onTouchTap:function(){_this.setState({toggled:!_this.state.toggled})}})),React.createElement("div",{style:{flex:1,fontSize:16}},instanceValue),React.createElement("div",null,onAddValue&&React.createElement(_materialUi.IconButton,{style:ibStyles,iconClassName:ADD_VALUE,onTouchTap:onAddValue}),React.createElement(_materialUi.IconButton,{style:ibStyles,iconClassName:REMOVE,onTouchTap:onRemove,disabled:!onRemove||disabled}),React.createElement(_materialUi.IconButton,{style:ibStyles,iconClassName:UP_ARROW,onTouchTap:onSwapUp,disabled:!onSwapUp||disabled}),React.createElement(_materialUi.IconButton,{style:ibStyles,iconClassName:DOWN_ARROW,onTouchTap:onSwapDown,disabled:!onSwapDown||disabled}))),toggled&&React.createElement(_FormPanel2.default,_extends({},this.props,{tabs:null,values:subValues,onChange:null,className:"replicable-group",depth:depth})))},ReplicatedGroup}(_react.Component);exports.default=ReplicatedGroup,module.exports=exports.default},{"./FormPanel":20,"material-ui":"material-ui",react:"react"}],23:[function(require,module,exports){"use strict";exports.__esModule=!0;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _ReplicatedGroup=require("./ReplicatedGroup"),_ReplicatedGroup2=_interopRequireDefault(_ReplicatedGroup),React=require("react"),_require=require("material-ui"),IconButton=_require.IconButton,LangUtils=require("pydio/util/lang");exports.default=React.createClass({displayName:"ReplicationPanel",propTypes:{parameters:React.PropTypes.array.isRequired,values:React.PropTypes.object,onChange:React.PropTypes.func,disabled:React.PropTypes.bool,binary_context:React.PropTypes.string,depth:React.PropTypes.number},buildSubValue:function(values){var index=arguments.length<=1||void 0===arguments[1]?0:arguments[1],subVal=void 0,suffix=0==index?"":"_"+index;return this.props.parameters.map(function(p){var pName=p.name;void 0!==values[pName+suffix]&&(subVal||(subVal={}),subVal[pName]=values[pName+suffix])}),subVal||!1},indexedValues:function(rowsArray){var index=0,values={};return rowsArray.map(function(row){var suffix=0==index?"":"_"+index;for(var p in row)row.hasOwnProperty(p)&&(values[p+suffix]=row[p]);index++}),values},indexValues:function(rowsArray,removeLastRow){var _this=this,indexed=this.indexedValues(rowsArray);this.props.onChange&&(removeLastRow?function(){var lastRow={},nextIndex=rowsArray.length-1;_this.props.parameters.map(function(p){lastRow[p.name+(nextIndex>0?"_"+nextIndex:"")]=""}),_this.props.onChange(indexed,!0,lastRow)}():this.props.onChange(indexed,!0))},instances:function(){for(var _this2=this,rows=[],subVal=void 0,index=0;subVal=this.buildSubValue(this.props.values,index);)index++,rows.push(subVal);var firstParam=this.props.parameters[0];return rows.length||"true"!==firstParam.replicationMandatory||function(){var emptyValue={};_this2.props.parameters.map(function(p){emptyValue[p.name]=p.default||""}),rows.push(emptyValue)}(),rows},addRow:function(){var newValue={},currentValues=this.instances();this.props.parameters.map(function(p){newValue[p.name]=p.default||""}),currentValues.push(newValue),this.indexValues(currentValues)},removeRow:function(index){var instances=this.instances(),removeInst=instances[index];instances=LangUtils.arrayWithout(this.instances(),index),instances.push(removeInst),this.indexValues(instances,!0)},swapRows:function(i,j){var instances=this.instances(),tmp=instances[j];instances[j]=instances[i],instances[i]=tmp,this.indexValues(instances)},onChange:function(index,newValues,dirty){var instances=this.instances();instances[index]=newValues,this.indexValues(instances)},onParameterChange:function(index,paramName,newValue,oldValue){var instances=this.instances();instances[index][paramName]=newValue,this.indexValues(instances)},render:function(){var _this3=this,_props=this.props,parameters=_props.parameters,disabled=_props.disabled,firstParam=parameters[0],replicationTitle=firstParam.replicationTitle||firstParam.label,replicationMandatory=(firstParam.replicationDescription||firstParam.description,"true"===firstParam.replicationMandatory),instances=this.instances(),multipleRows=instances.length>1,rows=(parameters.length,instances.map(function(subValues,index){var onSwapUp=void 0,onSwapDown=void 0,onRemove=void 0,onParameterChange=function(paramName,newValue,oldValue){_this3.onParameterChange(index,paramName,newValue,oldValue)};multipleRows&&index>0&&(onSwapUp=function(){_this3.swapRows(index,index-1)}),multipleRows&&index<instances.length-1&&(onSwapDown=function(){_this3.swapRows(index,index+1)}),!multipleRows&&replicationMandatory||(onRemove=function(){_this3.removeRow(index)});var props={onSwapUp:onSwapUp,onSwapDown:onSwapDown,onRemove:onRemove,onParameterChange:onParameterChange};return replicationMandatory&&0===index&&(props.onAddValue=function(){return _this3.addRow()}),React.createElement(_ReplicatedGroup2.default,_extends({key:index},_this3.props,props,{subValues:subValues}))}));if(replicationMandatory)return React.createElement("div",{className:"replicable-field",style:{marginBottom:14}},rows);var tStyle=rows.length?{}:{backgroundColor:"whitesmoke",borderRadius:4};return React.createElement("div",{className:"replicable-field",style:{marginBottom:14}},React.createElement("div",{style:_extends({display:"flex",alignItems:"center"},tStyle)},React.createElement(IconButton,{key:"add",iconClassName:"mdi mdi-plus-box-outline",tooltipPosition:"top-right",style:{height:36,width:36,padding:6},iconStyle:{fontSize:24},tooltip:"Add value",onClick:function(){return _this3.addRow()},disabled:disabled}),React.createElement("div",{className:"title",style:{fontSize:16,flex:1}},replicationTitle)),rows)}}),module.exports=exports.default},{"./ReplicatedGroup":22,"material-ui":"material-ui","pydio/util/lang":"pydio/util/lang",react:"react"}]},{},[13])(13)});