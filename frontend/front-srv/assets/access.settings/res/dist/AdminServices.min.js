!function a(n,i,s){function o(t,e){if(!i[t]){if(!n[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(r=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",r}r=i[t]={exports:{}},n[t][0].call(r.exports,function(e){return o(n[t][1][e]||e)},r,r.exports,a,n,i,s)}return i[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)o(s[e]);return o}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=u(e("prop-types")),n=u(e("pydio")),i=u(e("pydio/model/data-model")),s=u(e("pydio/model/node")),o=u(e("react")),l=u(e("create-react-class")),d=u(e("./ServicesList")),c=e("material-ui");function u(e){return e&&e.__esModule?e:{default:e}}function p(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function f(a){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach(function(e){var t,r;t=a,e=n[r=e],r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(n,e))})}return a}var e=n.default.requireLib("hoc"),m=e.ModernStyles,y=e.ModernSelectField,n=(0,l.default)({displayName:"Dashboard",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:a.default.instanceOf(i.default).isRequired,rootNode:a.default.instanceOf(s.default).isRequired,currentNode:a.default.instanceOf(s.default).isRequired,openEditor:a.default.func.isRequired,openRightPane:a.default.func.isRequired,closeRightPane:a.default.func.isRequired,pydio:a.default.instanceOf(n.default)},getInitialState:function(){var e=localStorage.getItem("console.services.details");return{details:e&&"true"===e,filter:"",peers:[],peerFilter:""}},onDetailsChange:function(e,t){this.setState({details:t}),localStorage.setItem("console.services.details",t?"true":"false")},onFilterChange:function(e,t,r){this.setState({filter:r})},onPeerFilterChange:function(e,t,r){this.setState({peerFilter:r})},reloadList:function(){this.refs.servicesList.reload()},onUpdatePeers:function(e){this.setState({peers:e})},render:function(){var t=this.props.pydio,e=this.state,r=e.peers,a=e.peerFilter,n=e.filter,i=e.details,e=function(e){return t.MessageHash["ajxp_admin.services."+e]||e},r=o.default.createElement("div",{style:{display:"flex",alignItems:"center",width:"100%"}},o.default.createElement("div",{style:{width:170,marginRight:8}},o.default.createElement(c.Toggle,{label:e("toggle.details"),toggled:i,onToggle:this.onDetailsChange,labelPosition:"right",style:f({width:170},m.toggleField.style)})),0<r.length&&o.default.createElement("div",{style:{width:150,height:14,marginRight:8}},o.default.createElement(y,{fullWidth:!0,className:"media-small-hide",style:{marginTop:-10},underlineStyle:{display:"none"},value:a,onChange:this.onPeerFilterChange},o.default.createElement(c.MenuItem,{value:"",primaryText:e("peerfilter.title")}),r.map(function(e){return o.default.createElement(c.MenuItem,{value:e,primaryText:e})}))),o.default.createElement("div",{style:{width:150,height:14}},o.default.createElement(y,{fullWidth:!0,className:"media-small-hide",style:{marginTop:-10},underlineStyle:{display:"none"},value:n,onChange:this.onFilterChange},o.default.createElement(c.MenuItem,{value:"",primaryText:e("filter.nofilter")}),o.default.createElement(c.MenuItem,{value:"STARTED",primaryText:e("filter.started")}),o.default.createElement(c.MenuItem,{value:"STOPPED",primaryText:e("filter.stopped")})))),e=this.props.toolsAbsolute;return o.default.createElement("div",{className:"main-layout-nav-to-stack workspaces-board"},o.default.createElement("div",{className:"vertical-layout",style:{width:"100%"}},o.default.createElement(AdminComponents.Header,{title:e?"":this.context.getMessage("172","settings"),icon:e?"":"mdi mdi-access-point-network",legend:this.context.getMessage("173","settings"),actions:[r],reloadAction:this.reloadList.bind(this),style:e?{position:"absolute",top:0,right:0}:null}),o.default.createElement(d.default,{ref:"servicesList",pydio:t,className:"layout-fill",style:{paddingBottom:16},dataModel:this.props.dataModel,rootNode:this.props.rootNode,currentNode:this.props.rootNode,filter:n,peerFilter:a,details:i,onUpdatePeers:this.onUpdatePeers.bind(this)})))}});r.default=n,t.exports=r.default},{"./ServicesList":3,"create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/model/data-model":"pydio/model/data-model","pydio/model/node":"pydio/model/node",react:"react"}],2:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a,c=(a=e("react"))&&a.__esModule?a:{default:a},u=e("material-ui");function i(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);return e=a?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),t=this,!(e=e)||"object"!==n(e)&&"function"!=typeof e?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(n,c["default"].Component);var e,t,r,a=o(n);function n(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),a.apply(this,arguments)}return e=n,(t=[{key:"renderServiceLine",value:function(e,t,r,a){var n="STARTED"===e.Status?"#33691e":"#d32f2f",i=!1;"STARTED"!==e.Status&&e.Metadata&&e.Metadata.unique&&(n="#9E9E9E",i=!0);var s=e.Name.startsWith("pydio.grpc.")?"Grpc":"Rest";"gateway"===t?s=e.Name.split(".").pop():"datasource"===t&&(e.Name.startsWith("pydio.grpc.data.sync.")?s=a("datasource.sync"):e.Name.startsWith("pydio.grpc.data.objects.")?s=a("datasource.objects"):e.Name.startsWith("pydio.grpc.data.index.")&&(s=a("datasource.index")));var o=[];"STARTED"===e.Status&&e.RunningPeers?e.RunningPeers.map(function(e){e.Port?o.push(e.Address+":"+e.Port):o.push(e.Address)}):i?o.push("Standby"):o.push("N/A");return c.default.createElement("div",{style:{display:"flex",alignItems:"center",margin:"6px 8px",backgroundColor:"#F5F5F5",padding:"8px 6px",borderRadius:2}},c.default.createElement(u.FontIcon,{style:{margin:"0 9px 0 4px",fontSize:20},className:"mdi-traffic-light",color:n}),c.default.createElement("span",{style:{flex:1}},o.join(", ")),r&&c.default.createElement("span",{style:{fontStyle:"italic",paddingRight:6,fontWeight:500,color:"#9e9e9e"}},s))}},{key:"render",value:function(){function t(e){return l.MessageHash["ajxp_admin.services.service."+e]||e}var r,a=this,e=this.props,n=e.title,i=e.services,s=e.tagId,o=e.showDescription,l=e.pydio;1<i.length&&i.map(function(e){e.Name.startsWith("pydio.grpc.")&&(r=e.Description)});var d=r||i[0].Description;d||"datasource"!==s||(d=i[0].Name.startsWith("pydio.grpc.data.objects.")?t("datasource.objects.legend"):t("datasource.legend"));e={container:{flex:1,minWidth:200,margin:4,display:"flex",flexDirection:"column"},title:{padding:8,fontSize:15,fontWeight:500,borderBottom:"1px solid #eee"},description:{padding:8,flex:1}};return c.default.createElement(u.Paper,{zDepth:1,style:e.container},c.default.createElement("div",{style:e.title},n),o&&c.default.createElement("div",{style:e.description},d),c.default.createElement("div",null,i.map(function(e){return a.renderServiceLine(e,s,o,t)})))}}])&&i(e.prototype,t),r&&i(e,r),n}();r.default=d,t.exports=r.default},{"material-ui":"material-ui",react:"react"}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=l(e("prop-types")),n=l(e("pydio")),f=l(e("react")),i=l(e("create-react-class")),s=l(e("pydio/http/api")),o=e("cells-sdk"),m=e("material-ui"),y=l(e("./ServiceCard"));function l(e){return e&&e.__esModule?e:{default:e}}function d(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function h(a){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach(function(e){var t,r;t=a,e=n[r=e],r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(n,e))})}return a}function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r,a=arguments[t];for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var v=n.default.requireLib("components").MaterialTable,b=["gateway","datasource","data","idm","scheduler","broker","frontend","discovery"];a=(0,i.default)({displayName:"ServicesList",mixins:[AdminComponents.MessagesConsumerMixin],propTypes:{dataModel:a.default.instanceOf(PydioDataModel).isRequired,rootNode:a.default.instanceOf(AjxpNode).isRequired,currentNode:a.default.instanceOf(AjxpNode).isRequired,filter:a.default.string,peerFilter:a.default.string,details:a.default.bool,onUpdatePeers:a.default.func},getInitialState:function(){return{services:[]}},componentDidMount:function(){this.load()},reload:function(){this.load()},load:function(){var r=this,e=new o.ConfigServiceApi(s.default.getRestClient());n.default.startLoading(),this.setState({loading:!0}),e.listServices().then(function(e){var t;n.default.endLoading(),r.setState({loading:!1}),r.setState({services:e.Services}),r.props.onUpdatePeers&&(e=e.Services,t={},e.map(function(e){e.RunningPeers&&e.RunningPeers.map(function(e){t[e.Address]=e.Address})}),e=Object.keys(t),r.props.onUpdatePeers(e))}).catch(function(){n.default.endLoading(),r.setState({loading:!1})})},renderListItem:function(e){var t,r=[],a=this.props,n=a.details,a=a.pydio;return n&&(e.Description&&r.push(e.Description),(n=e.RunningPeers)&&n.length&&(t=[],n.map(function(e){t.push(e.Address)}),r.push(a.MessageHash["ajxp_admin.services.service.ip"].replace("%s",t.join(","))))),f.default.createElement(m.ListItem,{primaryText:e.Name,secondaryText:r.join(" - "),leftCheckbox:f.default.createElement(m.Checkbox,{defaultChecked:"STARTED"===e.Status,checked:"STARTED"===e.Status})})},filterNodes:function(e){var t=this;return-1===e.Name.indexOf(".(.+)")&&((!this.props.filter||e.Status===this.props.filter)&&(!this.props.peerFilter||!!e.RunningPeers&&0<e.RunningPeers.filter(function(e){return e.Address===t.props.peerFilter}).length))},render:function(){function n(e){return s.MessageHash["ajxp_admin.services.tag."+e]||e}var e,i,t=this,r=this.props,s=r.pydio,a=r.details,o=this.state,l=o.services,r=void 0===l?[]:l,l=o.loading,d={margin:16,display:"flex",flexWrap:"wrap"},o=function(e){return s.MessageHash["ajxp_admin.services.column."+e]||e},c=(e=r.filter(function(e){return t.filterNodes(e)}),i={},e.sort(function(e,t){return e.Name>t.Name?1:e.Name===t.Name?0:-1}),b.forEach(function(a){i[a]={services:{}},e.map(function(e){var t,r;a===e.Tag&&((r=e.Name).startsWith("pydio.grpc.")?r=r.replace("pydio.grpc.",""):r.startsWith("pydio.rest.")&&(r=r.replace("pydio.rest.","")),"datasource"===a&&r.startsWith("data.")&&(r="index"===(r=r.replace("data.",""))||"sync"===r||"objects"===r?"main - "+r:(t=r.split(".").shift(),r=r.split(".").pop(),"objects"===t?"objects - "+r:"datasource - "+r)),i[a].services[r]||(i[a].services[r]=[]),i[a].services[r].push(e))})}),i);if(a){var u=Object.keys(c).map(function(t){var r=c[t].services,e=Object.keys(r).map(function(e){return f.default.createElement(y.default,{pydio:s,showDescription:!0,title:e,tagId:t,services:r[e]})}),a=[];return"datasource"===t?(a.push(f.default.createElement("div",{style:h(h({},d),{},{margin:"0 16px"})},Object.keys(r).map(function(e){return e.startsWith("main -")?f.default.createElement(y.default,{pydio:s,showDescription:!0,title:e.replace("main - ",""),tagId:t,services:r[e]}):null}))),a.push(f.default.createElement("div",{style:h(h({},d),{},{margin:"0 16px"})},Object.keys(r).map(function(e){return e.startsWith("datasource -")?f.default.createElement(y.default,{pydio:s,showDescription:!0,title:e.replace("datasource - ",""),tagId:t,services:r[e]}):null}))),a.push(f.default.createElement("div",{style:h(h({},d),{},{margin:"0 16px"})},Object.keys(r).map(function(e){return e.startsWith("objects -")?f.default.createElement(y.default,{pydio:s,showDescription:!0,title:e.replace("objects - ",""),tagId:t,services:r[e]}):null})))):a.push(f.default.createElement("div",{style:d},Object.keys(r).map(function(e){return f.default.createElement(y.default,{pydio:s,showDescription:!0,title:e,tagId:t,services:r[e]})}))),0===e.length?null:f.default.createElement("div",null,f.default.createElement(AdminComponents.SubHeader,{title:n(t+".title"),legend:n(t+".description")}),a)});return f.default.createElement("div",{className:this.props.className,style:this.props.style},u)}var p=[],r=[{name:"Status",label:"",style:{width:56,paddingLeft:12,paddingRight:12,textOverflow:"inherit"},headerStyle:{width:56},renderCell:function(e){var t="STARTED"===e.Status?"#33691e":"#d32f2f",r="STARTED"===e.Status?"Running":"Stopped";return"STARTED"!==e.Status&&e.Metadata&&e.Metadata.unique&&(t="#9E9E9E",r="Standby"),{element:f.default.createElement(m.FontIcon,{style:{margin:"0 9px 0 4px",fontSize:20},className:"mdi-traffic-light",color:t}),text:r}}},{name:"Name",label:o("name"),style:{paddingLeft:0},headerStyle:{paddingLeft:0}},{name:"Description",label:o("description"),style:{width:"40%"},headerStyle:{width:"40%"},hideSmall:!0},{name:"Version",label:o("version"),style:{width:110},headerStyle:{width:110},hideSmall:!0},{name:"Type",label:o("tag"),style:{width:120},headerStyle:{width:120},hideSmall:!0,renderCell:function(e){function t(e){return s.MessageHash["ajxp_admin.services.service."+e]||e}var r=e.Name.startsWith("pydio.grpc.")?"Grpc":"Rest";return"gateway"===e.Tag?r=e.Name.split(".").pop():"datasource"===e.Tag&&(e.Name.startsWith("pydio.grpc.data.sync.")?r=t("datasource.sync"):e.Name.startsWith("pydio.grpc.data.objects.")?r=t("datasource.objects"):e.Name.startsWith("pydio.grpc.data.index.")&&(r=t("datasource.index"))),r}},{name:"RunningPeers",label:o("peers"),hideSmall:!0,renderCell:function(e){var t=[];return"STARTED"===e.Status&&e.RunningPeers?t=e.RunningPeers.map(function(e){return e.Metadata&&e.Metadata["non-addressable"]?e.Metadata["non-addressable"]:e.Port?e.Address+":"+e.Port:e.Address}):t.push("N/A"),t.join(",")}}];Object.keys(c).forEach(function(e){var t=[],r=c[e].services;Object.keys(r).forEach(function(e){r[e].forEach(function(e){t.push(e)})}),t.length&&(t.unshift({Subheader:f.default.createElement("span",null,f.default.createElement("span",{style:{textTransform:"uppercase"}},n(e+".title"))," - ",n(e+".description"))}),p.push.apply(p,t))});a=AdminComponents.AdminStyles().body,u=a.tableMaster,o=a.block.props,a=a.block.container;return f.default.createElement("div",{className:this.props.className,style:this.props.style},f.default.createElement(m.Paper,g({},o,{style:a}),f.default.createElement(v,{data:p,columns:r,deselectOnClickAway:!0,showCheckboxes:!1,emptyStateString:s.MessageHash["ajxp_admin.services.empty."+(l?"loading":"noservice")],masterStyles:u})))}});r.default=a,t.exports=r.default},{"./ServiceCard":2,"cells-sdk":"cells-sdk","create-react-class":"create-react-class","material-ui":"material-ui","prop-types":"prop-types",pydio:"pydio","pydio/http/api":"pydio/http/api",react:"react"}],4:[function(e,t,r){"use strict";var a,n=(a=e("./board/Dashboard"))&&a.__esModule?a:{default:a};window.AdminServices={Dashboard:n.default}},{"./board/Dashboard":1}]},{},[4]);